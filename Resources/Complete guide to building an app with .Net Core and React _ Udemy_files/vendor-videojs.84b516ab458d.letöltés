/*! For license information please see vendor-videojs.84b516ab458dfea2eac8.js.LICENSE.txt */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vendor-videojs"],{"./node_modules/@videojs/http-streaming/dist/videojs-http-streaming.es.js":function(e,t,r){"use strict";var i=r("./node_modules/url-toolkit/src/url-toolkit.js");var n=r.n(i);var a=r("./node_modules/global/window.js");var s=r.n(a);var o=r("./node_modules/video.js/dist/video.cjs.js");var u=r.n(o);function l(){l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};return l.apply(this,arguments)}function d(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function f(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var c=function(){function e(){this.listeners={}}var t=e.prototype;t.on=function e(t,r){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(r)};t.off=function e(t,r){if(!this.listeners[t]){return false}var i=this.listeners[t].indexOf(r);this.listeners[t].splice(i,1);return i>-1};t.trigger=function e(t){var r=this.listeners[t];var i;var n;var a;if(!r){return}if(arguments.length===2){n=r.length;for(i=0;i<n;++i){r[i].call(this,arguments[1])}}else{a=Array.prototype.slice.call(arguments,1);n=r.length;for(i=0;i<n;++i){r[i].apply(this,a)}}};t.dispose=function e(){this.listeners={}};t.pipe=function e(t){this.on("data",(function(e){t.push(e)}))};return e}();var h=function(e){d(t,e);function t(){var t;t=e.call(this)||this;t.buffer="";return t}var r=t.prototype;r.push=function e(t){var r;this.buffer+=t;r=this.buffer.indexOf("\n");for(;r>-1;r=this.buffer.indexOf("\n")){this.trigger("data",this.buffer.substring(0,r));this.buffer=this.buffer.substring(r+1)}};return t}(c);var p=function e(){var t="[^=]*";var r='"[^"]*"|[^,]*';var i="(?:"+t+")=(?:"+r+")";return new RegExp("(?:^|,)("+i+")")};var v=function e(t){var r=t.split(p());var i={};var n=r.length;var a;while(n--){if(r[n]===""){continue}a=/([^=]*)=(.*)/.exec(r[n]).slice(1);a[0]=a[0].replace(/^\s+|\s+$/g,"");a[1]=a[1].replace(/^\s+|\s+$/g,"");a[1]=a[1].replace(/^['"](.*)['"]$/g,"$1");i[a[0]]=a[1]}return i};var m=function(e){d(t,e);function t(){var t;t=e.call(this)||this;t.customParsers=[];t.tagMappers=[];return t}var r=t.prototype;r.push=function e(t){var r=this;var i;var n;t=t.trim();if(t.length===0){return}if(t[0]!=="#"){this.trigger("data",{type:"uri",uri:t});return}var a=this.tagMappers.reduce((function(e,r){var i=r(t);if(i===t){return e}return e.concat([i])}),[t]);a.forEach((function(e){for(var t=0;t<r.customParsers.length;t++){if(r.customParsers[t].call(r,e)){return}}if(e.indexOf("#EXT")!==0){r.trigger("data",{type:"comment",text:e.slice(1)});return}e=e.replace("\r","");i=/^#EXTM3U/.exec(e);if(i){r.trigger("data",{type:"tag",tagType:"m3u"});return}i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"inf"};if(i[1]){n.duration=parseFloat(i[1])}if(i[2]){n.title=i[2]}r.trigger("data",n);return}i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"targetduration"};if(i[1]){n.duration=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"totalduration"};if(i[1]){n.duration=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"version"};if(i[1]){n.version=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"media-sequence"};if(i[1]){n.number=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"discontinuity-sequence"};if(i[1]){n.number=parseInt(i[1],10)}r.trigger("data",n);return}i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"playlist-type"};if(i[1]){n.playlistType=i[1]}r.trigger("data",n);return}i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e);if(i){n={type:"tag",tagType:"byterange"};if(i[1]){n.length=parseInt(i[1],10)}if(i[2]){n.offset=parseInt(i[2],10)}r.trigger("data",n);return}i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e);if(i){n={type:"tag",tagType:"allow-cache"};if(i[1]){n.allowed=!/NO/.test(i[1])}r.trigger("data",n);return}i=/^#EXT-X-MAP:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"map"};if(i[1]){var a=v(i[1]);if(a.URI){n.uri=a.URI}if(a.BYTERANGE){var s=a.BYTERANGE.split("@"),o=s[0],u=s[1];n.byterange={};if(o){n.byterange.length=parseInt(o,10)}if(u){n.byterange.offset=parseInt(u,10)}}}r.trigger("data",n);return}i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"stream-inf"};if(i[1]){n.attributes=v(i[1]);if(n.attributes.RESOLUTION){var l=n.attributes.RESOLUTION.split("x");var d={};if(l[0]){d.width=parseInt(l[0],10)}if(l[1]){d.height=parseInt(l[1],10)}n.attributes.RESOLUTION=d}if(n.attributes.BANDWIDTH){n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)}if(n.attributes["PROGRAM-ID"]){n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10)}}r.trigger("data",n);return}i=/^#EXT-X-MEDIA:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"media"};if(i[1]){n.attributes=v(i[1])}r.trigger("data",n);return}i=/^#EXT-X-ENDLIST/.exec(e);if(i){r.trigger("data",{type:"tag",tagType:"endlist"});return}i=/^#EXT-X-DISCONTINUITY/.exec(e);if(i){r.trigger("data",{type:"tag",tagType:"discontinuity"});return}i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"program-date-time"};if(i[1]){n.dateTimeString=i[1];n.dateTimeObject=new Date(i[1])}r.trigger("data",n);return}i=/^#EXT-X-KEY:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"key"};if(i[1]){n.attributes=v(i[1]);if(n.attributes.IV){if(n.attributes.IV.substring(0,2).toLowerCase()==="0x"){n.attributes.IV=n.attributes.IV.substring(2)}n.attributes.IV=n.attributes.IV.match(/.{8}/g);n.attributes.IV[0]=parseInt(n.attributes.IV[0],16);n.attributes.IV[1]=parseInt(n.attributes.IV[1],16);n.attributes.IV[2]=parseInt(n.attributes.IV[2],16);n.attributes.IV[3]=parseInt(n.attributes.IV[3],16);n.attributes.IV=new Uint32Array(n.attributes.IV)}}r.trigger("data",n);return}i=/^#EXT-X-START:?(.*)$/.exec(e);if(i){n={type:"tag",tagType:"start"};if(i[1]){n.attributes=v(i[1]);n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]);n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)}r.trigger("data",n);return}i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"cue-out-cont"};if(i[1]){n.data=i[1]}else{n.data=""}r.trigger("data",n);return}i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"cue-out"};if(i[1]){n.data=i[1]}else{n.data=""}r.trigger("data",n);return}i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e);if(i){n={type:"tag",tagType:"cue-in"};if(i[1]){n.data=i[1]}else{n.data=""}r.trigger("data",n);return}r.trigger("data",{type:"tag",data:e.slice(4)})}))};r.addParser=function e(t){var r=this;var i=t.expression,n=t.customType,a=t.dataParser,s=t.segment;if(typeof a!=="function"){a=function e(t){return t}}this.customParsers.push((function(e){var t=i.exec(e);if(t){r.trigger("data",{type:"custom",data:a(e),customType:n,segment:s});return true}}))};r.addTagMapper=function e(t){var r=t.expression,i=t.map;var n=function e(t){if(r.test(t)){return i(t)}return t};this.tagMappers.push(n)};return t}(c);var g=function(e){d(t,e);function t(){var t;t=e.call(this)||this;t.lineStream=new h;t.parseStream=new m;t.lineStream.pipe(t.parseStream);var r=f(f(t));var i=[];var n={};var a;var s;var o=function e(){};var u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};var d=0;t.manifest={allowCache:true,discontinuityStarts:[],segments:[]};t.parseStream.on("data",(function(e){var t;var f;({tag:function c(){({"allow-cache":function t(){this.manifest.allowCache=e.allowed;if(!("allowed"in e)){this.trigger("info",{message:"defaulting allowCache to YES"});this.manifest.allowCache=true}},byterange:function t(){var t={};if("length"in e){n.byterange=t;t.length=e.length;if(!("offset"in e)){this.trigger("info",{message:"defaulting offset to zero"});e.offset=0}}if("offset"in e){n.byterange=t;t.offset=e.offset}},endlist:function e(){this.manifest.endList=true},inf:function t(){if(!("mediaSequence"in this.manifest)){this.manifest.mediaSequence=0;this.trigger("info",{message:"defaulting media sequence to zero"})}if(!("discontinuitySequence"in this.manifest)){this.manifest.discontinuitySequence=0;this.trigger("info",{message:"defaulting discontinuity sequence to zero"})}if(e.duration>0){n.duration=e.duration}if(e.duration===0){n.duration=.01;this.trigger("info",{message:"updating zero segment duration to a small value"})}this.manifest.segments=i},key:function t(){if(!e.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(e.attributes.METHOD==="NONE"){s=null;return}if(!e.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(!e.attributes.METHOD){this.trigger("warn",{message:"defaulting key method to AES-128"})}s={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI};if(typeof e.attributes.IV!=="undefined"){s.iv=e.attributes.IV}},"media-sequence":function t(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number});return}this.manifest.mediaSequence=e.number},"discontinuity-sequence":function t(){if(!isFinite(e.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number});return}this.manifest.discontinuitySequence=e.number;d=e.number},"playlist-type":function t(){if(!/VOD|EVENT/.test(e.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist});return}this.manifest.playlistType=e.playlistType},map:function t(){a={};if(e.uri){a.uri=e.uri}if(e.byterange){a.byterange=e.byterange}},"stream-inf":function t(){this.manifest.playlists=i;this.manifest.mediaGroups=this.manifest.mediaGroups||u;if(!e.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}if(!n.attributes){n.attributes={}}l(n.attributes,e.attributes)},media:function r(){this.manifest.mediaGroups=this.manifest.mediaGroups||u;if(!(e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var i=this.manifest.mediaGroups[e.attributes.TYPE];i[e.attributes["GROUP-ID"]]=i[e.attributes["GROUP-ID"]]||{};t=i[e.attributes["GROUP-ID"]];f={default:/yes/i.test(e.attributes.DEFAULT)};if(f.default){f.autoselect=true}else{f.autoselect=/yes/i.test(e.attributes.AUTOSELECT)}if(e.attributes.LANGUAGE){f.language=e.attributes.LANGUAGE}if(e.attributes.URI){f.uri=e.attributes.URI}if(e.attributes["INSTREAM-ID"]){f.instreamId=e.attributes["INSTREAM-ID"]}if(e.attributes.CHARACTERISTICS){f.characteristics=e.attributes.CHARACTERISTICS}if(e.attributes.FORCED){f.forced=/yes/i.test(e.attributes.FORCED)}t[e.attributes.NAME]=f},discontinuity:function e(){d+=1;n.discontinuity=true;this.manifest.discontinuityStarts.push(i.length)},"program-date-time":function t(){if(typeof this.manifest.dateTimeString==="undefined"){this.manifest.dateTimeString=e.dateTimeString;this.manifest.dateTimeObject=e.dateTimeObject}n.dateTimeString=e.dateTimeString;n.dateTimeObject=e.dateTimeObject},targetduration:function t(){if(!isFinite(e.duration)||e.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration});return}this.manifest.targetDuration=e.duration},totalduration:function t(){if(!isFinite(e.duration)||e.duration<0){this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration});return}this.manifest.totalDuration=e.duration},start:function t(){if(!e.attributes||isNaN(e.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}},"cue-out":function t(){n.cueOut=e.data},"cue-out-cont":function t(){n.cueOutCont=e.data},"cue-in":function t(){n.cueIn=e.data}}[e.tagType]||o).call(r)},uri:function t(){n.uri=e.uri;i.push(n);if(this.manifest.targetDuration&&!("duration"in n)){this.trigger("warn",{message:"defaulting segment duration to the target duration"});n.duration=this.manifest.targetDuration}if(s){n.key=s}n.timeline=d;if(a){n.map=a}n={}},comment:function e(){},custom:function t(){if(e.segment){n.custom=n.custom||{};n.custom[e.customType]=e.data}else{this.manifest.custom=this.manifest.custom||{};this.manifest.custom[e.customType]=e.data}}})[e.type].call(r)}));return t}var r=t.prototype;r.push=function e(t){this.lineStream.push(t)};r.end=function e(){this.lineStream.push("\n")};r.addParser=function e(t){this.parseStream.addParser(t)};r.addTagMapper=function e(t){this.parseStream.addTagMapper(t)};return t}(c);var y=r("./node_modules/global/document.js");var _=r.n(y);var b=r("./node_modules/mpd-parser/dist/mpd-parser.es.js");var T=r("./node_modules/mux.js/lib/mp4/probe.js");var S=r.n(T);var E=r("./node_modules/mux.js/lib/mp4/index.js");var w=r("./node_modules/mux.js/lib/tools/ts-inspector.js");var k=r.n(w);var A=void 0;function C(e){var t=A[e.byteLength%16||0];var r=new Uint8Array(e.byteLength+t.length);r.set(e);r.set(t,e.byteLength);return r}A=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]];function L(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var x="1.0.2";var D=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var I=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,r,i){if(r)e(t.prototype,r);if(i)e(t,i);return t}}();var O=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var R=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var P=function e(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]];var r=t[0];var i=t[1];var n=r[4];var a=i[4];var s=void 0;var o=void 0;var u=void 0;var l=[];var d=[];var f=void 0;var c=void 0;var h=void 0;var p=void 0;var v=void 0;var m=void 0;for(s=0;s<256;s++){d[(l[s]=s<<1^(s>>7)*283)^s]=s}for(o=u=0;!n[o];o^=f||1,u=d[u]||1){p=u^u<<1^u<<2^u<<3^u<<4;p=p>>8^p&255^99;n[o]=p;a[p]=o;h=l[c=l[f=l[o]]];m=h*16843009^c*65537^f*257^o*16843008;v=l[p]*257^p*16843008;for(s=0;s<4;s++){r[s][o]=v=v<<24^v>>>8;i[s][p]=m=m<<24^m>>>8}}for(s=0;s<5;s++){r[s]=r[s].slice(0);i[s]=i[s].slice(0)}return t};var U=null;var M=function(){function e(t){D(this,e);if(!U){U=P()}this._tables=[[U[0][0].slice(),U[0][1].slice(),U[0][2].slice(),U[0][3].slice(),U[0][4].slice()],[U[1][0].slice(),U[1][1].slice(),U[1][2].slice(),U[1][3].slice(),U[1][4].slice()]];var r=void 0;var i=void 0;var n=void 0;var a=void 0;var s=void 0;var o=this._tables[0][4];var u=this._tables[1];var l=t.length;var d=1;if(l!==4&&l!==6&&l!==8){throw new Error("Invalid aes key size")}a=t.slice(0);s=[];this._key=[a,s];for(r=l;r<4*l+28;r++){n=a[r-1];if(r%l===0||l===8&&r%l===4){n=o[n>>>24]<<24^o[n>>16&255]<<16^o[n>>8&255]<<8^o[n&255];if(r%l===0){n=n<<8^n>>>24^d<<24;d=d<<1^(d>>7)*283}}a[r]=a[r-l]^n}for(i=0;r;i++,r--){n=a[i&3?r:r-4];if(r<=4||i<4){s[i]=n}else{s[i]=u[0][o[n>>>24]]^u[1][o[n>>16&255]]^u[2][o[n>>8&255]]^u[3][o[n&255]]}}}e.prototype.decrypt=function e(t,r,i,n,a,s){var o=this._key[1];var u=t^o[0];var l=n^o[1];var d=i^o[2];var f=r^o[3];var c=void 0;var h=void 0;var p=void 0;var v=o.length/4-2;var m=void 0;var g=4;var y=this._tables[1];var _=y[0];var b=y[1];var T=y[2];var S=y[3];var E=y[4];for(m=0;m<v;m++){c=_[u>>>24]^b[l>>16&255]^T[d>>8&255]^S[f&255]^o[g];h=_[l>>>24]^b[d>>16&255]^T[f>>8&255]^S[u&255]^o[g+1];p=_[d>>>24]^b[f>>16&255]^T[u>>8&255]^S[l&255]^o[g+2];f=_[f>>>24]^b[u>>16&255]^T[l>>8&255]^S[d&255]^o[g+3];g+=4;u=c;l=h;d=p}for(m=0;m<4;m++){a[(3&-m)+s]=E[u>>>24]<<24^E[l>>16&255]<<16^E[d>>8&255]<<8^E[f&255]^o[g++];c=u;u=l;l=d;d=f;f=c}};return e}();var N=function(){function e(){D(this,e);this.listeners={}}e.prototype.on=function e(t,r){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(r)};e.prototype.off=function e(t,r){if(!this.listeners[t]){return false}var i=this.listeners[t].indexOf(r);this.listeners[t].splice(i,1);return i>-1};e.prototype.trigger=function e(t){var r=this.listeners[t];if(!r){return}if(arguments.length===2){var i=r.length;for(var n=0;n<i;++n){r[n].call(this,arguments[1])}}else{var a=Array.prototype.slice.call(arguments,1);var s=r.length;for(var o=0;o<s;++o){r[o].apply(this,a)}}};e.prototype.dispose=function e(){this.listeners={}};e.prototype.pipe=function e(t){this.on("data",(function(e){t.push(e)}))};return e}();var j=function(e){O(t,e);function t(){D(this,t);var r=R(this,e.call(this,N));r.jobs=[];r.delay=1;r.timeout_=null;return r}t.prototype.processJob_=function e(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};t.prototype.push=function e(t){this.jobs.push(t);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return t}(N);var B=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};var F=function e(t,r,i){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2);var a=new M(Array.prototype.slice.call(r));var s=new Uint8Array(t.byteLength);var o=new Int32Array(s.buffer);var u=void 0;var l=void 0;var d=void 0;var f=void 0;var c=void 0;var h=void 0;var p=void 0;var v=void 0;var m=void 0;u=i[0];l=i[1];d=i[2];f=i[3];for(m=0;m<n.length;m+=4){c=B(n[m]);h=B(n[m+1]);p=B(n[m+2]);v=B(n[m+3]);a.decrypt(c,h,p,v,o,m);o[m]=B(o[m]^u);o[m+1]=B(o[m+1]^l);o[m+2]=B(o[m+2]^d);o[m+3]=B(o[m+3]^f);u=c;l=h;d=p;f=v}return s};var H=function(){function e(t,r,i,n){D(this,e);var a=e.STEP;var s=new Int32Array(t.buffer);var o=new Uint8Array(t.byteLength);var u=0;this.asyncStream_=new j;this.asyncStream_.push(this.decryptChunk_(s.subarray(u,u+a),r,i,o));for(u=a;u<s.length;u+=a){i=new Uint32Array([B(s[u-4]),B(s[u-3]),B(s[u-2]),B(s[u-1])]);this.asyncStream_.push(this.decryptChunk_(s.subarray(u,u+a),r,i,o))}this.asyncStream_.push((function(){n(null,L(o))}))}e.prototype.decryptChunk_=function e(t,r,i,n){return function(){var e=F(t,r,i);n.set(e,t.byteOffset)}};I(e,null,[{key:"STEP",get:function e(){return 32e3}}]);return e}();var q=function e(t,r){if(/^[a-z]+:/i.test(r)){return r}if(!/\/\//i.test(t)){t=n.a.buildAbsoluteURL(s.a.location.href,t)}return n.a.buildAbsoluteURL(t,r)};var G=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var V=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,r,i){if(r)e(t.prototype,r);if(i)e(t,i);return t}}();var W=function e(t,r,i){if(t===null)t=Function.prototype;var n=Object.getOwnPropertyDescriptor(t,r);if(n===undefined){var a=Object.getPrototypeOf(t);if(a===null){return undefined}else{return e(a,r,i)}}else if("value"in n){return n.value}else{var s=n.get;if(s===undefined){return undefined}return s.call(i)}};var z=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var K=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var Y=function(){function e(e,t){var r=[];var i=true;var n=false;var a=undefined;try{for(var s=e[Symbol.iterator](),o;!(i=(o=s.next()).done);i=true){r.push(o.value);if(t&&r.length===t)break}}catch(e){n=true;a=e}finally{try{if(!i&&s["return"])s["return"]()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var X=u.a.mergeOptions,J=u.a.EventTarget,Q=u.a.log;var $=function e(t,r){["AUDIO","SUBTITLES"].forEach((function(e){for(var i in t.mediaGroups[e]){for(var n in t.mediaGroups[e][i]){var a=t.mediaGroups[e][i][n];r(a,e,i,n)}}}))};var Z=function e(t,r,i){var n=r.slice();i=i||0;var a=Math.min(t.length,r.length+i);for(var s=i;s<a;s++){n[s-i]=X(t[s],n[s-i])}return n};var ee=function e(t,r){if(!t.resolvedUri){t.resolvedUri=q(r,t.uri)}if(t.key&&!t.key.resolvedUri){t.key.resolvedUri=q(r,t.key.uri)}if(t.map&&!t.map.resolvedUri){t.map.resolvedUri=q(r,t.map.uri)}};var te=function e(t,r){var i=X(t,{});var n=i.playlists[r.uri];if(!n){return null}if(n.segments&&r.segments&&n.segments.length===r.segments.length&&n.endList===r.endList&&n.mediaSequence===r.mediaSequence){return null}var a=X(n,r);if(n.segments){a.segments=Z(n.segments,r.segments,r.mediaSequence-n.mediaSequence)}a.segments.forEach((function(e){ee(e,a.resolvedUri)}));for(var s=0;s<i.playlists.length;s++){if(i.playlists[s].uri===r.uri){i.playlists[s]=a}}i.playlists[r.uri]=a;return i};var re=function e(t){var r=t.playlists.length;while(r--){var i=t.playlists[r];t.playlists[i.uri]=i;i.resolvedUri=q(t.uri,i.uri);i.id=r;if(!i.attributes){i.attributes={};Q.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}};var ie=function e(t){$(t,(function(e){if(e.uri){e.resolvedUri=q(t.uri,e.uri)}}))};var ne=function e(t,r){var i=t.segments[t.segments.length-1];var n=void 0;if(r&&i&&i.duration){n=i.duration*1e3}else{n=(t.targetDuration||10)*500}return n};var ae=function(e){z(t,e);function t(e,r,i){G(this,t);var n=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.srcUrl=e;n.hls_=r;n.withCredentials=i;var a=r.options_;n.customTagParsers=a&&a.customTagParsers||[];n.customTagMappers=a&&a.customTagMappers||[];if(!n.srcUrl){throw new Error("A non-empty playlist URL is required")}n.state="HAVE_NOTHING";n.on("mediaupdatetimeout",(function(){if(n.state!=="HAVE_METADATA"){return}n.state="HAVE_CURRENT_METADATA";n.request=n.hls_.xhr({uri:q(n.master.uri,n.media().uri),withCredentials:n.withCredentials},(function(e,t){if(!n.request){return}if(e){return n.playlistRequestError(n.request,n.media().uri,"HAVE_METADATA")}n.haveMetadata(n.request,n.media().uri)}))}));return n}V(t,[{key:"playlistRequestError",value:function e(t,r,i){this.request=null;if(i){this.state=i}this.error={playlist:this.master.playlists[r],status:t.status,message:"HLS playlist request error at URL: "+r,responseText:t.responseText,code:t.status>=500?4:2};this.trigger("error")}},{key:"haveMetadata",value:function e(t,r){var i=this;this.request=null;this.state="HAVE_METADATA";var n=new g;this.customTagParsers.forEach((function(e){return n.addParser(e)}));this.customTagMappers.forEach((function(e){return n.addTagMapper(e)}));n.push(t.responseText);n.end();n.manifest.uri=r;n.manifest.attributes=n.manifest.attributes||{};var a=te(this.master,n.manifest);this.targetDuration=n.manifest.targetDuration;if(a){this.master=a;this.media_=this.master.playlists[n.manifest.uri]}else{this.trigger("playlistunchanged")}if(!this.media().endList){s.a.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=s.a.setTimeout((function(){i.trigger("mediaupdatetimeout")}),ne(this.media(),!!a))}this.trigger("loadedplaylist")}},{key:"dispose",value:function e(){this.stopRequest();s.a.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function e(){if(this.request){var t=this.request;this.request=null;t.onreadystatechange=null;t.abort()}}},{key:"media",value:function e(t){var r=this;if(!t){return this.media_}if(this.state==="HAVE_NOTHING"){throw new Error("Cannot switch media playlist from "+this.state)}var i=this.state;if(typeof t==="string"){if(!this.master.playlists[t]){throw new Error("Unknown playlist URI: "+t)}t=this.master.playlists[t]}var n=!this.media_||t.uri!==this.media_.uri;if(this.master.playlists[t.uri].endList){if(this.request){this.request.onreadystatechange=null;this.request.abort();this.request=null}this.state="HAVE_METADATA";this.media_=t;if(n){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!n){return}this.state="SWITCHING_MEDIA";if(this.request){if(q(this.master.uri,t.uri)===this.request.url){return}this.request.onreadystatechange=null;this.request.abort();this.request=null}if(this.media_){this.trigger("mediachanging")}this.request=this.hls_.xhr({uri:q(this.master.uri,t.uri),withCredentials:this.withCredentials},(function(e,n){if(!r.request){return}if(e){return r.playlistRequestError(r.request,t.uri,i)}r.haveMetadata(n,t.uri);if(i==="HAVE_MASTER"){r.trigger("loadedmetadata")}else{r.trigger("mediachange")}}))}},{key:"pause",value:function e(){this.stopRequest();s.a.clearTimeout(this.mediaUpdateTimeout);if(this.state==="HAVE_NOTHING"){this.started=false}if(this.state==="SWITCHING_MEDIA"){if(this.media_){this.state="HAVE_METADATA"}else{this.state="HAVE_MASTER"}}else if(this.state==="HAVE_CURRENT_METADATA"){this.state="HAVE_METADATA"}}},{key:"load",value:function e(t){var r=this;s.a.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(t){var n=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=s.a.setTimeout((function(){return r.load()}),n);return}if(!this.started){this.start();return}if(i&&!i.endList){this.trigger("mediaupdatetimeout")}else{this.trigger("loadedplaylist")}}},{key:"start",value:function e(){var t=this;this.started=true;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(e,r){if(!t.request){return}t.request=null;if(e){t.error={status:r.status,message:"HLS playlist request error at URL: "+t.srcUrl,responseText:r.responseText,code:2};if(t.state==="HAVE_NOTHING"){t.started=false}return t.trigger("error")}var i=new g;t.customTagParsers.forEach((function(e){return i.addParser(e)}));t.customTagMappers.forEach((function(e){return i.addTagMapper(e)}));i.push(r.responseText);i.end();t.state="HAVE_MASTER";i.manifest.uri=t.srcUrl;if(i.manifest.playlists){t.master=i.manifest;re(t.master);ie(t.master);t.trigger("loadedplaylist");if(!t.request){t.media(i.manifest.playlists[0])}return}t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:s.a.location.href,playlists:[{uri:t.srcUrl,id:0}]};t.master.playlists[t.srcUrl]=t.master.playlists[0];t.master.playlists[0].resolvedUri=t.srcUrl;t.master.playlists[0].attributes=t.master.playlists[0].attributes||{};t.haveMetadata(r,t.srcUrl);return t.trigger("loadedmetadata")}))}}]);return t}(J);var se=u.a.createTimeRange;var oe=function e(t,r){var i=0;var n=r-t.mediaSequence;var a=t.segments[n];if(a){if(typeof a.start!=="undefined"){return{result:a.start,precise:true}}if(typeof a.end!=="undefined"){return{result:a.end-a.duration,precise:true}}}while(n--){a=t.segments[n];if(typeof a.end!=="undefined"){return{result:i+a.end,precise:true}}i+=a.duration;if(typeof a.start!=="undefined"){return{result:i+a.start,precise:true}}}return{result:i,precise:false}};var ue=function e(t,r){var i=0;var n=void 0;var a=r-t.mediaSequence;for(;a<t.segments.length;a++){n=t.segments[a];if(typeof n.start!=="undefined"){return{result:n.start-i,precise:true}}i+=n.duration;if(typeof n.end!=="undefined"){return{result:n.end-i,precise:true}}}return{result:-1,precise:false}};var le=function e(t,r,i){var n=void 0;var a=void 0;if(typeof r==="undefined"){r=t.mediaSequence+t.segments.length}if(r<t.mediaSequence){return 0}n=oe(t,r);if(n.precise){return n.result}a=ue(t,r);if(a.precise){return a.result}return n.result+i};var de=function e(t,r,i){if(!t){return 0}if(typeof i!=="number"){i=0}if(typeof r==="undefined"){if(t.totalDuration){return t.totalDuration}if(!t.endList){return s.a.Infinity}}return le(t,r,i)};var fe=function e(t,r,i){var n=0;if(r>i){var a=[i,r];r=a[0];i=a[1]}if(r<0){for(var s=r;s<Math.min(0,i);s++){n+=t.targetDuration}r=0}for(var o=r;o<i;o++){n+=t.segments[o].duration}return n};var ce=function e(t){if(!t.segments.length){return 0}var r=t.segments.length-1;var i=t.segments[r].duration||t.targetDuration;var n=i+t.targetDuration*2;while(r--){i+=t.segments[r].duration;if(i>=n){break}}return Math.max(0,r)};var he=function e(t,r,i){if(!t||!t.segments){return null}if(t.endList){return de(t)}if(r===null){return null}r=r||0;var n=i?ce(t):t.segments.length;return le(t,t.mediaSequence+n,r)};var pe=function e(t,r){var i=true;var n=r||0;var a=he(t,r,i);if(a===null){return se()}return se(n,a)};var ve=function e(t){return t-Math.floor(t)===0};var me=function e(t,r){if(ve(r)){return r+t*.1}var i=r.toString().split(".")[1].length;for(var n=1;n<=i;n++){var a=Math.pow(10,n);var s=r*a;if(ve(s)||n===i){return(s+t)/a}}};var ge=me.bind(null,1);var ye=me.bind(null,-1);var _e=function e(t,r,i,n){var a=void 0;var s=void 0;var o=t.segments.length;var u=r-n;if(u<0){if(i>0){for(a=i-1;a>=0;a--){s=t.segments[a];u+=ye(s.duration);if(u>0){return{mediaIndex:a,startTime:n-fe(t,i,a)}}}}return{mediaIndex:0,startTime:r}}if(i<0){for(a=i;a<0;a++){u-=t.targetDuration;if(u<0){return{mediaIndex:0,startTime:r}}}i=0}for(a=i;a<o;a++){s=t.segments[a];u-=ge(s.duration);if(u<0){return{mediaIndex:a,startTime:n+fe(t,i,a)}}}return{mediaIndex:o-1,startTime:r}};var be=function e(t){return t.excludeUntil&&t.excludeUntil>Date.now()};var Te=function e(t){return t.excludeUntil&&t.excludeUntil===Infinity};var Se=function e(t){var r=be(t);return!t.disabled&&!r};var Ee=function e(t){return t.disabled};var we=function e(t){for(var r=0;r<t.segments.length;r++){if(t.segments[r].key){return true}}return false};var ke=function e(t){for(var r=0;r<t.segments.length;r++){if(t.segments[r].map){return true}}return false};var Ae=function e(t,r){return r.attributes&&r.attributes[t]};var Ce=function e(t,r,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;if(!Ae("BANDWIDTH",i)){return NaN}var a=t*i.attributes.BANDWIDTH;return(a-n*8)/r};var Le=function e(t,r){if(t.playlists.length===1){return true}var i=r.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter((function(e){if(!Se(e)){return false}return(e.attributes.BANDWIDTH||0)<i})).length===0};var xe={duration:de,seekable:pe,safeLiveIndex:ce,getMediaInfoForTime:_e,isEnabled:Se,isDisabled:Ee,isBlacklisted:be,isIncompatible:Te,playlistEnd:he,isAes:we,isFmp4:ke,hasAttribute:Ae,estimateSegmentRequestTime:Ce,isLowestEnabledRendition:Le};var De=u.a.xhr,Ie=u.a.mergeOptions;var Oe=function e(){var t=function e(t,r){t=Ie({timeout:45e3},t);var i=e.beforeRequest||u.a.Hls.xhr.beforeRequest;if(i&&typeof i==="function"){var n=i(t);if(n){t=n}}var a=De(t,(function(e,t){var i=a.response;if(!e&&i){a.responseTime=Date.now();a.roundTripTime=a.responseTime-a.requestTime;a.bytesReceived=i.byteLength||i.length;if(!a.bandwidth){a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3)}}if(t.headers){a.responseHeaders=t.headers}if(e&&e.code==="ETIMEDOUT"){a.timedout=true}if(!e&&!a.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0){e=new Error("XHR Failed with a response of: "+(a&&(i||a.responseText)))}r(e,a)}));var s=a.abort;a.abort=function(){a.aborted=true;return s.apply(a,arguments)};a.uri=t.uri;a.requestTime=Date.now();return a};return t};var Re=function e(t,r){return t.start(r)+"-"+t.end(r)};var Pe=function e(t,r){var i=t.toString(16);return"00".substring(0,2-i.length)+i+(r%2?" ":"")};var Ue=function e(t){if(t>=32&&t<126){return String.fromCharCode(t)}return"."};var Me=function e(t){var r={};Object.keys(t).forEach((function(e){var i=t[e];if(ArrayBuffer.isView(i)){r[e]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}}else{r[e]=i}}));return r};var Ne=function e(t){var r=t.byterange||{length:Infinity,offset:0};return[r.length,r.offset,t.resolvedUri].join(",")};var je=function e(t){var r=Array.prototype.slice.call(t);var i=16;var n="";var a=void 0;var s=void 0;for(var o=0;o<r.length/i;o++){a=r.slice(o*i,o*i+i).map(Pe).join("");s=r.slice(o*i,o*i+i).map(Ue).join("");n+=a+" "+s+"\n"}return n};var Be=function e(t){var r=t.bytes;return je(r)};var Fe=function e(t){var r="";var i=void 0;for(i=0;i<t.length;i++){r+=Re(t,i)+" "}return r};var He=Object.freeze({createTransferableMessage:Me,initSegmentId:Ne,hexDump:je,tagDump:Be,textRanges:Fe});var qe=.25;var Ge=function e(t,r){if(!r.dateTimeObject){return null}var i=r.videoTimingInfo.transmuxerPrependedSeconds;var n=r.videoTimingInfo.transmuxedPresentationStart;var a=n+i;var s=t-a;return new Date(r.dateTimeObject.getTime()+s*1e3)};var Ve=function e(t){return t.transmuxedPresentationEnd-t.transmuxedPresentationStart-t.transmuxerPrependedSeconds};var We=function e(t,r){var i=void 0;try{i=new Date(t)}catch(e){return null}if(!r||!r.segments||r.segments.length===0){return null}var n=r.segments[0];if(i<n.dateTimeObject){return null}for(var a=0;a<r.segments.length-1;a++){n=r.segments[a];var s=r.segments[a+1].dateTimeObject;if(i<s){break}}var o=r.segments[r.segments.length-1];var u=o.dateTimeObject;var l=o.videoTimingInfo?Ve(o.videoTimingInfo):o.duration+o.duration*qe;var d=new Date(u.getTime()+l*1e3);if(i>d){return null}if(i>u){n=o}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:xe.duration(r,r.mediaSequence+r.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"}};var ze=function e(t,r){if(!r||!r.segments||r.segments.length===0){return null}var i=0;var n=void 0;for(var a=0;a<r.segments.length;a++){n=r.segments[a];i=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:i+n.duration;if(t<=i){break}}var s=r.segments[r.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<t){return null}if(t>i){if(t>i+s.duration*qe){return null}n=s}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:i-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}};var Ke=function e(t,r){var i=void 0;var n=void 0;try{i=new Date(t);n=new Date(r)}catch(e){}var a=i.getTime();var s=n.getTime();return(s-a)/1e3};var Ye=function e(t){if(!t.segments||t.segments.length===0){return false}for(var r=0;r<t.segments.length;r++){var i=t.segments[r];if(!i.dateTimeObject){return false}}return true};var Xe=function e(t){var r=t.playlist,i=t.time,n=i===undefined?undefined:i,a=t.callback;if(!a){throw new Error("getProgramTime: callback must be provided")}if(!r||n===undefined){return a({message:"getProgramTime: playlist and time must be provided"})}var s=ze(n,r);if(!s){return a({message:"valid programTime was not found"})}if(s.type==="estimate"){return a({message:"Accurate programTime could not be determined."+" Please seek to e.seekTime and try again",seekTime:s.estimatedStart})}var o={mediaSeconds:n};var u=Ge(n,s.segment);if(u){o.programDateTime=u.toISOString()}return a(null,o)};var Je=function e(t){var r=t.programTime,i=t.playlist,n=t.retryCount,a=n===undefined?2:n,s=t.seekTo,o=t.pauseAfterSeek,u=o===undefined?true:o,l=t.tech,d=t.callback;if(!d){throw new Error("seekToProgramTime: callback must be provided")}if(typeof r==="undefined"||!i||!s){return d({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"})}if(!i.endList&&!l.hasStarted_){return d({message:"player must be playing a live stream to start buffering"})}if(!Ye(i)){return d({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri})}var f=We(r,i);if(!f){return d({message:r+" was not found in the stream"})}var c=f.segment;var h=Ke(c.dateTimeObject,r);if(f.type==="estimate"){if(a===0){return d({message:r+" is not buffered yet. Try again"})}s(f.estimatedStart+h);l.one("seeked",(function(){e({programTime:r,playlist:i,retryCount:a-1,seekTo:s,pauseAfterSeek:u,tech:l,callback:d})}));return}var p=c.start+h;var v=function e(){return d(null,l.currentTime())};l.one("seeked",v);if(u){l.pause()}s(p)};var Qe=1/30;var $e=Qe*3;var Ze=function e(t,r){var i=[];var n=void 0;if(t&&t.length){for(n=0;n<t.length;n++){if(r(t.start(n),t.end(n))){i.push([t.start(n),t.end(n)])}}}return u.a.createTimeRanges(i)};var et=function e(t,r){return Ze(t,(function(e,t){return e-Qe<=r&&t+Qe>=r}))};var tt=function e(t,r){return Ze(t,(function(e){return e-Qe>=r}))};var rt=function e(t){if(t.length<2){return u.a.createTimeRanges()}var r=[];for(var i=1;i<t.length;i++){var n=t.end(i-1);var a=t.start(i);r.push([n,a])}return u.a.createTimeRanges(r)};var it=function e(t){var r=[];if(!t||!t.length){return""}for(var i=0;i<t.length;i++){r.push(t.start(i)+" => "+t.end(i))}return r.join(", ")};var nt=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var n=t.length?t.end(t.length-1):0;return(n-r)/i};var at=function e(t){var r=[];for(var i=0;i<t.length;i++){r.push({start:t.start(i),end:t.end(i)})}return r};var st=function e(t,r,i){var n=r.player_;if(i.captions&&i.captions.length){if(!t.inbandTextTracks_){t.inbandTextTracks_={}}for(var a in i.captionStreams){if(!t.inbandTextTracks_[a]){n.tech_.trigger({type:"usage",name:"hls-608"});var s=n.textTracks().getTrackById(a);if(s){t.inbandTextTracks_[a]=s}else{t.inbandTextTracks_[a]=n.addRemoteTextTrack({kind:"captions",id:a,label:a},false).track}}}}if(i.metadata&&i.metadata.length&&!t.metadataTrack_){t.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},false).track;t.metadataTrack_.inBandMetadataTrackDispatchType=i.metadata.dispatchType}};var ot=function e(t,r,i){var n=void 0;var a=void 0;if(!i){return}if(!i.cues){return}n=i.cues.length;while(n--){a=i.cues[n];if(a.startTime<=r&&a.endTime>=t){i.removeCue(a)}}};var ut=function e(t){Object.defineProperties(t.frame,{id:{get:function e(){u.a.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return t.value.key}},value:{get:function e(){u.a.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return t.value.data}},privateData:{get:function e(){u.a.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return t.value.data}}})};var lt=function e(t){var r=void 0;if(isNaN(t)||Math.abs(t)===Infinity){r=Number.MAX_VALUE}else{r=t}return r};var dt=function e(t,r,i){var n=s.a.WebKitDataCue||s.a.VTTCue;if(r){r.forEach((function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new n(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))}),t)}if(i){var a=lt(t.mediaSource_.duration);i.forEach((function(e){var t=e.cueTime+this.timestampOffset;e.frames.forEach((function(e){var r=new n(t,t,e.value||e.url||e.data||"");r.frame=e;r.value=e;ut(r);this.metadataTrack_.addCue(r)}),this)}),t);if(t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){var o=t.metadataTrack_.cues;var u=[];for(var l=0;l<o.length;l++){if(o[l]){u.push(o[l])}}var d=u.reduce((function(e,t){var r=e[t.startTime]||[];r.push(t);e[t.startTime]=r;return e}),{});var f=Object.keys(d).sort((function(e,t){return Number(e)-Number(t)}));f.forEach((function(e,t){var r=d[e];var i=Number(f[t+1])||a;r.forEach((function(e){e.endTime=i}))}))}}};var ft=typeof window!=="undefined"?window:{},ct=typeof Symbol==="undefined"?"__target":Symbol(),ht="application/javascript",pt=ft.BlobBuilder||ft.WebKitBlobBuilder||ft.MozBlobBuilder||ft.MSBlobBuilder,vt=ft.URL||ft.webkitURL||vt&&vt.msURL,mt=ft.Worker;function gt(e,t){return function r(i){var n=this;if(!t){return new mt(e)}else if(mt&&!i){var a=t.toString().replace(/^function.+?{/,"").slice(0,-1),s=Tt(a);this[ct]=new mt(s);St(this[ct],s);return this[ct]}else{var o={postMessage:function e(t){if(n.onmessage){setTimeout((function(){n.onmessage({data:t,target:o})}))}}};t.call(o);this.postMessage=function(e){setTimeout((function(){o.onmessage({data:e,target:n})}))};this.isThisThread=true}}}if(mt){var yt,_t=Tt("self.onmessage = function () {}"),bt=new Uint8Array(1);try{yt=new mt(_t);yt.postMessage(bt,[bt.buffer])}catch(e){mt=null}finally{vt.revokeObjectURL(_t);if(yt){yt.terminate()}}}function Tt(e){try{return vt.createObjectURL(new Blob([e],{type:ht}))}catch(r){var t=new pt;t.append(e);return vt.createObjectURL(t.getBlob(type))}}function St(e,t){if(!e||!t)return;var r=e.terminate;e.objURL=t;e.terminate=function(){if(e.objURL)vt.revokeObjectURL(e.objURL);r.call(e)}}var Et=new gt("./transmuxer-worker.worker.js",(function(e,t){var r=this;var i=function(){var e=Math.pow(2,32)-1;var t,i,n,a,s,o,u,l,d,f,c,h,p,v,m,g,y,_,b,T,S,E,w,k,A,C,L,x,D,I,O,R,P,U,M,N;(function(){var e;w={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if(typeof Uint8Array==="undefined"){return}for(e in w){if(w.hasOwnProperty(e)){w[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}k=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);A=new Uint8Array([0,0,0,1]);L=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);x=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);D={video:L,audio:x};R=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);O=new Uint8Array([0,0,0,0,0,0,0,0]);P=new Uint8Array([0,0,0,0,0,0,0,0]);U=P;M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);N=P;I=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();t=function e(t){var r=[],i=0,n,a,s;for(n=1;n<arguments.length;n++){r.push(arguments[n])}n=r.length;while(n--){i+=r[n].byteLength}a=new Uint8Array(i+8);s=new DataView(a.buffer,a.byteOffset,a.byteLength);s.setUint32(0,a.byteLength);a.set(t,4);for(n=0,i=8;n<r.length;n++){a.set(r[n],i);i+=r[n].byteLength}return a};i=function e(){return t(w.dinf,t(w.dref,R))};n=function e(r){return t(w.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,r.audioobjecttype<<3|r.samplingfrequencyindex>>>1,r.samplingfrequencyindex<<7|r.channelcount<<3,6,1,2]))};a=function e(){return t(w.ftyp,k,A,k,C)};g=function e(r){return t(w.hdlr,D[r])};s=function e(r){return t(w.mdat,r)};m=function e(r){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,r.duration>>>24&255,r.duration>>>16&255,r.duration>>>8&255,r.duration&255,85,196,0,0]);if(r.samplerate){i[12]=r.samplerate>>>24&255;i[13]=r.samplerate>>>16&255;i[14]=r.samplerate>>>8&255;i[15]=r.samplerate&255}return t(w.mdhd,i)};v=function e(r){return t(w.mdia,m(r),g(r.type),u(r))};o=function e(r){return t(w.mfhd,new Uint8Array([0,0,0,0,(r&4278190080)>>24,(r&16711680)>>16,(r&65280)>>8,r&255]))};u=function e(r){return t(w.minf,r.type==="video"?t(w.vmhd,I):t(w.smhd,O),i(),_(r))};l=function e(r,i){var n=[],a=i.length;while(a--){n[a]=T(i[a])}return t.apply(null,[w.moof,o(r)].concat(n))};d=function e(r){var i=r.length,n=[];while(i--){n[i]=h(r[i])}return t.apply(null,[w.moov,c(4294967295)].concat(n).concat(f(r)))};f=function e(r){var i=r.length,n=[];while(i--){n[i]=S(r[i])}return t.apply(null,[w.mvex].concat(n))};c=function e(r){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(r&4278190080)>>24,(r&16711680)>>16,(r&65280)>>8,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(w.mvhd,i)};y=function e(r){var i=r.samples||[],n=new Uint8Array(4+i.length),a,s;for(s=0;s<i.length;s++){a=i[s].flags;n[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy}return t(w.sdtp,n)};_=function e(r){return t(w.stbl,b(r),t(w.stts,N),t(w.stsc,U),t(w.stsz,M),t(w.stco,P))};(function(){var e,r;b=function i(n){return t(w.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),n.type==="video"?e(n):r(n))};e=function e(r){var i=r.sps||[],n=r.pps||[],a=[],s=[],o;for(o=0;o<i.length;o++){a.push((i[o].byteLength&65280)>>>8);a.push(i[o].byteLength&255);a=a.concat(Array.prototype.slice.call(i[o]))}for(o=0;o<n.length;o++){s.push((n[o].byteLength&65280)>>>8);s.push(n[o].byteLength&255);s=s.concat(Array.prototype.slice.call(n[o]))}return t(w.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(r.width&65280)>>8,r.width&255,(r.height&65280)>>8,r.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(w.avcC,new Uint8Array([1,r.profileIdc,r.profileCompatibility,r.levelIdc,255].concat([i.length]).concat(a).concat([n.length]).concat(s))),t(w.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};r=function e(r){return t(w.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(r.channelcount&65280)>>8,r.channelcount&255,(r.samplesize&65280)>>8,r.samplesize&255,0,0,0,0,(r.samplerate&65280)>>8,r.samplerate&255,0,0]),n(r))}})();p=function e(r){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(r.id&4278190080)>>24,(r.id&16711680)>>16,(r.id&65280)>>8,r.id&255,0,0,0,0,(r.duration&4278190080)>>24,(r.duration&16711680)>>16,(r.duration&65280)>>8,r.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(r.width&65280)>>8,r.width&255,0,0,(r.height&65280)>>8,r.height&255,0,0]);return t(w.tkhd,i)};T=function r(i){var n,a,s,o,u,l,d;n=t(w.tfhd,new Uint8Array([0,0,0,58,(i.id&4278190080)>>24,(i.id&16711680)>>16,(i.id&65280)>>8,i.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));l=Math.floor(i.baseMediaDecodeTime/(e+1));d=Math.floor(i.baseMediaDecodeTime%(e+1));a=t(w.tfdt,new Uint8Array([1,0,0,0,l>>>24&255,l>>>16&255,l>>>8&255,l&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255]));u=32+20+8+16+8+8;if(i.type==="audio"){s=E(i,u);return t(w.traf,n,a,s)}o=y(i);s=E(i,o.length+u);return t(w.traf,n,a,s,o)};h=function e(r){r.duration=r.duration||4294967295;return t(w.trak,p(r),v(r))};S=function e(r){var i=new Uint8Array([0,0,0,0,(r.id&4278190080)>>24,(r.id&16711680)>>16,(r.id&65280)>>8,r.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if(r.type!=="video"){i[i.length-1]=0}return t(w.trex,i)};(function(){var e,r,i;i=function e(t,r){var i=0,n=0,a=0,s=0;if(t.length){if(t[0].duration!==undefined){i=1}if(t[0].size!==undefined){n=2}if(t[0].flags!==undefined){a=4}if(t[0].compositionTimeOffset!==undefined){s=8}}return[0,0,i|n|a|s,1,(t.length&4278190080)>>>24,(t.length&16711680)>>>16,(t.length&65280)>>>8,t.length&255,(r&4278190080)>>>24,(r&16711680)>>>16,(r&65280)>>>8,r&255]};r=function e(r,n){var a,s,o,u;s=r.samples||[];n+=8+12+16*s.length;a=i(s,n);for(u=0;u<s.length;u++){o=s[u];a=a.concat([(o.duration&4278190080)>>>24,(o.duration&16711680)>>>16,(o.duration&65280)>>>8,o.duration&255,(o.size&4278190080)>>>24,(o.size&16711680)>>>16,(o.size&65280)>>>8,o.size&255,o.flags.isLeading<<2|o.flags.dependsOn,o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,o.flags.degradationPriority&240<<8,o.flags.degradationPriority&15,(o.compositionTimeOffset&4278190080)>>>24,(o.compositionTimeOffset&16711680)>>>16,(o.compositionTimeOffset&65280)>>>8,o.compositionTimeOffset&255])}return t(w.trun,new Uint8Array(a))};e=function e(r,n){var a,s,o,u;s=r.samples||[];n+=8+12+8*s.length;a=i(s,n);for(u=0;u<s.length;u++){o=s[u];a=a.concat([(o.duration&4278190080)>>>24,(o.duration&16711680)>>>16,(o.duration&65280)>>>8,o.duration&255,(o.size&4278190080)>>>24,(o.size&16711680)>>>16,(o.size&65280)>>>8,o.size&255])}return t(w.trun,new Uint8Array(a))};E=function t(i,n){if(i.type==="audio"){return e(i,n)}return r(i,n)}})();var j={ftyp:a,mdat:s,moof:l,moov:d,initSegment:function e(t){var r=a(),i=d(t),n;n=new Uint8Array(r.byteLength+i.byteLength);n.set(r);n.set(i,r.byteLength);return n}};var B=function e(t){return t>>>0};var F={toUnsigned:B};var H=F.toUnsigned;var q,G,V,W,z;q=function e(t,r){var i=[],n,a,s,o,u;if(!r.length){return null}for(n=0;n<t.byteLength;){a=H(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);s=G(t.subarray(n+4,n+8));o=a>1?n+a:t.byteLength;if(s===r[0]){if(r.length===1){i.push(t.subarray(n+8,o))}else{u=q(t.subarray(n+8,o),r.slice(1));if(u.length){i=i.concat(u)}}}n=o}return i};G=function e(t){var r="";r+=String.fromCharCode(t[0]);r+=String.fromCharCode(t[1]);r+=String.fromCharCode(t[2]);r+=String.fromCharCode(t[3]);return r};V=function e(t){var r={},i=q(t,["moov","trak"]);return i.reduce((function(e,t){var r,i,n,a,s;r=q(t,["tkhd"])[0];if(!r){return null}i=r[0];n=i===0?12:20;a=H(r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3]);s=q(t,["mdia","mdhd"])[0];if(!s){return null}i=s[0];n=i===0?12:20;e[a]=H(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]);return e}),r)};W=function e(t,r){var i,n,a;i=q(r,["moof","traf"]);n=[].concat.apply([],i.map((function(e){return q(e,["tfhd"]).map((function(r){var i,n,a;i=H(r[4]<<24|r[5]<<16|r[6]<<8|r[7]);n=t[i]||9e4;a=q(e,["tfdt"]).map((function(e){var t,r;t=e[0];r=H(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(t===1){r*=Math.pow(2,32);r+=H(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return r}))[0];a=a||Infinity;return a/n}))})));a=Math.min.apply(null,n);return isFinite(a)?a:0};z=function e(t){var r=q(t,["moov","trak"]);var i=[];r.forEach((function(e){var t=q(e,["mdia","hdlr"]);var r=q(e,["tkhd"]);t.forEach((function(e,t){var n=G(e.subarray(8,12));var a=r[t];var s;var o;var u;if(n==="vide"){s=new DataView(a.buffer,a.byteOffset,a.byteLength);o=s.getUint8(0);u=o===0?s.getUint32(12):s.getUint32(20);i.push(u)}}))}));return i};var K={findBox:q,parseType:G,timescale:V,startTime:W,videoTrackIds:z};var Y=function e(){this.init=function(){var e={};this.on=function(t,r){if(!e[t]){e[t]=[]}e[t]=e[t].concat(r)};this.off=function(t,r){var i;if(!e[t]){return false}i=e[t].indexOf(r);e[t]=e[t].slice();e[t].splice(i,1);return i>-1};this.trigger=function(t){var r,i,n,a;r=e[t];if(!r){return}if(arguments.length===2){n=r.length;for(i=0;i<n;++i){r[i].call(this,arguments[1])}}else{a=[];i=arguments.length;for(i=1;i<arguments.length;++i){a.push(arguments[i])}n=r.length;for(i=0;i<n;++i){r[i].apply(this,a)}}};this.dispose=function(){e={}}}};Y.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}));this.on("done",(function(t){e.flush(t)}));return e};Y.prototype.push=function(e){this.trigger("data",e)};Y.prototype.flush=function(e){this.trigger("done",e)};var X=Y;var J=function e(t){var r,i,n=[],a=[];n.byteLength=0;for(r=0;r<t.length;r++){i=t[r];if(i.nalUnitType==="access_unit_delimiter_rbsp"){if(n.length){n.duration=i.dts-n.dts;a.push(n)}n=[i];n.byteLength=i.data.byteLength;n.pts=i.pts;n.dts=i.dts}else{if(i.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){n.keyFrame=true}n.duration=i.dts-n.dts;n.byteLength+=i.data.byteLength;n.push(i)}}if(a.length&&(!n.duration||n.duration<=0)){n.duration=a[a.length-1].duration}a.push(n);return a};var Q=function e(t){var r,i,n=[],a=[];n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=t[0].pts;n.dts=t[0].dts;a.byteLength=0;a.nalCount=0;a.duration=0;a.pts=t[0].pts;a.dts=t[0].dts;for(r=0;r<t.length;r++){i=t[r];if(i.keyFrame){if(n.length){a.push(n);a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration}n=[i];n.nalCount=i.length;n.byteLength=i.byteLength;n.pts=i.pts;n.dts=i.dts;n.duration=i.duration}else{n.duration+=i.duration;n.nalCount+=i.length;n.byteLength+=i.byteLength;n.push(i)}}if(a.length&&n.duration<=0){n.duration=a[a.length-1].duration}a.byteLength+=n.byteLength;a.nalCount+=n.nalCount;a.duration+=n.duration;a.push(n);return a};var $=function e(t){var r;if(!t[0][0].keyFrame&&t.length>1){r=t.shift();t.byteLength-=r.byteLength;t.nalCount-=r.nalCount;t[0][0].dts=r.dts;t[0][0].pts=r.pts;t[0][0].duration+=r.duration}return t};var Z=function e(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var ee=function e(t,r){var i=Z();i.dataOffset=r;i.compositionTimeOffset=t.pts-t.dts;i.duration=t.duration;i.size=4*t.length;i.size+=t.byteLength;if(t.keyFrame){i.flags.dependsOn=2;i.flags.isNonSyncSample=0}return i};var te=function e(t,r){var i,n,a,s,o,u=r||0,l=[];for(i=0;i<t.length;i++){s=t[i];for(n=0;n<s.length;n++){o=s[n];a=ee(o,u);u+=a.size;l.push(a)}}return l};var re=function e(t){var r,i,n,a,s,o,u=0,l=t.byteLength,d=t.nalCount,f=l+4*d,c=new Uint8Array(f),h=new DataView(c.buffer);for(r=0;r<t.length;r++){a=t[r];for(i=0;i<a.length;i++){s=a[i];for(n=0;n<s.length;n++){o=s[n];h.setUint32(u,o.data.byteLength);u+=4;c.set(o.data,u);u+=o.data.byteLength}}}return c};var ie={groupNalsIntoFrames:J,groupFramesIntoGops:Q,extendFirstKeyFrame:$,generateSampleTable:te,concatenateNalData:re};var ne=[33,16,5,32,164,27];var ae=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var se=function e(t){var r=[];while(t--){r.push(0)}return r};var oe=function e(t){return Object.keys(t).reduce((function(e,r){e[r]=new Uint8Array(t[r].reduce((function(e,t){return e.concat(t)}),[]));return e}),{})};var ue={96e3:[ne,[227,64],se(154),[56]],88200:[ne,[231],se(170),[56]],64e3:[ne,[248,192],se(240),[56]],48e3:[ne,[255,192],se(268),[55,148,128],se(54),[112]],44100:[ne,[255,192],se(268),[55,163,128],se(84),[112]],32e3:[ne,[255,192],se(268),[55,234],se(226),[112]],24e3:[ne,[255,192],se(268),[55,255,128],se(268),[111,112],se(126),[224]],16e3:[ne,[255,192],se(268),[55,255,128],se(268),[111,255],se(269),[223,108],se(195),[1,192]],12e3:[ae,se(268),[3,127,248],se(268),[6,255,240],se(268),[13,255,224],se(268),[27,253,128],se(259),[56]],11025:[ae,se(268),[3,127,248],se(268),[6,255,240],se(268),[13,255,224],se(268),[27,255,192],se(268),[55,175,128],se(108),[112]],8e3:[ae,se(268),[3,121,16],se(47),[7]]};var le=oe(ue);var de=9e4,fe,ce,he,pe,ve,me;fe=function e(t){return t*de};ce=function e(t,r){return t*r};he=function e(t){return t/de};pe=function e(t,r){return t/r};ve=function e(t,r){return fe(pe(t,r))};me=function e(t,r){return ce(he(t),r)};var ge={secondsToVideoTs:fe,secondsToAudioTs:ce,videoTsToSeconds:he,audioTsToSeconds:pe,audioTsToVideoTs:ve,videoTsToAudioTs:me};var ye=9e4;var _e=function e(t){var r,i,n=0;for(r=0;r<t.length;r++){i=t[r];n+=i.data.byteLength}return n};var be=function e(t,r,i,n){var a,s=0,o=0,u=0,l=0,d,f;if(!r.length){return}a=ge.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate);s=Math.ceil(ye/(t.samplerate/1024));if(i&&n){o=a-Math.max(i,n);u=Math.floor(o/s);l=u*s}if(u<1||l>ye/2){return}d=le[t.samplerate];if(!d){d=r[0].data}for(f=0;f<u;f++){r.splice(f,0,{data:d})}t.baseMediaDecodeTime-=Math.floor(ge.videoTsToAudioTs(l,t.samplerate))};var Te=function e(t,r,i){if(r.minSegmentDts>=i){return t}r.minSegmentDts=Infinity;return t.filter((function(e){if(e.dts>=i){r.minSegmentDts=Math.min(r.minSegmentDts,e.dts);r.minSegmentPts=r.minSegmentDts;return true}return false}))};var Se=function e(t){var r,i,n=[];for(r=0;r<t.length;r++){i=t[r];n.push({size:i.data.byteLength,duration:1024})}return n};var Ee=function e(t){var r,i,n=0,a=new Uint8Array(_e(t));for(r=0;r<t.length;r++){i=t[r];a.set(i.data,n);n+=i.data.byteLength}return a};var we={prefixWithSilence:be,trimAdtsFramesByEarliestDts:Te,generateSampleTable:Se,concatenateFrameData:Ee};var ke=9e4;var Ae=function e(t,r){if(typeof r.pts==="number"){if(t.timelineStartInfo.pts===undefined){t.timelineStartInfo.pts=r.pts}if(t.minSegmentPts===undefined){t.minSegmentPts=r.pts}else{t.minSegmentPts=Math.min(t.minSegmentPts,r.pts)}if(t.maxSegmentPts===undefined){t.maxSegmentPts=r.pts}else{t.maxSegmentPts=Math.max(t.maxSegmentPts,r.pts)}}if(typeof r.dts==="number"){if(t.timelineStartInfo.dts===undefined){t.timelineStartInfo.dts=r.dts}if(t.minSegmentDts===undefined){t.minSegmentDts=r.dts}else{t.minSegmentDts=Math.min(t.minSegmentDts,r.dts)}if(t.maxSegmentDts===undefined){t.maxSegmentDts=r.dts}else{t.maxSegmentDts=Math.max(t.maxSegmentDts,r.dts)}}};var Ce=function e(t){delete t.minSegmentDts;delete t.maxSegmentDts;delete t.minSegmentPts;delete t.maxSegmentPts};var Le=function e(t,r){var i,n,a=t.minSegmentDts;if(!r){a-=t.timelineStartInfo.dts}i=t.timelineStartInfo.baseMediaDecodeTime;i+=a;i=Math.max(0,i);if(t.type==="audio"){n=t.samplerate/ke;i*=n;i=Math.floor(i)}return i};var xe={clearDtsInfo:Ce,calculateTrackBaseMediaDecodeTime:Le,collectDtsInfo:Ae};var De=4,Ie=128;var Oe=function e(t){var r=0,i={payloadType:-1,payloadSize:0},n=0,a=0;while(r<t.byteLength){if(t[r]===Ie){break}while(t[r]===255){n+=255;r++}n+=t[r++];while(t[r]===255){a+=255;r++}a+=t[r++];if(!i.payload&&n===De){i.payloadType=n;i.payloadSize=a;i.payload=t.subarray(r,r+a);break}r+=a;n=0;a=0}return i};var Re=function e(t){if(t.payload[0]!==181){return null}if((t.payload[1]<<8|t.payload[2])!==49){return null}if(String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])!=="GA94"){return null}if(t.payload[7]!==3){return null}return t.payload.subarray(8,t.payload.length-1)};var Pe=function e(t,r){var i=[],n,a,s,o;if(!(r[0]&64)){return i}a=r[0]&31;for(n=0;n<a;n++){s=n*3;o={type:r[s+2]&3,pts:t};if(r[s+2]&4){o.ccData=r[s+3]<<8|r[s+4];i.push(o)}}return i};var Ue=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};var Me={parseSei:Oe,parseUserData:Re,parseCaptionPackets:Pe,discardEmulationPreventionBytes:Ue,USER_DATA_REGISTERED_ITU_T_T35:De};var Ne=function e(){e.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new Ge(0,0),new Ge(0,1),new Ge(1,0),new Ge(1,1)];this.reset();this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data"));e.on("done",this.trigger.bind(this,"done"))}),this)};Ne.prototype=new X;Ne.prototype.push=function(e){var t,r,i;if(e.nalUnitType!=="sei_rbsp"){return}t=Me.parseSei(e.escapedRBSP);if(t.payloadType!==Me.USER_DATA_REGISTERED_ITU_T_T35){return}r=Me.parseUserData(t);if(!r){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=false}return}i=Me.parseCaptionPackets(e.pts,r);this.captionPackets_=this.captionPackets_.concat(i);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};Ne.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach((function(e){e.flush()}),this);return}this.captionPackets_.forEach((function(e,t){e.presortIndex=t}));this.captionPackets_.sort((function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts}));this.captionPackets_.forEach((function(e){if(e.type<2){this.dispatchCea608Packet(e)}}),this);this.captionPackets_.length=0;this.ccStreams_.forEach((function(e){e.flush()}),this);return};Ne.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach((function(e){e.reset()}))};Ne.prototype.dispatchCea608Packet=function(e){if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(this.activeCea608Channel_[e.type]===null){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};Ne.prototype.setsChannel1Active=function(e){return(e.ccData&30720)===4096};Ne.prototype.setsChannel2Active=function(e){return(e.ccData&30720)===6144};var je={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var Be=function e(t){if(t===null){return""}t=je[t]||t;return String.fromCharCode(t)};var Fe=14;var He=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var qe=function e(){var t=[],r=Fe+1;while(r--){t.push("")}return t};var Ge=function e(t,r){e.prototype.init.call(this);this.field_=t||0;this.dataChannel_=r||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,r,i,n,a;t=e.ccData&32639;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}i=t>>>8;n=t&255;if(t===this.PADDING_){return}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);r=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=r;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=qe()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=qe()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if(this.mode_!=="paintOn"){this.flushDisplayed(e.pts);this.displayed_=qe()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(i,n)){i=(i&3)<<8;a=Be(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(i,n)){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}i=(i&3)<<8;a=Be(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(i,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if((n&14)===14){this.addFormatting(e.pts,["i"])}if((n&1)===1){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(i,n)){this.column_+=n&3}else if(this.isPAC(i,n)){var s=He.indexOf(t&7968);if(this.mode_==="rollUp"){if(s-this.rollUpRows_+1<0){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(n&1&&this.formatting_.indexOf("u")===-1){this.addFormatting(e.pts,["u"])}if((t&16)===16){this.column_=((t&14)>>1)*4}if(this.isColorPAC(n)){if((n&14)===14){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(i)){if(n===0){n=null}a=Be(i);a+=Be(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};Ge.prototype=new X;Ge.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){console.error("Skipping malformed caption.");return""}})).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};Ge.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=qe();this.nonDisplayed_=qe();this.lastControlCode_=null;this.column_=0;this.row_=Fe;this.rollUpRows_=2;this.formatting_=[]};Ge.prototype.setConstants=function(){if(this.dataChannel_===0){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(this.dataChannel_===1){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};Ge.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};Ge.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63};Ge.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47};Ge.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35};Ge.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127};Ge.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};Ge.prototype.isNormalChar=function(e){return e>=32&&e<=127};Ge.prototype.setRollUp=function(e,t){if(this.mode_!=="rollUp"){this.row_=Fe;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=qe();this.displayed_=qe()}if(t!==undefined&&t!==this.row_){for(var r=0;r<this.rollUpRows_;r++){this.displayed_[t-r]=this.displayed_[this.row_-r];this.displayed_[this.row_-r]=""}}if(t===undefined){t=this.row_}this.topRow_=t-this.rollUpRows_+1};Ge.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var r=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,r)};Ge.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[];this[this.mode_](e,t)};Ge.prototype.popOn=function(e,t){var r=this.nonDisplayed_[this.row_];r+=t;this.nonDisplayed_[this.row_]=r};Ge.prototype.rollUp=function(e,t){var r=this.displayed_[this.row_];r+=t;this.displayed_[this.row_]=r};Ge.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<Fe+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};Ge.prototype.paintOn=function(e,t){var r=this.displayed_[this.row_];r+=t;this.displayed_[this.row_]=r};var Ve={CaptionStream:Ne,Cea608Stream:Ge};var We={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};var ze=8589934592;var Ke=4294967296;var Ye=function e(t,r){var i=1;if(t>r){i=-1}while(Math.abs(r-t)>Ke){t+=i*ze}return t};var Xe=function e(t){var r,i;e.prototype.init.call(this);this.type_=t;this.push=function(e){if(e.type!==this.type_){return}if(i===undefined){i=e.dts}e.dts=Ye(e.dts,i);e.pts=Ye(e.pts,i);r=e.dts;this.trigger("data",e)};this.flush=function(){i=r;this.trigger("done")};this.discontinuity=function(){i=void 0;r=void 0}};Xe.prototype=new X;var Je={TimestampRolloverStream:Xe,handleRollover:Ye};var Qe=function e(t,r,i){var n,a="";for(n=r;n<i;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a},$e=function e(t,r,i){return decodeURIComponent(Qe(t,r,i))},Ze=function e(t,r,i){return unescape(Qe(t,r,i))},et=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},tt={TXXX:function e(t){var r;if(t.data[0]!==3){return}for(r=1;r<t.data.length;r++){if(t.data[r]===0){t.description=$e(t.data,1,r);t.value=$e(t.data,r+1,t.data.length).replace(/\0*$/,"");break}}t.data=t.value},WXXX:function e(t){var r;if(t.data[0]!==3){return}for(r=1;r<t.data.length;r++){if(t.data[r]===0){t.description=$e(t.data,1,r);t.url=$e(t.data,r+1,t.data.length);break}}},PRIV:function e(t){var r;for(r=0;r<t.data.length;r++){if(t.data[r]===0){t.owner=Ze(t.data,0,r);break}}t.privateData=t.data.subarray(r+1);t.data=t.privateData}},rt;rt=function e(t){var r={debug:!!(t&&t.debug),descriptor:t&&t.descriptor},i=0,n=[],a=0,s;rt.prototype.init.call(this);this.dispatchType=We.METADATA_STREAM_TYPE.toString(16);if(r.descriptor){for(s=0;s<r.descriptor.length;s++){this.dispatchType+=("00"+r.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var t,s,o,u,l,d;if(e.type!=="timed-metadata"){return}if(e.dataAlignmentIndicator){a=0;n.length=0}if(n.length===0&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){if(r.debug){console.log("Skipping unrecognized metadata packet")}return}n.push(e);a+=e.data.byteLength;if(n.length===1){i=et(e.data.subarray(6,10));i+=10}if(a<i){return}t={data:new Uint8Array(i),frames:[],pts:n[0].pts,dts:n[0].dts};for(l=0;l<i;){t.data.set(n[0].data.subarray(0,i-l),l);l+=n[0].data.byteLength;a-=n[0].data.byteLength;n.shift()}s=10;if(t.data[5]&64){s+=4;s+=et(t.data.subarray(10,14));i-=et(t.data.subarray(16,20))}do{o=et(t.data.subarray(s+4,s+8));if(o<1){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}d=String.fromCharCode(t.data[s],t.data[s+1],t.data[s+2],t.data[s+3]);u={id:d,data:t.data.subarray(s+10,s+o+10)};u.key=u.id;if(tt[u.id]){tt[u.id](u);if(u.owner==="com.apple.streaming.transportStreamTimestamp"){var f=u.data,c=(f[3]&1)<<30|f[4]<<22|f[5]<<14|f[6]<<6|f[7]>>>2;c*=4;c+=f[7]&3;u.timeStamp=c;if(t.pts===undefined&&t.dts===undefined){t.pts=u.timeStamp;t.dts=u.timeStamp}this.trigger("timestamp",u)}}t.frames.push(u);s+=10;s+=o}while(s<i);this.trigger("data",t)}};rt.prototype=new X;var it=rt;var nt=Je.TimestampRolloverStream;var at,st,ot;var ut=188,lt=71;at=function e(){var t=new Uint8Array(ut),r=0;at.prototype.init.call(this);this.push=function(e){var i=0,n=ut,a;if(r){a=new Uint8Array(e.byteLength+r);a.set(t.subarray(0,r));a.set(e,r);r=0}else{a=e}while(n<a.byteLength){if(a[i]===lt&&a[n]===lt){this.trigger("data",a.subarray(i,n));i+=ut;n+=ut;continue}i++;n++}if(i<a.byteLength){t.set(a.subarray(i),0);r=a.byteLength-i}};this.flush=function(){if(r===ut&&t[0]===lt){this.trigger("data",t);r=0}this.trigger("done")}};at.prototype=new X;st=function e(){var t,r,i,n;st.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;t=function e(t,n){var a=0;if(n.payloadUnitStartIndicator){a+=t[a]+1}if(n.type==="pat"){r(t.subarray(a),n)}else{i(t.subarray(a),n)}};r=function e(t,r){r.section_number=t[7];r.last_section_number=t[8];n.pmtPid=(t[10]&31)<<8|t[11];r.pmtPid=n.pmtPid};i=function e(t,r){var i,a,s,o;if(!(t[5]&1)){return}n.programMapTable={video:null,audio:null,"timed-metadata":{}};i=(t[1]&15)<<8|t[2];a=3+i-4;s=(t[10]&15)<<8|t[11];o=12+s;while(o<a){var u=t[o];var l=(t[o+1]&31)<<8|t[o+2];if(u===We.H264_STREAM_TYPE&&n.programMapTable.video===null){n.programMapTable.video=l}else if(u===We.ADTS_STREAM_TYPE&&n.programMapTable.audio===null){n.programMapTable.audio=l}else if(u===We.METADATA_STREAM_TYPE){n.programMapTable["timed-metadata"][l]=u}o+=((t[o+3]&15)<<8|t[o+4])+5}r.programMapTable=n.programMapTable};this.push=function(e){var r={},i=4;r.payloadUnitStartIndicator=!!(e[1]&64);r.pid=e[1]&31;r.pid<<=8;r.pid|=e[2];if((e[3]&48)>>>4>1){i+=e[i]+1}if(r.pid===0){r.type="pat";t(e.subarray(i),r);this.trigger("data",r)}else if(r.pid===this.pmtPid){r.type="pmt";t(e.subarray(i),r);this.trigger("data",r);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===undefined){this.packetsWaitingForPmt.push([e,i,r])}else{this.processPes_(e,i,r)}};this.processPes_=function(e,t,r){if(r.pid===this.programMapTable.video){r.streamType=We.H264_STREAM_TYPE}else if(r.pid===this.programMapTable.audio){r.streamType=We.ADTS_STREAM_TYPE}else{r.streamType=this.programMapTable["timed-metadata"][r.pid]}r.type="pes";r.data=e.subarray(t);this.trigger("data",r)}};st.prototype=new X;st.STREAM_TYPES={h264:27,adts:15};ot=function e(){var t=this,r={data:[],size:0},i={data:[],size:0},n={data:[],size:0},a=function e(t,r){var i;r.packetLength=6+(t[4]<<8|t[5]);r.dataAlignmentIndicator=(t[6]&4)!==0;i=t[7];if(i&192){r.pts=(t[9]&14)<<27|(t[10]&255)<<20|(t[11]&254)<<12|(t[12]&255)<<5|(t[13]&254)>>>3;r.pts*=4;r.pts+=(t[13]&6)>>>1;r.dts=r.pts;if(i&64){r.dts=(t[14]&14)<<27|(t[15]&255)<<20|(t[16]&254)<<12|(t[17]&255)<<5|(t[18]&254)>>>3;r.dts*=4;r.dts+=(t[18]&6)>>>1}}r.data=t.subarray(9+t[8])},s=function e(r,i,n){var s=new Uint8Array(r.size),o={type:i},u=0,l=0,d=false,f;if(!r.data.length||r.size<9){return}o.trackId=r.data[0].pid;for(u=0;u<r.data.length;u++){f=r.data[u];s.set(f.data,l);l+=f.data.byteLength}a(s,o);d=i==="video"||o.packetLength<=r.size;if(n||d){r.size=0;r.data.length=0}if(d){t.trigger("data",o)}};ot.prototype.init.call(this);this.push=function(e){({pat:function e(){},pes:function t(){var a,o;switch(e.streamType){case We.H264_STREAM_TYPE:case We.H264_STREAM_TYPE:a=r;o="video";break;case We.ADTS_STREAM_TYPE:a=i;o="audio";break;case We.METADATA_STREAM_TYPE:a=n;o="timed-metadata";break;default:return}if(e.payloadUnitStartIndicator){s(a,o,true)}a.data.push(e);a.size+=e.data.byteLength},pmt:function r(){var i={type:"metadata",tracks:[]},n=e.programMapTable;if(n.video!==null){i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"})}if(n.audio!==null){i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"})}t.trigger("data",i)}})[e.type]()};this.flush=function(){s(r,"video");s(i,"audio");s(n,"timed-metadata");this.trigger("done")}};ot.prototype=new X;var dt={PAT_PID:0,MP2T_PACKET_LENGTH:ut,TransportPacketStream:at,TransportParseStream:st,ElementaryStream:ot,TimestampRolloverStream:nt,CaptionStream:Ve.CaptionStream,Cea608Stream:Ve.Cea608Stream,MetadataStream:it};for(var ft in We){if(We.hasOwnProperty(ft)){dt[ft]=We[ft]}}var ct=dt;var ht;var pt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];ht=function e(){var t;ht.prototype.init.call(this);this.push=function(e){var r=0,i=0,n,a,s,o,u,l;if(e.type!=="audio"){return}if(t){o=t;t=new Uint8Array(o.byteLength+e.data.byteLength);t.set(o);t.set(e.data,o.byteLength)}else{t=e.data}while(r+5<t.length){if(t[r]!==255||(t[r+1]&246)!==240){r++;continue}a=(~t[r+1]&1)*2;n=(t[r+3]&3)<<11|t[r+4]<<3|(t[r+5]&224)>>5;u=((t[r+6]&3)+1)*1024;l=u*9e4/pt[(t[r+2]&60)>>>2];s=r+n;if(t.byteLength<s){return}this.trigger("data",{pts:e.pts+i*l,dts:e.dts+i*l,sampleCount:u,audioobjecttype:(t[r+2]>>>6&3)+1,channelcount:(t[r+2]&1)<<2|(t[r+3]&192)>>>6,samplerate:pt[(t[r+2]&60)>>>2],samplingfrequencyindex:(t[r+2]&60)>>>2,samplesize:16,data:t.subarray(r+7+a,s)});if(t.byteLength===s){t=undefined;return}i++;t=t.subarray(s)}};this.flush=function(){this.trigger("done")}};ht.prototype=new X;var vt=ht;var mt;mt=function e(t){var r=t.byteLength,i=0,n=0;this.length=function(){return 8*r};this.bitsAvailable=function(){return 8*r+n};this.loadWord=function(){var e=t.byteLength-r,a=new Uint8Array(4),s=Math.min(4,r);if(s===0){throw new Error("no bytes available")}a.set(t.subarray(e,e+s));i=new DataView(a.buffer).getUint32(0);n=s*8;r-=s};this.skipBits=function(e){var t;if(n>e){i<<=e;n-=e}else{e-=n;t=Math.floor(e/8);e-=t*8;r-=t;this.loadWord();i<<=e;n-=e}};this.readBits=function(e){var t=Math.min(n,e),a=i>>>32-t;n-=t;if(n>0){i<<=t}else if(r>0){this.loadWord()}t=e-t;if(t>0){return a<<t|this.readBits(t)}return a};this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e){if((i&2147483648>>>e)!==0){i<<=e;n-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var gt=mt;var yt,_t;var bt;_t=function e(){var t=0,r,i;_t.prototype.init.call(this);this.push=function(e){var n;if(!i){i=e.data}else{n=new Uint8Array(i.byteLength+e.data.byteLength);n.set(i);n.set(e.data,i.byteLength);i=n}for(;t<i.byteLength-3;t++){if(i[t+2]===1){r=t+5;break}}while(r<i.byteLength){switch(i[r]){case 0:if(i[r-1]!==0){r+=2;break}else if(i[r-2]!==0){r++;break}if(t+3!==r-2){this.trigger("data",i.subarray(t+3,r-2))}do{r++}while(i[r]!==1&&r<i.length);t=r-2;r+=3;break;case 1:if(i[r-1]!==0||i[r-2]!==0){r+=3;break}this.trigger("data",i.subarray(t+3,r-2));t=r-2;r+=3;break;default:r+=3;break}}i=i.subarray(t);r-=t;t=0};this.flush=function(){if(i&&i.byteLength>3){this.trigger("data",i.subarray(t+3))}i=null;t=0;this.trigger("done")}};_t.prototype=new X;bt={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};yt=function e(){var t=new _t,r,i,n,a,s,o,u;yt.prototype.init.call(this);r=this;this.push=function(e){if(e.type!=="video"){return}i=e.trackId;n=e.pts;a=e.dts;t.push(e)};t.on("data",(function(e){var t={trackId:i,pts:n,dts:a,data:e};switch(e[0]&31){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp";t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp";t.escapedRBSP=s(e.subarray(1));t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp";break;default:break}r.trigger("data",t)}));t.on("done",(function(){r.trigger("done")}));this.flush=function(){t.flush()};u=function e(t,r){var i=8,n=8,a,s;for(a=0;a<t;a++){if(n!==0){s=r.readExpGolomb();n=(i+s+256)%256}i=n===0?i:n}};s=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};o=function e(t){var r=0,i=0,n=0,a=0,s=1,o,l,d,f,c,h,p,v,m,g,y,_,b,T;o=new gt(t);l=o.readUnsignedByte();f=o.readUnsignedByte();d=o.readUnsignedByte();o.skipUnsignedExpGolomb();if(bt[l]){c=o.readUnsignedExpGolomb();if(c===3){o.skipBits(1)}o.skipUnsignedExpGolomb();o.skipUnsignedExpGolomb();o.skipBits(1);if(o.readBoolean()){y=c!==3?8:12;for(T=0;T<y;T++){if(o.readBoolean()){if(T<6){u(16,o)}else{u(64,o)}}}}}o.skipUnsignedExpGolomb();h=o.readUnsignedExpGolomb();if(h===0){o.readUnsignedExpGolomb()}else if(h===1){o.skipBits(1);o.skipExpGolomb();o.skipExpGolomb();p=o.readUnsignedExpGolomb();for(T=0;T<p;T++){o.skipExpGolomb()}}o.skipUnsignedExpGolomb();o.skipBits(1);v=o.readUnsignedExpGolomb();m=o.readUnsignedExpGolomb();g=o.readBits(1);if(g===0){o.skipBits(1)}o.skipBits(1);if(o.readBoolean()){r=o.readUnsignedExpGolomb();i=o.readUnsignedExpGolomb();n=o.readUnsignedExpGolomb();a=o.readUnsignedExpGolomb()}if(o.readBoolean()){if(o.readBoolean()){b=o.readUnsignedByte();switch(b){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:{_=[o.readUnsignedByte()<<8|o.readUnsignedByte(),o.readUnsignedByte()<<8|o.readUnsignedByte()];break}}if(_){s=_[0]/_[1]}}}return{profileIdc:l,levelIdc:d,profileCompatibility:f,width:Math.ceil(((v+1)*16-r*2-i*2)*s),height:(2-g)*(m+1)*16-n*2-a*2}}};yt.prototype=new X;var Tt={H264Stream:yt,NalByteStream:_t};var St=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var Et=function e(t){if(t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)){return true}return false};var wt=function e(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]};var kt=function e(t,r,i){var n,a="";for(n=r;n<i;n++){a+="%"+("00"+t[n].toString(16)).slice(-2)}return a};var At=function e(t,r,i){return unescape(kt(t,r,i))};var Ct=function e(t,r){var i=t[r+6]<<21|t[r+7]<<14|t[r+8]<<7|t[r+9],n=t[r+5],a=(n&16)>>4;if(a){return i+20}return i+10};var Lt=function e(t,r){var i=(t[r+5]&224)>>5,n=t[r+4]<<3,a=t[r+3]&3<<11;return a|n|i};var xt=function e(t,r){if(t[r]==="I".charCodeAt(0)&&t[r+1]==="D".charCodeAt(0)&&t[r+2]==="3".charCodeAt(0)){return"timed-metadata"}else if(t[r]&255===255&&(t[r+1]&240)===240){return"audio"}return null};var Dt=function e(t){var r=0;while(r+5<t.length){if(t[r]!==255||(t[r+1]&246)!==240){r++;continue}return St[(t[r+2]&60)>>>2]}return null};var It=function e(t){var r,i,n,a;r=10;if(t[5]&64){r+=4;r+=wt(t.subarray(10,14))}do{i=wt(t.subarray(r+4,r+8));if(i<1){return null}a=String.fromCharCode(t[r],t[r+1],t[r+2],t[r+3]);if(a==="PRIV"){n=t.subarray(r+10,r+i+10);for(var s=0;s<n.byteLength;s++){if(n[s]===0){var o=At(n,0,s);if(o==="com.apple.streaming.transportStreamTimestamp"){var u=n.subarray(s+1);var l=(u[3]&1)<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;l*=4;l+=u[7]&3;return l}break}}}r+=10;r+=i}while(r<t.byteLength);return null};var Ot={isLikelyAacData:Et,parseId3TagSize:Ct,parseAdtsSize:Lt,parseType:xt,parseSampleRate:Dt,parseAacTimestamp:It};var Rt;Rt=function e(){var t=new Uint8Array,r=0;Rt.prototype.init.call(this);this.setTimestamp=function(e){r=e};this.push=function(e){var i=0,n=0,a,s,o,u;if(t.length){u=t.length;t=new Uint8Array(e.byteLength+u);t.set(t.subarray(0,u));t.set(e,u)}else{t=e}while(t.length-n>=3){if(t[n]==="I".charCodeAt(0)&&t[n+1]==="D".charCodeAt(0)&&t[n+2]==="3".charCodeAt(0)){if(t.length-n<10){break}i=Ot.parseId3TagSize(t,n);if(n+i>t.length){break}s={type:"timed-metadata",data:t.subarray(n,n+i)};this.trigger("data",s);n+=i;continue}else if((t[n]&255)===255&&(t[n+1]&240)===240){if(t.length-n<7){break}i=Ot.parseAdtsSize(t,n);if(n+i>t.length){break}o={type:"audio",data:t.subarray(n,n+i),pts:r,dts:r};this.trigger("data",o);n+=i;continue}n++}a=t.length-n;if(a>0){t=t.subarray(n)}else{t=new Uint8Array}}};Rt.prototype=new X;var Pt=Rt;var Ut=Tt.H264Stream;var Mt=Ot.isLikelyAacData;var Nt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var jt=["width","height","profileIdc","levelIdc","profileCompatibility"];var Bt,Ft,Ht,qt;var Gt=function e(t,r){var i;if(t.length!==r.length){return false}for(i=0;i<t.length;i++){if(t[i]!==r[i]){return false}}return true};var Vt=function e(t,r,i,n,a){return{start:{dts:t,pts:r},end:{dts:i,pts:n},prependedContentDuration:a}};Ft=function e(t,r){var i=[],n=0,a=0,s=0,o=Infinity;r=r||{};Ft.prototype.init.call(this);this.push=function(e){xe.collectDtsInfo(t,e);if(t){Nt.forEach((function(r){t[r]=e[r]}))}i.push(e)};this.setEarliestDts=function(e){a=e-t.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(e){o=e};this.setAudioAppendStart=function(e){s=e};this.flush=function(){var e,u,l,d;if(i.length===0){this.trigger("done","AudioSegmentStream");return}e=we.trimAdtsFramesByEarliestDts(i,t,a);t.baseMediaDecodeTime=xe.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);we.prefixWithSilence(t,e,s,o);t.samples=we.generateSampleTable(e);l=j.mdat(we.concatenateFrameData(e));i=[];u=j.moof(n,[t]);d=new Uint8Array(u.byteLength+l.byteLength);n++;d.set(u);d.set(l,u.byteLength);xe.clearDtsInfo(t);this.trigger("data",{track:t,boxes:d});this.trigger("done","AudioSegmentStream")}};Ft.prototype=new X;Bt=function e(t,r){var i=0,n=[],a=[],s,o;r=r||{};Bt.prototype.init.call(this);delete t.minPTS;this.gopCache_=[];this.push=function(e){xe.collectDtsInfo(t,e);if(e.nalUnitType==="seq_parameter_set_rbsp"&&!s){s=e.config;t.sps=[e.data];jt.forEach((function(e){t[e]=s[e]}),this)}if(e.nalUnitType==="pic_parameter_set_rbsp"&&!o){o=e.data;t.pps=[e.data]}n.push(e)};this.flush=function(){var e,s,o,u,l,d,f=0,c,h;while(n.length){if(n[0].nalUnitType==="access_unit_delimiter_rbsp"){break}n.shift()}if(n.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}e=ie.groupNalsIntoFrames(n);o=ie.groupFramesIntoGops(e);if(!o[0][0].keyFrame){s=this.getGopForFusion_(n[0],t);if(s){f=s.duration;o.unshift(s);o.byteLength+=s.byteLength;o.nalCount+=s.nalCount;o.pts=s.pts;o.dts=s.dts;o.duration+=s.duration}else{o=ie.extendFirstKeyFrame(o)}}if(a.length){var p;if(r.alignGopsAtEnd){p=this.alignGopsAtEnd_(o)}else{p=this.alignGopsAtStart_(o)}if(!p){this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}xe.clearDtsInfo(t);o=p}xe.collectDtsInfo(t,o);t.samples=ie.generateSampleTable(o);l=j.mdat(ie.concatenateNalData(o));t.baseMediaDecodeTime=xe.calculateTrackBaseMediaDecodeTime(t,r.keepOriginalTimestamps);this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})));c=o[0];h=o[o.length-1];this.trigger("segmentTimingInfo",Vt(c.dts,c.pts,h.dts+h.duration,h.pts+h.duration,f));this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);n=[];this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime);this.trigger("timelineStartInfo",t.timelineStartInfo);u=j.moof(i,[t]);d=new Uint8Array(u.byteLength+l.byteLength);i++;d.set(u);d.set(l,u.byteLength);this.trigger("data",{track:t,boxes:d});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){xe.clearDtsInfo(t);s=undefined;o=undefined};this.getGopForFusion_=function(e){var r=45e3,i=1e4,n=Infinity,a,s,o,u,l;for(l=0;l<this.gopCache_.length;l++){u=this.gopCache_[l];o=u.gop;if(!(t.pps&&Gt(t.pps[0],u.pps[0]))||!(t.sps&&Gt(t.sps[0],u.sps[0]))){continue}if(o.dts<t.timelineStartInfo.dts){continue}a=e.dts-o.dts-o.duration;if(a>=-i&&a<=r){if(!s||n>a){s=u;n=a}}}if(s){return s.gop}return null};this.alignGopsAtStart_=function(e){var t,r,i,n,s,o,u,l;s=e.byteLength;o=e.nalCount;u=e.duration;t=r=0;while(t<a.length&&r<e.length){i=a[t];n=e[r];if(i.pts===n.pts){break}if(n.pts>i.pts){t++;continue}r++;s-=n.byteLength;o-=n.nalCount;u-=n.duration}if(r===0){return e}if(r===e.length){return null}l=e.slice(r);l.byteLength=s;l.duration=u;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,r,i,n,s,o;t=a.length-1;r=e.length-1;s=null;o=false;while(t>=0&&r>=0){i=a[t];n=e[r];if(i.pts===n.pts){o=true;break}if(i.pts>n.pts){t--;continue}if(t===a.length-1){s=r}r--}if(!o&&s===null){return null}var u;if(o){u=r}else{u=s}if(u===0){return e}var l=e.slice(u);var d=l.reduce((function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e}),{byteLength:0,duration:0,nalCount:0});l.byteLength=d.byteLength;l.duration=d.duration;l.nalCount=d.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){a=e}};Bt.prototype=new X;qt=function e(t,r){this.numberOfTracks=0;this.metadataStream=r;t=t||{};if(typeof t.remux!=="undefined"){this.remuxTracks=!!t.remux}else{this.remuxTracks=true}if(typeof t.keepOriginalTimestamps==="boolean"){this.keepOriginalTimestamps=t.keepOriginalTimestamps}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;qt.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBoxes.push(e.boxes);this.pendingBytes+=e.boxes.byteLength;if(e.track.type==="video"){this.videoTrack=e.track}if(e.track.type==="audio"){this.audioTrack=e.track}}};qt.prototype=new X;qt.prototype.flush=function(e){var t=0,r={captions:[],captionStreams:{},metadata:[],info:{}},i,n,a,s=0,o;if(this.pendingTracks.length<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.remuxTracks){return}else if(this.pendingTracks.length===0){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){s=this.videoTrack.timelineStartInfo.pts;jt.forEach((function(e){r.info[e]=this.videoTrack[e]}),this)}else if(this.audioTrack){s=this.audioTrack.timelineStartInfo.pts;Nt.forEach((function(e){r.info[e]=this.audioTrack[e]}),this)}if(this.pendingTracks.length===1){r.type=this.pendingTracks[0].type}else{r.type="combined"}this.emittedTracks+=this.pendingTracks.length;a=j.initSegment(this.pendingTracks);r.initSegment=new Uint8Array(a.byteLength);r.initSegment.set(a);r.data=new Uint8Array(this.pendingBytes);for(o=0;o<this.pendingBoxes.length;o++){r.data.set(this.pendingBoxes[o],t);t+=this.pendingBoxes[o].byteLength}for(o=0;o<this.pendingCaptions.length;o++){i=this.pendingCaptions[o];i.startTime=i.startPts;if(!this.keepOriginalTimestamps){i.startTime-=s}i.startTime/=9e4;i.endTime=i.endPts;if(!this.keepOriginalTimestamps){i.endTime-=s}i.endTime/=9e4;r.captionStreams[i.stream]=true;r.captions.push(i)}for(o=0;o<this.pendingMetadata.length;o++){n=this.pendingMetadata[o];n.cueTime=n.pts;if(!this.keepOriginalTimestamps){n.cueTime-=s}n.cueTime/=9e4;r.metadata.push(n)}r.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",r);if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};Ht=function e(t){var r=this,i=true,n,a;Ht.prototype.init.call(this);t=t||{};this.baseMediaDecodeTime=t.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e;e.type="aac";e.metadataStream=new ct.MetadataStream;e.aacStream=new Pt;e.audioTimestampRolloverStream=new ct.TimestampRolloverStream("audio");e.timedMetadataTimestampRolloverStream=new ct.TimestampRolloverStream("timed-metadata");e.adtsStream=new vt;e.coalesceStream=new qt(t,e.metadataStream);e.headOfPipeline=e.aacStream;e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream);e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream);e.metadataStream.on("timestamp",(function(t){e.aacStream.setTimestamp(t.timeStamp)}));e.aacStream.on("data",(function(i){if(i.type==="timed-metadata"&&!e.audioSegmentStream){a=a||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"};e.coalesceStream.numberOfTracks++;e.audioSegmentStream=new Ft(a,t);e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream)}}));e.coalesceStream.on("data",this.trigger.bind(this,"data"));e.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var e={};this.transmuxPipeline_=e;e.type="ts";e.metadataStream=new ct.MetadataStream;e.packetStream=new ct.TransportPacketStream;e.parseStream=new ct.TransportParseStream;e.elementaryStream=new ct.ElementaryStream;e.videoTimestampRolloverStream=new ct.TimestampRolloverStream("video");e.audioTimestampRolloverStream=new ct.TimestampRolloverStream("audio");e.timedMetadataTimestampRolloverStream=new ct.TimestampRolloverStream("timed-metadata");e.adtsStream=new vt;e.h264Stream=new Ut;e.captionStream=new ct.CaptionStream;e.coalesceStream=new qt(t,e.metadataStream);e.headOfPipeline=e.packetStream;e.packetStream.pipe(e.parseStream).pipe(e.elementaryStream);e.elementaryStream.pipe(e.videoTimestampRolloverStream).pipe(e.h264Stream);e.elementaryStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream);e.elementaryStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream);e.h264Stream.pipe(e.captionStream).pipe(e.coalesceStream);e.elementaryStream.on("data",(function(i){var s;if(i.type==="metadata"){s=i.tracks.length;while(s--){if(!n&&i.tracks[s].type==="video"){n=i.tracks[s];n.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}else if(!a&&i.tracks[s].type==="audio"){a=i.tracks[s];a.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime}}if(n&&!e.videoSegmentStream){e.coalesceStream.numberOfTracks++;e.videoSegmentStream=new Bt(n,t);e.videoSegmentStream.on("timelineStartInfo",(function(t){if(a){a.timelineStartInfo=t;e.audioSegmentStream.setEarliestDts(t.dts)}}));e.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo"));e.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo"));e.videoSegmentStream.on("baseMediaDecodeTime",(function(t){if(a){e.audioSegmentStream.setVideoBaseMediaDecodeTime(t)}}));e.h264Stream.pipe(e.videoSegmentStream).pipe(e.coalesceStream)}if(a&&!e.audioSegmentStream){e.coalesceStream.numberOfTracks++;e.audioSegmentStream=new Ft(a,t);e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream)}}}));e.coalesceStream.on("data",this.trigger.bind(this,"data"));e.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(e){var r=this.transmuxPipeline_;if(!t.keepOriginalTimestamps){this.baseMediaDecodeTime=e}if(a){a.timelineStartInfo.dts=undefined;a.timelineStartInfo.pts=undefined;xe.clearDtsInfo(a);if(!t.keepOriginalTimestamps){a.timelineStartInfo.baseMediaDecodeTime=e}if(r.audioTimestampRolloverStream){r.audioTimestampRolloverStream.discontinuity()}}if(n){if(r.videoSegmentStream){r.videoSegmentStream.gopCache_=[];r.videoTimestampRolloverStream.discontinuity()}n.timelineStartInfo.dts=undefined;n.timelineStartInfo.pts=undefined;xe.clearDtsInfo(n);r.captionStream.reset();if(!t.keepOriginalTimestamps){n.timelineStartInfo.baseMediaDecodeTime=e}}if(r.timedMetadataTimestampRolloverStream){r.timedMetadataTimestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(a){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.alignGopsWith=function(e){if(n&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(i){var t=Mt(e);if(t&&this.transmuxPipeline_.type!=="aac"){this.setupAacPipeline()}else if(!t&&this.transmuxPipeline_.type!=="ts"){this.setupTsPipeline()}i=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){i=true;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};Ht.prototype=new X;var Wt={Transmuxer:Ht,VideoSegmentStream:Bt,AudioSegmentStream:Ft,AUDIO_PROPERTIES:Nt,VIDEO_PROPERTIES:jt,generateVideoSegmentTimingInfo:Vt};var zt,Kt,Yt=K.parseType,Xt=function e(t){return new Date(t*1e3-20828448e5)},Jt=function e(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}},Qt=function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=[],n,a;for(n=0;n+4<t.length;n+=a){a=r.getUint32(n);n+=4;if(a<=0){i.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(t[n]&31){case 1:i.push("slice_layer_without_partitioning_rbsp");break;case 5:i.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:i.push("sei_rbsp");break;case 7:i.push("seq_parameter_set_rbsp");break;case 8:i.push("pic_parameter_set_rbsp");break;case 9:i.push("access_unit_delimiter_rbsp");break;default:i.push("UNKNOWN NAL - "+t[n]&31);break}}return i},$t={avc1:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:r.getUint16(6),width:r.getUint16(24),height:r.getUint16(26),horizresolution:r.getUint16(28)+r.getUint16(30)/16,vertresolution:r.getUint16(32)+r.getUint16(34)/16,frameCount:r.getUint16(40),depth:r.getUint16(74),config:zt(t.subarray(78,t.byteLength))}},avcC:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:t[4]&3,sps:[],pps:[]},n=t[5]&31,a,s,o,u;o=6;for(u=0;u<n;u++){s=r.getUint16(o);o+=2;i.sps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}a=t[o];o++;for(u=0;u<a;u++){s=r.getUint16(o);o+=2;i.pps.push(new Uint8Array(t.subarray(o,o+s)));o+=s}return i},btrt:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:r.getUint32(0),maxBitrate:r.getUint32(4),avgBitrate:r.getUint32(8)}},esds:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:t[8]&31,decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(t[26]&7)<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={majorBrand:Yt(t.subarray(0,4)),minorVersion:r.getUint32(4),compatibleBrands:[]},n=8;while(n<t.byteLength){i.compatibleBrands.push(Yt(t.subarray(n,n+4)));n+=4}return i},dinf:function e(t){return{boxes:zt(t)}},dref:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:zt(t.subarray(8))}},hdlr:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:Yt(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(t[n]===0){n++;break}i.name+=String.fromCharCode(t[n])}i.name=decodeURIComponent(escape(i.name));return i},mdat:function e(t){return{byteLength:t.byteLength,nals:Qt(t)}},mdhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n,a={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};if(a.version===1){i+=4;a.creationTime=Xt(r.getUint32(i));i+=8;a.modificationTime=Xt(r.getUint32(i));i+=4;a.timescale=r.getUint32(i);i+=8;a.duration=r.getUint32(i)}else{a.creationTime=Xt(r.getUint32(i));i+=4;a.modificationTime=Xt(r.getUint32(i));i+=4;a.timescale=r.getUint32(i);i+=4;a.duration=r.getUint32(i)}i+=4;n=r.getUint16(i);a.language+=String.fromCharCode((n>>10)+96);a.language+=String.fromCharCode(((n&992)>>5)+96);a.language+=String.fromCharCode((n&31)+96);return a},mdia:function e(t){return{boxes:zt(t)}},mfhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function e(t){return{boxes:zt(t)}},mp4a:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={dataReferenceIndex:r.getUint16(6),channelcount:r.getUint16(16),samplesize:r.getUint16(18),samplerate:r.getUint16(24)+r.getUint16(26)/65536};if(t.byteLength>28){i.streamDescriptor=zt(t.subarray(28))[0]}return i},moof:function e(t){return{boxes:zt(t)}},moov:function e(t){return{boxes:zt(t)}},mvex:function e(t){return{boxes:zt(t)}},mvhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){i+=4;n.creationTime=Xt(r.getUint32(i));i+=8;n.modificationTime=Xt(r.getUint32(i));i+=4;n.timescale=r.getUint32(i);i+=8;n.duration=r.getUint32(i)}else{n.creationTime=Xt(r.getUint32(i));i+=4;n.modificationTime=Xt(r.getUint32(i));i+=4;n.timescale=r.getUint32(i);i+=4;n.duration=r.getUint32(i)}i+=4;n.rate=r.getUint16(i)+r.getUint16(i+2)/16;i+=4;n.volume=r.getUint8(i)+r.getUint8(i+1)/8;i+=2;i+=2;i+=2*4;n.matrix=new Uint32Array(t.subarray(i,i+9*4));i+=9*4;i+=6*4;n.nextTrackId=r.getUint32(i);return n},pdin:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:r.getUint32(4),initialDelay:r.getUint32(8)}},sdtp:function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},i;for(i=4;i<t.byteLength;i++){r.samples.push({dependsOn:(t[i]&48)>>4,isDependedOn:(t[i]&12)>>2,hasRedundancy:t[i]&3})}return r},sidx:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:r.getUint32(4),timescale:r.getUint32(8),earliestPresentationTime:r.getUint32(12),firstOffset:r.getUint32(16)},n=r.getUint16(22),a;for(a=24;n;a+=12,n--){i.references.push({referenceType:(t[a]&128)>>>7,referencedSize:r.getUint32(a)&2147483647,subsegmentDuration:r.getUint32(a+4),startsWithSap:!!(t[a+8]&128),sapType:(t[a+8]&112)>>>4,sapDeltaTime:r.getUint32(a+8)&268435455})}return i},smhd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function e(t){return{boxes:zt(t)}},stco:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},n=r.getUint32(4),a;for(a=8;n;a+=4,n--){i.chunkOffsets.push(r.getUint32(a))}return i},stsc:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=r.getUint32(4),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]},a;for(a=8;i;a+=12,i--){n.sampleToChunks.push({firstChunk:r.getUint32(a),samplesPerChunk:r.getUint32(a+4),sampleDescriptionIndex:r.getUint32(a+8)})}return n},stsd:function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:zt(t.subarray(8))}},stsz:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:r.getUint32(4),entries:[]},n;for(n=12;n<t.byteLength;n+=4){i.entries.push(r.getUint32(n))}return i},stts:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},n=r.getUint32(4),a;for(a=8;n;a+=8,n--){i.timeToSamples.push({sampleCount:r.getUint32(a),sampleDelta:r.getUint32(a+4)})}return i},styp:function e(t){return $t.ftyp(t)},tfdt:function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};if(r.version===1){r.baseMediaDecodeTime*=Math.pow(2,32);r.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]}return r},tfhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4)},n=i.flags[2]&1,a=i.flags[2]&2,s=i.flags[2]&8,o=i.flags[2]&16,u=i.flags[2]&32,l=i.flags[0]&65536,d=i.flags[0]&131072,f;f=8;if(n){f+=4;i.baseDataOffset=r.getUint32(12);f+=4}if(a){i.sampleDescriptionIndex=r.getUint32(f);f+=4}if(s){i.defaultSampleDuration=r.getUint32(f);f+=4}if(o){i.defaultSampleSize=r.getUint32(f);f+=4}if(u){i.defaultSampleFlags=r.getUint32(f)}if(l){i.durationIsEmpty=true}if(!n&&d){i.baseDataOffsetIsMoof=true}return i},tkhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};if(n.version===1){i+=4;n.creationTime=Xt(r.getUint32(i));i+=8;n.modificationTime=Xt(r.getUint32(i));i+=4;n.trackId=r.getUint32(i);i+=4;i+=8;n.duration=r.getUint32(i)}else{n.creationTime=Xt(r.getUint32(i));i+=4;n.modificationTime=Xt(r.getUint32(i));i+=4;n.trackId=r.getUint32(i);i+=4;i+=4;n.duration=r.getUint32(i)}i+=4;i+=2*4;n.layer=r.getUint16(i);i+=2;n.alternateGroup=r.getUint16(i);i+=2;n.volume=r.getUint8(i)+r.getUint8(i+1)/8;i+=2;i+=2;n.matrix=new Uint32Array(t.subarray(i,i+9*4));i+=9*4;n.width=r.getUint16(i)+r.getUint16(i+2)/16;i+=4;n.height=r.getUint16(i)+r.getUint16(i+2)/16;return n},traf:function e(t){return{boxes:zt(t)}},trak:function e(t){return{boxes:zt(t)}},trex:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4),defaultSampleDescriptionIndex:r.getUint32(8),defaultSampleDuration:r.getUint32(12),defaultSampleSize:r.getUint32(16),sampleDependsOn:t[20]&3,sampleIsDependedOn:(t[21]&192)>>6,sampleHasRedundancy:(t[21]&48)>>4,samplePaddingValue:(t[21]&14)>>1,sampleIsDifferenceSample:!!(t[21]&1),sampleDegradationPriority:r.getUint16(22)}},trun:function e(t){var r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=r.flags[2]&1,a=r.flags[2]&4,s=r.flags[1]&1,o=r.flags[1]&2,u=r.flags[1]&4,l=r.flags[1]&8,d=i.getUint32(4),f=8,c;if(n){r.dataOffset=i.getInt32(f);f+=4}if(a&&d){c={flags:Jt(t.subarray(f,f+4))};f+=4;if(s){c.duration=i.getUint32(f);f+=4}if(o){c.size=i.getUint32(f);f+=4}if(l){c.compositionTimeOffset=i.getUint32(f);f+=4}r.samples.push(c);d--}while(d--){c={};if(s){c.duration=i.getUint32(f);f+=4}if(o){c.size=i.getUint32(f);f+=4}if(u){c.flags=Jt(t.subarray(f,f+4));f+=4}if(l){c.compositionTimeOffset=i.getUint32(f);f+=4}r.samples.push(c)}return r},"url ":function e(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function e(t){var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:r.getUint16(4),opcolor:new Uint16Array([r.getUint16(6),r.getUint16(8),r.getUint16(10)])}}};zt=function e(t){var r=0,i=[],n,a,s,o,u;var l=new ArrayBuffer(t.length);var d=new Uint8Array(l);for(var f=0;f<t.length;++f){d[f]=t[f]}n=new DataView(l);while(r<t.byteLength){a=n.getUint32(r);s=Yt(t.subarray(r+4,r+8));o=a>1?r+a:t.byteLength;u=($t[s]||function(e){return{data:e}})(t.subarray(r+8,o));u.size=a;u.type=s;i.push(u);r=o}return i};Kt=function e(t,r){var i;r=r||0;i=new Array(r*2+1).join(" ");return t.map((function(e,t){return i+e.type+"\n"+Object.keys(e).filter((function(e){return e!=="type"&&e!=="boxes"})).map((function(t){var r=i+"  "+t+": ",n=e[t];if(n instanceof Uint8Array||n instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);if(!a){return r+"<>"}if(a.length===1){return r+"<"+a.join("").slice(1)+">"}return r+"<\n"+a.map((function(e){return i+"  "+e})).join("\n")+"\n"+i+"  >"}return r+JSON.stringify(n,null,2).split("\n").map((function(e,t){if(t===0){return e}return i+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+Kt(e.boxes,r+1):"")})).join("\n")};var Zt={inspect:zt,textify:Kt,parseTfdt:$t.tfdt,parseHdlr:$t.hdlr,parseTfhd:$t.tfhd,parseTrun:$t.trun,parseSidx:$t.sidx};var er=Me.discardEmulationPreventionBytes;var tr=Ve.CaptionStream;var rr=function e(t,r){var i=t;for(var n=0;n<r.length;n++){var a=r[n];if(i<a.size){return a}i-=a.size}return null};var ir=function e(t,r,i){var n=new DataView(t.buffer,t.byteOffset,t.byteLength),a=[],s,o,u,l;for(o=0;o+4<t.length;o+=u){u=n.getUint32(o);o+=4;if(u<=0){continue}switch(t[o]&31){case 6:var d=t.subarray(o+1,o+1+u);var f=rr(o,r);s={nalUnitType:"sei_rbsp",size:u,data:d,escapedRBSP:er(d),trackId:i};if(f){s.pts=f.pts;s.dts=f.dts;l=f}else{s.pts=l.pts;s.dts=l.dts}a.push(s);break;default:break}}return a};var nr=function e(t,r,i){var n=r;var a=i.defaultSampleDuration||0;var s=i.defaultSampleSize||0;var o=i.trackId;var u=[];t.forEach((function(e){var t=Zt.parseTrun(e);var r=t.samples;r.forEach((function(e){if(e.duration===undefined){e.duration=a}if(e.size===undefined){e.size=s}e.trackId=o;e.dts=n;if(e.compositionTimeOffset===undefined){e.compositionTimeOffset=0}e.pts=n+e.compositionTimeOffset;n+=e.duration}));u=u.concat(r)}));return u};var ar=function e(t,r){var i=K.findBox(t,["moof","traf"]);var n=K.findBox(t,["mdat"]);var a={};var s=[];n.forEach((function(e,t){var r=i[t];s.push({mdat:e,traf:r})}));s.forEach((function(e){var t=e.mdat;var i=e.traf;var n=K.findBox(i,["tfhd"]);var s=Zt.parseTfhd(n[0]);var o=s.trackId;var u=K.findBox(i,["tfdt"]);var l=u.length>0?Zt.parseTfdt(u[0]).baseMediaDecodeTime:0;var d=K.findBox(i,["trun"]);var f;var c;if(r===o&&d.length>0){f=nr(d,l,s);c=ir(t,f,o);if(!a[o]){a[o]=[]}a[o]=a[o].concat(c)}}));return a};var sr=function e(t,r,i){var n;if(!r){return null}n=ar(t,r);return{seiNals:n[r],timescale:i}};var or=function e(){var t=false;var r;var i;var n;var a;var s;this.isInitialized=function(){return t};this.init=function(){r=new tr;t=true;r.on("data",(function(e){e.startTime=e.startPts/a;e.endTime=e.endPts/a;s.captions.push(e);s.captionStreams[e.stream]=true}))};this.isNewInit=function(e,t){if(e&&e.length===0||t&&typeof t==="object"&&Object.keys(t).length===0){return false}return n!==e[0]||a!==t[n]};this.parse=function(e,t,r){var o;if(!this.isInitialized()){return null}else if(!t||!r){return null}else if(this.isNewInit(t,r)){n=t[0];a=r[n]}else if(!n||!a){i.push(e);return null}while(i.length>0){var u=i.shift();this.parse(u,t,r)}o=sr(e,n,a);if(o===null||!o.seiNals){return null}this.pushNals(o.seiNals);this.flushStream();return s};this.pushNals=function(e){if(!this.isInitialized()||!e||e.length===0){return null}e.forEach((function(e){r.push(e)}))};this.flushStream=function(){if(!this.isInitialized()){return null}r.flush()};this.clearParsedCaptions=function(){s.captions=[];s.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}r.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){i=[];n=null;a=null;if(!s){s={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()};var ur=or;var lr={generator:j,probe:K,Transmuxer:Wt.Transmuxer,AudioSegmentStream:Wt.AudioSegmentStream,VideoSegmentStream:Wt.VideoSegmentStream,CaptionParser:ur};var dr=function e(t,r){if(!(t instanceof r)){throw new TypeError("Cannot call a class as a function")}};var fr=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,r,i){if(r)e(t.prototype,r);if(i)e(t,i);return t}}();var cr=function e(t,r){r.on("data",(function(e){var r=e.initSegment;e.initSegment={data:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength};var i=e.data;e.data=i.buffer;t.postMessage({action:"data",segment:e,byteOffset:i.byteOffset,byteLength:i.byteLength},[e.data])}));if(r.captionStream){r.captionStream.on("data",(function(e){t.postMessage({action:"caption",data:e})}))}r.on("done",(function(e){t.postMessage({action:"done"})}));r.on("gopInfo",(function(e){t.postMessage({action:"gopInfo",gopInfo:e})}));r.on("videoSegmentTimingInfo",(function(e){t.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:e})}))};var hr=function(){function e(t,r){dr(this,e);this.options=r||{};this.self=t;this.init()}fr(e,[{key:"init",value:function e(){if(this.transmuxer){this.transmuxer.dispose()}this.transmuxer=new lr.Transmuxer(this.options);cr(this.self,this.transmuxer)}},{key:"push",value:function e(t){var r=new Uint8Array(t.data,t.byteOffset,t.byteLength);this.transmuxer.push(r)}},{key:"reset",value:function e(){this.init()}},{key:"setTimestampOffset",value:function e(t){var r=t.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(r*9e4))}},{key:"setAudioAppendStart",value:function e(t){this.transmuxer.setAudioAppendStart(Math.ceil(t.appendStart*9e4))}},{key:"flush",value:function e(t){this.transmuxer.flush()}},{key:"resetCaptions",value:function e(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function e(t){this.transmuxer.alignGopsWith(t.gopsToAlignWith.slice())}}]);return e}();var pr=function e(t){t.onmessage=function(e){if(e.data.action==="init"&&e.data.options){this.messageHandlers=new hr(t,e.data.options);return}if(!this.messageHandlers){this.messageHandlers=new hr(t)}if(e.data&&e.data.action&&e.data.action!=="init"){if(this.messageHandlers[e.data.action]){this.messageHandlers[e.data.action](e.data)}}}};var vr=new pr(r);return vr}()}));var wt={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"};var kt=function e(t){return t.map((function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,r){var i=("00"+Number(t).toString(16)).slice(-2);var n=("00"+Number(r).toString(16)).slice(-2);return"avc1."+i+"00"+n}))}))};var At=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r={codecCount:0};var i=void 0;r.codecCount=t.split(",").length;r.codecCount=r.codecCount||2;i=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t);if(i){r.videoCodec=i[2];r.videoObjectTypeIndicator=i[3]}r.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t);r.audioProfile=r.audioProfile&&r.audioProfile[2];return r};var Ct=function e(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return kt([e])[0]}))};var Lt=function e(t,r,i){return t+"/"+r+'; codecs="'+i.filter((function(e){return!!e})).join(", ")+'"'};var xt=function e(t){if(t.segments&&t.segments.length&&t.segments[0].map){return"mp4"}return"mp2t"};var Dt=function e(t){var r=t.attributes||{};if(r.CODECS){return At(r.CODECS)}return wt};var It=function e(t,r){if(!t.mediaGroups.AUDIO||!r){return null}var i=t.mediaGroups.AUDIO[r];if(!i){return null}for(var n in i){var a=i[n];if(a.default&&a.playlists){return At(a.playlists[0].attributes.CODECS).audioProfile}}return null};var Ot=function e(t,r){var i=xt(r);var n=Dt(r);var a=r.attributes||{};var s=true;var o=false;if(!r){return[]}if(t.mediaGroups.AUDIO&&a.AUDIO){var l=t.mediaGroups.AUDIO[a.AUDIO];if(l){o=true;s=false;for(var d in l){if(!l[d].uri&&!l[d].playlists){s=true;break}}}}if(o&&!n.audioProfile){if(!s){n.audioProfile=It(t,a.AUDIO)}if(!n.audioProfile){u.a.log.warn("Multiple audio tracks present but no audio codec string is specified. "+"Attempting to use the default audio codec (mp4a.40.2)");n.audioProfile=wt.audioProfile}}var f={};if(n.videoCodec){f.video=""+n.videoCodec+n.videoObjectTypeIndicator}if(n.audioProfile){f.audio="mp4a.40."+n.audioProfile}var c=Lt("audio",i,[f.audio]);var h=Lt("video",i,[f.video]);var p=Lt("video",i,[f.video,f.audio]);if(o){if(!s&&f.video){return[h,c]}if(!s&&!f.video){return[c,c]}return[p,c]}if(!f.video){return[c]}return[p]};var Rt=function e(t){var r={type:"",parameters:{}};var i=t.trim().split(";");r.type=i.shift().trim();i.forEach((function(e){var t=e.trim().split("=");if(t.length>1){var i=t[0].replace(/"/g,"").trim();var n=t[1].replace(/"/g,"").trim();r.parameters[i]=n}}));return r};var Pt=function e(t){return/mp4a\.\d+.\d+/i.test(t)};var Ut=function e(t){return/avc1\.[\da-f]+/i.test(t)};var Mt=function e(t,r,i){if(typeof r==="undefined"||r===null||!t.length){return[]}var n=Math.ceil((r-i+3)*9e4);var a=void 0;for(a=0;a<t.length;a++){if(t[a].pts>n){break}}return t.slice(a)};var Nt=function e(t,r,i){if(!r.length){return t}if(i){return r.slice()}var n=r[0].pts;var a=0;for(a;a<t.length;a++){if(t[a].pts>=n){break}}return t.slice(0,a).concat(r)};var jt=function e(t,r,i,n){var a=Math.ceil((r-n)*9e4);var s=Math.ceil((i-n)*9e4);var o=t.slice();var u=t.length;while(u--){if(t[u].pts<=s){break}}if(u===-1){return o}var l=u+1;while(l--){if(t[l].pts<=a){break}}l=Math.max(l,0);o.splice(l,u-l+1);return o};var Bt=function e(t,r,i){var n=null;var a=null;var s=0;var o=[];var l=[];if(!t&&!r){return u.a.createTimeRange()}if(!t){return r.buffered}if(!r){return t.buffered}if(i){return t.buffered}if(t.buffered.length===0&&r.buffered.length===0){return u.a.createTimeRange()}var d=t.buffered;var f=r.buffered;var c=d.length;while(c--){o.push({time:d.start(c),type:"start"});o.push({time:d.end(c),type:"end"})}c=f.length;while(c--){o.push({time:f.start(c),type:"start"});o.push({time:f.end(c),type:"end"})}o.sort((function(e,t){return e.time-t.time}));for(c=0;c<o.length;c++){if(o[c].type==="start"){s++;if(s===2){n=o[c].time}}else if(o[c].type==="end"){s--;if(s===1){a=o[c].time}}if(n!==null&&a!==null){l.push([n,a]);n=null;a=null}}return u.a.createTimeRanges(l)};var Ft=9e4;var Ht=function e(t,r){var i=t.addSourceBuffer(r);var n=Object.create(null);n.updating=false;n.realBuffer_=i;var a=function e(t){if(typeof i[t]==="function"){n[t]=function(){return i[t].apply(i,arguments)}}else if(typeof n[t]==="undefined"){Object.defineProperty(n,t,{get:function e(){return i[t]},set:function e(r){return i[t]=r}})}};for(var s in i){a(s)}return n};var qt=function(e){z(t,e);function t(e,r){G(this,t);var i=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u.a.EventTarget));i.timestampOffset_=0;i.pendingBuffers_=[];i.bufferUpdating_=false;i.mediaSource_=e;i.codecs_=r;i.audioCodec_=null;i.videoCodec_=null;i.audioDisabled_=false;i.appendAudioInitSegment_=true;i.gopBuffer_=[];i.timeMapping_=0;i.safeAppend_=u.a.browser.IE_VERSION>=11;var n={remux:false,alignGopsAtEnd:i.safeAppend_};i.codecs_.forEach((function(e){if(Pt(e)){i.audioCodec_=e}else if(Ut(e)){i.videoCodec_=e}}));i.transmuxer_=new Et;i.transmuxer_.postMessage({action:"init",options:n});i.transmuxer_.onmessage=function(e){if(e.data.action==="data"){return i.data_(e)}if(e.data.action==="done"){return i.done_(e)}if(e.data.action==="gopInfo"){return i.appendGopInfo_(e)}if(e.data.action==="videoSegmentTimingInfo"){return i.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo)}};Object.defineProperty(i,"timestampOffset",{get:function e(){return this.timestampOffset_},set:function e(t){if(typeof t==="number"&&t>=0){this.timestampOffset_=t;this.appendAudioInitSegment_=true;this.gopBuffer_.length=0;this.timeMapping_=0;this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t})}}});Object.defineProperty(i,"appendWindowStart",{get:function e(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function e(t){if(this.videoBuffer_){this.videoBuffer_.appendWindowStart=t}if(this.audioBuffer_){this.audioBuffer_.appendWindowStart=t}}});Object.defineProperty(i,"updating",{get:function e(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}});Object.defineProperty(i,"buffered",{get:function e(){return Bt(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}});return i}V(t,[{key:"data_",value:function e(t){var r=t.data.segment;r.data=new Uint8Array(r.data,t.data.byteOffset,t.data.byteLength);r.initSegment=new Uint8Array(r.initSegment.data,r.initSegment.byteOffset,r.initSegment.byteLength);st(this,this.mediaSource_,r);this.pendingBuffers_.push(r);return}},{key:"done_",value:function e(t){if(this.mediaSource_.readyState==="closed"){this.pendingBuffers_.length=0;return}this.processPendingSegments_();return}},{key:"videoSegmentTimingInfo_",value:function e(t){var r={start:{decode:t.start.dts/Ft,presentation:t.start.pts/Ft},end:{decode:t.end.dts/Ft,presentation:t.end.pts/Ft},baseMediaDecodeTime:t.baseMediaDecodeTime/Ft};if(t.prependedContentDuration){r.prependedContentDuration=t.prependedContentDuration/Ft}this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:r})}},{key:"createRealSourceBuffers_",value:function e(){var t=this;var r=["audio","video"];r.forEach((function(e){if(!t[e+"Codec_"]){return}if(t[e+"Buffer_"]){return}var i=null;if(t.mediaSource_[e+"Buffer_"]){i=t.mediaSource_[e+"Buffer_"];i.updating=false}else{var n=e+"Codec_";var a=e+'/mp4;codecs="'+t[n]+'"';i=Ht(t.mediaSource_.nativeMediaSource_,a);t.mediaSource_[e+"Buffer_"]=i}t[e+"Buffer_"]=i;["update","updatestart","updateend"].forEach((function(n){i.addEventListener(n,(function(){if(e==="audio"&&t.audioDisabled_){return}if(n==="updateend"){t[e+"Buffer_"].updating=false}var i=r.every((function(r){if(r==="audio"&&t.audioDisabled_){return true}if(e!==r&&t[r+"Buffer_"]&&t[r+"Buffer_"].updating){return false}return true}));if(i){return t.trigger(n)}}))}))}))}},{key:"appendBuffer",value:function e(t){this.bufferUpdating_=true;if(this.audioBuffer_&&this.audioBuffer_.buffered.length){var r=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:r.end(r.length-1)})}if(this.videoBuffer_){this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:Mt(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)})}this.transmuxer_.postMessage({action:"push",data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength},[t.buffer]);this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function e(t){this.gopBuffer_=Nt(this.gopBuffer_,t.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function e(t,r){if(this.videoBuffer_){this.videoBuffer_.updating=true;this.videoBuffer_.remove(t,r);this.gopBuffer_=jt(this.gopBuffer_,t,r,this.timeMapping_)}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.updating=true;this.audioBuffer_.remove(t,r)}ot(t,r,this.metadataTrack_);if(this.inbandTextTracks_){for(var i in this.inbandTextTracks_){ot(t,r,this.inbandTextTracks_[i])}}}},{key:"processPendingSegments_",value:function e(){var t={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};t=this.pendingBuffers_.reduce((function(e,t){var r=t.type;var i=t.data;var n=t.initSegment;e[r].segments.push(i);e[r].bytes+=i.byteLength;e[r].initSegment=n;if(t.captions){e.captions=e.captions.concat(t.captions)}if(t.info){e[r].info=t.info}if(t.metadata){e.metadata=e.metadata.concat(t.metadata)}return e}),t);if(!this.videoBuffer_&&!this.audioBuffer_){if(t.video.bytes===0){this.videoCodec_=null}if(t.audio.bytes===0){this.audioCodec_=null}this.createRealSourceBuffers_()}if(t.audio.info){this.mediaSource_.trigger({type:"audioinfo",info:t.audio.info})}if(t.video.info){this.mediaSource_.trigger({type:"videoinfo",info:t.video.info})}if(this.appendAudioInitSegment_){if(!this.audioDisabled_&&this.audioBuffer_){t.audio.segments.unshift(t.audio.initSegment);t.audio.bytes+=t.audio.initSegment.byteLength}this.appendAudioInitSegment_=false}var r=false;if(this.videoBuffer_&&t.video.bytes){t.video.segments.unshift(t.video.initSegment);t.video.bytes+=t.video.initSegment.byteLength;this.concatAndAppendSegments_(t.video,this.videoBuffer_)}else if(this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_)){r=true}dt(this,t.captions,t.metadata);if(!this.audioDisabled_&&this.audioBuffer_){this.concatAndAppendSegments_(t.audio,this.audioBuffer_)}this.pendingBuffers_.length=0;if(r){this.trigger("updateend")}this.bufferUpdating_=false}},{key:"concatAndAppendSegments_",value:function e(t,r){var i=0;var n=void 0;if(t.bytes){n=new Uint8Array(t.bytes);t.segments.forEach((function(e){n.set(e,i);i+=e.byteLength}));try{r.updating=true;r.appendBuffer(n)}catch(e){if(this.mediaSource_.player_){this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}}},{key:"abort",value:function e(){if(this.videoBuffer_){this.videoBuffer_.abort()}if(!this.audioDisabled_&&this.audioBuffer_){this.audioBuffer_.abort()}if(this.transmuxer_){this.transmuxer_.postMessage({action:"reset"})}this.pendingBuffers_.length=0;this.bufferUpdating_=false}}]);return t}(u.a.EventTarget);var Gt=function(e){z(t,e);function t(){G(this,t);var e=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));var r=void 0;e.nativeMediaSource_=new s.a.MediaSource;for(r in e.nativeMediaSource_){if(!(r in t.prototype)&&typeof e.nativeMediaSource_[r]==="function"){e[r]=e.nativeMediaSource_[r].bind(e.nativeMediaSource_)}}e.duration_=NaN;Object.defineProperty(e,"duration",{get:function e(){if(this.duration_===Infinity){return this.duration_}return this.nativeMediaSource_.duration},set:function e(t){this.duration_=t;if(t!==Infinity){this.nativeMediaSource_.duration=t;return}}});Object.defineProperty(e,"seekable",{get:function e(){if(this.duration_===Infinity){return u.a.createTimeRanges([[0,this.nativeMediaSource_.duration]])}return this.nativeMediaSource_.seekable}});Object.defineProperty(e,"readyState",{get:function e(){return this.nativeMediaSource_.readyState}});Object.defineProperty(e,"activeSourceBuffers",{get:function e(){return this.activeSourceBuffers_}});e.sourceBuffers=[];e.activeSourceBuffers_=[];e.updateActiveSourceBuffers_=function(){e.activeSourceBuffers_.length=0;if(e.sourceBuffers.length===1){var t=e.sourceBuffers[0];t.appendAudioInitSegment_=true;t.audioDisabled_=!t.audioCodec_;e.activeSourceBuffers_.push(t);return}var r=false;var i=true;for(var n=0;n<e.player_.audioTracks().length;n++){var a=e.player_.audioTracks()[n];if(a.enabled&&a.kind!=="main"){r=true;i=false;break}}e.sourceBuffers.forEach((function(t,n){t.appendAudioInitSegment_=true;if(t.videoCodec_&&t.audioCodec_){t.audioDisabled_=r}else if(t.videoCodec_&&!t.audioCodec_){t.audioDisabled_=true;i=false}else if(!t.videoCodec_&&t.audioCodec_){t.audioDisabled_=n?i:!i;if(t.audioDisabled_){return}}e.activeSourceBuffers_.push(t)}))};e.onPlayerMediachange_=function(){e.sourceBuffers.forEach((function(e){e.appendAudioInitSegment_=true}))};e.onHlsReset_=function(){e.sourceBuffers.forEach((function(e){if(e.transmuxer_){e.transmuxer_.postMessage({action:"resetCaptions"})}}))};e.onHlsSegmentTimeMapping_=function(t){e.sourceBuffers.forEach((function(e){return e.timeMapping_=t.mapping}))};["sourceopen","sourceclose","sourceended"].forEach((function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))}),e);e.on("sourceopen",(function(t){var r=_.a.querySelector('[src="'+e.url_+'"]');if(!r){return}e.player_=u()(r.parentNode);if(!e.player_){return}e.player_.tech_.on("hls-reset",e.onHlsReset_);e.player_.tech_.on("hls-segment-time-mapping",e.onHlsSegmentTimeMapping_);if(e.player_.audioTracks&&e.player_.audioTracks()){e.player_.audioTracks().on("change",e.updateActiveSourceBuffers_);e.player_.audioTracks().on("addtrack",e.updateActiveSourceBuffers_);e.player_.audioTracks().on("removetrack",e.updateActiveSourceBuffers_)}e.player_.on("mediachange",e.onPlayerMediachange_)}));e.on("sourceended",(function(t){var r=lt(e.duration);for(var i=0;i<e.sourceBuffers.length;i++){var n=e.sourceBuffers[i];var a=n.metadataTrack_&&n.metadataTrack_.cues;if(a&&a.length){a[a.length-1].endTime=r}}}));e.on("sourceclose",(function(e){this.sourceBuffers.forEach((function(e){if(e.transmuxer_){e.transmuxer_.terminate()}}));this.sourceBuffers.length=0;if(!this.player_){return}if(this.player_.audioTracks&&this.player_.audioTracks()){this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_);this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)}if(this.player_.el_){this.player_.off("mediachange",this.onPlayerMediachange_)}if(this.player_.tech_&&this.player_.tech_.el_){this.player_.tech_.off("hls-reset",this.onHlsReset_);this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)}}));return e}V(t,[{key:"addSeekableRange_",value:function e(t,r){var i=void 0;if(this.duration!==Infinity){i=new Error("MediaSource.addSeekableRange() can only be invoked "+"when the duration is Infinity");i.name="InvalidStateError";i.code=11;throw i}if(r>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration)){this.nativeMediaSource_.duration=r}}},{key:"addSourceBuffer",value:function e(t){var r=void 0;var i=Rt(t);if(/^(video|audio)\/mp2t$/i.test(i.type)){var n=[];if(i.parameters&&i.parameters.codecs){n=i.parameters.codecs.split(",");n=kt(n);n=n.filter((function(e){return Pt(e)||Ut(e)}))}if(n.length===0){n=["avc1.4d400d","mp4a.40.2"]}r=new qt(this,n);if(this.sourceBuffers.length!==0){this.sourceBuffers[0].createRealSourceBuffers_();r.createRealSourceBuffers_();this.sourceBuffers[0].audioDisabled_=true}}else{r=this.nativeMediaSource_.addSourceBuffer(t)}this.sourceBuffers.push(r);return r}}]);return t}(u.a.EventTarget);var Vt=0;u.a.mediaSources={};var Wt=function e(t,r){var i=u.a.mediaSources[t];if(i){i.trigger({type:"sourceopen",swfId:r})}else{throw new Error("Media Source not found (Video.js)")}};var zt=function e(){return!!s.a.MediaSource&&!!s.a.MediaSource.isTypeSupported&&s.a.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')};var Kt=function e(){this.MediaSource={open:Wt,supportsNativeMediaSources:zt};if(zt()){return new Gt}throw new Error("Cannot use create a virtual MediaSource for this video")};Kt.open=Wt;Kt.supportsNativeMediaSources=zt;var Yt={createObjectURL:function e(t){var r="blob:vjs-media-source/";var i=void 0;if(t instanceof Gt){i=s.a.URL.createObjectURL(t.nativeMediaSource_);t.url_=i;return i}if(!(t instanceof Gt)){i=s.a.URL.createObjectURL(t);t.url_=i;return i}i=r+Vt;Vt++;u.a.mediaSources[i]=t;return i}};u.a.MediaSource=Kt;u.a.URL=Yt;var Xt=u.a.EventTarget,Jt=u.a.mergeOptions;var Qt=function e(t,r){var i=void 0;var n=Jt(t,{duration:r.duration,minimumUpdatePeriod:r.minimumUpdatePeriod});for(var a=0;a<r.playlists.length;a++){var s=te(n,r.playlists[a]);if(s){n=s}else{i=true}}$(r,(function(e,t,r,a){if(e.playlists&&e.playlists.length){var s=e.playlists[0].uri;var o=te(n,e.playlists[0]);if(o){n=o;n.mediaGroups[t][r][a].playlists[0]=n.playlists[s];i=false}}}));if(i){return null}return n};var $t=function(e){z(t,e);function t(e,r,i,n){G(this,t);var a=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));a.hls_=r;a.withCredentials=i;if(!e){throw new Error("A non-empty playlist URL or playlist is required")}a.on("minimumUpdatePeriod",(function(){a.refreshXml_()}));a.on("mediaupdatetimeout",(function(){a.refreshMedia_()}));a.state="HAVE_NOTHING";a.loadedPlaylists_={};if(typeof e==="string"){a.srcUrl=e;return K(a)}a.setupChildLoader(n,e);return a}V(t,[{key:"setupChildLoader",value:function e(t,r){this.masterPlaylistLoader_=t;this.childPlaylist_=r}},{key:"dispose",value:function e(){this.stopRequest();this.loadedPlaylists_={};s.a.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function e(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function e(){if(this.request){var t=this.request;this.request=null;t.onreadystatechange=null;t.abort()}}},{key:"media",value:function e(t){if(!t){return this.media_}if(this.state==="HAVE_NOTHING"){throw new Error("Cannot switch media playlist from "+this.state)}var r=this.state;if(typeof t==="string"){if(!this.master.playlists[t]){throw new Error("Unknown playlist URI: "+t)}t=this.master.playlists[t]}var i=!this.media_||t.uri!==this.media_.uri;if(i&&this.loadedPlaylists_[t.uri]&&this.loadedPlaylists_[t.uri].endList){this.state="HAVE_METADATA";this.media_=t;if(i){this.trigger("mediachanging");this.trigger("mediachange")}return}if(!i){return}if(this.media_){this.trigger("mediachanging")}this.mediaRequest_=s.a.setTimeout(this.haveMetadata.bind(this,{startingState:r,playlist:t}),0)}},{key:"haveMetadata",value:function e(t){var r=t.startingState,i=t.playlist;this.state="HAVE_METADATA";this.media_=i;this.loadedPlaylists_[i.uri]=i;this.mediaRequest_=null;this.refreshMedia_();if(r==="HAVE_MASTER"){this.trigger("loadedmetadata")}else{this.trigger("mediachange")}}},{key:"pause",value:function e(){this.stopRequest();s.a.clearTimeout(this.mediaUpdateTimeout);if(this.state==="HAVE_NOTHING"){this.started=false}}},{key:"load",value:function e(t){var r=this;s.a.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(t){var n=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=s.a.setTimeout((function(){return r.load()}),n);return}if(!this.started){this.start();return}this.trigger("loadedplaylist")}},{key:"parseMasterXml",value:function e(){var t=Object(b["a"])(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_});t.uri=this.srcUrl;for(var r=0;r<t.playlists.length;r++){var i="placeholder-uri-"+r;t.playlists[r].uri=i;t.playlists[i]=t.playlists[r]}$(t,(function(e,r,i,n){if(e.playlists&&e.playlists.length){var a="placeholder-uri-"+r+"-"+i+"-"+n;e.playlists[0].uri=a;t.playlists[a]=e.playlists[0]}}));re(t);ie(t);return t}},{key:"start",value:function e(){var t=this;this.started=true;if(this.masterPlaylistLoader_){this.mediaRequest_=s.a.setTimeout(this.haveMaster_.bind(this),0);return}this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(e,r){if(!t.request){return}t.request=null;if(e){t.error={status:r.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:r.responseText,code:2};if(t.state==="HAVE_NOTHING"){t.started=false}return t.trigger("error")}t.masterXml_=r.responseText;if(r.responseHeaders&&r.responseHeaders.date){t.masterLoaded_=Date.parse(r.responseHeaders.date)}else{t.masterLoaded_=Date.now()}t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))}))}},{key:"syncClientServerClock_",value:function e(t){var r=this;var i=Object(b["b"])(this.masterXml_);if(i===null){this.clientOffset_=this.masterLoaded_-Date.now();return t()}if(i.method==="DIRECT"){this.clientOffset_=i.value-Date.now();return t()}this.request=this.hls_.xhr({uri:q(this.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(function(e,n){if(!r.request){return}if(e){r.clientOffset_=r.masterLoaded_-Date.now();return t()}var a=void 0;if(i.method==="HEAD"){if(!n.responseHeaders||!n.responseHeaders.date){a=r.masterLoaded_}else{a=Date.parse(n.responseHeaders.date)}}else{a=Date.parse(n.responseText)}r.clientOffset_=a-Date.now();t()}))}},{key:"haveMaster_",value:function e(){this.state="HAVE_MASTER";this.mediaRequest_=null;if(!this.masterPlaylistLoader_){this.master=this.parseMasterXml();this.trigger("loadedplaylist")}else if(!this.media_){this.media(this.childPlaylist_)}}},{key:"onClientServerClockSync_",value:function e(){var t=this;this.haveMaster_();if(!this.hasPendingRequest()&&!this.media_){this.media(this.master.playlists[0])}if(this.master&&this.master.minimumUpdatePeriod){s.a.setTimeout((function(){t.trigger("minimumUpdatePeriod")}),this.master.minimumUpdatePeriod)}}},{key:"refreshXml_",value:function e(){var t=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(e,r){if(!t.request){return}t.request=null;if(e){t.error={status:r.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:r.responseText,code:2};if(t.state==="HAVE_NOTHING"){t.started=false}return t.trigger("error")}t.masterXml_=r.responseText;var i=t.parseMasterXml();var n=Qt(t.master,i);if(n){t.master=n}s.a.setTimeout((function(){t.trigger("minimumUpdatePeriod")}),t.master.minimumUpdatePeriod)}))}},{key:"refreshMedia_",value:function e(){var t=this;var r=void 0;var i=void 0;if(this.masterPlaylistLoader_){r=this.masterPlaylistLoader_.master;i=this.masterPlaylistLoader_.parseMasterXml()}else{r=this.master;i=this.parseMasterXml()}var n=Qt(r,i);if(n){if(this.masterPlaylistLoader_){this.masterPlaylistLoader_.master=n}else{this.master=n}this.media_=n.playlists[this.media_.uri]}else{this.trigger("playlistunchanged")}if(!this.media().endList){this.mediaUpdateTimeout=s.a.setTimeout((function(){t.trigger("mediaupdatetimeout")}),ne(this.media(),!!n))}this.trigger("loadedplaylist")}}]);return t}(Xt);var Zt=function e(t){if(u.a.log.debug){return u.a.log.debug.bind(u.a,"VHS:",t+" >")}return function(){}};function er(){}var tr=function(){function e(t,r,i,n){G(this,e);this.callbacks_=[];this.pendingCallback_=null;this.timestampOffset_=0;this.mediaSource=t;this.processedAppend_=false;this.type_=i;this.mimeType_=r;this.logger_=Zt("SourceUpdater["+i+"]["+r+"]");if(t.readyState==="closed"){t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,r,n))}else{this.createSourceBuffer_(r,n)}}V(e,[{key:"createSourceBuffer_",value:function e(t,r){var i=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(t);this.logger_("created SourceBuffer");if(r){r.trigger("sourcebufferadded");if(this.mediaSource.sourceBuffers.length<2){r.on("sourcebufferadded",(function(){i.start_()}));return}}this.start_()}},{key:"start_",value:function e(){var t=this;this.started_=true;this.onUpdateendCallback_=function(){var e=t.pendingCallback_;t.pendingCallback_=null;t.logger_("buffered ["+it(t.buffered())+"]");if(e){e()}t.runCallback_()};this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_);this.runCallback_()}},{key:"abort",value:function e(t){var r=this;if(this.processedAppend_){this.queueCallback_((function(){r.sourceBuffer_.abort()}),t)}}},{key:"appendBuffer",value:function e(t,r){var i=this;this.processedAppend_=true;this.queueCallback_((function(){if(t.videoSegmentTimingInfoCallback){i.sourceBuffer_.addEventListener("videoSegmentTimingInfo",t.videoSegmentTimingInfoCallback)}i.sourceBuffer_.appendBuffer(t.bytes)}),(function(){if(t.videoSegmentTimingInfoCallback){i.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",t.videoSegmentTimingInfoCallback)}r()}))}},{key:"buffered",value:function e(){if(!this.sourceBuffer_){return u.a.createTimeRanges()}return this.sourceBuffer_.buffered}},{key:"remove",value:function e(t,r){var i=this;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:er;if(this.processedAppend_){this.queueCallback_((function(){i.logger_("remove ["+t+" => "+r+"]");i.sourceBuffer_.remove(t,r)}),n)}}},{key:"updating",value:function e(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==er}},{key:"timestampOffset",value:function e(t){var r=this;if(typeof t!=="undefined"){this.queueCallback_((function(){r.sourceBuffer_.timestampOffset=t}));this.timestampOffset_=t}return this.timestampOffset_}},{key:"queueCallback_",value:function e(t,r){this.callbacks_.push([t.bind(this),r]);this.runCallback_()}},{key:"runCallback_",value:function e(){var t=void 0;if(!this.updating()&&this.callbacks_.length&&this.started_){t=this.callbacks_.shift();this.pendingCallback_=t[1];t[0]()}}},{key:"dispose",value:function e(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_);if(this.sourceBuffer_&&this.mediaSource.readyState==="open"){this.sourceBuffer_.abort()}}}]);return e}();var rr={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1};var ir={FAILURE:2,TIMEOUT:-101,ABORTED:-102};var nr=function e(t){var r=void 0;var i=void 0;i=t.offset+t.length-1;r=t.offset;return"bytes="+r+"-"+i};var ar=function e(t){var r={};if(t.byterange){r.Range=nr(t.byterange)}return r};var sr=function e(t){t.forEach((function(e){e.abort()}))};var or=function e(t){return{bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}};var ur=function e(t){var r=t.target;var i=Date.now()-r.requestTime;var n={bandwidth:Infinity,bytesReceived:0,roundTripTime:i||0};n.bytesReceived=t.loaded;n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3);return n};var lr=function e(t,r){if(r.timedout){return{status:r.status,message:"HLS request timed-out at URL: "+r.uri,code:ir.TIMEOUT,xhr:r}}if(r.aborted){return{status:r.status,message:"HLS request aborted at URL: "+r.uri,code:ir.ABORTED,xhr:r}}if(t){return{status:r.status,message:"HLS request errored at URL: "+r.uri,code:ir.FAILURE,xhr:r}}return null};var dr=function e(t,r){return function(e,i){var n=i.response;var a=lr(e,i);if(a){return r(a,t)}if(n.byteLength!==16){return r({status:i.status,message:"Invalid HLS key at URL: "+i.uri,code:ir.FAILURE,xhr:i},t)}var s=new DataView(n);t.key.bytes=new Uint32Array([s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)]);return r(null,t)}};var fr=function e(t,r,i){return function(e,n){var a=n.response;var s=lr(e,n);if(s){return i(s,t)}if(a.byteLength===0){return i({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:ir.FAILURE,xhr:n},t)}t.map.bytes=new Uint8Array(n.response);if(!r.isInitialized()){r.init()}t.map.timescales=S.a.timescale(t.map.bytes);t.map.videoTrackIds=S.a.videoTrackIds(t.map.bytes);return i(null,t)}};var cr=function e(t,r,i){return function(e,n){var a=n.response;var s=lr(e,n);var o=void 0;if(s){return i(s,t)}if(a.byteLength===0){return i({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:ir.FAILURE,xhr:n},t)}t.stats=or(n);if(t.key){t.encryptedBytes=new Uint8Array(n.response)}else{t.bytes=new Uint8Array(n.response)}if(t.map&&t.map.bytes){if(!r.isInitialized()){r.init()}o=r.parse(t.bytes,t.map.videoTrackIds,t.map.timescales);if(o&&o.captions){t.captionStreams=o.captionStreams;t.fmp4Captions=o.captions}}return i(null,t)}};var hr=function e(t,r,i){var n=function e(n){if(n.data.source===r.requestId){t.removeEventListener("message",e);var a=n.data.decrypted;r.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength);return i(null,r)}};t.addEventListener("message",n);t.postMessage(Me({source:r.requestId,encrypted:r.encryptedBytes,key:r.key.bytes,iv:r.key.iv}),[r.encryptedBytes.buffer,r.key.bytes.buffer])};var pr=function e(t,r,i){var n=0;var a=false;return function(e,s){if(a){return}if(e){a=true;sr(t);return i(e,s)}n+=1;if(n===t.length){s.endOfAllRequests=Date.now();if(s.encryptedBytes){return hr(r,s,i)}return i(null,s)}}};var vr=function e(t,r){return function(e){t.stats=u.a.mergeOptions(t.stats,ur(e));if(!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived){t.stats.firstBytesReceivedAt=Date.now()}return r(e,t)}};var mr=function e(t,r,i,n,a,s,o){var l=[];var d=pr(l,i,o);if(a.key){var f=u.a.mergeOptions(r,{uri:a.key.resolvedUri,responseType:"arraybuffer"});var c=dr(a,d);var h=t(f,c);l.push(h)}if(a.map&&!a.map.bytes){var p=u.a.mergeOptions(r,{uri:a.map.resolvedUri,responseType:"arraybuffer",headers:ar(a.map)});var v=fr(a,n,d);var m=t(p,v);l.push(m)}var g=u.a.mergeOptions(r,{uri:a.resolvedUri,responseType:"arraybuffer",headers:ar(a)});var y=cr(a,n,d);var _=t(g,y);_.addEventListener("progress",vr(a,s));l.push(_);return function(){return sr(l)}};var gr=function e(t,r){var i=void 0;if(!t){return""}i=s.a.getComputedStyle(t);if(!i){return""}return i[r]};var yr=function e(t,r){var i=t.slice();t.sort((function(e,t){var n=r(e,t);if(n===0){return i.indexOf(e)-i.indexOf(t)}return n}))};var _r=function e(t,r){var i=void 0;var n=void 0;if(t.attributes.BANDWIDTH){i=t.attributes.BANDWIDTH}i=i||s.a.Number.MAX_VALUE;if(r.attributes.BANDWIDTH){n=r.attributes.BANDWIDTH}n=n||s.a.Number.MAX_VALUE;return i-n};var br=function e(t,r){var i=void 0;var n=void 0;if(t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width){i=t.attributes.RESOLUTION.width}i=i||s.a.Number.MAX_VALUE;if(r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width){n=r.attributes.RESOLUTION.width}n=n||s.a.Number.MAX_VALUE;if(i===n&&t.attributes.BANDWIDTH&&r.attributes.BANDWIDTH){return t.attributes.BANDWIDTH-r.attributes.BANDWIDTH}return i-n};var Tr=function e(t,r,i,n,a){var o=t.playlists.map((function(e){var t=void 0;var r=void 0;var i=void 0;t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width;r=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;i=e.attributes.BANDWIDTH;i=i||s.a.Number.MAX_VALUE;return{bandwidth:i,width:t,height:r,playlist:e}}));yr(o,(function(e,t){return e.bandwidth-t.bandwidth}));o=o.filter((function(e){return!xe.isIncompatible(e.playlist)}));var u=o.filter((function(e){return xe.isEnabled(e.playlist)}));if(!u.length){u=o.filter((function(e){return!xe.isDisabled(e.playlist)}))}var l=u.filter((function(e){return e.bandwidth*rr.BANDWIDTH_VARIANCE<r}));var d=l[l.length-1];var f=l.filter((function(e){return e.bandwidth===d.bandwidth}))[0];if(a===false){var c=f||u[0]||o[0];return c?c.playlist:null}var h=l.filter((function(e){return e.width&&e.height}));yr(h,(function(e,t){return e.width-t.width}));var p=h.filter((function(e){return e.width===i&&e.height===n}));d=p[p.length-1];var v=p.filter((function(e){return e.bandwidth===d.bandwidth}))[0];var m=void 0;var g=void 0;var y=void 0;if(!v){m=h.filter((function(e){return e.width>i||e.height>n}));g=m.filter((function(e){return e.width===m[0].width&&e.height===m[0].height}));d=g[g.length-1];y=g.filter((function(e){return e.bandwidth===d.bandwidth}))[0]}var _=y||v||f||u[0]||o[0];return _?_.playlist:null};var Sr=function e(){return Tr(this.playlists.master,this.systemBandwidth,parseInt(gr(this.tech_.el(),"width"),10),parseInt(gr(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)};var Er=function e(t){var r=t.master,i=t.currentTime,n=t.bandwidth,a=t.duration,s=t.segmentDuration,o=t.timeUntilRebuffer,u=t.currentTimeline,l=t.syncController;var d=r.playlists.filter((function(e){return!xe.isIncompatible(e)}));var f=d.filter(xe.isEnabled);if(!f.length){f=d.filter((function(e){return!xe.isDisabled(e)}))}var c=f.filter(xe.hasAttribute.bind(null,"BANDWIDTH"));var h=c.map((function(e){var t=l.getSyncPoint(e,a,u,i);var r=t?1:2;var d=xe.estimateSegmentRequestTime(s,n,e);var f=d*r-o;return{playlist:e,rebufferingImpact:f}}));var p=h.filter((function(e){return e.rebufferingImpact<=0}));yr(p,(function(e,t){return _r(t.playlist,e.playlist)}));if(p.length){return p[0]}yr(h,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact}));return h[0]||null};var wr=function e(){var t=this.playlists.master.playlists.filter(xe.isEnabled);yr(t,(function(e,t){return _r(e,t)}));var r=t.filter((function(e){return At(e.attributes.CODECS).videoCodec}));return r[0]||null};var kr=function e(t,r,i){for(var n in i){if(!t[n]){r.trigger({type:"usage",name:"hls-608"});var a=r.textTracks().getTrackById(n);if(a){t[n]=a}else{t[n]=r.addRemoteTextTrack({kind:"captions",id:n,label:n},false).track}}}};var Ar=function e(t){var r=t.inbandTextTracks,i=t.captionArray,n=t.timestampOffset;if(!i){return}var a=window.WebKitDataCue||window.VTTCue;i.forEach((function(e){var t=e.stream;var i=e.startTime;var s=e.endTime;if(!r[t]){return}i+=n;s+=n;r[t].addCue(new a(i,s,e.text))}))};var Cr=500;var Lr=function e(t,r,i){if(!t||!r){return false}var n=t.segments;var a=i===n.length;return t.endList&&r.readyState==="open"&&a};var xr=function e(t){return typeof t==="number"&&isFinite(t)};var Dr=function e(t,r,i){if(t!=="main"||!r||!i){return null}if(!i.containsAudio&&!i.containsVideo){return"Neither audio nor video found in segment."}if(r.containsVideo&&!i.containsVideo){return"Only audio found in segment when we expected video."+" We can't switch to audio only from a stream that had video."+" To get rid of this message, please add codec information to the manifest."}if(!r.containsVideo&&i.containsVideo){return"Video found in segment when we expected only audio."+" We can't switch to a stream with video from an audio only stream."+" To get rid of this message, please add codec information to the manifest."}return null};var Ir=function e(t,r,i){var n=void 0;if(t.length&&t.start(0)>0&&t.start(0)<r){n=t.start(0)}else{n=r-30}return Math.min(n,r-i)};var Or=function e(t){var r=t.segment,i=r.start,n=r.end,a=t.playlist,s=a.mediaSequence,o=a.id,u=a.segments,l=u===undefined?[]:u,d=t.mediaIndex,f=t.timeline;return["appending ["+d+"] of ["+s+", "+(s+l.length)+"] from playlist ["+o+"]","["+i+" => "+n+"] in timeline ["+f+"]"].join(" ")};var Rr=function(e){z(t,e);function t(e){G(this,t);var r=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!e){throw new TypeError("Initialization settings are required")}if(typeof e.currentTime!=="function"){throw new TypeError("No currentTime getter specified")}if(!e.mediaSource){throw new TypeError("No MediaSource specified")}r.bandwidth=e.bandwidth;r.throughput={rate:0,count:0};r.roundTrip=NaN;r.resetStats_();r.mediaIndex=null;r.hasPlayed_=e.hasPlayed;r.currentTime_=e.currentTime;r.seekable_=e.seekable;r.seeking_=e.seeking;r.duration_=e.duration;r.mediaSource_=e.mediaSource;r.hls_=e.hls;r.loaderType_=e.loaderType;r.startingMedia_=void 0;r.segmentMetadataTrack_=e.segmentMetadataTrack;r.goalBufferLength_=e.goalBufferLength;r.sourceType_=e.sourceType;r.inbandTextTracks_=e.inbandTextTracks;r.state_="INIT";r.checkBufferTimeout_=null;r.error_=void 0;r.currentTimeline_=-1;r.pendingSegment_=null;r.mimeType_=null;r.sourceUpdater_=null;r.xhrOptions_=null;r.activeInitSegmentId_=null;r.initSegments_={};r.captionParser_=new E["CaptionParser"];r.decrypter_=e.decrypter;r.syncController_=e.syncController;r.syncPoint_={segmentIndex:0,time:0};r.syncController_.on("syncinfoupdate",(function(){return r.trigger("syncinfoupdate")}));r.mediaSource_.addEventListener("sourceopen",(function(){return r.ended_=false}));r.fetchAtBuffer_=false;r.logger_=Zt("SegmentLoader["+r.loaderType_+"]");Object.defineProperty(r,"state",{get:function e(){return this.state_},set:function e(t){if(t!==this.state_){this.logger_(this.state_+" -> "+t);this.state_=t}}});return r}V(t,[{key:"resetStats_",value:function e(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0}},{key:"dispose",value:function e(){this.state="DISPOSED";this.pause();this.abort_();if(this.sourceUpdater_){this.sourceUpdater_.dispose()}this.resetStats_();this.captionParser_.reset()}},{key:"abort",value:function e(){if(this.state!=="WAITING"){if(this.pendingSegment_){this.pendingSegment_=null}return}this.abort_();this.state="READY";if(!this.paused()){this.monitorBuffer_()}}},{key:"abort_",value:function e(){if(this.pendingSegment_){this.pendingSegment_.abortRequests()}this.pendingSegment_=null}},{key:"error",value:function e(t){if(typeof t!=="undefined"){this.error_=t}this.pendingSegment_=null;return this.error_}},{key:"endOfStream",value:function e(){this.ended_=true;this.pause();this.trigger("ended")}},{key:"buffered_",value:function e(){if(!this.sourceUpdater_){return u.a.createTimeRanges()}return this.sourceUpdater_.buffered()}},{key:"initSegment",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!t){return null}var i=Ne(t);var n=this.initSegments_[i];if(r&&!n&&t.bytes){this.initSegments_[i]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:t.bytes,timescales:t.timescales,videoTrackIds:t.videoTrackIds}}return n||t}},{key:"couldBeginLoading_",value:function e(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&this.state==="INIT")&&!this.paused()}},{key:"load",value:function e(){this.monitorBuffer_();if(!this.playlist_){return}this.syncController_.setDateTimeMapping(this.playlist_);if(this.state==="INIT"&&this.couldBeginLoading_()){return this.init_()}if(!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"){return}this.state="READY"}},{key:"init_",value:function e(){this.state="READY";this.sourceUpdater_=new tr(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_);this.resetEverything();return this.monitorBuffer_()}},{key:"playlist",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return}var i=this.playlist_;var n=this.pendingSegment_;this.playlist_=t;this.xhrOptions_=r;if(!this.hasPlayed_()){t.syncInfo={mediaSequence:t.mediaSequence,time:0}}var a=null;if(i){if(i.id){a=i.id}else if(i.uri){a=i.uri}}this.logger_("playlist update ["+a+" => "+(t.id||t.uri)+"]");this.trigger("syncinfoupdate");if(this.state==="INIT"&&this.couldBeginLoading_()){return this.init_()}if(!i||i.uri!==t.uri){if(this.mediaIndex!==null){this.resyncLoader()}return}var s=t.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+s+"]");if(this.mediaIndex!==null){this.mediaIndex-=s}if(n){n.mediaIndex-=s;if(n.mediaIndex>=0){n.segment=t.segments[n.mediaIndex]}}this.syncController_.saveExpiredSegmentInfo(i,t)}},{key:"pause",value:function e(){if(this.checkBufferTimeout_){s.a.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=null}}},{key:"paused",value:function e(){return this.checkBufferTimeout_===null}},{key:"mimeType",value:function e(t,r){if(this.mimeType_){return}this.mimeType_=t;this.sourceBufferEmitter_=r;if(this.state==="INIT"&&this.couldBeginLoading_()){this.init_()}}},{key:"resetEverything",value:function e(t){this.ended_=false;this.resetLoader();this.remove(0,this.duration_(),t);this.captionParser_.clearAllCaptions();this.trigger("reseteverything")}},{key:"resetLoader",value:function e(){this.fetchAtBuffer_=false;this.resyncLoader()}},{key:"resyncLoader",value:function e(){this.mediaIndex=null;this.syncPoint_=null;this.abort()}},{key:"remove",value:function e(t,r,i){if(this.sourceUpdater_){this.sourceUpdater_.remove(t,r,i)}ot(t,r,this.segmentMetadataTrack_);if(this.inbandTextTracks_){for(var n in this.inbandTextTracks_){ot(t,r,this.inbandTextTracks_[n])}}}},{key:"monitorBuffer_",value:function e(){if(this.checkBufferTimeout_){s.a.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=s.a.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function e(){if(this.state==="READY"){this.fillBuffer_()}if(this.checkBufferTimeout_){s.a.clearTimeout(this.checkBufferTimeout_)}this.checkBufferTimeout_=s.a.setTimeout(this.monitorBufferTick_.bind(this),Cr)}},{key:"fillBuffer_",value:function e(){if(this.sourceUpdater_.updating()){return}if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(!t){return}if(this.isEndOfStream_(t.mediaIndex)){this.endOfStream();return}if(t.mediaIndex===this.playlist_.segments.length-1&&this.mediaSource_.readyState==="ended"&&!this.seeking_()){return}if(t.timeline!==this.currentTimeline_||t.startOfSegment!==null&&t.startOfSegment<this.sourceUpdater_.timestampOffset()){this.syncController_.reset();t.timestampOffset=t.startOfSegment;this.captionParser_.clearAllCaptions()}this.loadSegment_(t)}},{key:"isEndOfStream_",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.playlist_;return Lr(r,this.mediaSource_,t)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function e(t,r,i,n,a,s){var o=0;var u=void 0;if(t.length){o=t.end(t.length-1)}var l=Math.max(0,o-a);if(!r.segments.length){return null}if(l>=this.goalBufferLength_()){return null}if(!n&&l>=1){return null}if(s===null){i=this.getSyncSegmentCandidate_(r);return this.generateSegmentInfo_(r,i,null,true)}if(i!==null){var d=r.segments[i];if(d&&d.end){u=d.end}else{u=o}return this.generateSegmentInfo_(r,i+1,u,false)}if(this.fetchAtBuffer_){var f=xe.getMediaInfoForTime(r,o,s.segmentIndex,s.time);i=f.mediaIndex;u=f.startTime}else{var c=xe.getMediaInfoForTime(r,a,s.segmentIndex,s.time);i=c.mediaIndex;u=c.startTime}return this.generateSegmentInfo_(r,i,u,false)}},{key:"getSyncSegmentCandidate_",value:function e(t){var r=this;if(this.currentTimeline_===-1){return 0}var i=t.segments.map((function(e,t){return{timeline:e.timeline,segmentIndex:t}})).filter((function(e){return e.timeline===r.currentTimeline_}));if(i.length){return i[Math.min(i.length-1,1)].segmentIndex}return Math.max(t.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function e(t,r,i,n){if(r<0||r>=t.segments.length){return null}var a=t.segments[r];return{requestId:"segment-loader-"+Math.random(),uri:a.resolvedUri,mediaIndex:r,isSyncRequest:n,startOfSegment:i,playlist:t,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:a.timeline,duration:a.duration,segment:a}}},{key:"abortRequestEarly_",value:function e(t){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH){return false}if(Date.now()-(t.firstBytesReceivedAt||Date.now())<1e3){return false}var r=this.currentTime_();var i=t.bandwidth;var n=this.pendingSegment_.duration;var a=xe.estimateSegmentRequestTime(n,i,this.playlist_,t.bytesReceived);var s=nt(this.buffered_(),r,this.hls_.tech_.playbackRate())-1;if(a<=s){return false}var o=Er({master:this.hls_.playlists.master,currentTime:r,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:s,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!o){return}var u=a-s;var l=u-o.rebufferingImpact;var d=.5;if(s<=Qe){d=1}if(!o.playlist||o.playlist.uri===this.playlist_.uri||l<d){return false}this.bandwidth=o.playlist.attributes.BANDWIDTH*rr.BANDWIDTH_VARIANCE+1;this.abort();this.trigger("earlyabort");return true}},{key:"handleProgress_",value:function e(t,r){if(!this.pendingSegment_||r.requestId!==this.pendingSegment_.requestId||this.abortRequestEarly_(r.stats)){return}this.trigger("progress")}},{key:"loadSegment_",value:function e(t){this.state="WAITING";this.pendingSegment_=t;this.trimBackBuffer_(t);t.abortRequests=mr(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(t),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function e(t){var r=Ir(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);if(r>0){this.remove(0,r)}}},{key:"createSimplifiedSegmentObj_",value:function e(t){var r=t.segment;var i={resolvedUri:r.resolvedUri,byterange:r.byterange,requestId:t.requestId};if(r.key){var n=r.key.iv||new Uint32Array([0,0,0,t.mediaIndex+t.playlist.mediaSequence]);i.key={resolvedUri:r.key.resolvedUri,iv:n}}if(r.map){i.map=this.initSegment(r.map)}return i}},{key:"segmentRequestFinished_",value:function e(t,r){this.mediaRequests+=1;if(r.stats){this.mediaBytesTransferred+=r.stats.bytesReceived;this.mediaTransferDuration+=r.stats.roundTripTime}if(!this.pendingSegment_){this.mediaRequestsAborted+=1;return}if(r.requestId!==this.pendingSegment_.requestId){return}if(t){this.pendingSegment_=null;this.state="READY";if(t.code===ir.ABORTED){this.mediaRequestsAborted+=1;return}this.pause();if(t.code===ir.TIMEOUT){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate");return}this.mediaRequestsErrored+=1;this.error(t);this.trigger("error");return}this.bandwidth=r.stats.bandwidth;this.roundTrip=r.stats.roundTripTime;if(r.map){r.map=this.initSegment(r.map,true)}this.processSegmentResponse_(r)}},{key:"processSegmentResponse_",value:function e(t){var r=this.pendingSegment_;r.bytes=t.bytes;if(t.map){r.segment.map.bytes=t.map.bytes}r.endOfAllRequests=t.endOfAllRequests;if(t.fmp4Captions){kr(this.inbandTextTracks_,this.hls_.tech_,t.captionStreams);Ar({inbandTextTracks:this.inbandTextTracks_,captionArray:t.fmp4Captions,timestampOffset:0});this.captionParser_.clearParsedCaptions()}this.handleSegment_()}},{key:"handleSegment_",value:function e(){var t=this;if(!this.pendingSegment_){this.state="READY";return}var r=this.pendingSegment_;var i=r.segment;var n=this.syncController_.probeSegmentInfo(r);if(typeof this.startingMedia_==="undefined"&&n&&(n.containsAudio||n.containsVideo)){this.startingMedia_={containsAudio:n.containsAudio,containsVideo:n.containsVideo}}var a=Dr(this.loaderType_,this.startingMedia_,n);if(a){this.error({message:a,blacklistDuration:Infinity});this.trigger("error");return}if(r.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}if(r.timestampOffset!==null&&r.timestampOffset!==this.sourceUpdater_.timestampOffset()){this.sourceUpdater_.timestampOffset(r.timestampOffset);this.trigger("timestampoffset")}var s=this.syncController_.mappingForTimeline(r.timeline);if(s!==null){this.trigger({type:"segmenttimemapping",mapping:s})}this.state="APPENDING";if(i.map){var o=Ne(i.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==o){var u=this.initSegment(i.map);this.sourceUpdater_.appendBuffer({bytes:u.bytes},(function(){t.activeInitSegmentId_=o}))}}r.byteLength=r.bytes.byteLength;if(typeof i.start==="number"&&typeof i.end==="number"){this.mediaSecondsLoaded+=i.end-i.start}else{this.mediaSecondsLoaded+=i.duration}this.logger_(Or(r));this.sourceUpdater_.appendBuffer({bytes:r.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,r.requestId)},this.handleUpdateEnd_.bind(this))}},{key:"handleVideoSegmentTimingInfo_",value:function e(t,r){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId){return}var i=this.pendingSegment_.segment;if(!i.videoTimingInfo){i.videoTimingInfo={}}i.videoTimingInfo.transmuxerPrependedSeconds=r.videoSegmentTimingInfo.prependedContentDuration||0;i.videoTimingInfo.transmuxedPresentationStart=r.videoSegmentTimingInfo.start.presentation;i.videoTimingInfo.transmuxedPresentationEnd=r.videoSegmentTimingInfo.end.presentation;i.videoTimingInfo.baseMediaDecodeTime=r.videoSegmentTimingInfo.baseMediaDecodeTime}},{key:"handleUpdateEnd_",value:function e(){if(!this.pendingSegment_){this.state="READY";if(!this.paused()){this.monitorBuffer_()}return}var t=this.pendingSegment_;var r=t.segment;var i=this.mediaIndex!==null;this.pendingSegment_=null;this.recordThroughput_(t);this.addSegmentMetadataCue_(t);this.state="READY";this.mediaIndex=t.mediaIndex;this.fetchAtBuffer_=true;this.currentTimeline_=t.timeline;this.trigger("syncinfoupdate");if(r.end&&this.currentTime_()-r.end>t.playlist.targetDuration*3){this.resetEverything();return}if(i){this.trigger("bandwidthupdate")}this.trigger("progress");if(this.isEndOfStream_(t.mediaIndex+1,t.playlist)){this.endOfStream()}if(!this.paused()){this.monitorBuffer_()}}},{key:"recordThroughput_",value:function e(t){var r=this.throughput.rate;var i=Date.now()-t.endOfAllRequests+1;var n=Math.floor(t.byteLength/i*8*1e3);this.throughput.rate+=(n-r)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function e(t){if(!this.segmentMetadataTrack_){return}var r=t.segment;var i=r.start;var n=r.end;if(!xr(i)||!xr(n)){return}ot(i,n,this.segmentMetadataTrack_);var a=s.a.WebKitDataCue||s.a.VTTCue;var o={dateTimeObject:r.dateTimeObject,dateTimeString:r.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:i,end:n};var u=JSON.stringify(o);var l=new a(i,n,u);l.value=o;this.segmentMetadataTrack_.addCue(l)}}]);return t}(u.a.EventTarget);var Pr=function e(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))};var Ur=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)})));var Mr=function(e){z(t,e);function t(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};G(this,t);var i=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));i.mediaSource_=null;i.subtitlesTrack_=null;return i}V(t,[{key:"buffered_",value:function e(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length){return u.a.createTimeRanges()}var t=this.subtitlesTrack_.cues;var r=t[0].startTime;var i=t[t.length-1].startTime;return u.a.createTimeRanges([[r,i]])}},{key:"initSegment",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!t){return null}var i=Ne(t);var n=this.initSegments_[i];if(r&&!n&&t.bytes){var a=Ur.byteLength+t.bytes.byteLength;var s=new Uint8Array(a);s.set(t.bytes);s.set(Ur,t.bytes.byteLength);this.initSegments_[i]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:s}}return n||t}},{key:"couldBeginLoading_",value:function e(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function e(){this.state="READY";this.resetEverything();return this.monitorBuffer_()}},{key:"track",value:function e(t){if(typeof t==="undefined"){return this.subtitlesTrack_}this.subtitlesTrack_=t;if(this.state==="INIT"&&this.couldBeginLoading_()){this.init_()}return this.subtitlesTrack_}},{key:"remove",value:function e(t,r){ot(t,r,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function e(){var t=this;if(!this.syncPoint_){this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())}var r=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);r=this.skipEmptySegments_(r);if(!r){return}if(this.syncController_.timestampOffsetForTimeline(r.timeline)===null){var i=function e(){t.state="READY";if(!t.paused()){t.monitorBuffer_()}};this.syncController_.one("timestampoffset",i);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(r)}},{key:"skipEmptySegments_",value:function e(t){while(t&&t.segment.empty){t=this.generateSegmentInfo_(t.playlist,t.mediaIndex+1,t.startOfSegment+t.duration,t.isSyncRequest)}return t}},{key:"handleSegment_",value:function e(){var t=this;if(!this.pendingSegment_||!this.subtitlesTrack_){this.state="READY";return}this.state="APPENDING";var r=this.pendingSegment_;var i=r.segment;if(typeof s.a.WebVTT!=="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var n=function e(){t.handleSegment_()};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",n);this.subtitlesTrack_.tech_.one("vttjserror",(function(){t.subtitlesTrack_.tech_.off("vttjsloaded",n);t.error({message:"Error loading vtt.js"});t.state="READY";t.pause();t.trigger("error")}));return}i.requested=true;try{this.parseVTTCues_(r)}catch(e){this.error({message:e.message});this.state="READY";this.pause();return this.trigger("error")}this.updateTimeMapping_(r,this.syncController_.timelines[r.timeline],this.playlist_);if(r.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}r.byteLength=r.bytes.byteLength;this.mediaSecondsLoaded+=i.duration;if(r.cues.length){this.remove(r.cues[0].endTime,r.cues[r.cues.length-1].endTime)}r.cues.forEach((function(e){t.subtitlesTrack_.addCue(e)}));this.handleUpdateEnd_()}},{key:"parseVTTCues_",value:function e(t){var r=void 0;var i=false;if(typeof s.a.TextDecoder==="function"){r=new s.a.TextDecoder("utf8")}else{r=s.a.WebVTT.StringDecoder();i=true}var n=new s.a.WebVTT.Parser(s.a,s.a.vttjs,r);t.cues=[];t.timestampmap={MPEGTS:0,LOCAL:0};n.oncue=t.cues.push.bind(t.cues);n.ontimestampmap=function(e){return t.timestampmap=e};n.onparsingerror=function(e){u.a.log.warn("Error encountered when parsing cues: "+e.message)};if(t.segment.map){var a=t.segment.map.bytes;if(i){a=Pr(a)}n.parse(a)}var o=t.bytes;if(i){o=Pr(o)}n.parse(o);n.flush()}},{key:"updateTimeMapping_",value:function e(t,r,i){var n=t.segment;if(!r){return}if(!t.cues.length){n.empty=true;return}var a=t.timestampmap;var s=a.MPEGTS/9e4-a.LOCAL+r.mapping;t.cues.forEach((function(e){e.startTime+=s;e.endTime+=s}));if(!i.syncInfo){var o=t.cues[0].startTime;var u=t.cues[t.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+t.mediaIndex,time:Math.min(o,u-n.duration)}}}}]);return t}(Rr);var Nr=function e(t,r){var i=t.cues;for(var n=0;n<i.length;n++){var a=i[n];if(r>=a.adStartTime&&r<=a.adEndTime){return a}}return null};var jr=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(!t.segments){return}var n=i;var a=void 0;for(var o=0;o<t.segments.length;o++){var u=t.segments[o];if(!a){a=Nr(r,n+u.duration/2)}if(a){if("cueIn"in u){a.endTime=n;a.adEndTime=n;n+=u.duration;a=null;continue}if(n<a.endTime){n+=u.duration;continue}a.endTime+=u.duration}else{if("cueOut"in u){a=new s.a.VTTCue(n,n+u.duration,u.cueOut);a.adStartTime=n;a.adEndTime=n+parseFloat(u.cueOut);r.addCue(a)}if("cueOutCont"in u){var l=void 0;var d=void 0;var f=u.cueOutCont.split("/").map(parseFloat);var c=Y(f,2);l=c[0];d=c[1];a=new s.a.VTTCue(n,n+u.duration,"");a.adStartTime=n-l;a.adEndTime=a.adStartTime+d;r.addCue(a)}}n+=u.duration}};var Br=k.a.inspect;var Fr=[{name:"VOD",run:function e(t,r,i,n,a){if(i!==Infinity){var s={time:0,segmentIndex:0};return s}return null}},{name:"ProgramDateTime",run:function e(t,r,i,n,a){if(!t.datetimeToDisplayTime){return null}var s=r.segments||[];var o=null;var u=null;a=a||0;for(var l=0;l<s.length;l++){var d=s[l];if(d.dateTimeObject){var f=d.dateTimeObject.getTime()/1e3;var c=f+t.datetimeToDisplayTime;var h=Math.abs(a-c);if(u!==null&&u<h){break}u=h;o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function e(t,r,i,n,a){var s=r.segments||[];var o=null;var u=null;a=a||0;for(var l=0;l<s.length;l++){var d=s[l];if(d.timeline===n&&typeof d.start!=="undefined"){var f=Math.abs(a-d.start);if(u!==null&&u<f){break}if(!o||u===null||u>=f){u=f;o={time:d.start,segmentIndex:l}}}}return o}},{name:"Discontinuity",run:function e(t,r,i,n,a){var s=null;a=a||0;if(r.discontinuityStarts&&r.discontinuityStarts.length){var o=null;for(var u=0;u<r.discontinuityStarts.length;u++){var l=r.discontinuityStarts[u];var d=r.discontinuitySequence+u+1;var f=t.discontinuities[d];if(f){var c=Math.abs(a-f.time);if(o!==null&&o<c){break}if(!s||o===null||o>=c){o=c;s={time:f.time,segmentIndex:l}}}}}return s}},{name:"Playlist",run:function e(t,r,i,n,a){if(r.syncInfo){var s={time:r.syncInfo.time,segmentIndex:r.syncInfo.mediaSequence-r.mediaSequence};return s}return null}}];var Hr=function(e){z(t,e);function t(){G(this,t);var e=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.inspectCache_=undefined;e.timelines=[];e.discontinuities=[];e.datetimeToDisplayTime=null;e.logger_=Zt("SyncController");return e}V(t,[{key:"getSyncPoint",value:function e(t,r,i,n){var a=this.runStrategies_(t,r,i,n);if(!a.length){return null}return this.selectSyncPoint_(a,{key:"time",value:n})}},{key:"getExpiredTime",value:function e(t,r){if(!t||!t.segments){return null}var i=this.runStrategies_(t,r,t.discontinuitySequence,0);if(!i.length){return null}var n=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});if(n.segmentIndex>0){n.time*=-1}return Math.abs(n.time+fe(t,n.segmentIndex,0))}},{key:"runStrategies_",value:function e(t,r,i,n){var a=[];for(var s=0;s<Fr.length;s++){var o=Fr[s];var u=o.run(this,t,r,i,n);if(u){u.strategy=o.name;a.push({strategy:o.name,syncPoint:u})}}return a}},{key:"selectSyncPoint_",value:function e(t,r){var i=t[0].syncPoint;var n=Math.abs(t[0].syncPoint[r.key]-r.value);var a=t[0].strategy;for(var s=1;s<t.length;s++){var o=Math.abs(t[s].syncPoint[r.key]-r.value);if(o<n){n=o;i=t[s].syncPoint;a=t[s].strategy}}this.logger_("syncPoint for ["+r.key+": "+r.value+"] chosen with strategy"+(" ["+a+"]: [time:"+i.time+",")+(" segmentIndex:"+i.segmentIndex+"]"));return i}},{key:"saveExpiredSegmentInfo",value:function e(t,r){var i=r.mediaSequence-t.mediaSequence;for(var n=i-1;n>=0;n--){var a=t.segments[n];if(a&&typeof a.start!=="undefined"){r.syncInfo={mediaSequence:t.mediaSequence+n,time:a.start};this.logger_("playlist refresh sync: [time:"+r.syncInfo.time+","+(" mediaSequence: "+r.syncInfo.mediaSequence+"]"));this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function e(t){if(!this.datetimeToDisplayTime&&t.segments&&t.segments.length&&t.segments[0].dateTimeObject){var r=t.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-r}}},{key:"reset",value:function e(){this.inspectCache_=undefined}},{key:"probeSegmentInfo",value:function e(t){var r=t.segment;var i=t.playlist;var n=void 0;if(r.map){n=this.probeMp4Segment_(t)}else{n=this.probeTsSegment_(t)}if(n){if(this.calculateSegmentTimeMapping_(t,n)){this.saveDiscontinuitySyncInfo_(t);if(!i.syncInfo){i.syncInfo={mediaSequence:i.mediaSequence+t.mediaIndex,time:r.start}}}}return n}},{key:"probeMp4Segment_",value:function e(t){var r=t.segment;var i=S.a.timescale(r.map.bytes);var n=S.a.startTime(i,t.bytes);if(t.timestampOffset!==null){t.timestampOffset-=n}return{start:n,end:n+r.duration}}},{key:"probeTsSegment_",value:function e(t){var r=Br(t.bytes,this.inspectCache_);var i=void 0;var n=void 0;if(!r){return null}if(r.video&&r.video.length===2){this.inspectCache_=r.video[1].dts;i=r.video[0].dtsTime;n=r.video[1].dtsTime}else if(r.audio&&r.audio.length===2){this.inspectCache_=r.audio[1].dts;i=r.audio[0].dtsTime;n=r.audio[1].dtsTime}var a={start:i,end:n,containsVideo:r.video&&r.video.length===2,containsAudio:r.audio&&r.audio.length===2};return a}},{key:"timestampOffsetForTimeline",value:function e(t){if(typeof this.timelines[t]==="undefined"){return null}return this.timelines[t].time}},{key:"mappingForTimeline",value:function e(t){if(typeof this.timelines[t]==="undefined"){return null}return this.timelines[t].mapping}},{key:"calculateSegmentTimeMapping_",value:function e(t,r){var i=t.segment;var n=this.timelines[t.timeline];if(t.timestampOffset!==null){n={time:t.startOfSegment,mapping:t.startOfSegment-r.start};this.timelines[t.timeline]=n;this.trigger("timestampoffset");this.logger_("time mapping for timeline "+t.timeline+": "+("[time: "+n.time+"] [mapping: "+n.mapping+"]"));i.start=t.startOfSegment;i.end=r.end+n.mapping}else if(n){i.start=r.start+n.mapping;i.end=r.end+n.mapping}else{return false}return true}},{key:"saveDiscontinuitySyncInfo_",value:function e(t){var r=t.playlist;var i=t.segment;if(i.discontinuity){this.discontinuities[i.timeline]={time:i.start,accuracy:0}}else if(r.discontinuityStarts&&r.discontinuityStarts.length){for(var n=0;n<r.discontinuityStarts.length;n++){var a=r.discontinuityStarts[n];var s=r.discontinuitySequence+n+1;var o=a-t.mediaIndex;var u=Math.abs(o);if(!this.discontinuities[s]||this.discontinuities[s].accuracy>u){var l=void 0;if(o<0){l=i.start-fe(r,t.mediaIndex,a)}else{l=i.end+fe(r,t.mediaIndex+1,a)}this.discontinuities[s]={time:l,accuracy:u}}}}}}]);return t}(u.a.EventTarget);var qr=new gt("./decrypter-worker.worker.js",(function(e,t){var r=this;var i=function(){function e(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var t=function e(t,r){if(!(t instanceof r)){throw new TypeError("Cannot call a class as a function")}};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,r,i){if(r)e(t.prototype,r);if(i)e(t,i);return t}}();var n=function e(t,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(r)Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r};var a=function e(t,r){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return r&&(typeof r==="object"||typeof r==="function")?r:t};var s=function e(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]];var r=t[0];var i=t[1];var n=r[4];var a=i[4];var s=void 0;var o=void 0;var u=void 0;var l=[];var d=[];var f=void 0;var c=void 0;var h=void 0;var p=void 0;var v=void 0;var m=void 0;for(s=0;s<256;s++){d[(l[s]=s<<1^(s>>7)*283)^s]=s}for(o=u=0;!n[o];o^=f||1,u=d[u]||1){p=u^u<<1^u<<2^u<<3^u<<4;p=p>>8^p&255^99;n[o]=p;a[p]=o;h=l[c=l[f=l[o]]];m=h*16843009^c*65537^f*257^o*16843008;v=l[p]*257^p*16843008;for(s=0;s<4;s++){r[s][o]=v=v<<24^v>>>8;i[s][p]=m=m<<24^m>>>8}}for(s=0;s<5;s++){r[s]=r[s].slice(0);i[s]=i[s].slice(0)}return t};var o=null;var u=function(){function e(r){t(this,e);if(!o){o=s()}this._tables=[[o[0][0].slice(),o[0][1].slice(),o[0][2].slice(),o[0][3].slice(),o[0][4].slice()],[o[1][0].slice(),o[1][1].slice(),o[1][2].slice(),o[1][3].slice(),o[1][4].slice()]];var i=void 0;var n=void 0;var a=void 0;var u=void 0;var l=void 0;var d=this._tables[0][4];var f=this._tables[1];var c=r.length;var h=1;if(c!==4&&c!==6&&c!==8){throw new Error("Invalid aes key size")}u=r.slice(0);l=[];this._key=[u,l];for(i=c;i<4*c+28;i++){a=u[i-1];if(i%c===0||c===8&&i%c===4){a=d[a>>>24]<<24^d[a>>16&255]<<16^d[a>>8&255]<<8^d[a&255];if(i%c===0){a=a<<8^a>>>24^h<<24;h=h<<1^(h>>7)*283}}u[i]=u[i-c]^a}for(n=0;i;n++,i--){a=u[n&3?i:i-4];if(i<=4||n<4){l[n]=a}else{l[n]=f[0][d[a>>>24]]^f[1][d[a>>16&255]]^f[2][d[a>>8&255]]^f[3][d[a&255]]}}}e.prototype.decrypt=function e(t,r,i,n,a,s){var o=this._key[1];var u=t^o[0];var l=n^o[1];var d=i^o[2];var f=r^o[3];var c=void 0;var h=void 0;var p=void 0;var v=o.length/4-2;var m=void 0;var g=4;var y=this._tables[1];var _=y[0];var b=y[1];var T=y[2];var S=y[3];var E=y[4];for(m=0;m<v;m++){c=_[u>>>24]^b[l>>16&255]^T[d>>8&255]^S[f&255]^o[g];h=_[l>>>24]^b[d>>16&255]^T[f>>8&255]^S[u&255]^o[g+1];p=_[d>>>24]^b[f>>16&255]^T[u>>8&255]^S[l&255]^o[g+2];f=_[f>>>24]^b[u>>16&255]^T[l>>8&255]^S[d&255]^o[g+3];g+=4;u=c;l=h;d=p}for(m=0;m<4;m++){a[(3&-m)+s]=E[u>>>24]<<24^E[l>>16&255]<<16^E[d>>8&255]<<8^E[f&255]^o[g++];c=u;u=l;l=d;d=f;f=c}};return e}();var l=function(){function e(){t(this,e);this.listeners={}}e.prototype.on=function e(t,r){if(!this.listeners[t]){this.listeners[t]=[]}this.listeners[t].push(r)};e.prototype.off=function e(t,r){if(!this.listeners[t]){return false}var i=this.listeners[t].indexOf(r);this.listeners[t].splice(i,1);return i>-1};e.prototype.trigger=function e(t){var r=this.listeners[t];if(!r){return}if(arguments.length===2){var i=r.length;for(var n=0;n<i;++n){r[n].call(this,arguments[1])}}else{var a=Array.prototype.slice.call(arguments,1);var s=r.length;for(var o=0;o<s;++o){r[o].apply(this,a)}}};e.prototype.dispose=function e(){this.listeners={}};e.prototype.pipe=function e(t){this.on("data",(function(e){t.push(e)}))};return e}();var d=function(e){n(r,e);function r(){t(this,r);var i=a(this,e.call(this,l));i.jobs=[];i.delay=1;i.timeout_=null;return i}r.prototype.processJob_=function e(){this.jobs.shift()();if(this.jobs.length){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}else{this.timeout_=null}};r.prototype.push=function e(t){this.jobs.push(t);if(!this.timeout_){this.timeout_=setTimeout(this.processJob_.bind(this),this.delay)}};return r}(l);var f=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};var c=function e(t,r,i){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2);var a=new u(Array.prototype.slice.call(r));var s=new Uint8Array(t.byteLength);var o=new Int32Array(s.buffer);var l=void 0;var d=void 0;var c=void 0;var h=void 0;var p=void 0;var v=void 0;var m=void 0;var g=void 0;var y=void 0;l=i[0];d=i[1];c=i[2];h=i[3];for(y=0;y<n.length;y+=4){p=f(n[y]);v=f(n[y+1]);m=f(n[y+2]);g=f(n[y+3]);a.decrypt(p,v,m,g,o,y);o[y]=f(o[y]^l);o[y+1]=f(o[y+1]^d);o[y+2]=f(o[y+2]^c);o[y+3]=f(o[y+3]^h);l=p;d=v;c=m;h=g}return s};var h=function(){function r(i,n,a,s){t(this,r);var o=r.STEP;var u=new Int32Array(i.buffer);var l=new Uint8Array(i.byteLength);var c=0;this.asyncStream_=new d;this.asyncStream_.push(this.decryptChunk_(u.subarray(c,c+o),n,a,l));for(c=o;c<u.length;c+=o){a=new Uint32Array([f(u[c-4]),f(u[c-3]),f(u[c-2]),f(u[c-1])]);this.asyncStream_.push(this.decryptChunk_(u.subarray(c,c+o),n,a,l))}this.asyncStream_.push((function(){s(null,e(l))}))}r.prototype.decryptChunk_=function e(t,r,i,n){return function(){var e=c(t,r,i);n.set(e,t.byteOffset)}};i(r,null,[{key:"STEP",get:function e(){return 32e3}}]);return r}();var p=function e(t){var r={};Object.keys(t).forEach((function(e){var i=t[e];if(ArrayBuffer.isView(i)){r[e]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}}else{r[e]=i}}));return r};var v=function e(t){t.onmessage=function(e){var r=e.data;var i=new Uint8Array(r.encrypted.bytes,r.encrypted.byteOffset,r.encrypted.byteLength);var n=new Uint32Array(r.key.bytes,r.key.byteOffset,r.key.byteLength/4);var a=new Uint32Array(r.iv.bytes,r.iv.byteOffset,r.iv.byteLength/4);new h(i,n,a,(function(e,i){t.postMessage(p({source:r.source,decrypted:i}),[i.buffer])}))}};var m=new v(r);return m}()}));var Gr=function e(t){var r=t.default?"main":"alternative";if(t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0){r="main-desc"}return r};var Vr=function e(t,r){t.abort();t.pause();if(r&&r.activePlaylistLoader){r.activePlaylistLoader.pause();r.activePlaylistLoader=null}};var Wr=function e(t,r){r.activePlaylistLoader=t;t.load()};var zr=function e(t,r){return function(){var e=r.segmentLoaders,i=e[t],n=e.main,a=r.mediaTypes[t];var s=a.activeTrack();var o=a.activeGroup(s);var u=a.activePlaylistLoader;Vr(i,a);if(!o){return}if(!o.playlistLoader){if(u){n.resetEverything()}return}i.resyncLoader();Wr(o.playlistLoader,a)}};var Kr=function e(t,r){return function(){var e=r.segmentLoaders,i=e[t],n=e.main,a=r.mediaTypes[t];var s=a.activeTrack();var o=a.activeGroup(s);var u=a.activePlaylistLoader;Vr(i,a);if(!o){return}if(!o.playlistLoader){n.resetEverything();return}if(u===o.playlistLoader){Wr(o.playlistLoader,a);return}if(i.track){i.track(s)}i.resetEverything();Wr(o.playlistLoader,a)}};var Yr={AUDIO:function e(t,r){return function(){var e=r.segmentLoaders[t],i=r.mediaTypes[t],n=r.blacklistCurrentPlaylist;Vr(e,i);var a=i.activeTrack();var s=i.activeGroup();var o=(s.filter((function(e){return e.default}))[0]||s[0]).id;var l=i.tracks[o];if(a===l){n({message:"Problem encountered loading the default audio track."});return}u.a.log.warn("Problem encountered loading the alternate audio track."+"Switching back to default.");for(var d in i.tracks){i.tracks[d].enabled=i.tracks[d]===l}i.onTrackChanged()}},SUBTITLES:function e(t,r){return function(){var e=r.segmentLoaders[t],i=r.mediaTypes[t];u.a.log.warn("Problem encountered loading the subtitle track."+"Disabling subtitle track.");Vr(e,i);var n=i.activeTrack();if(n){n.mode="disabled"}i.onTrackChanged()}}};var Xr={AUDIO:function e(t,r,i){if(!r){return}var n=i.tech,a=i.requestOptions,s=i.segmentLoaders[t];r.on("loadedmetadata",(function(){var e=r.media();s.playlist(e,a);if(!n.paused()||e.endList&&n.preload()!=="none"){s.load()}}));r.on("loadedplaylist",(function(){s.playlist(r.media(),a);if(!n.paused()){s.load()}}));r.on("error",Yr[t](t,i))},SUBTITLES:function e(t,r,i){var n=i.tech,a=i.requestOptions,s=i.segmentLoaders[t],o=i.mediaTypes[t];r.on("loadedmetadata",(function(){var e=r.media();s.playlist(e,a);s.track(o.activeTrack());if(!n.paused()||e.endList&&n.preload()!=="none"){s.load()}}));r.on("loadedplaylist",(function(){s.playlist(r.media(),a);if(!n.paused()){s.load()}}));r.on("error",Yr[t](t,i))}};var Jr=function e(t,r){return function(e){return e.attributes[t]===r}};var Qr=function e(t){return function(e){return e.resolvedUri===t}};var $r={AUDIO:function e(t,r){var i=r.hls,n=r.sourceType,a=r.segmentLoaders[t],s=r.requestOptions.withCredentials,o=r.master,l=o.mediaGroups,d=o.playlists,f=r.mediaTypes[t],c=f.groups,h=f.tracks,p=r.masterPlaylistLoader;if(!l[t]||Object.keys(l[t]).length===0){l[t]={main:{default:{default:true}}}}for(var v in l[t]){if(!c[v]){c[v]=[]}var m=d.filter(Jr(t,v));for(var g in l[t][v]){var y=l[t][v][g];var _=m.filter(Qr(y.resolvedUri));if(_.length){delete y.resolvedUri}var b=void 0;if(y.resolvedUri){b=new ae(y.resolvedUri,i,s)}else if(y.playlists&&n==="dash"){b=new $t(y.playlists[0],i,s,p)}else{b=null}y=u.a.mergeOptions({id:g,playlistLoader:b},y);Xr[t](t,y.playlistLoader,r);c[v].push(y);if(typeof h[g]==="undefined"){var T=new u.a.AudioTrack({id:g,kind:Gr(y),enabled:false,language:y.language,default:y.default,label:g});h[g]=T}}}a.on("error",Yr[t](t,r))},SUBTITLES:function e(t,r){var i=r.tech,n=r.hls,a=r.sourceType,s=r.segmentLoaders[t],o=r.requestOptions.withCredentials,l=r.master.mediaGroups,d=r.mediaTypes[t],f=d.groups,c=d.tracks,h=r.masterPlaylistLoader;for(var p in l[t]){if(!f[p]){f[p]=[]}for(var v in l[t][p]){if(l[t][p][v].forced){continue}var m=l[t][p][v];var g=void 0;if(a==="hls"){g=new ae(m.resolvedUri,n,o)}else if(a==="dash"){g=new $t(m.playlists[0],n,o,h)}m=u.a.mergeOptions({id:v,playlistLoader:g},m);Xr[t](t,m.playlistLoader,r);f[p].push(m);if(typeof c[v]==="undefined"){var y=i.addRemoteTextTrack({id:v,kind:"subtitles",default:m.default&&m.autoselect,language:m.language,label:v},false).track;c[v]=y}}}s.on("error",Yr[t](t,r))},"CLOSED-CAPTIONS":function e(t,r){var i=r.tech,n=r.master.mediaGroups,a=r.mediaTypes[t],s=a.groups,o=a.tracks;for(var l in n[t]){if(!s[l]){s[l]=[]}for(var d in n[t][l]){var f=n[t][l][d];if(!f.instreamId.match(/CC\d/)){continue}s[l].push(u.a.mergeOptions({id:d},f));if(typeof o[d]==="undefined"){var c=i.addRemoteTextTrack({id:f.instreamId,kind:"captions",default:f.default&&f.autoselect,language:f.language,label:d},false).track;o[d]=c}}}}};var Zr=function e(t,r){return function(e){var i=r.masterPlaylistLoader,n=r.mediaTypes[t].groups;var a=i.media();if(!a){return null}var s=null;if(a.attributes[t]){s=n[a.attributes[t]]}s=s||n.main;if(typeof e==="undefined"){return s}if(e===null){return null}return s.filter((function(t){return t.id===e.id}))[0]||null}};var ei={AUDIO:function e(t,r){return function(){var e=r.mediaTypes[t].tracks;for(var i in e){if(e[i].enabled){return e[i]}}return null}},SUBTITLES:function e(t,r){return function(){var e=r.mediaTypes[t].tracks;for(var i in e){if(e[i].mode==="showing"){return e[i]}}return null}}};var ti=function e(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(e){$r[e](e,t)}));var r=t.mediaTypes,i=t.masterPlaylistLoader,n=t.tech,a=t.hls;["AUDIO","SUBTITLES"].forEach((function(e){r[e].activeGroup=Zr(e,t);r[e].activeTrack=ei[e](e,t);r[e].onGroupChanged=zr(e,t);r[e].onTrackChanged=Kr(e,t)}));var s=r.AUDIO.activeGroup();var o=(s.filter((function(e){return e.default}))[0]||s[0]).id;r.AUDIO.tracks[o].enabled=true;r.AUDIO.onTrackChanged();i.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return r[e].onGroupChanged()}))}));var u=function e(){r.AUDIO.onTrackChanged();n.trigger({type:"usage",name:"hls-audio-change"})};n.audioTracks().addEventListener("change",u);n.remoteTextTracks().addEventListener("change",r.SUBTITLES.onTrackChanged);a.on("dispose",(function(){n.audioTracks().removeEventListener("change",u);n.remoteTextTracks().removeEventListener("change",r.SUBTITLES.onTrackChanged)}));n.clearTracks("audio");for(var l in r.AUDIO.tracks){n.audioTracks().addTrack(r.AUDIO.tracks[l])}};var ri=function e(){var t={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:er,activeTrack:er,onGroupChanged:er,onTrackChanged:er}}));return t};var ii=60*2;var ni=void 0;var ai=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"];var si=function e(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]};var oi=function(e){z(t,e);function t(e){G(this,t);var r=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));var i=e.url,n=e.withCredentials,a=e.tech,s=e.bandwidth,o=e.externHls,l=e.useCueTags,d=e.blacklistDuration,f=e.enableLowInitialPlaylist,c=e.sourceType,h=e.seekTo;if(!i){throw new Error("A non-empty playlist URL is required")}ni=o;r.withCredentials=n;r.tech_=a;r.hls_=a.hls;r.seekTo_=h;r.sourceType_=c;r.useCueTags_=l;r.blacklistDuration=d;r.enableLowInitialPlaylist=f;if(r.useCueTags_){r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues");r.cueTagsTrack_.inBandMetadataTrackDispatchType=""}r.requestOptions_={withCredentials:r.withCredentials,timeout:null};r.mediaTypes_=ri();r.mediaSource=new u.a.MediaSource;r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_.bind(r));r.seekable_=u.a.createTimeRanges();r.hasPlayed_=function(){return false};r.syncController_=new Hr(e);r.segmentMetadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},false).track;r.decrypter_=new qr;r.inbandTextTracks_={};var p={hls:r.hls_,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function e(){return r.seekable()},seeking:function e(){return r.tech_.seeking()},duration:function e(){return r.mediaSource.duration},hasPlayed:function e(){return r.hasPlayed_()},goalBufferLength:function e(){return r.goalBufferLength()},bandwidth:s,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_,inbandTextTracks:r.inbandTextTracks_};r.masterPlaylistLoader_=r.sourceType_==="dash"?new $t(i,r.hls_,r.withCredentials):new ae(i,r.hls_,r.withCredentials);r.setupMasterPlaylistLoaderListeners_();r.mainSegmentLoader_=new Rr(u.a.mergeOptions(p,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),e);r.audioSegmentLoader_=new Rr(u.a.mergeOptions(p,{loaderType:"audio"}),e);r.subtitleSegmentLoader_=new Mr(u.a.mergeOptions(p,{loaderType:"vtt"}),e);r.setupSegmentLoaderListeners_();ai.forEach((function(e){r[e+"_"]=si.bind(r,e)}));r.logger_=Zt("MPC");r.masterPlaylistLoader_.load();return r}V(t,[{key:"setupMasterPlaylistLoaderListeners_",value:function e(){var t=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var e=t.masterPlaylistLoader_.media();var r=e.targetDuration*1.5*1e3;if(Le(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())){t.requestOptions_.timeout=0}else{t.requestOptions_.timeout=r}if(e.endList&&t.tech_.preload()!=="none"){t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.mainSegmentLoader_.load()}ti({sourceType:t.sourceType_,segmentLoaders:{AUDIO:t.audioSegmentLoader_,SUBTITLES:t.subtitleSegmentLoader_,main:t.mainSegmentLoader_},tech:t.tech_,requestOptions:t.requestOptions_,masterPlaylistLoader:t.masterPlaylistLoader_,hls:t.hls_,master:t.master(),mediaTypes:t.mediaTypes_,blacklistCurrentPlaylist:t.blacklistCurrentPlaylist.bind(t)});t.triggerPresenceUsage_(t.master(),e);try{t.setupSourceBuffers_()}catch(e){u.a.log.warn("Failed to create SourceBuffers",e);return t.mediaSource.endOfStream("decode")}t.setupFirstPlay();if(!t.mediaTypes_.AUDIO.activePlaylistLoader||t.mediaTypes_.AUDIO.activePlaylistLoader.media()){t.trigger("selectedinitialmedia")}else{t.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){t.trigger("selectedinitialmedia")}))}}));this.masterPlaylistLoader_.on("loadedplaylist",(function(){var e=t.masterPlaylistLoader_.media();if(!e){t.excludeUnsupportedVariants_();var r=void 0;if(t.enableLowInitialPlaylist){r=t.selectInitialPlaylist()}if(!r){r=t.selectPlaylist()}t.initialMedia_=r;t.masterPlaylistLoader_.media(t.initialMedia_);return}if(t.useCueTags_){t.updateAdCues_(e)}t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.updateDuration();if(!t.tech_.paused()){t.mainSegmentLoader_.load();if(t.audioSegmentLoader_){t.audioSegmentLoader_.load()}}if(!e.endList){var i=function e(){var r=t.seekable();if(r.length!==0){t.mediaSource.addSeekableRange_(r.start(0),r.end(0))}};if(t.duration()!==Infinity){var n=function e(){if(t.duration()===Infinity){i()}else{t.tech_.one("durationchange",e)}};t.tech_.one("durationchange",n)}else{i()}}}));this.masterPlaylistLoader_.on("error",(function(){t.blacklistCurrentPlaylist(t.masterPlaylistLoader_.error)}));this.masterPlaylistLoader_.on("mediachanging",(function(){t.mainSegmentLoader_.abort();t.mainSegmentLoader_.pause()}));this.masterPlaylistLoader_.on("mediachange",(function(){var e=t.masterPlaylistLoader_.media();var r=e.targetDuration*1.5*1e3;if(Le(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())){t.requestOptions_.timeout=0}else{t.requestOptions_.timeout=r}t.mainSegmentLoader_.playlist(e,t.requestOptions_);t.mainSegmentLoader_.load();t.tech_.trigger({type:"mediachange",bubbles:true})}));this.masterPlaylistLoader_.on("playlistunchanged",(function(){var e=t.masterPlaylistLoader_.media();var r=t.stuckAtPlaylistEnd_(e);if(r){t.blacklistCurrentPlaylist({message:"Playlist no longer updating."});t.tech_.trigger("playliststuck")}}));this.masterPlaylistLoader_.on("renditiondisabled",(function(){t.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}));this.masterPlaylistLoader_.on("renditionenabled",(function(){t.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))}},{key:"triggerPresenceUsage_",value:function e(t,r){var i=t.mediaGroups||{};var n=true;var a=Object.keys(i.AUDIO);for(var s in i.AUDIO){for(var o in i.AUDIO[s]){var u=i.AUDIO[s][o];if(!u.uri){n=false}}}if(n){this.tech_.trigger({type:"usage",name:"hls-demuxed"})}if(Object.keys(i.SUBTITLES).length){this.tech_.trigger({type:"usage",name:"hls-webvtt"})}if(ni.Playlist.isAes(r)){this.tech_.trigger({type:"usage",name:"hls-aes"})}if(ni.Playlist.isFmp4(r)){this.tech_.trigger({type:"usage",name:"hls-fmp4"})}if(a.length&&Object.keys(i.AUDIO[a[0]]).length>1){this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})}if(this.useCueTags_){this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}}},{key:"setupSegmentLoaderListeners_",value:function e(){var t=this;this.mainSegmentLoader_.on("bandwidthupdate",(function(){var e=t.selectPlaylist();var r=t.masterPlaylistLoader_.media();var i=t.tech_.buffered();var n=i.length?i.end(i.length-1)-t.tech_.currentTime():0;var a=t.bufferLowWaterLine();if(!r.endList||t.duration()<rr.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<r.attributes.BANDWIDTH||n>=a){t.masterPlaylistLoader_.media(e)}t.tech_.trigger("bandwidthupdate")}));this.mainSegmentLoader_.on("progress",(function(){t.trigger("progress")}));this.mainSegmentLoader_.on("error",(function(){t.blacklistCurrentPlaylist(t.mainSegmentLoader_.error())}));this.mainSegmentLoader_.on("syncinfoupdate",(function(){t.onSyncInfoUpdate_()}));this.mainSegmentLoader_.on("timestampoffset",(function(){t.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}));this.audioSegmentLoader_.on("syncinfoupdate",(function(){t.onSyncInfoUpdate_()}));this.mainSegmentLoader_.on("ended",(function(){t.onEndOfStream()}));this.mainSegmentLoader_.on("earlyabort",(function(){t.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the "+"request without rebuffering."},ii)}));this.mainSegmentLoader_.on("reseteverything",(function(){t.tech_.trigger("hls-reset")}));this.mainSegmentLoader_.on("segmenttimemapping",(function(e){t.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})}));this.audioSegmentLoader_.on("ended",(function(){t.onEndOfStream()}))}},{key:"mediaSecondsLoaded_",value:function e(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function e(){this.mainSegmentLoader_.load();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.load()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.load()}}},{key:"smoothQualityChange_",value:function e(){var t=this.selectPlaylist();if(t!==this.masterPlaylistLoader_.media()){this.masterPlaylistLoader_.media(t);this.mainSegmentLoader_.resetLoader()}}},{key:"fastQualityChange_",value:function e(){var t=this;var r=this.selectPlaylist();if(r===this.masterPlaylistLoader_.media()){return}this.masterPlaylistLoader_.media(r);this.mainSegmentLoader_.resetEverything((function(){if(u.a.browser.IE_VERSION||u.a.browser.IS_EDGE){t.tech_.setCurrentTime(t.tech_.currentTime()+.04)}else{t.tech_.setCurrentTime(t.tech_.currentTime())}}))}},{key:"play",value:function e(){if(this.setupFirstPlay()){return}if(this.tech_.ended()){this.seekTo_(0)}if(this.hasPlayed_()){this.load()}var t=this.tech_.seekable();if(this.tech_.duration()===Infinity){if(this.tech_.currentTime()<t.start(0)){return this.seekTo_(t.end(t.length-1))}}}},{key:"setupFirstPlay",value:function e(){var t=this;var r=this.masterPlaylistLoader_.media();if(!r||this.tech_.paused()||this.hasPlayed_()){return false}if(!r.endList){var i=this.seekable();if(!i.length){return false}if(u.a.browser.IE_VERSION&&this.tech_.readyState()===0){this.tech_.one("loadedmetadata",(function(){t.trigger("firstplay");t.seekTo_(i.end(0));t.hasPlayed_=function(){return true}}));return false}this.trigger("firstplay");this.seekTo_(i.end(0))}this.hasPlayed_=function(){return true};this.load();return true}},{key:"handleSourceOpen_",value:function e(){try{this.setupSourceBuffers_()}catch(e){u.a.log.warn("Failed to create Source Buffers",e);return this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var t=this.tech_.play();if(typeof t!=="undefined"&&typeof t.then==="function"){t.then(null,(function(e){}))}}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function e(){var t=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo){t=t&&this.audioSegmentLoader_.ended_}else{t=this.audioSegmentLoader_.ended_}}if(!t){return}this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){u.a.log.warn("Failed to call media source endOfStream",e)}}},{key:"stuckAtPlaylistEnd_",value:function e(t){var r=this.seekable();if(!r.length){return false}var i=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(i===null){return false}var n=ni.Playlist.playlistEnd(t,i);var a=this.tech_.currentTime();var s=this.tech_.buffered();if(!s.length){return n-a<=$e}var o=s.end(s.length-1);return o-a<=$e&&n-o<=$e}},{key:"blacklistCurrentPlaylist",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments[1];var i=void 0;var n=void 0;i=t.playlist||this.masterPlaylistLoader_.media();r=r||t.blacklistDuration||this.blacklistDuration;if(!i){this.error=t;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var a=this.masterPlaylistLoader_.master.playlists.filter(Se).length===1;if(a){u.a.log.warn("Problem encountered with the current "+"HLS playlist. Trying again since it is the final playlist.");this.tech_.trigger("retryplaylist");return this.masterPlaylistLoader_.load(a)}i.excludeUntil=Date.now()+r*1e3;this.tech_.trigger("blacklistplaylist");this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});n=this.selectPlaylist();u.a.log.warn("Problem encountered with the current HLS playlist."+(t.message?" "+t.message:"")+" Switching to another playlist.");return this.masterPlaylistLoader_.media(n)}},{key:"pauseLoading",value:function e(){this.mainSegmentLoader_.pause();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.pause()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.pause()}}},{key:"setCurrentTime",value:function e(t){var r=et(this.tech_.buffered(),t);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())){return 0}if(!this.masterPlaylistLoader_.media().segments){return 0}if(r&&r.length){return t}this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();if(this.mediaTypes_.AUDIO.activePlaylistLoader){this.audioSegmentLoader_.resetEverything();this.audioSegmentLoader_.abort()}if(this.mediaTypes_.SUBTITLES.activePlaylistLoader){this.subtitleSegmentLoader_.resetEverything();this.subtitleSegmentLoader_.abort()}this.load()}},{key:"duration",value:function e(){if(!this.masterPlaylistLoader_){return 0}if(this.mediaSource){return this.mediaSource.duration}return ni.Playlist.duration(this.masterPlaylistLoader_.media())}},{key:"seekable",value:function e(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function e(){var t=void 0;var r=void 0;if(!this.masterPlaylistLoader_){return}var i=this.masterPlaylistLoader_.media();if(!i){return}var n=this.syncController_.getExpiredTime(i,this.mediaSource.duration);if(n===null){return}t=ni.Playlist.seekable(i,n);if(t.length===0){return}if(this.mediaTypes_.AUDIO.activePlaylistLoader){i=this.mediaTypes_.AUDIO.activePlaylistLoader.media();n=this.syncController_.getExpiredTime(i,this.mediaSource.duration);if(n===null){return}r=ni.Playlist.seekable(i,n);if(r.length===0){return}}var a=void 0;var s=void 0;if(this.seekable_&&this.seekable_.length){a=this.seekable_.end(0);s=this.seekable_.start(0)}if(!r){this.seekable_=t}else if(r.start(0)>t.end(0)||t.start(0)>r.end(0)){this.seekable_=t}else{this.seekable_=u.a.createTimeRanges([[r.start(0)>t.start(0)?r.start(0):t.start(0),r.end(0)<t.end(0)?r.end(0):t.end(0)]])}if(this.seekable_&&this.seekable_.length){if(this.seekable_.end(0)===a&&this.seekable_.start(0)===s){return}}this.logger_("seekable updated ["+it(this.seekable_)+"]");this.tech_.trigger("seekablechanged")}},{key:"updateDuration",value:function e(){var t=this;var r=this.mediaSource.duration;var i=ni.Playlist.duration(this.masterPlaylistLoader_.media());var n=this.tech_.buffered();var a=function e(){t.logger_("Setting duration from "+t.mediaSource.duration+" => "+i);try{t.mediaSource.duration=i}catch(e){u.a.log.warn("Failed to set media source duration",e)}t.tech_.trigger("durationchange");t.mediaSource.removeEventListener("sourceopen",e)};if(n.length>0){i=Math.max(i,n.end(n.length-1))}if(r!==i){if(this.mediaSource.readyState!=="open"){this.mediaSource.addEventListener("sourceopen",a)}else{a()}}}},{key:"dispose",value:function e(){var t=this;this.decrypter_.terminate();this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();["AUDIO","SUBTITLES"].forEach((function(e){var r=t.mediaTypes_[e].groups;for(var i in r){r[i].forEach((function(e){if(e.playlistLoader){e.playlistLoader.dispose()}}))}}));this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function e(){return this.masterPlaylistLoader_.master}},{key:"media",value:function e(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function e(){var t=this.masterPlaylistLoader_.media();var r=void 0;if(!t||this.mediaSource.readyState!=="open"){return}r=Ot(this.masterPlaylistLoader_.master,t);if(r.length<1){this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri;return this.mediaSource.endOfStream("decode")}this.configureLoaderMimeTypes_(r);this.excludeIncompatibleVariants_(t)}},{key:"configureLoaderMimeTypes_",value:function e(t){var r=t.length>1&&t[0].indexOf(",")===-1&&t[0]!==t[1]?new u.a.EventTarget:null;this.mainSegmentLoader_.mimeType(t[0],r);if(t[1]){this.audioSegmentLoader_.mimeType(t[1],r)}}},{key:"excludeUnsupportedVariants_",value:function e(){this.master().playlists.forEach((function(e){if(e.attributes.CODECS&&s.a.MediaSource&&s.a.MediaSource.isTypeSupported&&!s.a.MediaSource.isTypeSupported('video/mp4; codecs="'+Ct(e.attributes.CODECS)+'"')){e.excludeUntil=Infinity}}))}},{key:"excludeIncompatibleVariants_",value:function e(t){var r=2;var i=null;var n=void 0;if(t.attributes.CODECS){n=At(t.attributes.CODECS);i=n.videoCodec;r=n.codecCount}this.master().playlists.forEach((function(e){var t={codecCount:2,videoCodec:null};if(e.attributes.CODECS){t=At(e.attributes.CODECS)}if(t.codecCount!==r){e.excludeUntil=Infinity}if(t.videoCodec!==i){e.excludeUntil=Infinity}}))}},{key:"updateAdCues_",value:function e(t){var r=0;var i=this.seekable();if(i.length){r=i.start(0)}jr(t,this.cueTagsTrack_,r)}},{key:"goalBufferLength",value:function e(){var t=this.tech_.currentTime();var r=rr.GOAL_BUFFER_LENGTH;var i=rr.GOAL_BUFFER_LENGTH_RATE;var n=Math.max(r,rr.MAX_GOAL_BUFFER_LENGTH);return Math.min(r+t*i,n)}},{key:"bufferLowWaterLine",value:function e(){var t=this.tech_.currentTime();var r=rr.BUFFER_LOW_WATER_LINE;var i=rr.BUFFER_LOW_WATER_LINE_RATE;var n=Math.max(r,rr.MAX_BUFFER_LOW_WATER_LINE);return Math.min(r+t*i,n)}}]);return t}(u.a.EventTarget);var ui=function e(t,r,i){return function(e){var n=t.master.playlists[r];var a=Te(n);var s=Se(n);if(typeof e==="undefined"){return s}if(e){delete n.disabled}else{n.disabled=true}if(e!==s&&!a){i();if(e){t.trigger("renditionenabled")}else{t.trigger("renditiondisabled")}}return e}};var li=function e(t,r,i){G(this,e);var n=t.masterPlaylistController_,a=t.options_.smoothQualityChange;var s=a?"smooth":"fast";var o=n[s+"QualityChange_"].bind(n);if(r.attributes.RESOLUTION){var u=r.attributes.RESOLUTION;this.width=u.width;this.height=u.height}this.bandwidth=r.attributes.BANDWIDTH;this.id=i;this.enabled=ui(t.playlists,r.uri,o)};var di=function e(t){var r=t.playlists;t.representations=function(){return r.master.playlists.filter((function(e){return!Te(e)})).map((function(e,r){return new li(t,e,e.uri)}))}};var fi=["seeking","seeked","pause","playing","error"];var ci=function(){function e(t){var r=this;G(this,e);this.tech_=t.tech;this.seekable=t.seekable;this.seekTo=t.seekTo;this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow;this.media=t.media;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=Zt("PlaybackWatcher");this.logger_("initialize");var i=function e(){return r.monitorCurrentTime_()};var n=function e(){return r.techWaiting_()};var a=function e(){return r.cancelTimer_()};var o=function e(){return r.fixesBadSeeks_()};this.tech_.on("seekablechanged",o);this.tech_.on("waiting",n);this.tech_.on(fi,a);this.tech_.on("canplay",i);this.dispose=function(){r.logger_("dispose");r.tech_.off("seekablechanged",o);r.tech_.off("waiting",n);r.tech_.off(fi,a);r.tech_.off("canplay",i);if(r.checkCurrentTimeTimeout_){s.a.clearTimeout(r.checkCurrentTimeTimeout_)}r.cancelTimer_()}}V(e,[{key:"monitorCurrentTime_",value:function e(){this.checkCurrentTime_();if(this.checkCurrentTimeTimeout_){s.a.clearTimeout(this.checkCurrentTimeTimeout_)}this.checkCurrentTimeTimeout_=s.a.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function e(){if(this.tech_.seeking()&&this.fixesBadSeeks_()){this.consecutiveUpdates=0;this.lastRecordedTime=this.tech_.currentTime();return}if(this.tech_.paused()||this.tech_.seeking()){return}var t=this.tech_.currentTime();var r=this.tech_.buffered();if(this.lastRecordedTime===t&&(!r.length||t+$e>=r.end(r.length-1))){return this.techWaiting_()}if(this.consecutiveUpdates>=5&&t===this.lastRecordedTime){this.consecutiveUpdates++;this.waiting_()}else if(t===this.lastRecordedTime){this.consecutiveUpdates++}else{this.consecutiveUpdates=0;this.lastRecordedTime=t}}},{key:"cancelTimer_",value:function e(){this.consecutiveUpdates=0;if(this.timer_){this.logger_("cancelTimer_");clearTimeout(this.timer_)}this.timer_=null}},{key:"fixesBadSeeks_",value:function e(){var t=this.tech_.seeking();if(!t){return false}var r=this.seekable();var i=this.tech_.currentTime();var n=this.afterSeekableWindow_(r,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);var a=void 0;if(n){var s=r.end(r.length-1);a=s}if(this.beforeSeekableWindow_(r,i)){var o=r.start(0);a=o+$e}if(typeof a!=="undefined"){this.logger_("Trying to seek outside of seekable at time "+i+" with "+("seekable range "+it(r)+". Seeking to ")+(a+"."));this.seekTo(a);return true}return false}},{key:"waiting_",value:function e(){if(this.techWaiting_()){return}var t=this.tech_.currentTime();var r=this.tech_.buffered();var i=et(r,t);if(i.length&&t+3<=i.end(0)){this.cancelTimer_();this.seekTo(t);this.logger_("Stopped at "+t+" while inside a buffered region "+("["+i.start(0)+" -> "+i.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time.");this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}},{key:"techWaiting_",value:function e(){var t=this.seekable();var r=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_()){return true}if(this.tech_.seeking()||this.timer_!==null){return true}if(this.beforeSeekableWindow_(t,r)){var i=t.end(t.length-1);this.logger_("Fell out of live window at time "+r+". Seeking to "+("live point (seekable end) "+i));this.cancelTimer_();this.seekTo(i);this.tech_.trigger({type:"usage",name:"hls-live-resync"});return true}var n=this.tech_.buffered();var a=tt(n,r);if(this.videoUnderflow_(a,n,r)){this.cancelTimer_();this.seekTo(r);this.tech_.trigger({type:"usage",name:"hls-video-underflow"});return true}if(a.length>0){var s=a.start(0)-r;this.logger_("Stopped at "+r+", setting timer for "+s+", seeking "+("to "+a.start(0)));this.timer_=setTimeout(this.skipTheGap_.bind(this),s*1e3,r);return true}return false}},{key:"afterSeekableWindow_",value:function e(t,r,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(!t.length){return false}var a=t.end(t.length-1)+$e;var s=!i.endList;if(s&&n){a=t.end(t.length-1)+i.targetDuration*3}if(r>a){return true}return false}},{key:"beforeSeekableWindow_",value:function e(t,r){if(t.length&&t.start(0)>0&&r<t.start(0)-$e){return true}return false}},{key:"videoUnderflow_",value:function e(t,r,i){if(t.length===0){var n=this.gapFromVideoUnderflow_(r,i);if(n){this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". "+("Seeking to current time "+i));return true}}return false}},{key:"skipTheGap_",value:function e(t){var r=this.tech_.buffered();var i=this.tech_.currentTime();var n=tt(r,i);this.cancelTimer_();if(n.length===0||i!==t){return}this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",t,"nextRange start:",n.start(0));this.seekTo(n.start(0)+Qe);this.tech_.trigger({type:"usage",name:"hls-gap-skip"})}},{key:"gapFromVideoUnderflow_",value:function e(t,r){var i=rt(t);for(var n=0;n<i.length;n++){var a=i.start(n);var s=i.end(n);if(r-a<4&&r-a>2){return{start:a,end:s}}}return null}}]);return e}();var hi={errorInterval:30,getSource:function e(t){var r=this.tech({IWillNotUseThisInPlugins:true});var i=r.currentSource_;return t(i)}};var pi=function e(t,r){var i=0;var n=0;var a=u.a.mergeOptions(hi,r);t.ready((function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})}));var s=function e(){if(n){t.currentTime(n)}};var o=function e(r){if(r===null||r===undefined){return}n=t.duration()!==Infinity&&t.currentTime()||0;t.one("loadedmetadata",s);t.src(r);t.trigger({type:"usage",name:"hls-error-reload"});t.play()};var l=function e(){if(Date.now()-i<a.errorInterval*1e3){t.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!a.getSource||typeof a.getSource!=="function"){u.a.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}i=Date.now();return a.getSource.call(t,o)};var d=function e(){t.off("loadedmetadata",s);t.off("error",l);t.off("dispose",e)};var f=function r(i){d();e(t,i)};t.on("error",l);t.on("dispose",d);t.reloadSourceOnError=f};var vi=function e(t){pi(this,t)};var mi="1.9.1";u.a.use("*",(function(e){return{setSource:function e(t,r){r(null,t)},setCurrentTime:function t(r){if(e.vhs&&e.currentSource().src===e.vhs.source_.src){e.vhs.setCurrentTime(r)}return r},play:function t(){if(e.vhs&&e.currentSource().src===e.vhs.source_.src){e.vhs.setCurrentTime(e.tech_.currentTime())}}}}));var gi={PlaylistLoader:ae,Playlist:xe,Decrypter:H,AsyncStream:j,decrypt:F,utils:He,STANDARD_PLAYLIST_SELECTOR:Sr,INITIAL_PLAYLIST_SELECTOR:wr,comparePlaylistBandwidth:_r,comparePlaylistResolution:br,xhr:Oe()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach((function(e){Object.defineProperty(gi,e,{get:function t(){u.a.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing");return rr[e]},set:function t(r){u.a.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing");if(typeof r!=="number"||r<0){u.a.log.warn("value of Hls."+e+" must be greater than or equal to 0");return}rr[e]=r}})}));var yi="videojs-vhs";var _i=function e(t){var r=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;if(r.test(t)){return"hls"}var i=/^application\/dash\+xml/i;if(i.test(t)){return"dash"}return null};var bi=function e(t,r){var i=r.media();var n=-1;for(var a=0;a<t.length;a++){if(t[a].id===i.uri){n=a;break}}t.selectedIndex_=n;t.trigger({selectedIndex:n,type:"change"})};var Ti=function e(t,r){r.representations().forEach((function(e){t.addQualityLevel(e)}));bi(t,r.playlists)};gi.canPlaySource=function(){return u.a.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var Si=function e(t,r,i){if(!t){return t}var n={};for(var a in t){n[a]={audioContentType:'audio/mp4; codecs="'+i.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+r.attributes.CODECS+'"'};if(r.contentProtection&&r.contentProtection[a]&&r.contentProtection[a].pssh){n[a].pssh=r.contentProtection[a].pssh}if(typeof t[a]==="string"){n[a].url=t[a]}}return u.a.mergeOptions(t,n)};var Ei=function e(t){if(t.options_.sourceType!=="dash"){return}var r=u.a.players[t.tech_.options_.playerId];if(r.eme){var i=Si(t.source_.keySystems,t.playlists.media(),t.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());if(i){r.currentSource().keySystems=i;if(r.eme.initializeMediaKeys){r.eme.initializeMediaKeys()}}}};var wi=function e(){if(!window.localStorage){return null}var t=window.localStorage.getItem(yi);if(!t){return null}try{return JSON.parse(t)}catch(e){return null}};var ki=function e(t){if(!window.localStorage){return false}var r=wi();r=r?u.a.mergeOptions(r,t):t;try{window.localStorage.setItem(yi,JSON.stringify(r))}catch(e){return false}return r};gi.supportsNativeHls=function(){var e=_.a.createElement("video");if(!u.a.getTech("Html5").isSupported()){return false}var t=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return t.some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}();gi.supportsNativeDash=function(){if(!u.a.getTech("Html5").isSupported()){return false}return/maybe|probably/i.test(_.a.createElement("video").canPlayType("application/dash+xml"))}();gi.supportsTypeNatively=function(e){if(e==="hls"){return gi.supportsNativeHls}if(e==="dash"){return gi.supportsNativeDash}return false};gi.isSupported=function(){return u.a.log.warn("HLS is no longer a tech. Please remove it from "+"your player's techOrder.")};var Ai=u.a.getComponent("Component");var Ci=function(e){z(t,e);function t(e,r,i){G(this,t);var n=K(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,i.hls));if(r.options_&&r.options_.playerId){var a=u()(r.options_.playerId);if(!a.hasOwnProperty("hls")){Object.defineProperty(a,"hls",{get:function e(){u.a.log.warn("player.hls is deprecated. Use player.tech().hls instead.");r.trigger({type:"usage",name:"hls-player-access"});return n},configurable:true})}a.vhs=n;a.dash=n;n.player_=a}n.tech_=r;n.source_=e;n.stats={};n.setOptions_();if(n.options_.overrideNative&&r.overrideNativeAudioTracks&&r.overrideNativeVideoTracks){r.overrideNativeAudioTracks(true);r.overrideNativeVideoTracks(true)}else if(n.options_.overrideNative&&(r.featuresNativeVideoTracks||r.featuresNativeAudioTracks)){throw new Error("Overriding native HLS requires emulated tracks. "+"See https://git.io/vMpjB")}n.on(_.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var t=_.a.fullscreenElement||_.a.webkitFullscreenElement||_.a.mozFullScreenElement||_.a.msFullscreenElement;if(t&&t.contains(n.tech_.el())){n.masterPlaylistController_.smoothQualityChange_()}}));n.on(n.tech_,"seeking",(function(){if(this.tech_.currentTime()===0&&this.tech_.player_.loop()){this.setCurrentTime(0)}}));n.on(n.tech_,"error",(function(){if(this.masterPlaylistController_){this.masterPlaylistController_.pauseLoading()}}));n.on(n.tech_,"play",n.play);return n}V(t,[{key:"setOptions_",value:function e(){var t=this;this.options_.withCredentials=this.options_.withCredentials||false;this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions===false?false:true;this.options_.smoothQualityChange=this.options_.smoothQualityChange||false;this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!=="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||false;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];if(typeof this.options_.blacklistDuration!=="number"){this.options_.blacklistDuration=5*60}if(typeof this.options_.bandwidth!=="number"){if(this.options_.useBandwidthFromLocalStorage){var r=wi();if(r&&r.bandwidth){this.options_.bandwidth=r.bandwidth;this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})}if(r&&r.throughput){this.options_.throughput=r.throughput;this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})}}}if(typeof this.options_.bandwidth!=="number"){this.options_.bandwidth=rr.INITIAL_BANDWIDTH}this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===rr.INITIAL_BANDWIDTH;["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers"].forEach((function(e){if(typeof t.source_[e]!=="undefined"){t.options_[e]=t.source_[e]}}));this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function e(t,r){var i=this;if(!t){return}this.setOptions_();this.options_.url=this.source_.src;this.options_.tech=this.tech_;this.options_.externHls=gi;this.options_.sourceType=_i(r);this.options_.seekTo=function(e){i.tech_.setCurrentTime(e);i.setCurrentTime(e)};this.masterPlaylistController_=new oi(this.options_);this.playbackWatcher_=new ci(u.a.mergeOptions(this.options_,{seekable:function e(){return i.seekable()},media:function e(){return i.masterPlaylistController_.media()}}));this.masterPlaylistController_.on("error",(function(){var e=u.a.players[i.tech_.options_.playerId];e.error(i.masterPlaylistController_.error)}));this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):gi.STANDARD_PLAYLIST_SELECTOR.bind(this);this.masterPlaylistController_.selectInitialPlaylist=gi.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function e(){return this.masterPlaylistController_.selectPlaylist},set:function e(t){this.masterPlaylistController_.selectPlaylist=t.bind(this)}},throughput:{get:function e(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function e(t){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=t;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function e(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function e(t){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=t;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function e(){var t=1/(this.bandwidth||1);var r=void 0;if(this.throughput>0){r=1/this.throughput}else{r=0}var i=Math.floor(1/(t+r));return i},set:function e(){u.a.log.error('The "systemBandwidth" property is read-only')}}});if(this.options_.bandwidth){this.bandwidth=this.options_.bandwidth}if(this.options_.throughput){this.throughput=this.options_.throughput}Object.defineProperties(this.stats,{bandwidth:{get:function e(){return i.bandwidth||0},enumerable:true},mediaRequests:{get:function e(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:true},mediaRequestsAborted:{get:function e(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:true},mediaRequestsTimedout:{get:function e(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:true},mediaRequestsErrored:{get:function e(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:true},mediaTransferDuration:{get:function e(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:true},mediaBytesTransferred:{get:function e(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:true},mediaSecondsLoaded:{get:function e(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:true},buffered:{get:function e(){return at(i.tech_.buffered())},enumerable:true},currentTime:{get:function e(){return i.tech_.currentTime()},enumerable:true},currentSource:{get:function e(){return i.tech_.currentSource_},enumerable:true},currentTech:{get:function e(){return i.tech_.name_},enumerable:true},duration:{get:function e(){return i.tech_.duration()},enumerable:true},master:{get:function e(){return i.playlists.master},enumerable:true},playerDimensions:{get:function e(){return i.tech_.currentDimensions()},enumerable:true},seekable:{get:function e(){return at(i.tech_.seekable())},enumerable:true},timestamp:{get:function e(){return Date.now()},enumerable:true},videoPlaybackQuality:{get:function e(){return i.tech_.getVideoPlaybackQuality()},enumerable:true}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",(function(){if(i.options_.useBandwidthFromLocalStorage){ki({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}}));this.masterPlaylistController_.on("selectedinitialmedia",(function(){di(i);Ei(i)}));this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")}));this.tech_.ready((function(){return i.setupQualityLevels_()}));if(!this.tech_.el()){return}this.tech_.src(u.a.URL.createObjectURL(this.masterPlaylistController_.mediaSource))}},{key:"setupQualityLevels_",value:function e(){var t=this;var r=u.a.players[this.tech_.options_.playerId];if(r&&r.qualityLevels){this.qualityLevels_=r.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",(function(){Ti(t.qualityLevels_,t)}));this.playlists.on("mediachange",(function(){bi(t.qualityLevels_,t.playlists)}))}}},{key:"play",value:function e(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function e(t){this.masterPlaylistController_.setCurrentTime(t)}},{key:"duration",value:function e(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function e(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function e(){if(this.playbackWatcher_){this.playbackWatcher_.dispose()}if(this.masterPlaylistController_){this.masterPlaylistController_.dispose()}if(this.qualityLevels_){this.qualityLevels_.dispose()}if(this.player_){delete this.player_.vhs;delete this.player_.dash;delete this.player_.hls}if(this.tech_&&this.tech_.hls){delete this.tech_.hls}W(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function e(t,r){return Xe({playlist:this.masterPlaylistController_.media(),time:t,callback:r})}},{key:"seekToProgramTime",value:function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:2;return Je({programTime:t,playlist:this.masterPlaylistController_.media(),retryCount:n,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:r})}}]);return t}(Ai);var Li={name:"videojs-http-streaming",VERSION:mi,canHandleSource:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=u.a.mergeOptions(u.a.options,r);return Li.canPlayType(t.type,i)},handleSource:function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=u.a.mergeOptions(u.a.options,i);r.hls=new Ci(t,r,n);r.hls.xhr=Oe();r.hls.src(t.src,t.type);return r.hls},canPlayType:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=u.a.mergeOptions(u.a.options,r),n=i.hls.overrideNative;var a=_i(t);var s=a&&(!gi.supportsTypeNatively(a)||n);return s?"maybe":""}};if(typeof u.a.MediaSource==="undefined"||typeof u.a.URL==="undefined"){u.a.MediaSource=Kt;u.a.URL=Yt}if(Kt.supportsNativeMediaSources()){u.a.getTech("Html5").registerSourceHandler(Li,0)}u.a.HlsHandler=Ci;u.a.HlsSourceHandler=Li;u.a.Hls=gi;if(!u.a.use){u.a.registerComponent("Hls",gi)}u.a.options.hls=u.a.options.hls||{};if(u.a.registerPlugin){u.a.registerPlugin("reloadSourceOnError",vi)}else{u.a.plugin("reloadSourceOnError",vi)}},"./node_modules/hls.js/dist/hls.light.js":function(e,t,r){typeof window!=="undefined"&&function t(r,i){if(true)e.exports=i();else{}}(this,(function(){return function(e){var t={};function r(i){if(t[i]){return t[i].exports}var n=t[i]={i:i,l:false,exports:{}};e[i].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.d=function(e,t,i){if(!r.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:i})}};r.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};r.t=function(e,t){if(t&1)e=r(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var i=Object.create(null);r.r(i);Object.defineProperty(i,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="/dist/";return r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,n="~";function a(){}if(Object.create){a.prototype=Object.create(null);if(!(new a).__proto__)n=false}function s(e,t,r){this.fn=e;this.context=t;this.once=r||false}function o(e,t,r,i,a){if(typeof r!=="function"){throw new TypeError("The listener must be a function")}var o=new s(r,i||e,a),u=n?n+t:t;if(!e._events[u])e._events[u]=o,e._eventsCount++;else if(!e._events[u].fn)e._events[u].push(o);else e._events[u]=[e._events[u],o];return e}function u(e,t){if(--e._eventsCount===0)e._events=new a;else delete e._events[t]}function l(){this._events=new a;this._eventsCount=0}l.prototype.eventNames=function e(){var t=[],r,a;if(this._eventsCount===0)return t;for(a in r=this._events){if(i.call(r,a))t.push(n?a.slice(1):a)}if(Object.getOwnPropertySymbols){return t.concat(Object.getOwnPropertySymbols(r))}return t};l.prototype.listeners=function e(t){var r=n?n+t:t,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,s=i.length,o=new Array(s);a<s;a++){o[a]=i[a].fn}return o};l.prototype.listenerCount=function e(t){var r=n?n+t:t,i=this._events[r];if(!i)return 0;if(i.fn)return 1;return i.length};l.prototype.emit=function e(t,r,i,a,s,o){var u=n?n+t:t;if(!this._events[u])return false;var l=this._events[u],d=arguments.length,f,c;if(l.fn){if(l.once)this.removeListener(t,l.fn,undefined,true);switch(d){case 1:return l.fn.call(l.context),true;case 2:return l.fn.call(l.context,r),true;case 3:return l.fn.call(l.context,r,i),true;case 4:return l.fn.call(l.context,r,i,a),true;case 5:return l.fn.call(l.context,r,i,a,s),true;case 6:return l.fn.call(l.context,r,i,a,s,o),true}for(c=1,f=new Array(d-1);c<d;c++){f[c-1]=arguments[c]}l.fn.apply(l.context,f)}else{var h=l.length,p;for(c=0;c<h;c++){if(l[c].once)this.removeListener(t,l[c].fn,undefined,true);switch(d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,r);break;case 3:l[c].fn.call(l[c].context,r,i);break;case 4:l[c].fn.call(l[c].context,r,i,a);break;default:if(!f)for(p=1,f=new Array(d-1);p<d;p++){f[p-1]=arguments[p]}l[c].fn.apply(l[c].context,f)}}}return true};l.prototype.on=function e(t,r,i){return o(this,t,r,i,false)};l.prototype.once=function e(t,r,i){return o(this,t,r,i,true)};l.prototype.removeListener=function e(t,r,i,a){var s=n?n+t:t;if(!this._events[s])return this;if(!r){u(this,s);return this}var o=this._events[s];if(o.fn){if(o.fn===r&&(!a||o.once)&&(!i||o.context===i)){u(this,s)}}else{for(var l=0,d=[],f=o.length;l<f;l++){if(o[l].fn!==r||a&&!o[l].once||i&&o[l].context!==i){d.push(o[l])}}if(d.length)this._events[s]=d.length===1?d[0]:d;else u(this,s)}return this};l.prototype.removeAllListeners=function e(t){var r;if(t){r=n?n+t:t;if(this._events[r])u(this,r)}else{this._events=new a;this._eventsCount=0}return this};l.prototype.off=l.prototype.removeListener;l.prototype.addListener=l.prototype.on;l.prefixed=n;l.EventEmitter=l;if(true){e.exports=l}},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){(function(t){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/;var i=/^([^\/?#]*)(.*)$/;var n=/(?:\/|^)\.(?=\/)/g;var a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g;var s={buildAbsoluteURL:function(e,t,r){r=r||{};e=e.trim();t=t.trim();if(!t){if(!r.alwaysNormalize){return e}var n=s.parseURL(e);if(!n){throw new Error("Error trying to parse base URL.")}n.path=s.normalizePath(n.path);return s.buildURLFromParts(n)}var a=s.parseURL(t);if(!a){throw new Error("Error trying to parse relative URL.")}if(a.scheme){if(!r.alwaysNormalize){return t}a.path=s.normalizePath(a.path);return s.buildURLFromParts(a)}var o=s.parseURL(e);if(!o){throw new Error("Error trying to parse base URL.")}if(!o.netLoc&&o.path&&o.path[0]!=="/"){var u=i.exec(o.path);o.netLoc=u[1];o.path=u[2]}if(o.netLoc&&!o.path){o.path="/"}var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){l.netLoc=o.netLoc;if(a.path[0]!=="/"){if(!a.path){l.path=o.path;if(!a.params){l.params=o.params;if(!a.query){l.query=o.query}}}else{var d=o.path;var f=d.substring(0,d.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(f)}}}if(l.path===null){l.path=r.alwaysNormalize?s.normalizePath(a.path):a.path}return s.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);if(!t){return null}return{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(n,"");while(e.length!==(e=e.replace(a,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};if(true)e.exports=s;else{}})(this)},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:false,exports:{}};e[i].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.i=function(e){return e};r.d=function(e,t,i){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:i})}};r.r=function(e){Object.defineProperty(e,"__esModule",{value:true})};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="/";r.oe=function(e){console.error(e);throw e};var i=r(r.s=ENTRY_MODULE);return i.default||i}var n="[\\.|\\-|\\+|\\w|/|@]+";var a="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+n+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(e){return!isNaN(1*e)}function u(e,t,i){var u={};u[i]=[];var l=t.toString();var d=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!d)return u;var f=d[1];var c=new RegExp("(\\\\n|\\W)"+s(f)+a,"g");var h;while(h=c.exec(l)){if(h[3]==="dll-reference")continue;u[i].push(h[3])}c=new RegExp("\\("+s(f)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+a,"g");while(h=c.exec(l)){if(!e[h[2]]){u[i].push(h[1]);e[h[2]]=r(h[1]).m}u[h[2]]=u[h[2]]||[];u[h[2]].push(h[4])}var p=Object.keys(u);for(var v=0;v<p.length;v++){for(var m=0;m<u[p[v]].length;m++){if(o(u[p[v]][m])){u[p[v]][m]=1*u[p[v]][m]}}}return u}function l(e){var t=Object.keys(e);return t.reduce((function(t,r){return t||e[r].length>0}),false)}function d(e,t){var r={main:[t]};var i={main:[]};var n={main:{}};while(l(r)){var a=Object.keys(r);for(var s=0;s<a.length;s++){var o=a[s];var d=r[o];var f=d.pop();n[o]=n[o]||{};if(n[o][f]||!e[o][f])continue;n[o][f]=true;i[o]=i[o]||[];i[o].push(f);var c=u(e,e[o][f],o);var h=Object.keys(c);for(var p=0;p<h.length;p++){r[h[p]]=r[h[p]]||[];r[h[p]]=r[h[p]].concat(c[h[p]])}}}return i}e.exports=function(e,t){t=t||{};var n={main:r.m};var a=t.all?{main:Object.keys(n.main)}:d(n,e);var s="";Object.keys(a).filter((function(e){return e!=="main"})).forEach((function(e){var t=0;while(a[e][t]){t++}a[e].push(t);n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";s=s+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map((function(t){return""+JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"}));s=s+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map((function(e){return""+JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var o=new window.Blob([s],{type:"text/javascript"});if(t.bare){return o}var u=window.URL||window.webkitURL||window.mozURL||window.msURL;var l=u.createObjectURL(o);var f=new window.Worker(l);f.objectURL=l;return f}},"./src/demux/demuxer-inline.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/events.js");var n=r("./src/errors.ts");var a=function(){function e(e,t){this.subtle=e;this.aesIV=t}var t=e.prototype;t.decrypt=function e(t,r){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},r,t)};return e}();var s=function(){function e(e,t){this.subtle=e;this.key=t}var t=e.prototype;t.expandKey=function e(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},false,["encrypt","decrypt"])};return e}();var o=s;function u(e){var t=e.byteLength;var r=t&&new DataView(e).getUint8(t-1);if(r){return e.slice(0,t-r)}else{return e}}var l=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}var t=e.prototype;t.uint8ArrayToUint32Array_=function e(t){var r=new DataView(t);var i=new Uint32Array(4);for(var n=0;n<4;n++){i[n]=r.getUint32(n*4)}return i};t.initTable=function e(){var t=this.sBox;var r=this.invSBox;var i=this.subMix;var n=i[0];var a=i[1];var s=i[2];var o=i[3];var u=this.invSubMix;var l=u[0];var d=u[1];var f=u[2];var c=u[3];var h=new Uint32Array(256);var p=0;var v=0;var m=0;for(m=0;m<256;m++){if(m<128){h[m]=m<<1}else{h[m]=m<<1^283}}for(m=0;m<256;m++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^g&255^99;t[p]=g;r[g]=p;var y=h[p];var _=h[y];var b=h[_];var T=h[g]*257^g*16843008;n[p]=T<<24|T>>>8;a[p]=T<<16|T>>>16;s[p]=T<<8|T>>>24;o[p]=T;T=b*16843009^_*65537^y*257^p*16843008;l[g]=T<<24|T>>>8;d[g]=T<<16|T>>>16;f[g]=T<<8|T>>>24;c[g]=T;if(!p){p=v=1}else{p=y^h[h[h[b^y]]];v^=h[h[v]]}}};t.expandKey=function e(t){var r=this.uint8ArrayToUint32Array_(t);var i=true;var n=0;while(n<r.length&&i){i=r[n]===this.key[n];n++}if(i){return}this.key=r;var a=this.keySize=r.length;if(a!==4&&a!==6&&a!==8){throw new Error("Invalid aes key size="+a)}var s=this.ksRows=(a+6+1)*4;var o;var u;var l=this.keySchedule=new Uint32Array(s);var d=this.invKeySchedule=new Uint32Array(s);var f=this.sBox;var c=this.rcon;var h=this.invSubMix;var p=h[0];var v=h[1];var m=h[2];var g=h[3];var y;var _;for(o=0;o<s;o++){if(o<a){y=l[o]=r[o];continue}_=y;if(o%a===0){_=_<<8|_>>>24;_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255];_^=c[o/a|0]<<24}else if(a>6&&o%a===4){_=f[_>>>24]<<24|f[_>>>16&255]<<16|f[_>>>8&255]<<8|f[_&255]}l[o]=y=(l[o-a]^_)>>>0}for(u=0;u<s;u++){o=s-u;if(u&3){_=l[o]}else{_=l[o-4]}if(u<4||o<=4){d[u]=_}else{d[u]=p[f[_>>>24]]^v[f[_>>>16&255]]^m[f[_>>>8&255]]^g[f[_&255]]}d[u]=d[u]>>>0}};t.networkToHostOrderSwap=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};t.decrypt=function e(t,r,i,n){var a=this.keySize+6;var s=this.invKeySchedule;var o=this.invSBox;var l=this.invSubMix;var d=l[0];var f=l[1];var c=l[2];var h=l[3];var p=this.uint8ArrayToUint32Array_(i);var v=p[0];var m=p[1];var g=p[2];var y=p[3];var _=new Int32Array(t);var b=new Int32Array(_.length);var T,S,E,w;var k,A,C,L;var x,D,I,O;var R,P;var U=this.networkToHostOrderSwap;while(r<_.length){x=U(_[r]);D=U(_[r+1]);I=U(_[r+2]);O=U(_[r+3]);k=x^s[0];A=O^s[1];C=I^s[2];L=D^s[3];R=4;for(P=1;P<a;P++){T=d[k>>>24]^f[A>>16&255]^c[C>>8&255]^h[L&255]^s[R];S=d[A>>>24]^f[C>>16&255]^c[L>>8&255]^h[k&255]^s[R+1];E=d[C>>>24]^f[L>>16&255]^c[k>>8&255]^h[A&255]^s[R+2];w=d[L>>>24]^f[k>>16&255]^c[A>>8&255]^h[C&255]^s[R+3];k=T;A=S;C=E;L=w;R=R+4}T=o[k>>>24]<<24^o[A>>16&255]<<16^o[C>>8&255]<<8^o[L&255]^s[R];S=o[A>>>24]<<24^o[C>>16&255]<<16^o[L>>8&255]<<8^o[k&255]^s[R+1];E=o[C>>>24]<<24^o[L>>16&255]<<16^o[k>>8&255]<<8^o[A&255]^s[R+2];w=o[L>>>24]<<24^o[k>>16&255]<<16^o[A>>8&255]<<8^o[C&255]^s[R+3];R=R+3;b[r]=U(T^v);b[r+1]=U(w^m);b[r+2]=U(E^g);b[r+3]=U(S^y);v=x;m=D;g=I;y=O;r=r+4}return n?u(b.buffer):b.buffer};t.destroy=function e(){this.key=undefined;this.keySize=undefined;this.ksRows=undefined;this.sBox=undefined;this.invSBox=undefined;this.subMix=undefined;this.invSubMix=undefined;this.keySchedule=undefined;this.invKeySchedule=undefined;this.rcon=undefined};return e}();var d=l;var f=r("./src/utils/logger.js");var c=r("./src/utils/get-self-scope.js");var h=Object(c["getSelfScope"])();var p=function(){function e(e,t,r){var i=r===void 0?{}:r,n=i.removePKCS7Padding,a=n===void 0?true:n;this.logEnabled=true;this.observer=e;this.config=t;this.removePKCS7Padding=a;if(a){try{var s=h.crypto;if(s){this.subtle=s.subtle||s.webkitSubtle}}catch(e){}}this.disableWebCrypto=!this.subtle}var t=e.prototype;t.isSync=function e(){return this.disableWebCrypto&&this.config.enableSoftwareAES};t.decrypt=function e(t,r,i,n){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){if(this.logEnabled){f["logger"].log("JS AES decrypt");this.logEnabled=false}var u=this.decryptor;if(!u){this.decryptor=u=new d}u.expandKey(r);n(u.decrypt(t,0,i,this.removePKCS7Padding))}else{if(this.logEnabled){f["logger"].log("WebCrypto AES decrypt");this.logEnabled=false}var l=this.subtle;if(this.key!==r){this.key=r;this.fastAesKey=new o(l,r)}this.fastAesKey.expandKey().then((function(e){var o=new a(l,i);o.decrypt(t,e).catch((function(e){s.onWebCryptoError(e,t,r,i,n)})).then((function(e){n(e)}))})).catch((function(e){s.onWebCryptoError(e,t,r,i,n)}))}};t.onWebCryptoError=function e(t,r,a,s,o){if(this.config.enableSoftwareAES){f["logger"].log("WebCrypto Error, disable WebCrypto API");this.disableWebCrypto=true;this.logEnabled=true;this.decrypt(r,a,s,o)}else{f["logger"].error("decrypting error : "+t.message);this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_DECRYPT_ERROR,fatal:true,reason:t.message})}};t.destroy=function e(){var t=this.decryptor;if(t){t.destroy();this.decryptor=undefined}};return e}();var v=p;var m=r("./src/polyfills/number.js");function g(e,t,r,a){var s,o,u,l,d,c=navigator.userAgent.toLowerCase(),h=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=((t[r+2]&192)>>>6)+1;o=(t[r+2]&60)>>>2;if(o>p.length-1){e.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:true,reason:"invalid ADTS sampling index:"+o});return}l=(t[r+2]&1)<<2;l|=(t[r+3]&192)>>>6;f["logger"].log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+o+"["+p[o]+"Hz],channelConfig:"+l);if(/firefox/i.test(c)){if(o>=6){s=5;d=new Array(4);u=o-3}else{s=2;d=new Array(2);u=o}}else if(c.indexOf("android")!==-1){s=2;d=new Array(2);u=o}else{s=5;d=new Array(4);if(a&&(a.indexOf("mp4a.40.29")!==-1||a.indexOf("mp4a.40.5")!==-1)||!a&&o>=6){u=o-3}else{if(a&&a.indexOf("mp4a.40.2")!==-1&&(o>=6&&l===1||/vivaldi/i.test(c))||!a&&l===1){s=2;d=new Array(2)}u=o}}d[0]=s<<3;d[0]|=(o&14)>>1;d[1]|=(o&1)<<7;d[1]|=l<<3;if(s===5){d[1]|=(u&14)>>1;d[2]=(u&1)<<7;d[2]|=2<<2;d[3]=0}return{config:d,samplerate:p[o],channelCount:l,codec:"mp4a.40."+s,manifestCodec:h}}function y(e,t){return e[t]===255&&(e[t+1]&246)===240}function _(e,t){return e[t+1]&1?7:9}function b(e,t){return(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5}function T(e,t){if(t+1<e.length&&y(e,t)){return true}return false}function S(e,t){if(T(e,t)){var r=_(e,t);if(t+r>=e.length){return false}var i=b(e,t);if(i<=r){return false}var n=t+i;if(n===e.length||n+1<e.length&&y(e,n)){return true}}return false}function E(e,t,r,i,n){if(!e.samplerate){var a=g(t,r,i,n);e.config=a.config;e.samplerate=a.samplerate;e.channelCount=a.channelCount;e.codec=a.codec;e.manifestCodec=a.manifestCodec;f["logger"].log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function w(e){return 1024*9e4/e}function k(e,t,r,i,n){var a,s,o;var u=e.length;a=_(e,t);s=b(e,t);s-=a;if(s>0&&t+a+s<=u){o=r+i*n;return{headerLength:a,frameLength:s,stamp:o}}return undefined}function A(e,t,r,i,n){var a=w(e.samplerate);var s=k(t,r,i,n,a);if(s){var o=s.stamp;var u=s.headerLength;var l=s.frameLength;var d={unit:t.subarray(r+u,r+u+l),pts:o,dts:o};e.samples.push(d);return{sample:d,length:l+u}}return undefined}var C=r("./src/demux/id3.js");var L=function(){function e(e,t,r){this.observer=e;this.config=r;this.remuxer=t}var t=e.prototype;t.resetInitSegment=function e(t,r,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:true,samples:[],len:0,manifestCodec:r,duration:n,inputTimeScale:9e4}};t.resetTimeStamp=function e(){};e.probe=function e(t){if(!t){return false}var r=C["default"].getID3Data(t,0)||[];var i=r.length;for(var n=t.length;i<n;i++){if(S(t,i)){f["logger"].log("ADTS sync word found !");return true}}return false};t.append=function e(t,r,i,n){var a=this._audioTrack;var s=C["default"].getID3Data(t,0)||[];var o=C["default"].getTimeStamp(s);var u=Object(m["isFiniteNumber"])(o)?o*90:r*9e4;var l=0;var d=u;var c=t.length;var h=s.length;var p=[{pts:d,dts:d,data:s}];while(h<c-1){if(T(t,h)&&h+5<c){E(a,this.observer,t,h,a.manifestCodec);var v=A(a,t,h,u,l);if(v){h+=v.length;d=v.sample.pts;l++}else{f["logger"].log("Unable to parse AAC frame");break}}else if(C["default"].isHeader(t,h)){s=C["default"].getID3Data(t,h);p.push({pts:d,dts:d,data:s});h+=s.length}else{h++}}this.remuxer.remux(a,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},r,i,n)};t.destroy=function e(){};return e}();var x=L;var D=r("./src/demux/mp4demuxer.js");var I={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function e(t,r,i,n,a){if(i+24>r.length){return undefined}var s=this.parseHeader(r,i);if(s&&i+s.frameLength<=r.length){var o=s.samplesPerFrame*9e4/s.sampleRate;var u=n+a*o;var l={unit:r.subarray(i,i+s.frameLength),pts:u,dts:u};t.config=[];t.channelCount=s.channelCount;t.samplerate=s.sampleRate;t.samples.push(l);return{sample:l,length:s.frameLength}}return undefined},parseHeader:function e(t,r){var i=t[r+1]>>3&3;var n=t[r+1]>>1&3;var a=t[r+2]>>4&15;var s=t[r+2]>>2&3;var o=t[r+2]>>1&1;if(i!==1&&a!==0&&a!==15&&s!==3){var u=i===3?3-n:n===3?3:4;var l=I.BitratesMap[u*14+a-1]*1e3;var d=i===3?0:i===2?1:2;var f=I.SamplingRateMap[d*3+s];var c=t[r+3]>>6===3?1:2;var h=I.SamplesCoefficients[i][n];var p=I.BytesInSlot[n];var v=h*8*p;var m=parseInt(h*l/f+o,10)*p;return{sampleRate:f,channelCount:c,frameLength:m,samplesPerFrame:v}}return undefined},isHeaderPattern:function e(t,r){return t[r]===255&&(t[r+1]&224)===224&&(t[r+1]&6)!==0},isHeader:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){return true}return false},probe:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){var i=4;var n=this.parseHeader(t,r);var a=i;if(n&&n.frameLength){a=n.frameLength}var s=r+a;if(s===t.length||s+1<t.length&&this.isHeaderPattern(t,s)){return true}}return false}};var O=I;var R=function(){function e(e){this.data=e;this.bytesAvailable=e.byteLength;this.word=0;this.bitsAvailable=0}var t=e.prototype;t.loadWord=function e(){var t=this.data,r=this.bytesAvailable,i=t.byteLength-r,n=new Uint8Array(4),a=Math.min(4,r);if(a===0){throw new Error("no bytes available")}n.set(t.subarray(i,i+a));this.word=new DataView(n.buffer).getUint32(0);this.bitsAvailable=a*8;this.bytesAvailable-=a};t.skipBits=function e(t){var r;if(this.bitsAvailable>t){this.word<<=t;this.bitsAvailable-=t}else{t-=this.bitsAvailable;r=t>>3;t-=r>>3;this.bytesAvailable-=r;this.loadWord();this.word<<=t;this.bitsAvailable-=t}};t.readBits=function e(t){var r=Math.min(this.bitsAvailable,t),i=this.word>>>32-r;if(t>32){f["logger"].error("Cannot read more than 32 bits at a time")}this.bitsAvailable-=r;if(this.bitsAvailable>0){this.word<<=r}else if(this.bytesAvailable>0){this.loadWord()}r=t-r;if(r>0&&this.bitsAvailable){return i<<r|this.readBits(r)}else{return i}};t.skipLZ=function e(){var t;for(t=0;t<this.bitsAvailable;++t){if((this.word&2147483648>>>t)!==0){this.word<<=t;this.bitsAvailable-=t;return t}}this.loadWord();return t+this.skipLZ()};t.skipUEG=function e(){this.skipBits(1+this.skipLZ())};t.skipEG=function e(){this.skipBits(1+this.skipLZ())};t.readUEG=function e(){var t=this.skipLZ();return this.readBits(t+1)-1};t.readEG=function e(){var t=this.readUEG();if(1&t){return 1+t>>>1}else{return-1*(t>>>1)}};t.readBoolean=function e(){return this.readBits(1)===1};t.readUByte=function e(){return this.readBits(8)};t.readUShort=function e(){return this.readBits(16)};t.readUInt=function e(){return this.readBits(32)};t.skipScalingList=function e(t){var r=8,i=8,n,a;for(n=0;n<t;n++){if(i!==0){a=this.readEG();i=(r+a+256)%256}r=i===0?r:i}};t.readSPS=function e(){var t=0,r=0,i=0,n=0,a,s,o,u,l,d,f,c,h,p=this.readUByte.bind(this),v=this.readBits.bind(this),m=this.readUEG.bind(this),g=this.readBoolean.bind(this),y=this.skipBits.bind(this),_=this.skipEG.bind(this),b=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);p();a=p();s=v(5);y(3);o=p();b();if(a===100||a===110||a===122||a===244||a===44||a===83||a===86||a===118||a===128){var S=m();if(S===3){y(1)}b();b();y(1);if(g()){c=S!==3?8:12;for(h=0;h<c;h++){if(g()){if(h<6){T(16)}else{T(64)}}}}}b();var E=m();if(E===0){m()}else if(E===1){y(1);_();_();u=m();for(h=0;h<u;h++){_()}}b();y(1);l=m();d=m();f=v(1);if(f===0){y(1)}y(1);if(g()){t=m();r=m();i=m();n=m()}var w=[1,1];if(g()){if(g()){var k=p();switch(k){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:{w=[p()<<8|p(),p()<<8|p()];break}}}}return{width:Math.ceil((l+1)*16-t*2-r*2),height:(2-f)*(d+1)*16-(f?2:4)*(i+n),pixelRatio:w}};t.readSliceType=function e(){this.readUByte();this.readUEG();return this.readUEG()};return e}();var P=R;var U=function(){function e(e,t,r,i){this.decryptdata=r;this.discardEPB=i;this.decrypter=new v(e,t,{removePKCS7Padding:false})}var t=e.prototype;t.decryptBuffer=function e(t,r){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,r)};t.decryptAacSample=function e(t,r,i,n){var a=t[r].unit;var s=a.subarray(16,a.length-a.length%16);var o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);var u=this;this.decryptBuffer(o,(function(e){e=new Uint8Array(e);a.set(e,16);if(!n){u.decryptAacSamples(t,r+1,i)}}))};t.decryptAacSamples=function e(t,r,i){for(;;r++){if(r>=t.length){i();return}if(t[r].unit.length<32){continue}var n=this.decrypter.isSync();this.decryptAacSample(t,r,i,n);if(!n){return}}};t.getAvcEncryptedData=function e(t){var r=Math.floor((t.length-48)/160)*16+16;var i=new Int8Array(r);var n=0;for(var a=32;a<=t.length-16;a+=160,n+=16){i.set(t.subarray(a,a+16),n)}return i};t.getAvcDecryptedUnit=function e(t,r){r=new Uint8Array(r);var i=0;for(var n=32;n<=t.length-16;n+=160,i+=16){t.set(r.subarray(i,i+16),n)}return t};t.decryptAvcSample=function e(t,r,i,n,a,s){var o=this.discardEPB(a.data);var u=this.getAvcEncryptedData(o);var l=this;this.decryptBuffer(u.buffer,(function(e){a.data=l.getAvcDecryptedUnit(o,e);if(!s){l.decryptAvcSamples(t,r,i+1,n)}}))};t.decryptAvcSamples=function e(t,r,i,n){for(;;r++,i=0){if(r>=t.length){n();return}var a=t[r].units;for(;;i++){if(i>=a.length){break}var s=a[i];if(s.data.length<=48||s.type!==1&&s.type!==5){continue}var o=this.decrypter.isSync();this.decryptAvcSample(t,r,i,n,s,o);if(!o){return}}}};return e}();var M=U;var N={video:1,audio:2,id3:3,text:4};var j=function(){function e(e,t,r,i){this.observer=e;this.config=r;this.typeSupported=i;this.remuxer=t;this.sampleAes=null;this.pmtUnknownTypes={}}var t=e.prototype;t.setDecryptData=function e(t){if(t!=null&&t.key!=null&&t.method==="SAMPLE-AES"){this.sampleAes=new M(this.observer,this.config,t,this.discardEPB)}else{this.sampleAes=null}};e.probe=function t(r){var i=e._syncOffset(r);if(i<0){return false}else{if(i){f["logger"].warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?")}return true}};e._syncOffset=function e(t){var r=Math.min(1e3,t.length-3*188);var i=0;while(i<r){if(t[i]===71&&t[i+188]===71&&t[i+2*188]===71){return i}else{i++}}return-1};e.createTrack=function e(t,r){return{container:t==="video"||t==="audio"?"video/mp2t":undefined,type:t,id:N[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:t==="video"?0:undefined,isAAC:t==="audio"?true:undefined,duration:t==="audio"?r:undefined}};t.resetInitSegment=function t(r,i,n,a){this.pmtParsed=false;this._pmtId=-1;this.pmtUnknownTypes={};this._avcTrack=e.createTrack("video",a);this._audioTrack=e.createTrack("audio",a);this._id3Track=e.createTrack("id3",a);this._txtTrack=e.createTrack("text",a);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=i;this.videoCodec=n;this._duration=a};t.resetTimeStamp=function e(){};t.append=function t(r,a,s,o){var u,l=r.length,d,c,h,p,v,m=false;this.pmtUnknownTypes={};this.contiguous=s;var g=this.pmtParsed,y=this._avcTrack,_=this._audioTrack,b=this._id3Track,T=y.pid,S=_.pid,E=b.pid,w=this._pmtId,k=y.pesData,A=_.pesData,C=b.pesData,L=this._parsePAT,x=this._parsePMT.bind(this),D=this._parsePES,I=this._parseAVCPES.bind(this),O=this._parseAACPES.bind(this),R=this._parseMPEGPES.bind(this),P=this._parseID3PES.bind(this);var U=e._syncOffset(r);l-=(l+U)%188;for(u=U;u<l;u+=188){if(r[u]===71){d=!!(r[u+1]&64);c=((r[u+1]&31)<<8)+r[u+2];h=(r[u+3]&48)>>4;if(h>1){p=u+5+r[u+4];if(p===u+188){continue}}else{p=u+4}switch(c){case T:if(d){if(k&&(v=D(k))){I(v,false)}k={data:[],size:0}}if(k){k.data.push(r.subarray(p,u+188));k.size+=u+188-p}break;case S:if(d){if(A&&(v=D(A))){if(_.isAAC){O(v)}else{R(v)}}A={data:[],size:0}}if(A){A.data.push(r.subarray(p,u+188));A.size+=u+188-p}break;case E:if(d){if(C&&(v=D(C))){P(v)}C={data:[],size:0}}if(C){C.data.push(r.subarray(p,u+188));C.size+=u+188-p}break;case 0:if(d){p+=r[p]+1}w=this._pmtId=L(r,p);break;case w:if(d){p+=r[p]+1}var M=x(r,p,this.typeSupported.mpeg===true||this.typeSupported.mp3===true,this.sampleAes!=null);T=M.avc;if(T>0){y.pid=T}S=M.audio;if(S>0){_.pid=S;_.isAAC=M.isAAC}E=M.id3;if(E>0){b.pid=E}if(m&&!g){f["logger"].log("reparse from beginning");m=false;u=U-188}g=this.pmtParsed=true;break;case 17:case 8191:break;default:m=true;break}}else{this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:false,reason:"TS packet did not start with 0x47"})}}if(k&&(v=D(k))){I(v,true);y.pesData=null}else{y.pesData=k}if(A&&(v=D(A))){if(_.isAAC){O(v)}else{R(v)}_.pesData=null}else{if(A&&A.size){f["logger"].log("last AAC PES packet truncated,might overlap between fragments")}_.pesData=A}if(C&&(v=D(C))){P(v);b.pesData=null}else{b.pesData=C}if(this.sampleAes==null){this.remuxer.remux(_,y,b,this._txtTrack,a,s,o)}else{this.decryptAndRemux(_,y,b,this._txtTrack,a,s,o)}};t.decryptAndRemux=function e(t,r,i,n,a,s,o){if(t.samples&&t.isAAC){var u=this;this.sampleAes.decryptAacSamples(t.samples,0,(function(){u.decryptAndRemuxAvc(t,r,i,n,a,s,o)}))}else{this.decryptAndRemuxAvc(t,r,i,n,a,s,o)}};t.decryptAndRemuxAvc=function e(t,r,i,n,a,s,o){if(r.samples){var u=this;this.sampleAes.decryptAvcSamples(r.samples,0,0,(function(){u.remuxer.remux(t,r,i,n,a,s,o)}))}else{this.remuxer.remux(t,r,i,n,a,s,o)}};t.destroy=function e(){this._initPTS=this._initDTS=undefined;this._duration=0};t._parsePAT=function e(t,r){return(t[r+10]&31)<<8|t[r+11]};t._trackUnknownPmt=function e(t,r,i){var n=this.pmtUnknownTypes[t]||0;if(n===0){this.pmtUnknownTypes[t]=0;r.call(f["logger"],i)}this.pmtUnknownTypes[t]++;return n};t._parsePMT=function e(t,r,i,n){var a,s,o,u,l={audio:-1,avc:-1,id3:-1,isAAC:true};a=(t[r+1]&15)<<8|t[r+2];s=r+3+a-4;o=(t[r+10]&15)<<8|t[r+11];r+=12+o;while(r<s){u=(t[r+1]&31)<<8|t[r+2];switch(t[r]){case 207:if(!n){this._trackUnknownPmt(t[r],f["logger"].warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:if(l.audio===-1){l.audio=u}break;case 21:if(l.id3===-1){l.id3=u}break;case 219:if(!n){this._trackUnknownPmt(t[r],f["logger"].warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:if(l.avc===-1){l.avc=u}break;case 3:case 4:if(!i){this._trackUnknownPmt(t[r],f["logger"].warn,"MPEG audio found, not supported in this browser")}else if(l.audio===-1){l.audio=u;l.isAAC=false}break;case 36:this._trackUnknownPmt(t[r],f["logger"].warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(t[r],f["logger"].log,"Unknown stream type:"+t[r]);break}r+=((t[r+3]&15)<<8|t[r+4])+5}return l};t._parsePES=function e(t){var r=0,i,n,a,s,o,u,l,d,c,h=t.data;if(!t||t.size===0){return null}while(h[0].length<19&&h.length>1){var p=new Uint8Array(h[0].length+h[1].length);p.set(h[0]);p.set(h[1],h[0].length);h[0]=p;h.splice(1,1)}i=h[0];a=(i[0]<<16)+(i[1]<<8)+i[2];if(a===1){s=(i[4]<<8)+i[5];if(s&&s>t.size-6){return null}n=i[7];if(n&192){l=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2;if(n&64){d=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2;if(l-d>60*9e4){f["logger"].warn(Math.round((l-d)/9e4)+"s delta between PTS and DTS, align them");l=d}}else{d=l}}o=i[8];c=o+9;if(t.size<=c){return null}t.size-=c;u=new Uint8Array(t.size);for(var v=0,m=h.length;v<m;v++){i=h[v];var g=i.byteLength;if(c){if(c>g){c-=g;continue}else{i=i.subarray(c);g-=c;c=0}}u.set(i,r);r+=g}if(s){s-=o+3}return{data:u,pts:l,dts:d,len:s}}else{return null}};t.pushAccesUnit=function e(t,r){if(t.units.length&&t.frame){var i=r.samples;var n=i.length;if(isNaN(t.pts)){if(n){var a=i[n-1];t.pts=a.pts;t.dts=a.dts}else{r.dropped++;return}}if(!this.config.forceKeyFrameOnDiscontinuity||t.key===true||r.sps&&(n||this.contiguous)){t.id=n;i.push(t)}else{r.dropped++}}if(t.debug.length){f["logger"].log(t.pts+"/"+t.dts+":"+t.debug)}};t._parseAVCPES=function e(t,r){var i=this;var n=this._avcTrack,a=this._parseAVCNALu(t.data),s=false,o,u=this.avcSample,l,d=false,f,c=this.pushAccesUnit.bind(this),h=function e(t,r,i,n){return{key:t,pts:r,dts:i,units:[],debug:n}};t.data=null;if(u&&a.length&&!n.audFound){c(u,n);u=this.avcSample=h(false,t.pts,t.dts,"")}a.forEach((function(e){switch(e.type){case 1:l=true;if(!u){u=i.avcSample=h(true,t.pts,t.dts,"")}if(s){u.debug+="NDR "}u.frame=true;var r=e.data;if(d&&r.length>4){var a=new P(r).readSliceType();if(a===2||a===4||a===7||a===9){u.key=true}}break;case 5:l=true;if(!u){u=i.avcSample=h(true,t.pts,t.dts,"")}if(s){u.debug+="IDR "}u.key=true;u.frame=true;break;case 6:l=true;if(s&&u){u.debug+="SEI "}o=new P(i.discardEPB(e.data));o.readUByte();var p=0;var v=0;var m=false;var g=0;while(!m&&o.bytesAvailable>1){p=0;do{g=o.readUByte();p+=g}while(g===255);v=0;do{g=o.readUByte();v+=g}while(g===255);if(p===4&&o.bytesAvailable!==0){m=true;var y=o.readUByte();if(y===181){var _=o.readUShort();if(_===49){var b=o.readUInt();if(b===1195456820){var T=o.readUByte();if(T===3){var S=o.readUByte();var E=o.readUByte();var w=31&S;var k=[S,E];for(f=0;f<w;f++){k.push(o.readUByte());k.push(o.readUByte());k.push(o.readUByte())}i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:t.pts,bytes:k})}}}}}else if(p===5&&o.bytesAvailable!==0){m=true;if(v>16){var A=[];for(f=0;f<16;f++){A.push(o.readUByte().toString(16));if(f===3||f===5||f===7||f===9){A.push("-")}}var L=v-16;var x=new Uint8Array(L);for(f=0;f<L;f++){x[f]=o.readUByte()}i._insertSampleInOrder(i._txtTrack.samples,{pts:t.pts,payloadType:p,uuid:A.join(""),userDataBytes:x,userData:Object(C["utf8ArrayToStr"])(x.buffer)})}}else if(v<o.bytesAvailable){for(f=0;f<v;f++){o.readUByte()}}}break;case 7:l=true;d=true;if(s&&u){u.debug+="SPS "}if(!n.sps){o=new P(e.data);var D=o.readSPS();n.width=D.width;n.height=D.height;n.pixelRatio=D.pixelRatio;n.sps=[e.data];n.duration=i._duration;var I=e.data.subarray(1,4);var O="avc1.";for(f=0;f<3;f++){var R=I[f].toString(16);if(R.length<2){R="0"+R}O+=R}n.codec=O}break;case 8:l=true;if(s&&u){u.debug+="PPS "}if(!n.pps){n.pps=[e.data]}break;case 9:l=false;n.audFound=true;if(u){c(u,n)}u=i.avcSample=h(false,t.pts,t.dts,s?"AUD ":"");break;case 12:l=false;break;default:l=false;if(u){u.debug+="unknown NAL "+e.type+" "}break}if(u&&l){var U=u.units;U.push(e)}}));if(r&&u){c(u,n);this.avcSample=null}};t._insertSampleInOrder=function e(t,r){var i=t.length;if(i>0){if(r.pts>=t[i-1].pts){t.push(r)}else{for(var n=i-1;n>=0;n--){if(r.pts<t[n].pts){t.splice(n,0,r);break}}}}else{t.push(r)}};t._getLastNalUnit=function e(){var t=this.avcSample,r;if(!t||t.units.length===0){var i=this._avcTrack,n=i.samples;t=n[n.length-1]}if(t){var a=t.units;r=a[a.length-1]}return r};t._parseAVCNALu=function e(t){var r=0,i=t.byteLength,n,a,s=this._avcTrack,o=s.naluState||0,u=o;var l=[],d,f,c=-1,h;if(o===-1){c=0;h=t[0]&31;o=0;r=1}while(r<i){n=t[r++];if(!o){o=n?0:1;continue}if(o===1){o=n?0:2;continue}if(!n){o=3}else if(n===1){if(c>=0){d={data:t.subarray(c,r-o-1),type:h};l.push(d)}else{var p=this._getLastNalUnit();if(p){if(u&&r<=4-u){if(p.state){p.data=p.data.subarray(0,p.data.byteLength-u)}}a=r-o-1;if(a>0){var v=new Uint8Array(p.data.byteLength+a);v.set(p.data,0);v.set(t.subarray(0,a),p.data.byteLength);p.data=v}}}if(r<i){f=t[r]&31;c=r;h=f;o=0}else{o=-1}}else{o=0}}if(c>=0&&o>=0){d={data:t.subarray(c,i),type:h,state:o};l.push(d)}if(l.length===0){var m=this._getLastNalUnit();if(m){var g=new Uint8Array(m.data.byteLength+t.byteLength);g.set(m.data,0);g.set(t,m.data.byteLength);m.data=g}}s.naluState=o;return l};t.discardEPB=function e(t){var r=t.byteLength,i=[],n=1,a,s;while(n<r-2){if(t[n]===0&&t[n+1]===0&&t[n+2]===3){i.push(n+2);n+=2}else{n++}}if(i.length===0){return t}a=r-i.length;s=new Uint8Array(a);var o=0;for(n=0;n<a;o++,n++){if(o===i[0]){o++;i.shift()}s[n]=t[o]}return s};t._parseAACPES=function e(t){var r=this._audioTrack,a=t.data,s=t.pts,o=0,u=this.aacOverFlow,l=this.aacLastPTS,d,c,h,p,v;if(u){var m=new Uint8Array(u.byteLength+a.byteLength);m.set(u,0);m.set(a,u.byteLength);a=m}for(h=o,v=a.length;h<v-1;h++){if(T(a,h)){break}}if(h){var g,y;if(h<v-1){g="AAC PES did not start with ADTS header,offset:"+h;y=false}else{g="no ADTS header found in AAC PES";y=true}f["logger"].warn("parsing error:"+g);this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:y,reason:g});if(y){return}}E(r,this.observer,a,h,this.audioCodec);c=0;d=w(r.samplerate);if(u&&l){var _=l+d;if(Math.abs(_-s)>1){f["logger"].log("AAC: align PTS for overlapping frames by "+Math.round((_-s)/90));s=_}}while(h<v){if(T(a,h)){if(h+5<v){var b=A(r,a,h,s,c);if(b){h+=b.length;p=b.sample.pts;c++;continue}}break}else{h++}}if(h<v){u=a.subarray(h,v)}else{u=null}this.aacOverFlow=u;this.aacLastPTS=p};t._parseMPEGPES=function e(t){var r=t.data;var i=r.length;var n=0;var a=0;var s=t.pts;while(a<i){if(O.isHeader(r,a)){var o=O.appendFrame(this._audioTrack,r,a,s,n);if(o){a+=o.length;n++}else{break}}else{a++}}};t._parseID3PES=function e(t){this._id3Track.samples.push(t)};return e}();var B=j;var F=function(){function e(e,t,r){this.observer=e;this.config=r;this.remuxer=t}var t=e.prototype;t.resetInitSegment=function e(t,r,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:false,samples:[],len:0,manifestCodec:r,duration:n,inputTimeScale:9e4}};t.resetTimeStamp=function e(){};e.probe=function e(t){var r,i;var n=C["default"].getID3Data(t,0);if(n&&C["default"].getTimeStamp(n)!==undefined){for(r=n.length,i=Math.min(t.length-1,r+100);r<i;r++){if(O.probe(t,r)){f["logger"].log("MPEG Audio sync word found !");return true}}}return false};t.append=function e(t,r,i,n){var a=C["default"].getID3Data(t,0)||[];var s=C["default"].getTimeStamp(a);var o=s!==undefined?90*s:r*9e4;var u=a.length;var l=t.length;var d=0,f=0;var c=this._audioTrack;var h=[{pts:o,dts:o,data:a}];while(u<l){if(O.isHeader(t,u)){var p=O.appendFrame(c,t,u,o,d);if(p){u+=p.length;f=p.sample.pts;d++}else{break}}else if(C["default"].isHeader(t,u)){a=C["default"].getID3Data(t,u);h.push({pts:f,dts:f,data:a});u+=a.length}else{u++}}this.remuxer.remux(c,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},r,i,n)};t.destroy=function e(){};return e}();var H=F;var q=function(){function e(){}e.getSilentFrame=function e(t,r){switch(t){case"mp4a.40.2":if(r===1){return new Uint8Array([0,200,0,128,35,128])}else if(r===2){return new Uint8Array([33,0,73,144,2,25,0,35,128])}else if(r===3){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142])}else if(r===4){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56])}else if(r===5){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56])}else if(r===6){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}break;default:if(r===1){return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}else if(r===2){return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}else if(r===3){return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}break}return null};return e}();var G=q;var V=Math.pow(2,32)-1;var W=function(){function e(){}e.init=function t(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var r;for(r in e.types){if(e.types.hasOwnProperty(r)){e.types[r]=[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3)]}}var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);var s=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=s;e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]);var u=new Uint8Array([97,118,99,49]);var l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,u);e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))};e.box=function e(t){var r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n,s;while(n--){i+=r[n].byteLength}s=new Uint8Array(i);s[0]=i>>24&255;s[1]=i>>16&255;s[2]=i>>8&255;s[3]=i&255;s.set(t,4);for(n=0,i=8;n<a;n++){s.set(r[n],i);i+=r[n].byteLength}return s};e.hdlr=function t(r){return e.box(e.types.hdlr,e.HDLR_TYPES[r])};e.mdat=function t(r){return e.box(e.types.mdat,r)};e.mdhd=function t(r,i){i*=r;var n=Math.floor(i/(V+1));var a=Math.floor(i%(V+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,a>>24,a>>16&255,a>>8&255,a&255,85,196,0,0]))};e.mdia=function t(r){return e.box(e.types.mdia,e.mdhd(r.timescale,r.duration),e.hdlr(r.type),e.minf(r))};e.mfhd=function t(r){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255]))};e.minf=function t(r){if(r.type==="audio"){return e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(r))}else{return e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(r))}};e.moof=function t(r,i,n){return e.box(e.types.moof,e.mfhd(r),e.traf(n,i))};e.moov=function t(r){var i=r.length,n=[];while(i--){n[i]=e.trak(r[i])}return e.box.apply(null,[e.types.moov,e.mvhd(r[0].timescale,r[0].duration)].concat(n).concat(e.mvex(r)))};e.mvex=function t(r){var i=r.length,n=[];while(i--){n[i]=e.trex(r[i])}return e.box.apply(null,[e.types.mvex].concat(n))};e.mvhd=function t(r,i){i*=r;var n=Math.floor(i/(V+1));var a=Math.floor(i%(V+1));var s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,a>>24,a>>16&255,a>>8&255,a&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,s)};e.sdtp=function t(r){var i=r.samples||[],n=new Uint8Array(4+i.length),a,s;for(s=0;s<i.length;s++){a=i[s].flags;n[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy}return e.box(e.types.sdtp,n)};e.stbl=function t(r){return e.box(e.types.stbl,e.stsd(r),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))};e.avc1=function t(r){var i=[],n=[],a,s,o;for(a=0;a<r.sps.length;a++){s=r.sps[a];o=s.byteLength;i.push(o>>>8&255);i.push(o&255);i=i.concat(Array.prototype.slice.call(s))}for(a=0;a<r.pps.length;a++){s=r.pps[a];o=s.byteLength;n.push(o>>>8&255);n.push(o&255);n=n.concat(Array.prototype.slice.call(s))}var u=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],252|3,224|r.sps.length].concat(i).concat([r.pps.length]).concat(n))),l=r.width,d=r.height,f=r.pixelRatio[0],c=r.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,c>>24,c>>16&255,c>>8&255,c&255])))};e.esds=function e(t){var r=t.config.length;return new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t.config).concat([6,1,2]))};e.mp4a=function t(r){var i=r.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r.channelCount,0,16,0,0,0,0,i>>8&255,i&255,0,0]),e.box(e.types.esds,e.esds(r)))};e.mp3=function t(r){var i=r.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r.channelCount,0,16,0,0,0,0,i>>8&255,i&255,0,0]))};e.stsd=function t(r){if(r.type==="audio"){if(!r.isAAC&&r.codec==="mp3"){return e.box(e.types.stsd,e.STSD,e.mp3(r))}return e.box(e.types.stsd,e.STSD,e.mp4a(r))}else{return e.box(e.types.stsd,e.STSD,e.avc1(r))}};e.tkhd=function t(r){var i=r.id,n=r.duration*r.timescale,a=r.width,s=r.height,o=Math.floor(n/(V+1)),u=Math.floor(n%(V+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,i&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,a&255,0,0,s>>8&255,s&255,0,0]))};e.traf=function t(r,i){var n=e.sdtp(r),a=r.id,s=Math.floor(i/(V+1)),o=Math.floor(i%(V+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),e.trun(r,n.length+16+20+8+16+8+8),n)};e.trak=function t(r){r.duration=r.duration||4294967295;return e.box(e.types.trak,e.tkhd(r),e.mdia(r))};e.trex=function t(r){var i=r.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))};e.trun=function t(r,i){var n=r.samples||[],a=n.length,s=12+16*a,o=new Uint8Array(s),u,l,d,f,c,h;i+=8+s;o.set([0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,a&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255],0);for(u=0;u<a;u++){l=n[u];d=l.duration;f=l.size;c=l.flags;h=l.cts;o.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,c.degradPrio&240<<8,c.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*u)}return e.box(e.types.trun,o)};e.initSegment=function t(r){if(!e.types){e.init()}var i=e.moov(r),n;n=new Uint8Array(e.FTYP.byteLength+i.byteLength);n.set(e.FTYP);n.set(i,e.FTYP.byteLength);return n};return e}();var z=W;var K=9e4;function Y(e,t,r,i){if(r===void 0){r=1}if(i===void 0){i=false}return X(e,t,1/r)}function X(e,t,r,i){if(r===void 0){r=1}if(i===void 0){i=false}var n=e*t*r;return i?Math.round(n):n}function J(e,t){if(t===void 0){t=false}return X(e,1e3,1/K,t)}function Q(e,t){if(t===void 0){t=1}return X(e,K,1/t)}var $=Q(10);var Z=Q(.2);var ee=null;var te=function(){function e(e,t,r,i){this.observer=e;this.config=t;this.typeSupported=r;this.ISGenerated=false;if(ee===null){var n=navigator.userAgent.match(/Chrome\/(\d+)/i);ee=n?parseInt(n[1]):0}}var t=e.prototype;t.destroy=function e(){};t.resetTimeStamp=function e(t){this._initPTS=this._initDTS=t};t.resetInitSegment=function e(){this.ISGenerated=false};t.getVideoStartPts=function e(t){var r=false;var i=t.reduce((function(e,t){var i=t.pts-e;if(i<-4294967296){r=true;return re(e,t.pts)}else if(i>0){return e}else{return t.pts}}),t[0].pts);if(r){f["logger"].debug("PTS rollover detected")}return i};t.remux=function e(t,r,n,a,s,o,u){if(!this.ISGenerated){this.generateIS(t,r,s)}if(this.ISGenerated){var l=t.samples.length;var d=r.samples.length;var c=s;var h=s;if(l&&d){var p=this.getVideoStartPts(r.samples);var v=re(t.samples[0].pts,p)-p;var m=v/r.inputTimeScale;c+=Math.max(0,m);h+=Math.max(0,-m)}if(l){if(!t.timescale){f["logger"].warn("regenerate InitSegment as audio detected");this.generateIS(t,r,s)}var g=this.remuxAudio(t,c,o,u);if(d){var y;if(g){y=g.endPTS-g.startPTS}if(!r.timescale){f["logger"].warn("regenerate InitSegment as video detected");this.generateIS(t,r,s)}this.remuxVideo(r,h,o,y)}}else{if(d){var _=this.remuxVideo(r,h,o,0,u);if(_&&t.codec){this.remuxEmptyAudio(t,c,o,_)}}}}if(n.samples.length){this.remuxID3(n,s)}if(a.samples.length){this.remuxText(a,s)}this.observer.trigger(i["default"].FRAG_PARSED)};t.generateIS=function e(t,r,a){var s=this.observer,o=t.samples,u=r.samples,l=this.typeSupported,d="audio/mp4",c={},h={tracks:c},p=this._initPTS===undefined,v,m;if(p){v=m=Infinity}if(t.config&&o.length){t.timescale=t.samplerate;f["logger"].log("audio sampling rate : "+t.samplerate);if(!t.isAAC){if(l.mpeg){d="audio/mpeg";t.codec=""}else if(l.mp3){t.codec="mp3"}}c.audio={container:d,codec:t.codec,initSegment:!t.isAAC&&l.mpeg?new Uint8Array:z.initSegment([t]),metadata:{channelCount:t.channelCount}};if(p){v=m=o[0].pts-Math.round(t.inputTimeScale*a)}}if(r.sps&&r.pps&&u.length){var g=r.inputTimeScale;r.timescale=g;c.video={container:"video/mp4",codec:r.codec,initSegment:z.initSegment([r]),metadata:{width:r.width,height:r.height}};if(p){var y=this.getVideoStartPts(u);var _=Math.round(g*a);m=Math.min(m,re(u[0].dts,y)-_);v=Math.min(v,y-_);this.observer.trigger(i["default"].INIT_PTS_FOUND,{initPTS:v})}}else if(p&&c.audio){this.observer.trigger(i["default"].INIT_PTS_FOUND,{initPTS:v})}if(Object.keys(c).length){s.trigger(i["default"].FRAG_PARSING_INIT_SEGMENT,h);this.ISGenerated=true;if(p){this._initPTS=v;this._initDTS=m}}else{s.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:false,reason:"no audio/video samples found"})}};t.remuxVideo=function e(t,r,a,s){var o=t.timescale;var u=t.samples;var l=[];var d=u.length;var c=this._initPTS;var h=8;var p;var v;var m;var g;var y;var _=Number.POSITIVE_INFINITY;var b=Number.NEGATIVE_INFINITY;var T=0;var S=false;var E=this.nextAvcDts;if(d===0){return}if(!a){var w=r*o;var k=u[0].pts-re(u[0].dts,u[0].pts);E=w-k}for(var A=0;A<d;A++){var C=u[A];C.pts=re(C.pts-c,E);C.dts=re(C.dts-c,E);if(C.dts>C.pts){T=Math.max(Math.min(T,C.pts-C.dts),-1*Z)}if(C.dts<u[A>0?A-1:A].dts){S=true}}if(S){u.sort((function(e,t){var r=e.dts-t.dts;var i=e.pts-t.pts;return r||i||e.id-t.id}))}g=u[0].dts;y=u[d-1].dts;var L=Math.round((y-g)/(d-1));if(T<0){if(T<L*-2){f["logger"].warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+J(-L,true)+" ms");var x=T;for(var D=0;D<d;D++){u[D].dts=x=Math.max(x,u[D].pts-L);u[D].pts=Math.max(x,u[D].pts)}}else{f["logger"].warn("PTS < DTS detected in video samples, shifting DTS by "+J(T,true)+" ms to overcome this issue");for(var I=0;I<d;I++){u[I].dts=u[I].dts+T}}g=u[0].dts;y=u[d-1].dts}if(a){var O=g-E;var R=O>L;var P=O<-1;if(R||P){if(R){f["logger"].warn("AVC: "+J(O,true)+" ms ("+O+"dts) hole between fragments detected, filling it")}else{f["logger"].warn("AVC: "+J(-O,true)+" ms ("+O+"dts) overlapping between fragments detected")}g=E;var U=u[0].pts-O;u[0].dts=g;u[0].pts=U;f["logger"].log("Video: First PTS/DTS adjusted: "+J(U,true)+"/"+J(g,true)+", delta: "+J(O,true)+" ms")}}if(ee&&ee<75){g=Math.max(0,g)}var M=0;var N=0;for(var j=0;j<d;j++){var B=u[j];var F=B.units;var H=F.length;var q=0;for(var G=0;G<H;G++){q+=F[G].data.length}N+=q;M+=H;B.length=q;B.dts=Math.max(B.dts,g);B.pts=Math.max(B.pts,B.dts,0);_=Math.min(B.pts,_);b=Math.max(B.pts,b)}y=u[d-1].dts;var V=N+4*M+8;try{v=new Uint8Array(V)}catch(e){this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MUX_ERROR,details:n["ErrorDetails"].REMUX_ALLOC_ERROR,fatal:false,bytes:V,reason:"fail allocating video mdat "+V});return}var W=new DataView(v.buffer);W.setUint32(0,V);v.set(z.types.mdat,4);for(var K=0;K<d;K++){var Y=u[K];var X=Y.units;var Q=0;var $=void 0;for(var te=0,ie=X.length;te<ie;te++){var ne=X[te];var ae=ne.data;var se=ne.data.byteLength;W.setUint32(h,se);h+=4;v.set(ae,h);h+=se;Q+=4+se}if(K<d-1){p=u[K+1].dts-Y.dts}else{var oe=this.config;var ue=Y.dts-u[K>0?K-1:K].dts;if(oe.stretchShortVideoTrack){var le=oe.maxBufferHole;var de=Math.floor(le*o);var fe=(s?_+s*o:this.nextAudioPts)-Y.pts;if(fe>de){p=fe-ue;if(p<0){p=ue}f["logger"].log("It is approximately "+J(fe,false)+" ms to the next segment; using duration "+J(p,false)+" ms for the last video frame.")}else{p=ue}}else{p=ue}}$=Math.round(Y.pts-Y.dts);l.push({size:Q,duration:p,cts:$,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Y.key?2:1,isNonSync:Y.key?0:1}})}this.nextAvcDts=y+p;var ce=t.dropped;t.nbNalu=0;t.dropped=0;if(l.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var he=l[0].flags;he.dependsOn=2;he.isNonSync=0}t.samples=l;m=z.moof(t.sequenceNumber++,g,t);t.samples=[];var pe={data1:m,data2:v,startPTS:_/o,endPTS:(b+p)/o,startDTS:g/o,endDTS:this.nextAvcDts/o,type:"video",hasAudio:false,hasVideo:true,nb:l.length,dropped:ce};this.observer.trigger(i["default"].FRAG_PARSING_DATA,pe);return pe};t.remuxAudio=function e(t,r,a,s){var o=t.inputTimeScale;var u=t.timescale;var l=o/u;var d=t.isAAC?1024:1152;var c=d*l;var h=this._initPTS;var p=!t.isAAC&&this.typeSupported.mpeg;var v;var m;var g;var y;var _;var b;var T=p?0:8;var S=t.samples;var E=[];var w=this.nextAudioPts;a|=S.length&&w&&(s&&Math.abs(r-w/o)<.1||Math.abs(S[0].pts-w-h)<20*c);S.forEach((function(e){e.pts=e.dts=re(e.pts-h,r*o)}));S=S.filter((function(e){return e.pts>=0}));if(S.length===0){return}if(!a){if(!s){w=S[0].pts}else{w=Math.max(0,r*o)}}if(t.isAAC){var k=this.config.maxAudioFramesDrift;for(var A=0,C=w;A<S.length;){var L=S[A];var x=L.pts;var D=x-C;if(D<=-k*c){if(a||A>0){f["logger"].warn("Dropping 1 audio frame @ "+J(C,true)/1e3+"s due to "+J(D,true)+" ms overlap.");S.splice(A,1)}else{f["logger"].warn("Audio frame @ "+J(x,true)/1e3+"s overlaps nextAudioPts by "+J(D,true)+" ms.");C=x+c;A++}}else if(D>=k*c&&D<$&&C){var I=Math.round(D/c);f["logger"].warn("Injecting "+I+" audio frames @ "+J(C,true)/1e3+"s due to "+J(D,true)+" ms gap.");for(var O=0;O<I;O++){var R=Math.max(C,0);m=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!m){f["logger"].log("Unable to get silent frame for given audio codec; duplicating last frame instead.");m=L.unit.subarray()}S.splice(A,0,{unit:m,pts:R,dts:R});C+=c;A++}L.pts=L.dts=C;C+=c;A++}else{if(Math.abs(D)>.1*c){}L.pts=L.dts=C;C+=c;A++}}}var P=S.length;var U=0;while(P--){U+=S[P].unit.byteLength}for(var M=0,N=S.length;M<N;M++){var j=S[M];var B=j.unit;var F=j.pts;if(b!==undefined&&v){v.duration=Math.round((F-b)/l)}else{var H=F-w;var q=0;if(a&&t.isAAC){if(H){if(H>0&&H<$){q=Math.round((F-w)/c);f["logger"].log(J(H,true)+" ms hole between AAC samples detected,filling it");if(q>0){m=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!m){m=B.subarray()}U+=q*m.length}}else if(H<-12){f["logger"].log("drop overlapping AAC sample, expected/parsed/delta: "+J(w,true)+" ms / "+J(F,true)+" ms / "+J(-H,true)+" ms");U-=B.byteLength;continue}F=w}}_=F;if(U>0){U+=T;try{g=new Uint8Array(U)}catch(e){this.observer.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MUX_ERROR,details:n["ErrorDetails"].REMUX_ALLOC_ERROR,fatal:false,bytes:U,reason:"fail allocating audio mdat "+U});return}if(!p){var V=new DataView(g.buffer);V.setUint32(0,U);g.set(z.types.mdat,4)}}else{return}for(var W=0;W<q;W++){m=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!m){f["logger"].log("Unable to get silent frame for given audio codec; duplicating this frame instead.");m=B.subarray()}g.set(m,T);T+=m.byteLength;v={size:m.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};E.push(v)}}g.set(B,T);var K=B.byteLength;T+=K;v={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};E.push(v);b=F}var Y=0;P=E.length;if(P>=2){Y=E[P-2].duration;v.duration=Y}if(P){this.nextAudioPts=w=b+l*Y;t.samples=E;if(p){y=new Uint8Array}else{y=z.moof(t.sequenceNumber++,_/l,t)}t.samples=[];var X=_/o;var Q=w/o;var Z={data1:y,data2:g,startPTS:X,endPTS:Q,startDTS:X,endDTS:Q,type:"audio",hasAudio:true,hasVideo:false,nb:P};this.observer.trigger(i["default"].FRAG_PARSING_DATA,Z);return Z}return null};t.remuxEmptyAudio=function e(t,r,i,n){var a=t.inputTimeScale;var s=t.samplerate?t.samplerate:a;var o=a/s;var u=this.nextAudioPts;var l=(u!==undefined?u:n.startDTS*a)+this._initDTS;var d=n.endDTS*a+this._initDTS;var c=1024;var h=o*c;var p=Math.ceil((d-l)/h);var v=G.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);f["logger"].warn("remux empty Audio");if(!v){f["logger"].trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}var m=[];for(var g=0;g<p;g++){var y=l+g*h;m.push({unit:v,pts:y,dts:y})}t.samples=m;this.remuxAudio(t,r,i)};t.remuxID3=function e(t,r){var n=t.samples.length;if(!n){return}var a=t.inputTimeScale;var s=this._initPTS;var o=this._initDTS;for(var u=0;u<n;u++){var l=t.samples[u];l.pts=re(l.pts-s,r*a)/a;l.dts=re(l.dts-o,r*a)/a}this.observer.trigger(i["default"].FRAG_PARSING_METADATA,{samples:t.samples});t.samples=[]};t.remuxText=function e(t,r){var n=t.samples.length;var a=t.inputTimeScale;var s=this._initPTS;if(n){for(var o=0;o<n;o++){var u=t.samples[o];u.pts=re(u.pts-s,r*a)/a}t.samples.sort((function(e,t){return e.pts-t.pts}));this.observer.trigger(i["default"].FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]};return e}();function re(e,t){var r;if(t===undefined){return e}if(t<e){r=-8589934592}else{r=8589934592}while(Math.abs(e-t)>4294967296){e+=r}return e}var ie=te;var ne=function(){function e(e){this.observer=e}var t=e.prototype;t.destroy=function e(){};t.resetTimeStamp=function e(){};t.resetInitSegment=function e(){};t.remux=function e(t,r,n,a,s,o,u,l){var d=this.observer;var f="";if(t){f+="audio"}if(r){f+="video"}d.trigger(i["default"].FRAG_PARSING_DATA,{data1:l,startPTS:s,startDTS:s,type:f,hasAudio:!!t,hasVideo:!!r,nb:1,dropped:0});d.trigger(i["default"].FRAG_PARSED)};return e}();var ae=ne;var se=Object(c["getSelfScope"])();var oe;try{oe=se.performance.now.bind(se.performance)}catch(e){f["logger"].debug("Unable to use Performance API on this environment");oe=se.Date.now}var ue=function(){function e(e,t,r,i){this.observer=e;this.typeSupported=t;this.config=r;this.vendor=i}var t=e.prototype;t.destroy=function e(){var t=this.demuxer;if(t){t.destroy()}};t.push=function e(t,r,n,a,s,o,u,l,d,f,c,h){var p=this;if(t.byteLength>0&&r!=null&&r.key!=null&&r.method==="AES-128"){var m=this.decrypter;if(m==null){m=this.decrypter=new v(this.observer,this.config)}var g=oe();m.decrypt(t,r.key.buffer,r.iv.buffer,(function(e){var t=oe();p.observer.trigger(i["default"].FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:t}});p.pushDecrypted(new Uint8Array(e),r,new Uint8Array(n),a,s,o,u,l,d,f,c,h)}))}else{this.pushDecrypted(new Uint8Array(t),r,new Uint8Array(n),a,s,o,u,l,d,f,c,h)}};t.pushDecrypted=function e(t,r,a,s,o,u,l,d,f,c,h,p){var v=this.demuxer;var m=this.remuxer;if(!v||l||d){var g=this.observer;var y=this.typeSupported;var _=this.config;var b=[{demux:B,remux:ie},{demux:D["default"],remux:ae},{demux:x,remux:ie},{demux:H,remux:ie}];var T;for(var S=0,E=b.length;S<E;S++){T=b[S];if(T.demux.probe(t)){break}}if(!T){g.trigger(i["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].FRAG_PARSING_ERROR,fatal:true,reason:"no demux matching with content found"});return}if(!m||!(m instanceof T.remux)){m=new T.remux(g,_,y,this.vendor)}if(!v||!(v instanceof T.demux)){v=new T.demux(g,m,_,y);this.probe=T.demux.probe}this.demuxer=v;this.remuxer=m}if(l||d){v.resetInitSegment(a,s,o,c);m.resetInitSegment()}if(l){v.resetTimeStamp(p);m.resetTimeStamp(p)}if(typeof v.setDecryptData==="function"){v.setDecryptData(r)}v.append(t,u,f,h)};return e}();var le=t["default"]=ue},"./src/demux/demuxer-worker.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/demux/demuxer-inline.js");var n=r("./src/events.js");var a=r("./src/utils/logger.js");var s=r("./node_modules/eventemitter3/index.js");var o=r.n(s);var u=function e(t){var r=new s["EventEmitter"];r.trigger=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++){n[a-1]=arguments[a]}r.emit.apply(r,[t,t].concat(n))};r.off=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++){n[a-1]=arguments[a]}r.removeListener.apply(r,[t].concat(n))};var o=function e(r,i){t.postMessage({event:r,data:i})};t.addEventListener("message",(function(e){var n=e.data;switch(n.cmd){case"init":var s=JSON.parse(n.config);t.demuxer=new i["default"](r,n.typeSupported,s,n.vendor);Object(a["enableLogs"])(s.debug);o("init",null);break;case"demux":t.demuxer.push(n.data,n.decryptdata,n.initSegment,n.audioCodec,n.videoCodec,n.timeOffset,n.discontinuity,n.trackSwitch,n.contiguous,n.duration,n.accurateTimeOffset,n.defaultInitPTS);break;default:break}}));r.on(n["default"].FRAG_DECRYPTED,o);r.on(n["default"].FRAG_PARSING_INIT_SEGMENT,o);r.on(n["default"].FRAG_PARSED,o);r.on(n["default"].ERROR,o);r.on(n["default"].FRAG_PARSING_METADATA,o);r.on(n["default"].FRAG_PARSING_USERDATA,o);r.on(n["default"].INIT_PTS_FOUND,o);r.on(n["default"].FRAG_PARSING_DATA,(function(e,r){var i=[];var n={event:e,data:r};if(r.data1){n.data1=r.data1.buffer;i.push(r.data1.buffer);delete r.data1}if(r.data2){n.data2=r.data2.buffer;i.push(r.data2.buffer);delete r.data2}t.postMessage(n,i)}))};t["default"]=u},"./src/demux/id3.js":function(e,t,r){"use strict";r.r(t);r.d(t,"utf8ArrayToStr",(function(){return o}));var i=r("./src/utils/get-self-scope.js");var n=function(){function e(){}e.isHeader=function e(t,r){if(r+10<=t.length){if(t[r]===73&&t[r+1]===68&&t[r+2]===51){if(t[r+3]<255&&t[r+4]<255){if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128){return true}}}}return false};e.isFooter=function e(t,r){if(r+10<=t.length){if(t[r]===51&&t[r+1]===68&&t[r+2]===73){if(t[r+3]<255&&t[r+4]<255){if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128){return true}}}}return false};e.getID3Data=function t(r,i){var n=i;var a=0;while(e.isHeader(r,i)){a+=10;var s=e._readSize(r,i+6);a+=s;if(e.isFooter(r,i+10)){a+=10}i+=a}if(a>0){return r.subarray(n,n+a)}return undefined};e._readSize=function e(t,r){var i=0;i=(t[r]&127)<<21;i|=(t[r+1]&127)<<14;i|=(t[r+2]&127)<<7;i|=t[r+3]&127;return i};e.getTimeStamp=function t(r){var i=e.getID3Frames(r);for(var n=0;n<i.length;n++){var a=i[n];if(e.isTimeStampFrame(a)){return e._readTimeStamp(a)}}return undefined};e.isTimeStampFrame=function e(t){return t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp"};e._getFrameData=function t(r){var i=String.fromCharCode(r[0],r[1],r[2],r[3]);var n=e._readSize(r,4);var a=10;return{type:i,size:n,data:r.subarray(a,a+n)}};e.getID3Frames=function t(r){var i=0;var n=[];while(e.isHeader(r,i)){var a=e._readSize(r,i+6);i+=10;var s=i+a;while(i+8<s){var o=e._getFrameData(r.subarray(i));var u=e._decodeFrame(o);if(u){n.push(u)}i+=o.size+10}if(e.isFooter(r,i)){i+=10}}return n};e._decodeFrame=function t(r){if(r.type==="PRIV"){return e._decodePrivFrame(r)}else if(r.type[0]==="T"){return e._decodeTextFrame(r)}else if(r.type[0]==="W"){return e._decodeURLFrame(r)}return undefined};e._readTimeStamp=function e(t){if(t.data.byteLength===8){var r=new Uint8Array(t.data);var i=r[3]&1;var n=(r[4]<<23)+(r[5]<<15)+(r[6]<<7)+r[7];n/=45;if(i){n+=47721858.84}return Math.round(n)}return undefined};e._decodePrivFrame=function t(r){if(r.size<2){return undefined}var i=e._utf8ArrayToStr(r.data,true);var n=new Uint8Array(r.data.subarray(i.length+1));return{key:r.type,info:i,data:n.buffer}};e._decodeTextFrame=function t(r){if(r.size<2){return undefined}if(r.type==="TXXX"){var i=1;var n=e._utf8ArrayToStr(r.data.subarray(i),true);i+=n.length+1;var a=e._utf8ArrayToStr(r.data.subarray(i));return{key:r.type,info:n,data:a}}else{var s=e._utf8ArrayToStr(r.data.subarray(1));return{key:r.type,data:s}}};e._decodeURLFrame=function t(r){if(r.type==="WXXX"){if(r.size<2){return undefined}var i=1;var n=e._utf8ArrayToStr(r.data.subarray(i),true);i+=n.length+1;var a=e._utf8ArrayToStr(r.data.subarray(i));return{key:r.type,info:n,data:a}}else{var s=e._utf8ArrayToStr(r.data);return{key:r.type,data:s}}};e._utf8ArrayToStr=function e(t,r){if(r===void 0){r=false}var i=s();if(i){var n=i.decode(t);if(r){var a=n.indexOf("\0");return a!==-1?n.substring(0,a):n}return n.replace(/\0/g,"")}var o=t.length;var u;var l;var d;var f="";var c=0;while(c<o){u=t[c++];if(u===0&&r){return f}else if(u===0||u===3){continue}switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:f+=String.fromCharCode(u);break;case 12:case 13:l=t[c++];f+=String.fromCharCode((u&31)<<6|l&63);break;case 14:l=t[c++];d=t[c++];f+=String.fromCharCode((u&15)<<12|(l&63)<<6|(d&63)<<0);break;default:}}return f};return e}();var a;function s(){var e=Object(i["getSelfScope"])();if(!a&&typeof e.TextDecoder!=="undefined"){a=new e.TextDecoder("utf-8")}return a}var o=n._utf8ArrayToStr;t["default"]=n},"./src/demux/mp4demuxer.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/utils/logger.js");var n=r("./src/events.js");var a=Math.pow(2,32)-1;var s=function(){function e(e,t){this.observer=e;this.remuxer=t}var t=e.prototype;t.resetTimeStamp=function e(t){this.initPTS=t};t.resetInitSegment=function t(r,i,a,s){if(r&&r.byteLength){var o=this.initData=e.parseInitSegment(r);if(i==null){i="mp4a.40.5"}if(a==null){a="avc1.42e01e"}var u={};if(o.audio&&o.video){u.audiovideo={container:"video/mp4",codec:i+","+a,initSegment:s?r:null}}else{if(o.audio){u.audio={container:"audio/mp4",codec:i,initSegment:s?r:null}}if(o.video){u.video={container:"video/mp4",codec:a,initSegment:s?r:null}}}this.observer.trigger(n["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:u})}else{if(i){this.audioCodec=i}if(a){this.videoCodec=a}}};e.probe=function t(r){return e.findBox({data:r,start:0,end:Math.min(r.length,16384)},["moof"]).length>0};e.bin2str=function e(t){return String.fromCharCode.apply(null,t)};e.readUint16=function e(t,r){if(t.data){r+=t.start;t=t.data}var i=t[r]<<8|t[r+1];return i<0?65536+i:i};e.readUint32=function e(t,r){if(t.data){r+=t.start;t=t.data}var i=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3];return i<0?4294967296+i:i};e.writeUint32=function e(t,r,i){if(t.data){r+=t.start;t=t.data}t[r]=i>>24;t[r+1]=i>>16&255;t[r+2]=i>>8&255;t[r+3]=i&255};e.findBox=function t(r,i){var n=[],a,s,o,u,l,d,f;if(r.data){d=r.start;u=r.end;r=r.data}else{d=0;u=r.byteLength}if(!i.length){return null}for(a=d;a<u;){s=e.readUint32(r,a);o=e.bin2str(r.subarray(a+4,a+8));f=s>1?a+s:u;if(o===i[0]){if(i.length===1){n.push({data:r,start:a+8,end:f})}else{l=e.findBox({data:r,start:a+8,end:f},i.slice(1));if(l.length){n=n.concat(l)}}}a=f}return n};e.parseSegmentIndex=function t(r){var i=e.findBox(r,["moov"])[0];var n=i?i.end:null;var a=0;var s=e.findBox(r,["sidx"]);var o;if(!s||!s[0]){return null}o=[];s=s[0];var u=s.data[0];a=u===0?8:16;var l=e.readUint32(s,a);a+=4;var d=0;var f=0;if(u===0){a+=8}else{a+=16}a+=2;var c=s.end+f;var h=e.readUint16(s,a);a+=2;for(var p=0;p<h;p++){var v=a;var m=e.readUint32(s,v);v+=4;var g=m&2147483647;var y=(m&2147483648)>>>31;if(y===1){console.warn("SIDX has hierarchical references (not supported)");return}var _=e.readUint32(s,v);v+=4;o.push({referenceSize:g,subsegmentDuration:_,info:{duration:_/l,start:c,end:c+g-1}});c+=g;v+=4;a=v}return{earliestPresentationTime:d,timescale:l,version:u,referencesCount:h,references:o,moovEndOffset:n}};e.parseInitSegment=function t(r){var n=[];var a=e.findBox(r,["moov","trak"]);a.forEach((function(t){var r=e.findBox(t,["tkhd"])[0];if(r){var a=r.data[r.start];var s=a===0?12:20;var o=e.readUint32(r,s);var u=e.findBox(t,["mdia","mdhd"])[0];if(u){a=u.data[u.start];s=a===0?12:20;var l=e.readUint32(u,s);var d=e.findBox(t,["mdia","hdlr"])[0];if(d){var f=e.bin2str(d.data.subarray(d.start+8,d.start+12));var c={soun:"audio",vide:"video"}[f];if(c){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var p=e.bin2str(h.data.subarray(h.start+12,h.start+16));i["logger"].log("MP4Demuxer:"+c+":"+p+" found")}n[o]={timescale:l,type:c};n[c]={timescale:l,id:o}}}}}}));return n};e.getStartDTS=function t(r,i){var n,a,s;n=e.findBox(i,["moof","traf"]);a=[].concat.apply([],n.map((function(t){return e.findBox(t,["tfhd"]).map((function(i){var n,a,s;n=e.readUint32(i,4);a=r[n].timescale||9e4;s=e.findBox(t,["tfdt"]).map((function(t){var r,i;r=t.data[t.start];i=e.readUint32(t,4);if(r===1){i*=Math.pow(2,32);i+=e.readUint32(t,8)}return i}))[0];return s/a}))})));s=Math.min.apply(null,a);return isFinite(s)?s:0};e.offsetStartDTS=function t(r,i,n){e.findBox(i,["moof","traf"]).map((function(t){return e.findBox(t,["tfhd"]).map((function(i){var s=e.readUint32(i,4);var o=r[s].timescale||9e4;e.findBox(t,["tfdt"]).map((function(t){var r=t.data[t.start];var i=e.readUint32(t,4);if(r===0){e.writeUint32(t,4,i-n*o)}else{i*=Math.pow(2,32);i+=e.readUint32(t,8);i-=n*o;i=Math.max(i,0);var s=Math.floor(i/(a+1));var u=Math.floor(i%(a+1));e.writeUint32(t,4,s);e.writeUint32(t,8,u)}}))}))}))};t.append=function t(r,i,a,s){var o=this.initData;if(!o){this.resetInitSegment(r,this.audioCodec,this.videoCodec,false);o=this.initData}var u,l=this.initPTS;if(l===undefined){var d=e.getStartDTS(o,r);this.initPTS=l=d-i;this.observer.trigger(n["default"].INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,r,l);u=e.getStartDTS(o,r);this.remuxer.remux(o.audio,o.video,null,null,u,a,s,r)};t.destroy=function e(){};return e}();t["default"]=s},"./src/empty.js":function(e,t){e.exports=void 0},"./src/errors.ts":function(e,t,r){"use strict";r.r(t);r.d(t,"ErrorTypes",(function(){return i}));r.d(t,"ErrorDetails",(function(){return n}));var i;(function(e){e["NETWORK_ERROR"]="networkError";e["MEDIA_ERROR"]="mediaError";e["KEY_SYSTEM_ERROR"]="keySystemError";e["MUX_ERROR"]="muxError";e["OTHER_ERROR"]="otherError"})(i||(i={}));var n;(function(e){e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys";e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess";e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession";e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed";e["KEY_SYSTEM_NO_INIT_DATA"]="keySystemNoInitData";e["MANIFEST_LOAD_ERROR"]="manifestLoadError";e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut";e["MANIFEST_PARSING_ERROR"]="manifestParsingError";e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError";e["LEVEL_EMPTY_ERROR"]="levelEmptyError";e["LEVEL_LOAD_ERROR"]="levelLoadError";e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut";e["LEVEL_SWITCH_ERROR"]="levelSwitchError";e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError";e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut";e["FRAG_LOAD_ERROR"]="fragLoadError";e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut";e["FRAG_DECRYPT_ERROR"]="fragDecryptError";e["FRAG_PARSING_ERROR"]="fragParsingError";e["REMUX_ALLOC_ERROR"]="remuxAllocError";e["KEY_LOAD_ERROR"]="keyLoadError";e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut";e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError";e["BUFFER_APPEND_ERROR"]="bufferAppendError";e["BUFFER_APPENDING_ERROR"]="bufferAppendingError";e["BUFFER_STALLED_ERROR"]="bufferStalledError";e["BUFFER_FULL_ERROR"]="bufferFullError";e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole";e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall";e["INTERNAL_EXCEPTION"]="internalException"})(n||(n={}))},"./src/events.js":function(e,t,r){"use strict";r.r(t);var i={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};t["default"]=i},"./src/hls.ts":function(e,t,r){"use strict";r.r(t);r.d(t,"default",(function(){return tr}));var i=r("./node_modules/url-toolkit/src/url-toolkit.js");var n=r("./src/errors.ts");var a=r("./src/polyfills/number.js");var s=r("./src/events.js");var o=r("./src/utils/logger.js");var u={hlsEventGeneric:true,hlsHandlerDestroying:true,hlsHandlerDestroyed:true};var l=function(){function e(e){this.hls=void 0;this.handledEvents=void 0;this.useGenericHandler=void 0;this.hls=e;this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}this.handledEvents=r;this.useGenericHandler=true;this.registerListeners()}var t=e.prototype;t.destroy=function e(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()};t.onHandlerDestroying=function e(){};t.onHandlerDestroyed=function e(){};t.isEventHandler=function e(){return typeof this.handledEvents==="object"&&this.handledEvents.length&&typeof this.onEvent==="function"};t.registerListeners=function e(){if(this.isEventHandler()){this.handledEvents.forEach((function(e){if(u[e]){throw new Error("Forbidden event-name: "+e)}this.hls.on(e,this.onEvent)}),this)}};t.unregisterListeners=function e(){if(this.isEventHandler()){this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)}};t.onEvent=function e(t,r){this.onEventGeneric(t,r)};t.onEventGeneric=function e(t,r){var i=function e(t,r){var i="on"+t.replace("hls","");if(typeof this[i]!=="function"){throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")")}return this[i].bind(this,r)};try{i.call(this,t,r).call()}catch(e){o["logger"].error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e);this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].OTHER_ERROR,details:n["ErrorDetails"].INTERNAL_EXCEPTION,fatal:false,event:t,err:e})}};return e}();var d=l;var f;(function(e){e["MANIFEST"]="manifest";e["LEVEL"]="level";e["AUDIO_TRACK"]="audioTrack";e["SUBTITLE_TRACK"]="subtitleTrack"})(f||(f={}));var c;(function(e){e["MAIN"]="main";e["AUDIO"]="audio";e["SUBTITLE"]="subtitle"})(c||(c={}));var h=r("./src/demux/mp4demuxer.js");function p(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function v(e,t,r){if(t)p(e.prototype,t);if(r)p(e,r);return e}var m=function(){function e(e,t){this._uri=null;this.baseuri=void 0;this.reluri=void 0;this.method=null;this.key=null;this.iv=null;this.baseuri=e;this.reluri=t}v(e,[{key:"uri",get:function e(){if(!this._uri&&this.reluri){this._uri=Object(i["buildAbsoluteURL"])(this.baseuri,this.reluri,{alwaysNormalize:true})}return this._uri}}]);return e}();function g(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function y(e,t,r){if(t)g(e.prototype,t);if(r)g(e,r);return e}var _;(function(e){e["AUDIO"]="audio";e["VIDEO"]="video"})(_||(_={}));var b=function(){function e(){var e;this._url=null;this._byteRange=null;this._decryptdata=null;this._elementaryStreams=(e={},e[_.AUDIO]=false,e[_.VIDEO]=false,e);this.deltaPTS=0;this.rawProgramDateTime=null;this.programDateTime=null;this.title=null;this.tagList=[];this.cc=void 0;this.type=void 0;this.relurl=void 0;this.baseurl=void 0;this.duration=void 0;this.start=void 0;this.sn=0;this.urlId=0;this.level=0;this.levelkey=void 0;this.loader=void 0}var t=e.prototype;t.setByteRange=function e(t,r){var i=t.split("@",2);var n=[];if(i.length===1){n[0]=r?r.byteRangeEndOffset:0}else{n[0]=parseInt(i[1])}n[1]=parseInt(i[0])+n[0];this._byteRange=n};t.addElementaryStream=function e(t){this._elementaryStreams[t]=true};t.hasElementaryStream=function e(t){return this._elementaryStreams[t]===true};t.createInitializationVector=function e(t){var r=new Uint8Array(16);for(var i=12;i<16;i++){r[i]=t>>8*(15-i)&255}return r};t.setDecryptDataFromLevelKey=function e(t,r){var i=t;if((t===null||t===void 0?void 0:t.method)&&t.uri&&!t.iv){i=new m(t.baseuri,t.reluri);i.method=t.method;i.iv=this.createInitializationVector(r)}return i};y(e,[{key:"url",get:function e(){if(!this._url&&this.relurl){this._url=Object(i["buildAbsoluteURL"])(this.baseurl,this.relurl,{alwaysNormalize:true})}return this._url},set:function e(t){this._url=t}},{key:"byteRange",get:function e(){if(!this._byteRange){return[]}return this._byteRange}},{key:"byteRangeStartOffset",get:function e(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function e(){return this.byteRange[1]}},{key:"decryptdata",get:function e(){if(!this.levelkey&&!this._decryptdata){return null}if(!this._decryptdata&&this.levelkey){var t=this.sn;if(typeof t!=="number"){if(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv){o["logger"].warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue')}t=0}this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"endProgramDateTime",get:function e(){if(this.programDateTime===null){return null}if(!Object(a["isFiniteNumber"])(this.programDateTime)){return null}var t=!Object(a["isFiniteNumber"])(this.duration)?0:this.duration;return this.programDateTime+t*1e3}},{key:"encrypted",get:function e(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]);return e}();function T(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function S(e,t,r){if(t)T(e.prototype,t);if(r)T(e,r);return e}var E=function(){function e(e){this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=true;this.needSidxRanges=false;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=e;this.version=null}S(e,[{key:"hasProgramDateTime",get:function e(){return!!(this.fragments[0]&&Object(a["isFiniteNumber"])(this.fragments[0].programDateTime))}}]);return e}();var w=/^(\d+)x(\d+)$/;var k=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;var A=function(){function e(t){if(typeof t==="string"){t=e.parseAttrList(t)}for(var r in t){if(t.hasOwnProperty(r)){this[r]=t[r]}}}var t=e.prototype;t.decimalInteger=function e(t){var r=parseInt(this[t],10);if(r>Number.MAX_SAFE_INTEGER){return Infinity}return r};t.hexadecimalInteger=function e(t){if(this[t]){var r=(this[t]||"0x").slice(2);r=(r.length&1?"0":"")+r;var i=new Uint8Array(r.length/2);for(var n=0;n<r.length/2;n++){i[n]=parseInt(r.slice(n*2,n*2+2),16)}return i}else{return null}};t.hexadecimalIntegerAsNumber=function e(t){var r=parseInt(this[t],16);if(r>Number.MAX_SAFE_INTEGER){return Infinity}return r};t.decimalFloatingPoint=function e(t){return parseFloat(this[t])};t.enumeratedString=function e(t){return this[t]};t.decimalResolution=function e(t){var r=w.exec(this[t]);if(r===null){return undefined}return{width:parseInt(r[1],10),height:parseInt(r[2],10)}};e.parseAttrList=function e(t){var r,i={};k.lastIndex=0;while((r=k.exec(t))!==null){var n=r[2],a='"';if(n.indexOf(a)===0&&n.lastIndexOf(a)===n.length-1){n=n.slice(1,-1)}i[r[1]]=n}return i};return e}();var C=A;var L={audio:{a3ds:true,"ac-3":true,"ac-4":true,alac:true,alaw:true,dra1:true,"dts+":true,"dts-":true,dtsc:true,dtse:true,dtsh:true,"ec-3":true,enca:true,g719:true,g726:true,m4ae:true,mha1:true,mha2:true,mhm1:true,mhm2:true,mlpa:true,mp4a:true,"raw ":true,Opus:true,samr:true,sawb:true,sawp:true,sevc:true,sqcp:true,ssmv:true,twos:true,ulaw:true},video:{avc1:true,avc2:true,avc3:true,avc4:true,avcp:true,drac:true,dvav:true,dvhe:true,encv:true,hev1:true,hvc1:true,mjp2:true,mp4v:true,mvc1:true,mvc2:true,mvc3:true,mvc4:true,resv:true,rv60:true,s263:true,svc1:true,svc2:true,"vc-1":true,vp08:true,vp09:true}};function x(e,t){var r=L[t];return!!r&&r[e.slice(0,4)]===true}function D(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var I=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g;var O=/#EXT-X-MEDIA:(.*)/g;var R=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g");var P=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/;var U=/\.(mp4|m4s|m4v|m4a)$/i;var M=function(){function e(){}e.findGroup=function e(t,r){for(var i=0;i<t.length;i++){var n=t[i];if(n.id===r){return n}}};e.convertAVC1ToAVCOTI=function e(t){var r=t.split(".");var i;if(r.length>2){i=r.shift()+".";i+=parseInt(r.shift()).toString(16);i+=("000"+parseInt(r.shift()).toString(16)).substr(-4)}else{i=t}return i};e.resolve=function e(t,r){return i["buildAbsoluteURL"](r,t,{alwaysNormalize:true})};e.parseMasterPlaylist=function t(r,i){var n=[];var a={};var s=false;I.lastIndex=0;function o(e,t){["video","audio"].forEach((function(r){var i=e.filter((function(e){return x(e,r)}));if(i.length){var n=i.filter((function(e){return e.lastIndexOf("avc1",0)===0||e.lastIndexOf("mp4a",0)===0}));t[r+"Codec"]=n.length>0?n[0]:i[0];e=e.filter((function(e){return i.indexOf(e)===-1}))}}));t.unknownCodecs=e}var u;while((u=I.exec(r))!=null){if(u[1]){var l={};var d=l.attrs=new C(u[1]);l.url=e.resolve(u[2],i);var f=d.decimalResolution("RESOLUTION");if(f){l.width=f.width;l.height=f.height}l.bitrate=d.decimalInteger("AVERAGE-BANDWIDTH")||d.decimalInteger("BANDWIDTH");l.name=d.NAME;o([].concat((d.CODECS||"").split(/[ ,]+/)),l);if(l.videoCodec&&l.videoCodec.indexOf("avc1")!==-1){l.videoCodec=e.convertAVC1ToAVCOTI(l.videoCodec)}n.push(l)}else if(u[3]){var c=new C(u[3]);if(c["DATA-ID"]){s=true;a[c["DATA-ID"]]=c}}}return{levels:n,sessionData:s?a:null}};e.parseMasterPlaylistMedia=function t(r,i,n,a){if(a===void 0){a=[]}var s;var o=[];var u=0;O.lastIndex=0;while((s=O.exec(r))!==null){var l=new C(s[1]);if(l.TYPE===n){var d={attrs:l,id:u++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE,type:n,default:l.DEFAULT==="YES",autoselect:l.AUTOSELECT==="YES",forced:l.FORCED==="YES",lang:l.LANGUAGE};if(l.URI){d.url=e.resolve(l.URI,i)}if(a.length){var f=e.findGroup(a,d.groupId);d.audioCodec=f?f.codec:a[0].codec}o.push(d)}}return o};e.parseLevelPlaylist=function e(t,r,i,n,s){var u=0;var l=0;var d=new E(r);var f=0;var c=null;var h=new b;var p;var v;var g;var y=null;R.lastIndex=0;while((p=R.exec(t))!==null){var _=p[1];if(_){h.duration=parseFloat(_);var T=(" "+p[2]).slice(1);h.title=T||null;h.tagList.push(T?["INF",_,T]:["INF",_])}else if(p[3]){if(Object(a["isFiniteNumber"])(h.duration)){var S=u++;h.type=n;h.start=l;if(g){h.levelkey=g}h.sn=S;h.level=i;h.cc=f;h.urlId=s;h.baseurl=r;h.relurl=(" "+p[3]).slice(1);j(h,c);d.fragments.push(h);c=h;l+=h.duration;h=new b}}else if(p[4]){var w=(" "+p[4]).slice(1);if(c){h.setByteRange(w,c)}else{h.setByteRange(w)}}else if(p[5]){h.rawProgramDateTime=(" "+p[5]).slice(1);h.tagList.push(["PROGRAM-DATE-TIME",h.rawProgramDateTime]);if(y===null){y=d.fragments.length}}else{p=p[0].match(P);if(!p){o["logger"].warn("No matches on slow regex match for level playlist!");continue}for(v=1;v<p.length;v++){if(typeof p[v]!=="undefined"){break}}var k=(" "+p[v+1]).slice(1);var A=(" "+p[v+2]).slice(1);switch(p[v]){case"#":h.tagList.push(A?[k,A]:[k]);break;case"PLAYLIST-TYPE":d.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":u=d.startSN=parseInt(k);break;case"TARGETDURATION":d.targetduration=parseFloat(k);break;case"VERSION":d.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":d.live=false;break;case"DIS":f++;h.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(k);break;case"KEY":{var L=k;var x=new C(L);var D=x.enumeratedString("METHOD");var I=x.URI;var O=x.hexadecimalInteger("IV");var M=x.KEYFORMAT||"identity";if(M==="com.apple.streamingkeydelivery"){o["logger"].warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}if(D){g=new m(r,I);if(I&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(D)>=0){g.method=D;g.key=null;g.iv=O}}break}case"START":{var B=new C(k);var F=B.decimalFloatingPoint("TIME-OFFSET");if(Object(a["isFiniteNumber"])(F)){d.startTimeOffset=F}break}case"MAP":{var H=new C(k);h.relurl=H.URI;if(H.BYTERANGE){h.setByteRange(H.BYTERANGE)}h.baseurl=r;h.level=i;h.type=n;h.sn="initSegment";d.initSegment=h;h=new b;h.rawProgramDateTime=d.initSegment.rawProgramDateTime;break}default:o["logger"].warn("line parsed but not handled: "+p);break}}}h=c;if(h&&!h.relurl){d.fragments.pop();l-=h.duration}d.totalduration=l;d.averagetargetduration=l/d.fragments.length;d.endSN=u-1;d.startCC=d.fragments[0]?d.fragments[0].cc:0;d.endCC=f;if(!d.initSegment&&d.fragments.length){if(d.fragments.every((function(e){return U.test(e.relurl)}))){o["logger"].warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX");h=new b;h.relurl=d.fragments[0].relurl;h.baseurl=r;h.level=i;h.type=n;h.sn="initSegment";d.initSegment=h;d.needSidxRanges=true}}if(y){N(d.fragments,y)}return d};return e}();function N(e,t){var r=e[t];for(var i=t-1;i>=0;i--){var n=e[i];n.programDateTime=r.programDateTime-n.duration*1e3;r=n}}function j(e,t){if(e.rawProgramDateTime){e.programDateTime=Date.parse(e.rawProgramDateTime)}else if(t===null||t===void 0?void 0:t.programDateTime){e.programDateTime=t.endProgramDateTime}if(!Object(a["isFiniteNumber"])(e.programDateTime)){e.programDateTime=null;e.rawProgramDateTime=null}}function B(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var F=window,H=F.performance;var q=function(e){B(t,e);function t(t){var r;r=e.call(this,t,s["default"].MANIFEST_LOADING,s["default"].LEVEL_LOADING,s["default"].AUDIO_TRACK_LOADING,s["default"].SUBTITLE_TRACK_LOADING)||this;r.loaders={};return r}t.canHaveQualityLevels=function e(t){return t!==f.AUDIO_TRACK&&t!==f.SUBTITLE_TRACK};t.mapContextToLevelType=function e(t){var r=t.type;switch(r){case f.AUDIO_TRACK:return c.AUDIO;case f.SUBTITLE_TRACK:return c.SUBTITLE;default:return c.MAIN}};t.getResponseUrl=function e(t,r){var i=t.url;if(i===undefined||i.indexOf("data:")===0){i=r.url}return i};var r=t.prototype;r.createInternalLoader=function e(t){var r=this.hls.config;var i=r.pLoader;var n=r.loader;var a=i||n;var s=new a(r);t.loader=s;this.loaders[t.type]=s;return s};r.getInternalLoader=function e(t){return this.loaders[t.type]};r.resetInternalLoader=function e(t){if(this.loaders[t]){delete this.loaders[t]}};r.destroyInternalLoaders=function e(){for(var t in this.loaders){var r=this.loaders[t];if(r){r.destroy()}this.resetInternalLoader(t)}};r.destroy=function t(){this.destroyInternalLoaders();e.prototype.destroy.call(this)};r.onManifestLoading=function e(t){this.load({url:t.url,type:f.MANIFEST,level:0,id:null,responseType:"text"})};r.onLevelLoading=function e(t){this.load({url:t.url,type:f.LEVEL,level:t.level,id:t.id,responseType:"text"})};r.onAudioTrackLoading=function e(t){this.load({url:t.url,type:f.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})};r.onSubtitleTrackLoading=function e(t){this.load({url:t.url,type:f.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})};r.load=function e(t){var r=this.hls.config;o["logger"].debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var i=this.getInternalLoader(t);if(i){var n=i.context;if(n&&n.url===t.url){o["logger"].trace("playlist request ongoing");return false}else{o["logger"].warn("aborting previous loader for type: "+t.type);i.abort()}}var a;var s;var u;var l;switch(t.type){case f.MANIFEST:a=r.manifestLoadingMaxRetry;s=r.manifestLoadingTimeOut;u=r.manifestLoadingRetryDelay;l=r.manifestLoadingMaxRetryTimeout;break;case f.LEVEL:a=0;l=0;u=0;s=r.levelLoadingTimeOut;break;default:a=r.levelLoadingMaxRetry;s=r.levelLoadingTimeOut;u=r.levelLoadingRetryDelay;l=r.levelLoadingMaxRetryTimeout;break}i=this.createInternalLoader(t);var d={timeout:s,maxRetry:a,retryDelay:u,maxRetryDelay:l};var c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};o["logger"].debug("Calling internal loader delegate for URL: "+t.url);i.load(t,d,c);return true};r.loadsuccess=function e(t,r,i,n){if(n===void 0){n=null}if(i.isSidxRequest){this._handleSidxRequest(t,i);this._handlePlaylistLoaded(t,r,i,n);return}this.resetInternalLoader(i.type);if(typeof t.data!=="string"){throw new Error('expected responseType of "text" for PlaylistLoader')}var a=t.data;r.tload=H.now();if(a.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(t,i,"no EXTM3U delimiter",n);return}if(a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0){this._handleTrackOrLevelPlaylist(t,r,i,n)}else{this._handleMasterPlaylist(t,r,i,n)}};r.loaderror=function e(t,r,i){if(i===void 0){i=null}this._handleNetworkError(r,i,false,t)};r.loadtimeout=function e(t,r,i){if(i===void 0){i=null}this._handleNetworkError(r,i,true)};r._handleMasterPlaylist=function e(r,i,n,a){var u=this.hls;var l=r.data;var d=t.getResponseUrl(r,n);var f=M.parseMasterPlaylist(l,d),c=f.levels,h=f.sessionData;if(!c.length){this._handleManifestParsingError(r,n,"no level found in manifest",a);return}var p=c.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}));var v=M.parseMasterPlaylistMedia(l,d,"AUDIO",p);var m=M.parseMasterPlaylistMedia(l,d,"SUBTITLES");var g=M.parseMasterPlaylistMedia(l,d,"CLOSED-CAPTIONS");if(v.length){var y=false;v.forEach((function(e){if(!e.url){y=true}}));if(y===false&&c[0].audioCodec&&!c[0].attrs.AUDIO){o["logger"].log("audio codec signaled in quality level, but no embedded audio track signaled, create one");v.unshift({type:"main",name:"main",default:false,autoselect:false,forced:false,id:-1,attrs:{},url:""})}}u.trigger(s["default"].MANIFEST_LOADED,{levels:c,audioTracks:v,subtitles:m,captions:g,url:d,stats:i,networkDetails:a,sessionData:h})};r._handleTrackOrLevelPlaylist=function e(r,i,o,u){var l=this.hls;var d=o.id,c=o.level,h=o.type;var p=t.getResponseUrl(r,o);var v=Object(a["isFiniteNumber"])(d)?d:0;var m=Object(a["isFiniteNumber"])(c)?c:v;var g=t.mapContextToLevelType(o);var y=M.parseLevelPlaylist(r.data,p,m,g,v);y.tload=i.tload;if(!y.fragments.length){l.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].LEVEL_EMPTY_ERROR,fatal:false,url:p,reason:"no fragments found in level",level:typeof o.level==="number"?o.level:undefined});return}if(h===f.MANIFEST){var _={url:p,details:y};l.trigger(s["default"].MANIFEST_LOADED,{levels:[_],audioTracks:[],url:p,stats:i,networkDetails:u,sessionData:null})}i.tparsed=H.now();if(y.needSidxRanges){var b=y.initSegment.url;this.load({url:b,isSidxRequest:true,type:h,level:c,levelDetails:y,id:d,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}o.levelDetails=y;this._handlePlaylistLoaded(r,i,o,u)};r._handleSidxRequest=function e(t,r){if(typeof t.data==="string"){throw new Error("sidx request must be made with responseType of array buffer")}var i=h["default"].parseSegmentIndex(new Uint8Array(t.data));if(!i){return}var n=i.references;var a=r.levelDetails;n.forEach((function(e,t){var r=e.info;if(!a){return}var i=a.fragments[t];if(i.byteRange.length===0){i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}}));if(a){a.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}};r._handleManifestParsingError=function e(t,r,i,a){this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].MANIFEST_PARSING_ERROR,fatal:true,url:t.url,reason:i,networkDetails:a})};r._handleNetworkError=function e(t,r,i,a){if(i===void 0){i=false}if(a===void 0){a=null}o["logger"].info("A network error occured while loading a "+t.type+"-type playlist");var u;var l;var d=this.getInternalLoader(t);switch(t.type){case f.MANIFEST:u=i?n["ErrorDetails"].MANIFEST_LOAD_TIMEOUT:n["ErrorDetails"].MANIFEST_LOAD_ERROR;l=true;break;case f.LEVEL:u=i?n["ErrorDetails"].LEVEL_LOAD_TIMEOUT:n["ErrorDetails"].LEVEL_LOAD_ERROR;l=false;break;case f.AUDIO_TRACK:u=i?n["ErrorDetails"].AUDIO_TRACK_LOAD_TIMEOUT:n["ErrorDetails"].AUDIO_TRACK_LOAD_ERROR;l=false;break;default:l=false}if(d){d.abort();this.resetInternalLoader(t.type)}var c={type:n["ErrorTypes"].NETWORK_ERROR,details:u,fatal:l,url:t.url,loader:d,context:t,networkDetails:r};if(a){c.response=a}this.hls.trigger(s["default"].ERROR,c)};r._handlePlaylistLoaded=function e(r,i,n,a){var o=n.type,u=n.level,l=n.id,d=n.levelDetails;if(!d||!d.targetduration){this._handleManifestParsingError(r,n,"invalid target duration",a);return}var c=t.canHaveQualityLevels(n.type);if(c){this.hls.trigger(s["default"].LEVEL_LOADED,{details:d,level:u||0,id:l||0,stats:i,networkDetails:a})}else{switch(o){case f.AUDIO_TRACK:this.hls.trigger(s["default"].AUDIO_TRACK_LOADED,{details:d,id:l,stats:i,networkDetails:a});break;case f.SUBTITLE_TRACK:this.hls.trigger(s["default"].SUBTITLE_TRACK_LOADED,{details:d,id:l,stats:i,networkDetails:a});break}}};return t}(d);var G=q;function V(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var W=function(e){V(t,e);function t(t){var r;r=e.call(this,t,s["default"].FRAG_LOADING)||this;r.loaders={};return r}var r=t.prototype;r.destroy=function t(){var r=this.loaders;for(var i in r){var n=r[i];if(n){n.destroy()}}this.loaders={};e.prototype.destroy.call(this)};r.onFragLoading=function e(t){var r=t.frag,i=r.type,n=this.loaders,s=this.hls.config,u=s.fLoader,l=s.loader;r.loaded=0;var d=n[i];if(d){o["logger"].warn("abort previous fragment loader for type: "+i);d.abort()}d=n[i]=r.loader=s.fLoader?new u(s):new l(s);var f,c,h;f={url:r.url,frag:r,responseType:"arraybuffer",progressData:false};var p=r.byteRangeStartOffset,v=r.byteRangeEndOffset;if(Object(a["isFiniteNumber"])(p)&&Object(a["isFiniteNumber"])(v)){f.rangeStart=p;f.rangeEnd=v}c={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout};h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};d.load(f,c,h)};r.loadsuccess=function e(t,r,i,n){if(n===void 0){n=null}var a=t.data,o=i.frag;o.loader=undefined;this.loaders[o.type]=undefined;this.hls.trigger(s["default"].FRAG_LOADED,{payload:a,frag:o,stats:r,networkDetails:n})};r.loaderror=function e(t,r,i){if(i===void 0){i=null}var a=r.frag;var o=a.loader;if(o){o.abort()}this.loaders[a.type]=undefined;this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].FRAG_LOAD_ERROR,fatal:false,frag:r.frag,response:t,networkDetails:i})};r.loadtimeout=function e(t,r,i){if(i===void 0){i=null}var a=r.frag;var o=a.loader;if(o){o.abort()}this.loaders[a.type]=undefined;this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].FRAG_LOAD_TIMEOUT,fatal:false,frag:r.frag,networkDetails:i})};r.loadprogress=function e(t,r,i,n){if(n===void 0){n=null}var a=r.frag;a.loaded=t.loaded;this.hls.trigger(s["default"].FRAG_LOAD_PROGRESS,{frag:a,stats:t,networkDetails:n})};return t}(d);var z=W;function K(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Y=function(e){K(t,e);function t(t){var r;r=e.call(this,t,s["default"].KEY_LOADING)||this;r.loaders={};r.decryptkey=null;r.decrypturl=null;return r}var r=t.prototype;r.destroy=function t(){for(var r in this.loaders){var i=this.loaders[r];if(i){i.destroy()}}this.loaders={};e.prototype.destroy.call(this)};r.onKeyLoading=function e(t){var r=t.frag;var i=r.type;var n=this.loaders[i];if(!r.decryptdata){o["logger"].warn("Missing decryption data on fragment in onKeyLoading");return}var a=r.decryptdata.uri;if(a!==this.decrypturl||this.decryptkey===null){var u=this.hls.config;if(n){o["logger"].warn("abort previous key loader for type:"+i);n.abort()}if(!a){o["logger"].warn("key uri is falsy");return}r.loader=this.loaders[i]=new u.loader(u);this.decrypturl=a;this.decryptkey=null;var l={url:a,frag:r,responseType:"arraybuffer"};var d={timeout:u.fragLoadingTimeOut,maxRetry:0,retryDelay:u.fragLoadingRetryDelay,maxRetryDelay:u.fragLoadingMaxRetryTimeout};var f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};r.loader.load(l,d,f)}else if(this.decryptkey){r.decryptdata.key=this.decryptkey;this.hls.trigger(s["default"].KEY_LOADED,{frag:r})}};r.loadsuccess=function e(t,r,i){var n=i.frag;if(!n.decryptdata){o["logger"].error("after key load, decryptdata unset");return}this.decryptkey=n.decryptdata.key=new Uint8Array(t.data);n.loader=undefined;delete this.loaders[n.type];this.hls.trigger(s["default"].KEY_LOADED,{frag:n})};r.loaderror=function e(t,r){var i=r.frag;var a=i.loader;if(a){a.abort()}delete this.loaders[i.type];this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].KEY_LOAD_ERROR,fatal:false,frag:i,response:t})};r.loadtimeout=function e(t,r){var i=r.frag;var a=i.loader;if(a){a.abort()}delete this.loaders[i.type];this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].NETWORK_ERROR,details:n["ErrorDetails"].KEY_LOAD_TIMEOUT,fatal:false,frag:i})};return t}(d);var X=Y;function J(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Q={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var $=function(e){J(t,e);function t(t){var r;r=e.call(this,t,s["default"].BUFFER_APPENDED,s["default"].FRAG_BUFFERED,s["default"].FRAG_LOADED)||this;r.bufferPadding=.2;r.fragments=Object.create(null);r.timeRanges=Object.create(null);r.config=t.config;return r}var r=t.prototype;r.destroy=function t(){this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.config=null;d.prototype.destroy.call(this);e.prototype.destroy.call(this)};r.getBufferedFrag=function e(t,r){var i=this.fragments;var n=Object.keys(i).filter((function(e){var n=i[e];if(n.body.type!==r){return false}if(!n.buffered){return false}var a=n.body;return a.startPTS<=t&&t<=a.endPTS}));if(n.length===0){return null}else{var a=n.pop();return i[a].body}};r.detectEvictedFragments=function e(t,r){var i=this;Object.keys(this.fragments).forEach((function(e){var n=i.fragments[e];if(!n||!n.buffered){return}var a=n.range[t];if(!a){return}var s=a.time;for(var o=0;o<s.length;o++){var u=s[o];if(!i.isTimeBuffered(u.startPTS,u.endPTS,r)){i.removeFragment(n.body);break}}}))};r.detectPartialFragments=function e(t){var r=this;var i=this.getFragmentKey(t);var n=this.fragments[i];if(n){n.buffered=true;Object.keys(this.timeRanges).forEach((function(e){if(t.hasElementaryStream(e)){var i=r.timeRanges[e];n.range[e]=r.getBufferedTimes(t.startPTS,t.endPTS,i)}}))}};r.getBufferedTimes=function e(t,r,i){var n=[];var a,s;var o=false;for(var u=0;u<i.length;u++){a=i.start(u)-this.bufferPadding;s=i.end(u)+this.bufferPadding;if(t>=a&&r<=s){n.push({startPTS:Math.max(t,i.start(u)),endPTS:Math.min(r,i.end(u))});break}else if(t<s&&r>a){n.push({startPTS:Math.max(t,i.start(u)),endPTS:Math.min(r,i.end(u))});o=true}else if(r<=a){break}}return{time:n,partial:o}};r.getFragmentKey=function e(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn};r.getPartialFragment=function e(t){var r=this;var i,n,a;var s=null;var o=0;Object.keys(this.fragments).forEach((function(e){var u=r.fragments[e];if(r.isPartial(u)){n=u.body.startPTS-r.bufferPadding;a=u.body.endPTS+r.bufferPadding;if(t>=n&&t<=a){i=Math.min(t-n,a-t);if(o<=i){s=u.body;o=i}}}}));return s};r.getState=function e(t){var r=this.getFragmentKey(t);var i=this.fragments[r];var n=Q.NOT_LOADED;if(i!==undefined){if(!i.buffered){n=Q.APPENDING}else if(this.isPartial(i)===true){n=Q.PARTIAL}else{n=Q.OK}}return n};r.isPartial=function e(t){return t.buffered===true&&(t.range.video!==undefined&&t.range.video.partial===true||t.range.audio!==undefined&&t.range.audio.partial===true)};r.isTimeBuffered=function e(t,r,i){var n,a;for(var s=0;s<i.length;s++){n=i.start(s)-this.bufferPadding;a=i.end(s)+this.bufferPadding;if(t>=n&&r<=a){return true}if(r<=n){return false}}return false};r.onFragLoaded=function e(t){var r=t.frag;if(!Object(a["isFiniteNumber"])(r.sn)||r.bitrateTest){return}this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:false}};r.onBufferAppended=function e(t){var r=this;this.timeRanges=t.timeRanges;Object.keys(this.timeRanges).forEach((function(e){var t=r.timeRanges[e];r.detectEvictedFragments(e,t)}))};r.onFragBuffered=function e(t){this.detectPartialFragments(t.frag)};r.hasFragment=function e(t){var r=this.getFragmentKey(t);return this.fragments[r]!==undefined};r.removeFragment=function e(t){var r=this.getFragmentKey(t);delete this.fragments[r]};r.removeAllFragments=function e(){this.fragments=Object.create(null)};return t}(d);var Z={search:function e(t,r){var i=0;var n=t.length-1;var a=null;var s=null;while(i<=n){a=(i+n)/2|0;s=t[a];var o=r(s);if(o>0){i=a+1}else if(o<0){n=a-1}else{return s}}return null}};var ee=Z;var te=function(){function e(){}e.isBuffered=function e(t,r){try{if(t){var i=t.buffered;for(var n=0;n<i.length;n++){if(r>=i.start(n)&&r<=i.end(n)){return true}}}}catch(e){}return false};e.bufferInfo=function e(t,r,i){try{if(t){var n=t.buffered;var a=[];var s;for(s=0;s<n.length;s++){a.push({start:n.start(s),end:n.end(s)})}return this.bufferedInfo(a,r,i)}}catch(e){}return{len:0,start:r,end:r,nextStart:undefined}};e.bufferedInfo=function e(t,r,i){t.sort((function(e,t){var r=e.start-t.start;if(r){return r}else{return t.end-e.end}}));var n=[];if(i){for(var a=0;a<t.length;a++){var s=n.length;if(s){var o=n[s-1].end;if(t[a].start-o<i){if(t[a].end>o){n[s-1].end=t[a].end}}else{n.push(t[a])}}else{n.push(t[a])}}}else{n=t}var u=0;var l;var d=r;var f=r;for(var c=0;c<n.length;c++){var h=n[c].start,p=n[c].end;if(r+i>=h&&r<p){d=h;f=p;u=f-r}else if(r+i<h){l=h;break}}return{len:u,start:d,end:f,nextStart:l}};return e}();var re=r("./node_modules/eventemitter3/index.js");var ie=r("./node_modules/webworkify-webpack/index.js");var ne=r("./src/demux/demuxer-inline.js");function ae(){return window.MediaSource||window.WebKitMediaSource}var se=r("./src/utils/get-self-scope.js");function oe(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var ue=function(e){oe(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.trigger=function e(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++){i[n-1]=arguments[n]}this.emit.apply(this,[t,t].concat(i))};return t}(re["EventEmitter"]);var le=Object(se["getSelfScope"])();var de=ae()||{isTypeSupported:function e(){return false}};var fe=function(){function e(e,t){var r=this;this.hls=e;this.id=t;var i=this.observer=new ue;var a=e.config;var u=function t(i,n){n=n||{};n.frag=r.frag;n.id=r.id;e.trigger(i,n)};i.on(s["default"].FRAG_DECRYPTED,u);i.on(s["default"].FRAG_PARSING_INIT_SEGMENT,u);i.on(s["default"].FRAG_PARSING_DATA,u);i.on(s["default"].FRAG_PARSED,u);i.on(s["default"].ERROR,u);i.on(s["default"].FRAG_PARSING_METADATA,u);i.on(s["default"].FRAG_PARSING_USERDATA,u);i.on(s["default"].INIT_PTS_FOUND,u);var l={mp4:de.isTypeSupported("video/mp4"),mpeg:de.isTypeSupported("audio/mpeg"),mp3:de.isTypeSupported('audio/mp4; codecs="mp3"')};var d=navigator.vendor;if(a.enableWorker&&typeof Worker!=="undefined"){o["logger"].log("demuxing in webworker");var f;try{f=this.w=ie("./src/demux/demuxer-worker.js");this.onwmsg=this.onWorkerMessage.bind(this);f.addEventListener("message",this.onwmsg);f.onerror=function(t){e.trigger(s["default"].ERROR,{type:n["ErrorTypes"].OTHER_ERROR,details:n["ErrorDetails"].INTERNAL_EXCEPTION,fatal:true,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})};f.postMessage({cmd:"init",typeSupported:l,vendor:d,id:t,config:JSON.stringify(a)})}catch(e){o["logger"].warn("Error in worker:",e);o["logger"].error("Error while initializing DemuxerWorker, fallback on DemuxerInline");if(f){le.URL.revokeObjectURL(f.objectURL)}this.demuxer=new ne["default"](i,l,a,d);this.w=undefined}}else{this.demuxer=new ne["default"](i,l,a,d)}}var t=e.prototype;t.destroy=function e(){var t=this.w;if(t){t.removeEventListener("message",this.onwmsg);t.terminate();this.w=null}else{var r=this.demuxer;if(r){r.destroy();this.demuxer=null}}var i=this.observer;if(i){i.removeAllListeners();this.observer=null}};t.push=function e(t,r,i,n,s,u,l,d){var f=this.w;var c=Object(a["isFiniteNumber"])(s.startPTS)?s.startPTS:s.start;var h=s.decryptdata;var p=this.frag;var v=!(p&&s.cc===p.cc);var m=!(p&&s.level===p.level);var g=p&&s.sn===p.sn+1;var y=!m&&g;if(v){o["logger"].log(this.id+":discontinuity detected")}if(m){o["logger"].log(this.id+":switch detected")}this.frag=s;if(f){f.postMessage({cmd:"demux",data:t,decryptdata:h,initSegment:r,audioCodec:i,videoCodec:n,timeOffset:c,discontinuity:v,trackSwitch:m,contiguous:y,duration:u,accurateTimeOffset:l,defaultInitPTS:d},t instanceof ArrayBuffer?[t]:[])}else{var _=this.demuxer;if(_){_.push(t,h,r,i,n,c,v,m,y,u,l,d)}}};t.onWorkerMessage=function e(t){var r=t.data,i=this.hls;switch(r.event){case"init":le.URL.revokeObjectURL(this.w.objectURL);break;case s["default"].FRAG_PARSING_DATA:r.data.data1=new Uint8Array(r.data1);if(r.data2){r.data.data2=new Uint8Array(r.data2)}default:r.data=r.data||{};r.data.frag=this.frag;r.data.id=this.id;i.trigger(r.event,r.data);break}};return e}();var ce=fe;function he(e,t,r){switch(t){case"audio":if(!e.audioGroupIds){e.audioGroupIds=[]}e.audioGroupIds.push(r);break;case"text":if(!e.textGroupIds){e.textGroupIds=[]}e.textGroupIds.push(r);break}}function pe(e,t,r){var i=e[t],n=e[r],s=n.startPTS;if(Object(a["isFiniteNumber"])(s)){if(r>t){i.duration=s-i.start;if(i.duration<0){o["logger"].warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")}}else{n.duration=i.start-s;if(n.duration<0){o["logger"].warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")}}}else{if(r>t){var u=i.cc===n.cc;n.start=i.start+(u&&i.minEndPTS?i.minEndPTS-i.start:i.duration)}else{n.start=Math.max(i.start-n.duration,0)}}}function ve(e,t,r,i,n,s){var o=r;var u=i;if(Object(a["isFiniteNumber"])(t.startPTS)){var l=Math.abs(t.startPTS-r);if(!Object(a["isFiniteNumber"])(t.deltaPTS)){t.deltaPTS=l}else{t.deltaPTS=Math.max(l,t.deltaPTS)}o=Math.max(r,t.startPTS);r=Math.min(r,t.startPTS);u=Math.min(i,t.endPTS);i=Math.max(i,t.endPTS);n=Math.min(n,t.startDTS);s=Math.max(s,t.endDTS)}var d=r-t.start;t.start=t.startPTS=r;t.maxStartPTS=o;t.endPTS=i;t.minEndPTS=u;t.startDTS=n;t.endDTS=s;t.duration=i-r;var f=t.sn;if(!e||f<e.startSN||f>e.endSN){return 0}var c,h,p;c=f-e.startSN;h=e.fragments;h[c]=t;for(p=c;p>0;p--){pe(h,p,p-1)}for(p=c;p<h.length-1;p++){pe(h,p,p+1)}e.PTSKnown=true;return d}function me(e,t){if(t.initSegment&&e.initSegment){t.initSegment=e.initSegment}var r=0;var i;ye(e,t,(function(e,n){r=e.cc-n.cc;if(Object(a["isFiniteNumber"])(e.startPTS)){n.start=n.startPTS=e.startPTS;n.endPTS=e.endPTS;n.duration=e.duration;n.backtracked=e.backtracked;n.dropped=e.dropped;i=n}t.PTSKnown=true}));if(!t.PTSKnown){return}if(r){o["logger"].log("discontinuity sliding from playlist, take drift into account");var n=t.fragments;for(var s=0;s<n.length;s++){n[s].cc+=r}}if(i){ve(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS)}else{_e(e,t)}t.PTSKnown=e.PTSKnown}function ge(e,t,r){if(r===void 0){r=0}var i=-1;ye(e,t,(function(e,t,r){t.start=e.start;i=r}));var n=t.fragments;if(i<0){n.forEach((function(e){e.start+=r}));return}for(var a=i+1;a<n.length;a++){n[a].start=n[a-1].start+n[a-1].duration}}function ye(e,t,r){if(!e||!t){return}var i=Math.max(e.startSN,t.startSN)-t.startSN;var n=Math.min(e.endSN,t.endSN)-t.startSN;var a=t.startSN-e.startSN;for(var s=i;s<=n;s++){var o=e.fragments[a+s];var u=t.fragments[s];if(!o||!u){break}r(o,u,s)}}function _e(e,t){var r=t.startSN-e.startSN;var i=e.fragments;var n=t.fragments;if(r<0||r>i.length){return}for(var a=0;a<n.length;a++){n[a].start+=i[r].start}}function be(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration);var n=i/2;if(e&&t.endSN===e.endSN){i=n}if(r){i=Math.max(n,i-(window.performance.now()-r))}return Math.round(i)}var Te={toString:function e(t){var r="";var i=t.length;for(var n=0;n<i;n++){r+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]"}return r}};var Se=Te;function Ee(e,t){var r=null;for(var i=0;i<e.length;i+=1){var n=e[i];if(n&&n.cc===t){r=n;break}}return r}function we(e,t){return ee.search(e,(function(e){if(e.cc<t){return 1}else if(e.cc>t){return-1}else{return 0}}))}function ke(e,t,r){var i=false;if(t&&t.details&&r){if(r.endCC>r.startCC||e&&e.cc<r.startCC){i=true}}return i}function Ae(e,t){var r=e.fragments;var i=t.fragments;if(!i.length||!r.length){o["logger"].log("No fragments to align");return}var n=Ee(r,i[0].cc);if(!n||n&&!n.startPTS){o["logger"].log("No frag in previous level to align on");return}return n}function Ce(e,t){t.fragments.forEach((function(t){if(t){var r=t.start+e;t.start=t.startPTS=r;t.endPTS=r+t.duration}}));t.PTSKnown=true}function Le(e,t,r){xe(e,r,t);if(!r.PTSKnown&&t){De(r,t.details)}}function xe(e,t,r){if(ke(e,r,t)){var i=Ae(r.details,t);if(i){o["logger"].log("Adjusting PTS using last level due to CC increase within current level");Ce(i.start,t)}}}function De(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime){return}var r=t.fragments[0].programDateTime;var i=e.fragments[0].programDateTime;var n=(i-r)/1e3+t.fragments[0].start;if(Object(a["isFiniteNumber"])(n)){o["logger"].log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3));Ce(n,e)}}}function Ie(e,t,r){if(t===null||!Array.isArray(e)||!e.length||!Object(a["isFiniteNumber"])(t)){return null}var i=e[0].programDateTime;if(t<(i||0)){return null}var n=e[e.length-1].endProgramDateTime;if(t>=(n||0)){return null}r=r||0;for(var s=0;s<e.length;++s){var o=e[s];if(Pe(t,r,o)){return o}}return null}function Oe(e,t,r,i){if(r===void 0){r=0}if(i===void 0){i=0}var n=null;if(e){n=t[e.sn-t[0].sn+1]}else if(r===0&&t[0].start===0){n=t[0]}if(n&&Re(r,i,n)===0){return n}var a=ee.search(t,Re.bind(null,r,i));if(a){return a}return n}function Re(e,t,r){if(e===void 0){e=0}if(t===void 0){t=0}var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));if(r.start+r.duration-i<=e){return 1}else if(r.start-i>e&&r.start){return-1}return 0}function Pe(e,t,r){var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0))*1e3;var n=r.endProgramDateTime||0;return n-i>e}var Ue=250;var Me=2;var Ne=.1;var je=.05;var Be=function(){function e(e,t,r,i){this.config=e;this.media=t;this.fragmentTracker=r;this.hls=i;this.nudgeRetry=0;this.stallReported=false;this.stalled=null;this.moved=false;this.seeking=false}var t=e.prototype;t.poll=function e(t){var r=this.config,i=this.media,n=this.stalled;var a=i.currentTime,s=i.seeking;var u=this.seeking&&!s;var l=!this.seeking&&s;this.seeking=s;if(a!==t){this.moved=true;if(n!==null){if(this.stallReported){var d=self.performance.now()-n;o["logger"].warn("playback not stuck anymore @"+a+", after "+Math.round(d)+"ms");this.stallReported=false}this.stalled=null;this.nudgeRetry=0}return}if(l||u){this.stalled=null}if(i.paused||i.ended||i.playbackRate===0||!i.buffered.length){return}var f=te.bufferInfo(i,a,0);var c=f.len>0;var h=f.nextStart||0;if(!c&&!h){return}if(s){var p=f.len>Me;var v=!h||h-a>Me&&!this.fragmentTracker.getPartialFragment(a);if(p||v){return}this.moved=false}if(!this.moved&&this.stalled){var m=Math.max(h,f.start||0)-a;if(m>0&&m<=Me){this._trySkipBufferHole(null);return}}var g=self.performance.now();if(n===null){this.stalled=g;return}var y=g-n;if(!s&&y>=Ue){this._reportStall(f.len)}var _=te.bufferInfo(i,a,r.maxBufferHole);this._tryFixBufferStall(_,y)};t._tryFixBufferStall=function e(t,r){var i=this.config,n=this.fragmentTracker,a=this.media;var s=a.currentTime;var u=n.getPartialFragment(s);if(u){var l=this._trySkipBufferHole(u);if(l){return}}if(t.len>i.maxBufferHole&&r>i.highBufferWatchdogPeriod*1e3){o["logger"].warn("Trying to nudge playhead over buffer-hole");this.stalled=null;this._tryNudgeBuffer()}};t._reportStall=function e(t){var r=this.hls,i=this.media,a=this.stallReported;if(!a){this.stallReported=true;o["logger"].warn("Playback stalling at @"+i.currentTime+" due to low buffer (buffer="+t+")");r.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_STALLED_ERROR,fatal:false,buffer:t})}};t._trySkipBufferHole=function e(t){var r=this.config,i=this.hls,a=this.media;var u=a.currentTime;var l=0;for(var d=0;d<a.buffered.length;d++){var f=a.buffered.start(d);if(u+r.maxBufferHole>=l&&u<f){var c=Math.max(f+je,a.currentTime+Ne);o["logger"].warn("skipping hole, adjusting currentTime from "+u+" to "+c);this.moved=true;this.stalled=null;a.currentTime=c;if(t){i.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_SEEK_OVER_HOLE,fatal:false,reason:"fragment loaded with buffer holes, seeking from "+u+" to "+c,frag:t})}return c}l=a.buffered.end(d)}return 0};t._tryNudgeBuffer=function e(){var t=this.config,r=this.hls,i=this.media;var a=i.currentTime;var u=(this.nudgeRetry||0)+1;this.nudgeRetry=u;if(u<t.nudgeMaxRetry){var l=a+u*t.nudgeOffset;o["logger"].warn("Nudging 'currentTime' from "+a+" to "+l);i.currentTime=l;r.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_NUDGE_ON_STALL,fatal:false})}else{o["logger"].error("Playhead still not moving while enough data buffered @"+a+" after "+t.nudgeMaxRetry+" nudges");r.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_STALLED_ERROR,fatal:true})}};return e}();function Fe(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function He(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var qe=function(e){He(t,e);function t(t){var r;for(var i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++){n[a-1]=arguments[a]}r=e.call.apply(e,[this,t].concat(n))||this;r._boundTick=void 0;r._tickTimer=null;r._tickInterval=null;r._tickCallCount=0;r._boundTick=r.tick.bind(Fe(r));return r}var r=t.prototype;r.onHandlerDestroying=function e(){this.clearNextTick();this.clearInterval()};r.hasInterval=function e(){return!!this._tickInterval};r.hasNextTick=function e(){return!!this._tickTimer};r.setInterval=function e(t){if(!this._tickInterval){this._tickInterval=self.setInterval(this._boundTick,t);return true}return false};r.clearInterval=function e(){if(this._tickInterval){self.clearInterval(this._tickInterval);this._tickInterval=null;return true}return false};r.clearNextTick=function e(){if(this._tickTimer){self.clearTimeout(this._tickTimer);this._tickTimer=null;return true}return false};r.tick=function e(){this._tickCallCount++;if(this._tickCallCount===1){this.doTick();if(this._tickCallCount>1){this.clearNextTick();this._tickTimer=self.setTimeout(this._boundTick,0)}this._tickCallCount=0}};r.doTick=function e(){};return t}(d);function Ge(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Ve={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var We=function(e){Ge(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.doTick=function e(){};r.startLoad=function e(){};r.stopLoad=function e(){var t=this.fragCurrent;if(t){if(t.loader){t.loader.abort()}this.fragmentTracker.removeFragment(t)}if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.fragCurrent=null;this.fragPrevious=null;this.clearInterval();this.clearNextTick();this.state=Ve.STOPPED};r._streamEnded=function e(t,r){var i=this.fragCurrent,n=this.fragmentTracker;if(!r.live&&i&&!i.backtracked&&i.sn===r.endSN&&!t.nextStart){var a=n.getState(i);return a===Q.PARTIAL||a===Q.OK}return false};r.onMediaSeeking=function e(){var t=this.config,r=this.media,i=this.mediaBuffer,n=this.state;var s=r?r.currentTime:null;var u=te.bufferInfo(i||r,s,this.config.maxBufferHole);o["logger"].log("media seeking to "+(Object(a["isFiniteNumber"])(s)?s.toFixed(3):s));if(n===Ve.FRAG_LOADING){var l=this.fragCurrent;if(u.len===0&&l){var d=t.maxFragLookUpTolerance;var f=l.start-d;var c=l.start+l.duration+d;if(s<f||s>c){if(l.loader){o["logger"].log("seeking outside of buffer while fragment load in progress, cancel fragment load");l.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;this.state=Ve.IDLE}else{o["logger"].log("seeking outside of buffer but within currently loaded fragment range")}}}else if(n===Ve.ENDED){if(u.len===0){this.fragPrevious=null;this.fragCurrent=null}this.state=Ve.IDLE}if(r){this.lastCurrentTime=s}if(!this.loadedmetadata){this.nextLoadPosition=this.startPosition=s}this.tick()};r.onMediaEnded=function e(){this.startPosition=this.lastCurrentTime=0};r.onHandlerDestroying=function t(){this.stopLoad();e.prototype.onHandlerDestroying.call(this)};r.onHandlerDestroyed=function e(){this.state=Ve.STOPPED;this.fragmentTracker=null};r.computeLivePosition=function e(t,r){var i=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*r.targetduration;return t+Math.max(0,r.totalduration-i)};return t}(qe);function ze(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Ke(e,t,r){if(t)ze(e.prototype,t);if(r)ze(e,r);return e}function Ye(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Xe=100;var Je=function(e){Ye(t,e);function t(t,r){var i;i=e.call(this,t,s["default"].MEDIA_ATTACHED,s["default"].MEDIA_DETACHING,s["default"].MANIFEST_LOADING,s["default"].MANIFEST_PARSED,s["default"].LEVEL_LOADED,s["default"].LEVELS_UPDATED,s["default"].KEY_LOADED,s["default"].FRAG_LOADED,s["default"].FRAG_LOAD_EMERGENCY_ABORTED,s["default"].FRAG_PARSING_INIT_SEGMENT,s["default"].FRAG_PARSING_DATA,s["default"].FRAG_PARSED,s["default"].ERROR,s["default"].AUDIO_TRACK_SWITCHING,s["default"].AUDIO_TRACK_SWITCHED,s["default"].BUFFER_CREATED,s["default"].BUFFER_APPENDED,s["default"].BUFFER_FLUSHED)||this;i.fragmentTracker=r;i.config=t.config;i.audioCodecSwap=false;i._state=Ve.STOPPED;i.stallReported=false;i.gapController=null;i.altAudio=false;i.audioOnly=false;i.bitrateTest=false;return i}var r=t.prototype;r.startLoad=function e(t){if(this.levels){var r=this.lastCurrentTime,i=this.hls;this.stopLoad();this.setInterval(Xe);this.level=-1;this.fragLoadError=0;if(!this.startFragRequested){var n=i.startLevel;if(n===-1){if(i.config.testBandwidth){n=0;this.bitrateTest=true}else{n=i.nextAutoLevel}}this.level=i.nextLoadLevel=n;this.loadedmetadata=false}if(r>0&&t===-1){o["logger"].log("override startPosition with lastCurrentTime @"+r.toFixed(3));t=r}this.state=Ve.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t;this.tick()}else{this.forceStartLoad=true;this.state=Ve.STOPPED}};r.stopLoad=function t(){this.forceStartLoad=false;e.prototype.stopLoad.call(this)};r.doTick=function e(){switch(this.state){case Ve.BUFFER_FLUSHING:this.fragLoadError=0;break;case Ve.IDLE:this._doTickIdle();break;case Ve.WAITING_LEVEL:var t=this.levels[this.level];if(t&&t.details){this.state=Ve.IDLE}break;case Ve.FRAG_LOADING_WAITING_RETRY:var r=window.performance.now();var i=this.retryDate;if(!i||r>=i||this.media&&this.media.seeking){o["logger"].log("mediaController: retryDate reached, switch back to IDLE state");this.state=Ve.IDLE}break;case Ve.ERROR:case Ve.STOPPED:case Ve.FRAG_LOADING:case Ve.PARSING:case Ve.PARSED:case Ve.ENDED:break;default:break}this._checkBuffer();this._checkFragmentChanged()};r._doTickIdle=function e(){var t=this.hls,r=t.config,i=this.media;if(this.levelLastLoaded===undefined||!i&&(this.startFragRequested||!r.startFragPrefetch)){return}if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var n;if(this.loadedmetadata){n=i.currentTime}else{n=this.nextLoadPosition}var a=t.nextLoadLevel,u=this.levels[a];if(!u){return}var l=u.bitrate,d;if(l){d=Math.max(8*r.maxBufferSize/l,r.maxBufferLength)}else{d=r.maxBufferLength}d=Math.min(d,r.maxMaxBufferLength);var f=n<r.maxBufferHole?Math.max(Me,r.maxBufferHole):r.maxBufferHole;var c=te.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,f);var h=c.len;if(h>=d){return}o["logger"].trace("buffer length of "+h.toFixed(3)+" is below max of "+d.toFixed(3)+". checking for more payload ...");this.level=t.nextLoadLevel=a;var p=u.details;if(!p||p.live&&this.levelLastLoaded!==a){this.state=Ve.WAITING_LEVEL;return}if(this._streamEnded(c,p)){var v={};if(this.altAudio){v.type="video"}this.hls.trigger(s["default"].BUFFER_EOS,v);this.state=Ve.ENDED;return}this._fetchPayloadOrEos(n,c,p)};r._fetchPayloadOrEos=function e(t,r,i){var n=this.fragPrevious,a=this.level,s=i.fragments,u=s.length;if(u===0){return}var l=s[0].start,d=s[u-1].start+s[u-1].duration,f=r.end,c;if(i.initSegment&&!i.initSegment.data){c=i.initSegment}else{if(i.live){var h=this.config.initialLiveManifestSize;if(u<h){o["logger"].warn("Can not start playback of a level, reason: not enough fragments "+u+" < "+h);return}c=this._ensureFragmentAtLivePoint(i,f,l,d,n,s);if(c===null){return}}else{if(f<l){c=s[0]}}}if(!c){c=this._findFragment(l,n,u,s,f,d,i)}if(c){if(c.encrypted){this._loadKey(c,i)}else{this._loadFragment(c,i,t,f)}}};r._ensureFragmentAtLivePoint=function e(t,r,i,n,s,u){var l=this.hls.config,d=this.media;var f;var c=Infinity;if(l.liveMaxLatencyDuration!==undefined){c=l.liveMaxLatencyDuration}else if(Object(a["isFiniteNumber"])(l.liveMaxLatencyDurationCount)){c=l.liveMaxLatencyDurationCount*t.targetduration}if(r<Math.max(i-l.maxFragLookUpTolerance,n-c)){var h=this.liveSyncPosition=this.computeLivePosition(i,t);r=h;if(d&&!d.paused&&d.readyState&&d.duration>h&&h>d.currentTime){o["logger"].log("buffer end: "+r.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3));d.currentTime=h}this.nextLoadPosition=h}if(t.PTSKnown&&r>n&&d&&d.readyState){return null}if(this.startFragRequested&&!t.PTSKnown){if(s){if(t.hasProgramDateTime){o["logger"].log("live playlist, switching playlist, load frag with same PDT: "+s.programDateTime);f=Ie(u,s.endProgramDateTime,l.maxFragLookUpTolerance)}else{var p=s.sn+1;if(p>=t.startSN&&p<=t.endSN){var v=u[p-t.startSN];if(s.cc===v.cc){f=v;o["logger"].log("live playlist, switching playlist, load frag with next SN: "+f.sn)}}if(!f){f=ee.search(u,(function(e){return s.cc-e.cc}));if(f){o["logger"].log("live playlist, switching playlist, load frag with same CC: "+f.sn)}}}}}return f};r._findFragment=function e(t,r,i,n,a,s,u){var l=this.hls.config;var d;if(a<s){var f=a>s-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;d=Oe(r,n,a,f)}else{d=n[i-1]}if(d){var c=d.sn-u.startSN;var h=r&&d.level===r.level;var p=n[c-1];var v=n[c+1];if(r&&d.sn===r.sn){if(h&&!d.backtracked){if(d.sn<u.endSN){var m=r.deltaPTS;if(m&&m>l.maxBufferHole&&r.dropped&&c){d=p;o["logger"].warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")}else{d=v;if(this.fragmentTracker.getState(d)!==Q.OK){o["logger"].log("Re-loading fragment with SN: "+d.sn)}}}else{d=null}}else if(d.backtracked){if(v&&v.backtracked){o["logger"].warn("Already backtracked from fragment "+v.sn+", will not backtrack to fragment "+d.sn+". Loading fragment "+v.sn);d=v}else{o["logger"].warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe");d.dropped=0;if(p){d=p;d.backtracked=true}else if(c){d=null}}}}}return d};r._loadKey=function e(t,r){o["logger"].log("Loading key for "+t.sn+" of ["+r.startSN+"-"+r.endSN+"], level "+this.level);this.state=Ve.KEY_LOADING;this.hls.trigger(s["default"].KEY_LOADING,{frag:t})};r._loadFragment=function e(t,r,i,n){var u=this.fragmentTracker.getState(t);this.fragCurrent=t;if(t.sn!=="initSegment"){this.startFragRequested=true}if(Object(a["isFiniteNumber"])(t.sn)&&!t.bitrateTest){this.nextLoadPosition=t.start+t.duration}if(t.backtracked||u===Q.NOT_LOADED||u===Q.PARTIAL){t.autoLevel=this.hls.autoLevelEnabled;t.bitrateTest=this.bitrateTest;o["logger"].log("Loading "+t.sn+" of ["+r.startSN+"-"+r.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(i.toFixed(3))+", bufferEnd: "+parseFloat(n.toFixed(3)));this.hls.trigger(s["default"].FRAG_LOADING,{frag:t});if(!this.demuxer){this.demuxer=new ce(this.hls,"main")}this.state=Ve.FRAG_LOADING}else if(u===Q.APPENDING){if(this._reduceMaxBufferLength(t.duration)){this.fragmentTracker.removeFragment(t)}}};r.getBufferedFrag=function e(t){return this.fragmentTracker.getBufferedFrag(t,c.MAIN)};r.followingBufferedFrag=function e(t){if(t){return this.getBufferedFrag(t.endPTS+.5)}return null};r._checkFragmentChanged=function e(){var t,r,i=this.media;if(i&&i.readyState&&i.seeking===false){r=i.currentTime;if(r>this.lastCurrentTime){this.lastCurrentTime=r}if(te.isBuffered(i,r)){t=this.getBufferedFrag(r)}else if(te.isBuffered(i,r+.1)){t=this.getBufferedFrag(r+.1)}if(t){var n=t;if(n!==this.fragPlaying){this.hls.trigger(s["default"].FRAG_CHANGED,{frag:n});var a=n.level;if(!this.fragPlaying||this.fragPlaying.level!==a){this.hls.trigger(s["default"].LEVEL_SWITCHED,{level:a})}this.fragPlaying=n}}}};r.immediateLevelSwitch=function e(){o["logger"].log("immediateLevelSwitch");if(!this.immediateSwitch){this.immediateSwitch=true;var t=this.media,r;if(t){r=t.paused;if(!r){t.pause()}}else{r=true}this.previouslyPaused=r}var i=this.fragCurrent;if(i&&i.loader){i.loader.abort()}this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)};r.immediateLevelSwitchEnd=function e(){var t=this.media;if(t&&t.buffered.length){this.immediateSwitch=false;if(t.currentTime>0&&te.isBuffered(t,t.currentTime)){t.currentTime-=1e-4}if(!this.previouslyPaused){t.play()}}};r.nextLevelSwitch=function e(){var t=this.media;if(t&&t.readyState){var r;var i=this.getBufferedFrag(t.currentTime);if(i&&i.startPTS>1){this.flushMainBuffer(0,i.startPTS-1)}if(!t.paused){var n=this.hls.nextLoadLevel,a=this.levels[n],s=this.fragLastKbps;if(s&&this.fragCurrent){r=this.fragCurrent.duration*a.bitrate/(1e3*s)+1}else{r=0}}else{r=0}var o=this.getBufferedFrag(t.currentTime+r);if(o){var u=this.followingBufferedFrag(o);if(u){var l=this.fragCurrent;if(l&&l.loader){l.loader.abort()}this.fragCurrent=null;var d=Math.max(o.endPTS,u.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,u.duration));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}};r.flushMainBuffer=function e(t,r){this.state=Ve.BUFFER_FLUSHING;var i={startOffset:t,endOffset:r};if(this.altAudio){i.type="video"}this.hls.trigger(s["default"].BUFFER_FLUSHING,i)};r.onMediaAttached=function e(t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("seeked",this.onvseeked);r.addEventListener("ended",this.onvended);var i=this.config;if(this.levels&&i.autoStartLoad){this.hls.startLoad(i.startPosition)}this.gapController=new Be(i,r,this.fragmentTracker,this.hls)};r.onMediaDetaching=function e(){var t=this.media;if(t&&t.ended){o["logger"].log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}var r=this.levels;if(r){r.forEach((function(e){if(e.details){e.details.fragments.forEach((function(e){e.backtracked=undefined}))}}))}if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("seeked",this.onvseeked);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.fragmentTracker.removeAllFragments();this.media=this.mediaBuffer=null;this.loadedmetadata=false;this.stopLoad()};r.onMediaSeeked=function e(){var t=this.media;var r=t?t.currentTime:undefined;if(Object(a["isFiniteNumber"])(r)){o["logger"].log("media seeked to "+r.toFixed(3))}this.tick()};r.onManifestLoading=function e(){o["logger"].log("trigger BUFFER_RESET");this.hls.trigger(s["default"].BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=false;this.startPosition=this.lastCurrentTime=0};r.onManifestParsed=function e(t){var r=false,i=false,n;t.levels.forEach((function(e){n=e.audioCodec;if(n){if(n.indexOf("mp4a.40.2")!==-1){r=true}if(n.indexOf("mp4a.40.5")!==-1){i=true}}}));this.audioCodecSwitch=r&&i;if(this.audioCodecSwitch){o["logger"].log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC")}this.altAudio=t.altAudio;this.levels=t.levels;this.startFragRequested=false;var a=this.config;if(a.autoStartLoad||this.forceStartLoad){this.hls.startLoad(a.startPosition)}};r.onLevelLoaded=function e(t){var r=t.details;var i=t.level;var n=this.levels[this.levelLastLoaded];var u=this.levels[i];var l=r.totalduration;var d=0;o["logger"].log("level "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+l);if(r.live||u.details&&u.details.live){var f=u.details;if(f&&r.fragments.length>0){me(f,r);d=r.fragments[0].start;this.liveSyncPosition=this.computeLivePosition(d,f);if(r.PTSKnown&&Object(a["isFiniteNumber"])(d)){o["logger"].log("live playlist sliding:"+d.toFixed(3))}else{o["logger"].log("live playlist - outdated PTS, unknown sliding");Le(this.fragPrevious,n,r)}}else{o["logger"].log("live playlist - first load, unknown sliding");r.PTSKnown=false;Le(this.fragPrevious,n,r)}}else{r.PTSKnown=false}u.details=r;this.levelLastLoaded=i;this.hls.trigger(s["default"].LEVEL_UPDATED,{details:r,level:i});if(this.startFragRequested===false){if(this.startPosition===-1||this.lastCurrentTime===-1){var c=r.startTimeOffset;if(Object(a["isFiniteNumber"])(c)){if(c<0){o["logger"].log("negative start time offset "+c+", count from end of last fragment");c=d+l+c}o["logger"].log("start time offset found in playlist, adjust startPosition to "+c);this.startPosition=c}else{if(r.live){this.startPosition=this.computeLivePosition(d,r);o["logger"].log("configure startPosition to "+this.startPosition)}else{this.startPosition=0}}this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}if(this.state===Ve.WAITING_LEVEL){this.state=Ve.IDLE}this.tick()};r.onKeyLoaded=function e(){if(this.state===Ve.KEY_LOADING){this.state=Ve.IDLE;this.tick()}};r.onFragLoaded=function e(t){var r=this.fragCurrent,i=this.hls,n=this.levels,a=this.media;var u=t.frag;if(this.state===Ve.FRAG_LOADING&&r&&u.type==="main"&&u.level===r.level&&u.sn===r.sn){var l=t.stats;var d=n[r.level];var f=d.details;this.bitrateTest=false;this.stats=l;o["logger"].log("Loaded "+r.sn+" of ["+f.startSN+" ,"+f.endSN+"],level "+r.level);if(u.bitrateTest&&i.nextLoadLevel){this.state=Ve.IDLE;this.startFragRequested=false;l.tparsed=l.tbuffered=window.performance.now();i.trigger(s["default"].FRAG_BUFFERED,{stats:l,frag:r,id:"main"});this.tick()}else if(u.sn==="initSegment"){this.state=Ve.IDLE;l.tparsed=l.tbuffered=window.performance.now();f.initSegment.data=t.payload;i.trigger(s["default"].FRAG_BUFFERED,{stats:l,frag:r,id:"main"});this.tick()}else{o["logger"].log("Parsing "+r.sn+" of ["+f.startSN+" ,"+f.endSN+"],level "+r.level+", cc "+r.cc);this.state=Ve.PARSING;this.pendingBuffering=true;this.appended=false;if(u.bitrateTest){u.bitrateTest=false;this.fragmentTracker.onFragLoaded({frag:u})}var c=!(a&&a.seeking)&&(f.PTSKnown||!f.live);var h=f.initSegment?f.initSegment.data:[];var p=this._getAudioCodec(d);var v=this.demuxer=this.demuxer||new ce(this.hls,"main");v.push(t.payload,h,p,d.videoCodec,r,f.totalduration,c)}}this.fragLoadError=0};r.onFragParsingInitSegment=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="main"&&i.sn===r.sn&&i.level===r.level&&this.state===Ve.PARSING){var n=t.tracks,a,u;this.audioOnly=n.audio&&!n.video;if(this.altAudio&&!this.audioOnly){delete n.audio}u=n.audio;if(u){var l=this.levels[this.level].audioCodec,d=navigator.userAgent.toLowerCase();if(l&&this.audioCodecSwap){o["logger"].log("swapping playlist audio codec");if(l.indexOf("mp4a.40.5")!==-1){l="mp4a.40.2"}else{l="mp4a.40.5"}}if(this.audioCodecSwitch){if(u.metadata.channelCount!==1&&d.indexOf("firefox")===-1){l="mp4a.40.5"}}if(d.indexOf("android")!==-1&&u.container!=="audio/mpeg"){l="mp4a.40.2";o["logger"].log("Android: force audio codec to "+l)}u.levelCodec=l;u.id=t.id}u=n.video;if(u){u.levelCodec=this.levels[this.level].videoCodec;u.id=t.id}this.hls.trigger(s["default"].BUFFER_CODECS,n);for(a in n){u=n[a];o["logger"].log("main track:"+a+",container:"+u.container+",codecs[level/parsed]=["+u.levelCodec+"/"+u.codec+"]");var f=u.initSegment;if(f){this.appended=true;this.pendingBuffering=true;this.hls.trigger(s["default"].BUFFER_APPENDING,{type:a,data:f,parent:"main",content:"initSegment"})}}this.tick()}};r.onFragParsingData=function e(t){var r=this;var i=this.fragCurrent;var n=t.frag;if(i&&t.id==="main"&&n.sn===i.sn&&n.level===i.level&&!(t.type==="audio"&&this.altAudio)&&this.state===Ve.PARSING){var u=this.levels[this.level],l=i;if(!Object(a["isFiniteNumber"])(t.endPTS)){t.endPTS=t.startPTS+i.duration;t.endDTS=t.startDTS+i.duration}if(t.hasAudio===true){l.addElementaryStream(_.AUDIO)}if(t.hasVideo===true){l.addElementaryStream(_.VIDEO)}o["logger"].log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0));if(t.type==="video"){l.dropped=t.dropped;if(l.dropped){if(!l.backtracked){var d=u.details;if(d&&l.sn===d.startSN){o["logger"].warn("missing video frame(s) on first frag, appending with gap",l.sn)}else{o["logger"].warn("missing video frame(s), backtracking fragment",l.sn);this.fragmentTracker.removeFragment(l);l.backtracked=true;this.nextLoadPosition=t.startPTS;this.state=Ve.IDLE;this.fragPrevious=l;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.tick();return}}else{o["logger"].warn("Already backtracked on this fragment, appending with the gap",l.sn)}}else{l.backtracked=false}}var f=ve(u.details,l,t.startPTS,t.endPTS,t.startDTS,t.endDTS),c=this.hls;c.trigger(s["default"].LEVEL_PTS_UPDATED,{details:u.details,level:this.level,drift:f,type:t.type,start:t.startPTS,end:t.endPTS});[t.data1,t.data2].forEach((function(e){if(e&&e.length&&r.state===Ve.PARSING){r.appended=true;r.pendingBuffering=true;c.trigger(s["default"].BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"})}}));this.tick()}};r.onFragParsed=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="main"&&i.sn===r.sn&&i.level===r.level&&this.state===Ve.PARSING){this.stats.tparsed=window.performance.now();this.state=Ve.PARSED;this._checkAppendedParsed()}};r.onAudioTrackSwitching=function e(t){var r=this.altAudio;var i=!!t.url;var n=t.id;if(!i){if(this.mediaBuffer!==this.media){o["logger"].log("switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var a=this.fragCurrent;if(a.loader){o["logger"].log("switching to main audio track, cancel main fragment load");a.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=Ve.IDLE}var u=this.hls;if(r){u.trigger(s["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}u.trigger(s["default"].AUDIO_TRACK_SWITCHED,{id:n})}};r.onAudioTrackSwitched=function e(t){var r=t.id,i=!!this.hls.audioTracks[r].url;if(i){var n=this.videoBuffer;if(n&&this.mediaBuffer!==n){o["logger"].log("switching on alternate audio, use video.buffered to schedule main fragment loading");this.mediaBuffer=n}}this.altAudio=i;this.tick()};r.onBufferCreated=function e(t){var r=t.tracks,i,n,a=false;for(var s in r){var u=r[s];if(u.id==="main"){n=s;i=u;if(s==="video"){this.videoBuffer=r[s].buffer}}else{a=true}}if(a&&i){o["logger"].log("alternate track found, use "+n+".buffered to schedule main fragment loading");this.mediaBuffer=i.buffer}else{this.mediaBuffer=this.media}};r.onBufferAppended=function e(t){if(t.parent==="main"){var r=this.state;if(r===Ve.PARSING||r===Ve.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};r._checkAppendedParsed=function e(){if(this.state===Ve.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var r=this.mediaBuffer?this.mediaBuffer:this.media;o["logger"].log("main buffered : "+Se.toString(r.buffered));this.fragPrevious=t;var i=this.stats;i.tbuffered=window.performance.now();this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst));this.hls.trigger(s["default"].FRAG_BUFFERED,{stats:i,frag:t,id:"main"});this.state=Ve.IDLE}if(this.loadedmetadata||this.startPosition<=0){this.tick()}}};r.onError=function e(t){var r=t.frag||this.fragCurrent;if(r&&r.type!=="main"){return}var i=!!this.media&&te.isBuffered(this.media,this.media.currentTime)&&te.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case n["ErrorDetails"].FRAG_LOAD_ERROR:case n["ErrorDetails"].FRAG_LOAD_TIMEOUT:case n["ErrorDetails"].KEY_LOAD_ERROR:case n["ErrorDetails"].KEY_LOAD_TIMEOUT:if(!t.fatal){if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);o["logger"].warn("mediaController: frag loading failed, retry in "+a+" ms");this.retryDate=window.performance.now()+a;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.fragLoadError++;this.state=Ve.FRAG_LOADING_WAITING_RETRY}else{o["logger"].error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ...");t.fatal=true;this.state=Ve.ERROR}}break;case n["ErrorDetails"].LEVEL_LOAD_ERROR:case n["ErrorDetails"].LEVEL_LOAD_TIMEOUT:if(this.state!==Ve.ERROR){if(t.fatal){this.state=Ve.ERROR;o["logger"].warn("streamController: "+t.details+",switch to "+this.state+" state ...")}else{if(!t.levelRetry&&this.state===Ve.WAITING_LEVEL){this.state=Ve.IDLE}}}break;case n["ErrorDetails"].BUFFER_FULL_ERROR:if(t.parent==="main"&&(this.state===Ve.PARSING||this.state===Ve.PARSED)){if(i){this._reduceMaxBufferLength(this.config.maxBufferLength);this.state=Ve.IDLE}else{o["logger"].warn("buffer full error also media.currentTime is not buffered, flush everything");this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}}break;default:break}};r._reduceMaxBufferLength=function e(t){var r=this.config;if(r.maxMaxBufferLength>=t){r.maxMaxBufferLength/=2;o["logger"].warn("main:reduce max buffer length to "+r.maxMaxBufferLength+"s");return true}return false};r._checkBuffer=function e(){var t=this.media;if(!t||t.readyState===0){return}var r=this.mediaBuffer?this.mediaBuffer:t;var i=r.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=true;this._seekToStartPos()}else if(this.immediateSwitch){this.immediateLevelSwitchEnd()}else{this.gapController.poll(this.lastCurrentTime,i)}};r.onFragLoadEmergencyAborted=function e(){this.state=Ve.IDLE;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.tick()};r.onBufferFlushed=function e(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var r=this.audioOnly?_.AUDIO:_.VIDEO;this.fragmentTracker.detectEvictedFragments(r,t.buffered)}this.state=Ve.IDLE;this.fragPrevious=null};r.onLevelsUpdated=function e(t){this.levels=t.levels};r.swapAudioCodec=function e(){this.audioCodecSwap=!this.audioCodecSwap};r._seekToStartPos=function e(){var t=this.media;var r=t.currentTime;var i=this.startPosition;if(r!==i&&i>=0){if(t.seeking){o["logger"].log("could not seek to "+i+", already seeking at "+r);return}var n=t.buffered.length?t.buffered.start(0):0;var a=n-i;if(a>0&&a<this.config.maxBufferHole){o["logger"].log("adjusting start position by "+a+" to match buffer start");i+=a;this.startPosition=i}o["logger"].log("seek to target start position "+i+" from current time "+r+". ready state "+t.readyState);t.currentTime=i}};r._getAudioCodec=function e(t){var r=this.config.defaultAudioCodec||t.audioCodec;if(this.audioCodecSwap){o["logger"].log("swapping playlist audio codec");if(r){if(r.indexOf("mp4a.40.5")!==-1){r="mp4a.40.2"}else{r="mp4a.40.5"}}}return r};Ke(t,[{key:"state",set:function e(t){if(this.state!==t){var r=this.state;this._state=t;o["logger"].log("main stream-controller: "+r+"->"+t);this.hls.trigger(s["default"].STREAM_STATE_TRANSITION,{previousState:r,nextState:t})}},get:function e(){return this._state}},{key:"currentLevel",get:function e(){var t=this.media;if(t){var r=this.getBufferedFrag(t.currentTime);if(r){return r.level}}return-1}},{key:"nextBufferedFrag",get:function e(){var t=this.media;if(t){return this.followingBufferedFrag(this.getBufferedFrag(t.currentTime))}else{return null}}},{key:"nextLevel",get:function e(){var t=this.nextBufferedFrag;if(t){return t.level}else{return-1}}},{key:"liveSyncPosition",get:function e(){return this._liveSyncPosition},set:function e(t){this._liveSyncPosition=t}}]);return t}(We);var Qe=Je;function $e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Ze(e,t,r){if(t)$e(e.prototype,t);if(r)$e(e,r);return e}function et(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var tt;var rt=function(e){et(t,e);function t(t){var r;r=e.call(this,t,s["default"].MANIFEST_LOADED,s["default"].LEVEL_LOADED,s["default"].AUDIO_TRACK_SWITCHED,s["default"].FRAG_LOADED,s["default"].ERROR)||this;r.canload=false;r.currentLevelIndex=null;r.manualLevelIndex=-1;r.timer=null;tt=/chrome|firefox/.test(navigator.userAgent.toLowerCase());return r}var r=t.prototype;r.onHandlerDestroying=function e(){this.clearTimer();this.manualLevelIndex=-1};r.clearTimer=function e(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null}};r.startLoad=function e(){var t=this._levels;this.canload=true;this.levelRetryCount=0;if(t){t.forEach((function(e){e.loadError=0;var t=e.details;if(t&&t.live){e.details=undefined}}))}if(this.timer!==null){this.loadLevel()}};r.stopLoad=function e(){this.canload=false};r.onManifestLoaded=function e(t){var r=[];var i=[];var a;var u={};var l=null;var d=false;var f=false;t.levels.forEach((function(e){var t=e.attrs;e.loadError=0;e.fragmentError=false;d=d||!!e.videoCodec;f=f||!!e.audioCodec;if(tt&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1){e.audioCodec=undefined}l=u[e.bitrate];if(!l){e.url=[e.url];e.urlId=0;u[e.bitrate]=e;r.push(e)}else{l.url.push(e.url)}if(t){if(t.AUDIO){he(l||e,"audio",t.AUDIO)}if(t.SUBTITLES){he(l||e,"text",t.SUBTITLES)}}}));if(d&&f){r=r.filter((function(e){var t=e.videoCodec;return!!t}))}r=r.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||D(t,"audio"))&&(!r||D(r,"video"))}));if(t.audioTracks){i=t.audioTracks.filter((function(e){return!e.audioCodec||D(e.audioCodec,"audio")}));i.forEach((function(e,t){e.id=t}))}if(r.length>0){a=r[0].bitrate;r.sort((function(e,t){return e.bitrate-t.bitrate}));this._levels=r;for(var c=0;c<r.length;c++){if(r[c].bitrate===a){this._firstLevel=c;o["logger"].log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+a);break}}var h=f&&!d;this.hls.trigger(s["default"].MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:t.stats,audio:f,video:d,altAudio:!h&&i.some((function(e){return!!e.url}))})}else{this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:true,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})}};r.setLevelInternal=function e(t){var r=this._levels;var i=this.hls;if(t>=0&&t<r.length){this.clearTimer();if(this.currentLevelIndex!==t){o["logger"].log("switching to level "+t);this.currentLevelIndex=t;var a=r[t];a.level=t;i.trigger(s["default"].LEVEL_SWITCHING,a)}var u=r[t];var l=u.details;if(!l||l.live){var d=u.urlId;i.trigger(s["default"].LEVEL_LOADING,{url:u.url[d],level:t,id:d})}}else{i.trigger(s["default"].ERROR,{type:n["ErrorTypes"].OTHER_ERROR,details:n["ErrorDetails"].LEVEL_SWITCH_ERROR,level:t,fatal:false,reason:"invalid level idx"})}};r.onError=function e(t){if(t.fatal){if(t.type===n["ErrorTypes"].NETWORK_ERROR){this.clearTimer()}return}var r=false,i=false;var a;switch(t.details){case n["ErrorDetails"].FRAG_LOAD_ERROR:case n["ErrorDetails"].FRAG_LOAD_TIMEOUT:case n["ErrorDetails"].KEY_LOAD_ERROR:case n["ErrorDetails"].KEY_LOAD_TIMEOUT:a=t.frag.level;i=true;break;case n["ErrorDetails"].LEVEL_LOAD_ERROR:case n["ErrorDetails"].LEVEL_LOAD_TIMEOUT:a=t.context.level;r=true;break;case n["ErrorDetails"].REMUX_ALLOC_ERROR:a=t.level;r=true;break}if(a!==undefined){this.recoverLevel(t,a,r,i)}};r.recoverLevel=function e(t,r,i,n){var a=this;var s=this.hls.config;var u=t.details;var l=this._levels[r];var d,f,c;l.loadError++;l.fragmentError=n;if(i){if(this.levelRetryCount+1<=s.levelLoadingMaxRetry){f=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout);this.timer=setTimeout((function(){return a.loadLevel()}),f);t.levelRetry=true;this.levelRetryCount++;o["logger"].warn("level controller, "+u+", retry in "+f+" ms, current retry count is "+this.levelRetryCount)}else{o["logger"].error("level controller, cannot recover from "+u+" error");this.currentLevelIndex=null;this.clearTimer();t.fatal=true;return}}if(i||n){d=l.url.length;if(d>1&&l.loadError<d){l.urlId=(l.urlId+1)%d;l.details=undefined;o["logger"].warn("level controller, "+u+" for level "+r+": switching to redundant URL-id "+l.urlId)}else{if(this.manualLevelIndex===-1){c=r===0?this._levels.length-1:r-1;o["logger"].warn("level controller, "+u+": switch to "+c);this.hls.nextAutoLevel=this.currentLevelIndex=c}else if(n){o["logger"].warn("level controller, "+u+": reload a fragment");this.currentLevelIndex=null}}}};r.onFragLoaded=function e(t){var r=t.frag;if(r!==undefined&&r.type==="main"){var i=this._levels[r.level];if(i!==undefined){i.fragmentError=false;i.loadError=0;this.levelRetryCount=0}}};r.onLevelLoaded=function e(t){var r=this;var i=t.level,n=t.details;if(i!==this.currentLevelIndex){return}var a=this._levels[i];if(!a.fragmentError){a.loadError=0;this.levelRetryCount=0}if(n.live){var s=be(a.details,n,t.stats.trequest);o["logger"].log("live playlist, reload in "+Math.round(s)+" ms");this.timer=setTimeout((function(){return r.loadLevel()}),s)}else{this.clearTimer()}};r.onAudioTrackSwitched=function e(t){var r=this.hls.audioTracks[t.id].groupId;var i=this.hls.levels[this.currentLevelIndex];if(!i){return}if(i.audioGroupIds){var n=-1;for(var a=0;a<i.audioGroupIds.length;a++){if(i.audioGroupIds[a]===r){n=a;break}}if(n!==i.urlId){i.urlId=n;this.startLoad()}}};r.loadLevel=function e(){o["logger"].debug("call to loadLevel");if(this.currentLevelIndex!==null&&this.canload){var t=this._levels[this.currentLevelIndex];if(typeof t==="object"&&t.url.length>0){var r=this.currentLevelIndex;var i=t.urlId;var n=t.url[i];o["logger"].log("Attempt loading level index "+r+" with URL-id "+i);this.hls.trigger(s["default"].LEVEL_LOADING,{url:n,level:r,id:i})}}};r.removeLevel=function e(t,r){var i=this.levels.filter((function(e,i){if(i!==t){return true}if(e.url.length>1&&r!==undefined){e.url=e.url.filter((function(e,t){return t!==r}));e.urlId=0;return true}return false})).map((function(e,t){var r=e.details;if(r&&r.fragments){r.fragments.forEach((function(e){e.level=t}))}return e}));this._levels=i;this.hls.trigger(s["default"].LEVELS_UPDATED,{levels:i})};Ze(t,[{key:"levels",get:function e(){return this._levels}},{key:"level",get:function e(){return this.currentLevelIndex},set:function e(t){var r=this._levels;if(r){t=Math.min(t,r.length-1);if(this.currentLevelIndex!==t||!r[t].details){this.setLevelInternal(t)}}}},{key:"manualLevel",get:function e(){return this.manualLevelIndex},set:function e(t){this.manualLevelIndex=t;if(this._startLevel===undefined){this._startLevel=t}if(t!==-1){this.level=t}}},{key:"firstLevel",get:function e(){return this._firstLevel},set:function e(t){this._firstLevel=t}},{key:"startLevel",get:function e(){if(this._startLevel===undefined){var t=this.hls.config.startLevel;if(t!==undefined){return t}else{return this._firstLevel}}else{return this._startLevel}},set:function e(t){this._startLevel=t}},{key:"nextLoadLevel",get:function e(){if(this.manualLevelIndex!==-1){return this.manualLevelIndex}else{return this.hls.nextAutoLevel}},set:function e(t){this.level=t;if(this.manualLevelIndex===-1){this.hls.nextAutoLevel=t}}}]);return t}(d);var it=r("./src/demux/id3.js");function nt(e,t){var r;try{r=new Event("addtrack")}catch(e){r=document.createEvent("Event");r.initEvent("addtrack",false,false)}r.track=e;t.dispatchEvent(r)}function at(e){if(e===null||e===void 0?void 0:e.cues){while(e.cues.length>0){e.removeCue(e.cues[0])}}}function st(e,t){if(t<e[0].endTime){return e[0]}if(t>e[e.length-1].endTime){return e[e.length-1]}var r=0;var i=e.length-1;while(r<=i){var n=Math.floor((i+r)/2);if(t<e[n].endTime){i=n-1}else if(t>e[n].endTime){r=n+1}else{return e[n]}}return e[r].endTime-t<t-e[i].endTime?e[r]:e[i]}function ot(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var ut=.25;var lt=function(e){ot(t,e);function t(t){var r;r=e.call(this,t,s["default"].MEDIA_ATTACHED,s["default"].MEDIA_DETACHING,s["default"].FRAG_PARSING_METADATA,s["default"].LIVE_BACK_BUFFER_REACHED)||this;r.id3Track=undefined;r.media=undefined;return r}var r=t.prototype;r.destroy=function e(){d.prototype.destroy.call(this)};r.onMediaAttached=function e(t){this.media=t.media;if(!this.media){}};r.onMediaDetaching=function e(){at(this.id3Track);this.id3Track=undefined;this.media=undefined};r.getID3Track=function e(t){for(var r=0;r<t.length;r++){var i=t[r];if(i.kind==="metadata"&&i.label==="id3"){nt(i,this.media);return i}}return this.media.addTextTrack("metadata","id3")};r.onFragParsingMetadata=function e(t){var r=t.frag;var i=t.samples;if(!this.id3Track){this.id3Track=this.getID3Track(this.media.textTracks);this.id3Track.mode="hidden"}var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue;for(var a=0;a<i.length;a++){var s=it["default"].getID3Frames(i[a].data);if(s){var o=Math.max(i[a].pts,0);var u=a<i.length-1?i[a+1].pts:r.endPTS;if(!u){u=r.start+r.duration}var l=u-o;if(l<=0){u=o+ut}for(var d=0;d<s.length;d++){var f=s[d];if(!it["default"].isTimeStampFrame(f)){var c=new n(o,u,"");c.value=f;this.id3Track.addCue(c)}}}}};r.onLiveBackBufferReached=function e(t){var r=t.bufferEnd;var i=this.id3Track;if(!i||!i.cues||!i.cues.length){return}var n=st(i.cues,r);if(!n){return}while(i.cues[0]!==n){i.removeCue(i.cues[0])}};return t}(d);var dt=lt;function ft(){var e=ae();if(!e){return false}var t=self.SourceBuffer||self.WebKitSourceBuffer;var r=e&&typeof e.isTypeSupported==="function"&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');var i=!t||t.prototype&&typeof t.prototype.appendBuffer==="function"&&typeof t.prototype.remove==="function";return!!r&&!!i}var ct=function(){function e(e){this.alpha_=void 0;this.estimate_=void 0;this.totalWeight_=void 0;this.alpha_=e?Math.exp(Math.log(.5)/e):0;this.estimate_=0;this.totalWeight_=0}var t=e.prototype;t.sample=function e(t,r){var i=Math.pow(this.alpha_,t);this.estimate_=r*(1-i)+i*this.estimate_;this.totalWeight_+=t};t.getTotalWeight=function e(){return this.totalWeight_};t.getEstimate=function e(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}else{return this.estimate_}};return e}();var ht=ct;var pt=function(){function e(e,t,r,i){this.hls=void 0;this.defaultEstimate_=void 0;this.minWeight_=void 0;this.minDelayMs_=void 0;this.slow_=void 0;this.fast_=void 0;this.hls=e;this.defaultEstimate_=i;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new ht(t);this.fast_=new ht(r)}var t=e.prototype;t.sample=function e(t,r){t=Math.max(t,this.minDelayMs_);var i=8*r,n=t/1e3,a=i/n;this.fast_.sample(n,a);this.slow_.sample(n,a)};t.canEstimate=function e(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_};t.getEstimate=function e(){if(this.canEstimate()){return Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}else{return this.defaultEstimate_}};t.destroy=function e(){};return e}();var vt=pt;function mt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function gt(e,t,r){if(t)mt(e.prototype,t);if(r)mt(e,r);return e}function yt(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function _t(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var bt=window,Tt=bt.performance;var St=function(e){_t(t,e);function t(t){var r;r=e.call(this,t,s["default"].FRAG_LOADING,s["default"].FRAG_LOADED,s["default"].FRAG_BUFFERED,s["default"].ERROR)||this;r.lastLoadedFragLevel=0;r._nextAutoLevel=-1;r.hls=t;r.timer=null;r._bwEstimator=null;r.onCheck=r._abandonRulesCheck.bind(yt(r));return r}var r=t.prototype;r.destroy=function e(){this.clearTimer();d.prototype.destroy.call(this)};r.onFragLoading=function e(t){var r=t.frag;if(r.type==="main"){if(!this.timer){this.fragCurrent=r;this.timer=setInterval(this.onCheck,100)}if(!this._bwEstimator){var i=this.hls;var n=i.config;var a=r.level;var s=i.levels[a].details.live;var o;var u;if(s){o=n.abrEwmaFastLive;u=n.abrEwmaSlowLive}else{o=n.abrEwmaFastVoD;u=n.abrEwmaSlowVoD}this._bwEstimator=new vt(i,u,o,n.abrEwmaDefaultEstimate)}}};r._abandonRulesCheck=function e(){var t=this.hls;var r=t.media;var i=this.fragCurrent;if(!i){return}var n=i.loader;if(!n||n.stats&&n.stats.aborted){o["logger"].warn("frag loader destroy or aborted, disarm abandonRules");this.clearTimer();this._nextAutoLevel=-1;return}var a=n.stats;if(r&&a&&(!r.paused&&r.playbackRate!==0||!r.readyState)&&i.autoLevel&&i.level){var u=Tt.now()-a.trequest;var l=Math.abs(r.playbackRate);if(u>500*i.duration/l){var d=t.levels;var f=Math.max(1,a.bw?a.bw/8:a.loaded*1e3/u);var c=d[i.level];if(!c){return}var h=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate;var p=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*h/8));var v=r.currentTime;var m=(p-a.loaded)/f;var g=(te.bufferInfo(r,v,t.config.maxBufferHole).end-v)/l;if(g<2*i.duration/l&&m>g){var y=t.minAutoLevel;var _;var b;for(b=i.level-1;b>y;b--){var T=d[b].realBitrate?Math.max(d[b].realBitrate,d[b].bitrate):d[b].bitrate;var S=i.duration*T/(8*.8*f);if(S<g){break}}if(_<m){o["logger"].warn("loading too slow, abort fragment loading and switch to level "+b+":fragLoadedDelay["+b+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+_.toFixed(1)+"<"+m.toFixed(1)+":"+g.toFixed(1));t.nextLoadLevel=b;this._bwEstimator.sample(u,a.loaded);n.abort();this.clearTimer();t.trigger(s["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a})}}}}};r.onFragLoaded=function e(t){var r=t.frag;if(r.type==="main"&&Object(a["isFiniteNumber"])(r.sn)){this.clearTimer();this.lastLoadedFragLevel=r.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level];var n=(i.loaded?i.loaded.bytes:0)+t.stats.loaded;var s=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:n,duration:s};i.realBitrate=Math.round(8*n/s)}if(t.frag.bitrateTest){var o=t.stats;o.tparsed=o.tbuffered=o.tload;this.onFragBuffered(t)}}};r.onFragBuffered=function e(t){var r=t.stats;var i=t.frag;if(r.aborted!==true&&i.type==="main"&&Object(a["isFiniteNumber"])(i.sn)&&(!i.bitrateTest||r.tload===r.tbuffered)){var n=r.tparsed-r.trequest;o["logger"].log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest)));this._bwEstimator.sample(n,r.loaded);r.bwEstimate=this._bwEstimator.getEstimate();if(i.bitrateTest){this.bitrateTestDelay=n/1e3}else{this.bitrateTestDelay=0}}};r.onError=function e(t){switch(t.details){case n["ErrorDetails"].FRAG_LOAD_ERROR:case n["ErrorDetails"].FRAG_LOAD_TIMEOUT:this.clearTimer();break;default:break}};r.clearTimer=function e(){clearInterval(this.timer);this.timer=null};r._findBestLevel=function e(t,r,i,n,a,s,u,l,d){for(var f=a;f>=n;f--){var c=d[f];if(!c){continue}var h=c.details;var p=h?h.totalduration/h.fragments.length:r;var v=h?h.live:false;var m=void 0;if(f<=t){m=u*i}else{m=l*i}var g=d[f].realBitrate?Math.max(d[f].realBitrate,d[f].bitrate):d[f].bitrate;var y=g*p/m;o["logger"].trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+f+"/"+Math.round(m)+"/"+g+"/"+p+"/"+s+"/"+y);if(m>g&&(!y||v&&!this.bitrateTestDelay||y<s)){return f}}return-1};gt(t,[{key:"nextAutoLevel",get:function e(){var t=this._nextAutoLevel;var r=this._bwEstimator;if(t!==-1&&(!r||!r.canEstimate())){return t}var i=this._nextABRAutoLevel;if(t!==-1){i=Math.min(t,i)}return i},set:function e(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function e(){var t=this.hls;var r=t.maxAutoLevel,i=t.levels,n=t.config,a=t.minAutoLevel;var s=t.media;var u=this.lastLoadedFragLevel;var l=this.fragCurrent?this.fragCurrent.duration:0;var d=s?s.currentTime:0;var f=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1;var c=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate;var h=(te.bufferInfo(s,d,n.maxBufferHole).end-d)/f;var p=this._findBestLevel(u,l,c,a,r,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(p>=0){return p}else{o["logger"].trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var v=l?Math.min(l,n.maxStarvationDelay):n.maxStarvationDelay;var m=n.abrBandWidthFactor;var g=n.abrBandWidthUpFactor;if(h===0){var y=this.bitrateTestDelay;if(y){var _=l?Math.min(l,n.maxLoadingDelay):n.maxLoadingDelay;v=_-y;o["logger"].trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*v)+" ms");m=g=1}}p=this._findBestLevel(u,l,c,a,r,h+v,m,g,i);return Math.max(p,0)}}}]);return t}(d);var Et=St;function wt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var kt=ae();var At=function(e){wt(t,e);function t(t){var r;r=e.call(this,t,s["default"].MEDIA_ATTACHING,s["default"].MEDIA_DETACHING,s["default"].MANIFEST_PARSED,s["default"].BUFFER_RESET,s["default"].BUFFER_APPENDING,s["default"].BUFFER_CODECS,s["default"].BUFFER_EOS,s["default"].BUFFER_FLUSHING,s["default"].LEVEL_PTS_UPDATED,s["default"].LEVEL_UPDATED)||this;r._msDuration=null;r._levelDuration=null;r._levelTargetDuration=10;r._live=null;r._objectUrl=null;r._needsFlush=false;r._needsEos=false;r.config=void 0;r.audioTimestampOffset=void 0;r.bufferCodecEventsExpected=0;r._bufferCodecEventsTotal=0;r.media=null;r.mediaSource=null;r.segments=[];r.parent=void 0;r.appending=false;r.appended=0;r.appendError=0;r.flushBufferCounter=0;r.tracks={};r.pendingTracks={};r.sourceBuffer={};r.flushRange=[];r._onMediaSourceOpen=function(){o["logger"].log("media source opened");r.hls.trigger(s["default"].MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;if(e){e.removeEventListener("sourceopen",r._onMediaSourceOpen)}r.checkPendingTracks()};r._onMediaSourceClose=function(){o["logger"].log("media source closed")};r._onMediaSourceEnded=function(){o["logger"].log("media source ended")};r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var e=r.sourceBuffer.audio;o["logger"].warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+r.audioTimestampOffset);e.timestampOffset=r.audioTimestampOffset;delete r.audioTimestampOffset}if(r._needsFlush){r.doFlush()}if(r._needsEos){r.checkEos()}r.appending=false;var t=r.parent;var i=r.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0);var n={};var a=r.sourceBuffer;for(var u in a){var l=a[u];if(!l){throw Error("handling source buffer update end error: source buffer for "+u+" uninitilized and unable to update buffered TimeRanges.")}n[u]=l.buffered}r.hls.trigger(s["default"].BUFFER_APPENDED,{parent:t,pending:i,timeRanges:n});if(!r._needsFlush){r.doAppending()}r.updateMediaElementDuration();if(i===0){r.flushLiveBackBuffer()}};r._onSBUpdateError=function(e){o["logger"].error("sourceBuffer error:",e);r.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_APPENDING_ERROR,fatal:false})};r.config=t.config;return r}var r=t.prototype;r.destroy=function e(){d.prototype.destroy.call(this)};r.onLevelPtsUpdated=function e(t){var r=t.type;var i=this.tracks.audio;if(r==="audio"&&i&&i.container==="audio/mpeg"){var n=this.sourceBuffer.audio;if(!n){throw Error("Level PTS Updated and source buffer for audio uninitalized")}var a=Math.abs(n.timestampOffset-t.start);if(a>.1){var s=n.updating;try{n.abort()}catch(e){o["logger"].warn("can not abort audio buffer: "+e)}if(!s){o["logger"].warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.start);n.timestampOffset=t.start}else{this.audioTimestampOffset=t.start}}}};r.onManifestParsed=function e(t){var r=2;if(t.audio&&!t.video||!t.altAudio){r=1}this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r;o["logger"].log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")};r.onMediaAttaching=function e(t){var r=this.media=t.media;if(r&&kt){var i=this.mediaSource=new kt;i.addEventListener("sourceopen",this._onMediaSourceOpen);i.addEventListener("sourceended",this._onMediaSourceEnded);i.addEventListener("sourceclose",this._onMediaSourceClose);r.src=window.URL.createObjectURL(i);this._objectUrl=r.src}};r.onMediaDetaching=function e(){o["logger"].log("media source detaching");var t=this.mediaSource;if(t){if(t.readyState==="open"){try{t.endOfStream()}catch(e){o["logger"].warn("onMediaDetaching:"+e.message+" while calling endOfStream")}}t.removeEventListener("sourceopen",this._onMediaSourceOpen);t.removeEventListener("sourceended",this._onMediaSourceEnded);t.removeEventListener("sourceclose",this._onMediaSourceClose);if(this.media){if(this._objectUrl){window.URL.revokeObjectURL(this._objectUrl)}if(this.media.src===this._objectUrl){this.media.removeAttribute("src");this.media.load()}else{o["logger"].warn("media.src was changed by a third party - skip cleanup")}}this.mediaSource=null;this.media=null;this._objectUrl=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.hls.trigger(s["default"].MEDIA_DETACHED)};r.checkPendingTracks=function e(){var t=this.bufferCodecEventsExpected,r=this.pendingTracks;var i=Object.keys(r).length;if(i&&!t||i===2){this.createSourceBuffers(r);this.pendingTracks={};this.doAppending()}};r.onBufferReset=function e(){var t=this.sourceBuffer;for(var r in t){var i=t[r];try{if(i){if(this.mediaSource){this.mediaSource.removeSourceBuffer(i)}i.removeEventListener("updateend",this._onSBUpdateEnd);i.removeEventListener("error",this._onSBUpdateError)}}catch(e){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0};r.onBufferCodecs=function e(t){var r=this;if(Object.keys(this.sourceBuffer).length){return}Object.keys(t).forEach((function(e){r.pendingTracks[e]=t[e]}));this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0);if(this.mediaSource&&this.mediaSource.readyState==="open"){this.checkPendingTracks()}};r.createSourceBuffers=function e(t){var r=this.sourceBuffer,i=this.mediaSource;if(!i){throw Error("createSourceBuffers called when mediaSource was null")}for(var a in t){if(!r[a]){var u=t[a];if(!u){throw Error("source buffer exists for track "+a+", however track does not")}var l=u.levelCodec||u.codec;var d=u.container+";codecs="+l;o["logger"].log("creating sourceBuffer("+d+")");try{var f=r[a]=i.addSourceBuffer(d);f.addEventListener("updateend",this._onSBUpdateEnd);f.addEventListener("error",this._onSBUpdateError);this.tracks[a]={buffer:f,codec:l,id:u.id,container:u.container,levelCodec:u.levelCodec}}catch(e){o["logger"].error("error while trying to add sourceBuffer:"+e.message);this.hls.trigger(s["default"].ERROR,{type:n["ErrorTypes"].MEDIA_ERROR,details:n["ErrorDetails"].BUFFER_ADD_CODEC_ERROR,fatal:false,err:e,mimeType:d})}}}this.hls.trigger(s["default"].BUFFER_CREATED,{tracks:this.tracks})};r.onBufferAppending=function e(t){if(!this._needsFlush){if(!this.segments){this.segments=[t]}else{this.segments.push(t)}this.doAppending()}};r.onBufferEos=function e(t){for(var r in this.sourceBuffer){if(!t.type||t.type===r){var i=this.sourceBuffer[r];if(i&&!i.ended){i.ended=true;o["logger"].log(r+" sourceBuffer now EOS")}}}this.checkEos()};r.checkEos=function e(){var t=this.sourceBuffer,r=this.mediaSource;if(!r||r.readyState!=="open"){this._needsEos=false;return}for(var i in t){var n=t[i];if(!n)continue;if(!n.ended){return}if(n.updating){this._needsEos=true;return}}o["logger"].log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{r.endOfStream()}catch(e){o["logger"].warn("exception while calling mediaSource.endOfStream()")}this._needsEos=false};r.onBufferFlushing=function e(t){if(t.type){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type})}else{this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"});this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})}this.flushBufferCounter=0;this.doFlush()};r.flushLiveBackBuffer=function e(){if(!this._live){return}var t=this.config.liveBackBufferLength;if(!isFinite(t)||t<0){return}if(!this.media){o["logger"].error("flushLiveBackBuffer called without attaching media");return}var r=this.media.currentTime;var i=this.sourceBuffer;var n=Object.keys(i);var a=r-Math.max(t,this._levelTargetDuration);for(var u=n.length-1;u>=0;u--){var l=n[u];var d=i[l];if(d){var f=d.buffered;if(f.length>0&&a>f.start(0)){if(this.removeBufferRange(l,d,0,a)){this.hls.trigger(s["default"].LIVE_BACK_BUFFER_REACHED,{bufferEnd:a})}}}}};r.onLevelUpdated=function e(t){var r=t.details;if(r.fragments.length>0){this._levelDuration=r.totalduration+r.fragments[0].start;this._levelTargetDuration=r.averagetargetduration||r.targetduration||10;this._live=r.live;this.updateMediaElementDuration()}};r.updateMediaElementDuration=function e(){var t=this.config;var r;if(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open"){return}for(var i in this.sourceBuffer){var n=this.sourceBuffer[i];if(n&&n.updating===true){return}}r=this.media.duration;if(this._msDuration===null){this._msDuration=this.mediaSource.duration}if(this._live===true&&t.liveDurationInfinity===true){o["logger"].log("Media Source duration is set to Infinity");this._msDuration=this.mediaSource.duration=Infinity}else if(this._levelDuration>this._msDuration&&this._levelDuration>r||!Object(a["isFiniteNumber"])(r)){o["logger"].log("Updating Media Source duration to "+this._levelDuration.toFixed(3));this._msDuration=this.mediaSource.duration=this._levelDuration}};r.doFlush=function e(){while(this.flushRange.length){var t=this.flushRange[0];if(this.flushBuffer(t.start,t.end,t.type)){this.flushRange.shift();this.flushBufferCounter=0}else{this._needsFlush=true;return}}if(this.flushRange.length===0){this._needsFlush=false;var r=0;var i=this.sourceBuffer;try{for(var n in i){var a=i[n];if(a){r+=a.buffered.length}}}catch(e){o["logger"].error("error while accessing sourceBuffer.buffered")}this.appended=r;this.hls.trigger(s["default"].BUFFER_FLUSHED)}};r.doAppending=function e(){var t=this.config,r=this.hls,i=this.segments,a=this.sourceBuffer;if(!Object.keys(a).length){return}if(!this.media||this.media.error){this.segments=[];o["logger"].error("trying to append although a media error occured, flush segment and abort");return}if(this.appending){return}var u=i.shift();if(!u){return}try{var l=a[u.type];if(!l){this._onSBUpdateEnd();return}if(l.updating){i.unshift(u);return}l.ended=false;this.parent=u.parent;l.appendBuffer(u.data);this.appendError=0;this.appended++;this.appending=true}catch(e){o["logger"].error("error while trying to append buffer:"+e.message);i.unshift(u);var d={type:n["ErrorTypes"].MEDIA_ERROR,parent:u.parent,details:"",fatal:false};if(e.code===22){this.segments=[];d.details=n["ErrorDetails"].BUFFER_FULL_ERROR}else{this.appendError++;d.details=n["ErrorDetails"].BUFFER_APPEND_ERROR;if(this.appendError>t.appendErrorMaxRetry){o["logger"].log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer");this.segments=[];d.fatal=true}}r.trigger(s["default"].ERROR,d)}};r.flushBuffer=function e(t,r,i){var n=this.sourceBuffer;if(!Object.keys(n).length){return true}var a="null";if(this.media){a=this.media.currentTime.toFixed(3)}o["logger"].log("flushBuffer,pos/start/end: "+a+"/"+t+"/"+r);if(this.flushBufferCounter>=this.appended){o["logger"].warn("abort flushing too many retries");return true}var s=n[i];if(s){s.ended=false;if(!s.updating){if(this.removeBufferRange(i,s,t,r)){this.flushBufferCounter++;return false}}else{o["logger"].warn("cannot flush, sb updating in progress");return false}}o["logger"].log("buffer flushed");return true};r.removeBufferRange=function e(t,r,i,n){try{for(var a=0;a<r.buffered.length;a++){var s=r.buffered.start(a);var u=r.buffered.end(a);var l=Math.max(s,i);var d=Math.min(u,n);if(Math.min(d,u)-l>.5){var f="null";if(this.media){f=this.media.currentTime.toString()}o["logger"].log("sb remove "+t+" ["+l+","+d+"], of ["+s+","+u+"], pos:"+f);r.remove(l,d);return true}}}catch(e){o["logger"].warn("removeBufferRange failed",e)}return false};return t}(d);var Ct=At;function Lt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function xt(e,t,r){if(t)Lt(e.prototype,t);if(r)Lt(e,r);return e}function Dt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var It=function(e){Dt(t,e);function t(t){var r;r=e.call(this,t,s["default"].FPS_DROP_LEVEL_CAPPING,s["default"].MEDIA_ATTACHING,s["default"].MANIFEST_PARSED,s["default"].LEVELS_UPDATED,s["default"].BUFFER_CODECS,s["default"].MEDIA_DETACHING)||this;r.autoLevelCapping=Number.POSITIVE_INFINITY;r.firstLevel=null;r.levels=[];r.media=null;r.restrictedLevels=[];r.timer=null;r.clientRect=null;return r}var r=t.prototype;r.destroy=function e(){if(this.hls.config.capLevelToPlayerSize){this.media=null;this.clientRect=null;this.stopCapping()}};r.onFpsDropLevelCapping=function e(r){if(t.isLevelAllowed(r.droppedLevel,this.restrictedLevels)){this.restrictedLevels.push(r.droppedLevel)}};r.onMediaAttaching=function e(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null};r.onManifestParsed=function e(t){var r=this.hls;this.restrictedLevels=[];this.levels=t.levels;this.firstLevel=t.firstLevel;if(r.config.capLevelToPlayerSize&&t.video){this.startCapping()}};r.onBufferCodecs=function e(t){var r=this.hls;if(r.config.capLevelToPlayerSize&&t.video){this.startCapping()}};r.onLevelsUpdated=function e(t){this.levels=t.levels};r.onMediaDetaching=function e(){this.stopCapping()};r.detectPlayerSize=function e(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var r=this.hls;r.autoLevelCapping=this.getMaxLevel(t-1);if(r.autoLevelCapping>this.autoLevelCapping){r.streamController.nextLevelSwitch()}this.autoLevelCapping=r.autoLevelCapping}}};r.getMaxLevel=function e(r){var i=this;if(!this.levels){return-1}var n=this.levels.filter((function(e,n){return t.isLevelAllowed(n,i.restrictedLevels)&&n<=r}));this.clientRect=null;return t.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)};r.startCapping=function e(){if(this.timer){return}this.autoLevelCapping=Number.POSITIVE_INFINITY;this.hls.firstLevel=this.getMaxLevel(this.firstLevel);clearInterval(this.timer);this.timer=setInterval(this.detectPlayerSize.bind(this),1e3);this.detectPlayerSize()};r.stopCapping=function e(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;if(this.timer){this.timer=clearInterval(this.timer);this.timer=null}};r.getDimensions=function e(){if(this.clientRect){return this.clientRect}var t=this.media;var r={width:0,height:0};if(t){var i=t.getBoundingClientRect();r.width=i.width;r.height=i.height;if(!r.width&&!r.height){r.width=i.right-i.left||t.width||0;r.height=i.bottom-i.top||t.height||0}}this.clientRect=r;return r};t.isLevelAllowed=function e(t,r){if(r===void 0){r=[]}return r.indexOf(t)===-1};t.getMaxLevelByMediaSize=function e(t,r,i){if(!t||t&&!t.length){return-1}var n=function e(t,r){if(!r){return true}return t.width!==r.width||t.height!==r.height};var a=t.length-1;for(var s=0;s<t.length;s+=1){var o=t[s];if((o.width>=r||o.height>=i)&&n(o,t[s+1])){a=s;break}}return a};xt(t,[{key:"mediaWidth",get:function e(){return this.getDimensions().width*t.contentScaleFactor}},{key:"mediaHeight",get:function e(){return this.getDimensions().height*t.contentScaleFactor}}],[{key:"contentScaleFactor",get:function e(){var t=1;try{t=window.devicePixelRatio}catch(e){}return t}}]);return t}(d);var Ot=It;function Rt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Pt=window,Ut=Pt.performance;var Mt=function(e){Rt(t,e);function t(t){return e.call(this,t,s["default"].MEDIA_ATTACHING)||this}var r=t.prototype;r.destroy=function e(){if(this.timer){clearInterval(this.timer)}this.isVideoPlaybackQualityAvailable=false};r.onMediaAttaching=function e(t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var i=this.video=t.media instanceof window.HTMLVideoElement?t.media:null;if(typeof i.getVideoPlaybackQuality==="function"){this.isVideoPlaybackQualityAvailable=true}clearInterval(this.timer);this.timer=setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}};r.checkFPS=function e(t,r,i){var n=Ut.now();if(r){if(this.lastTime){var a=n-this.lastTime,u=i-this.lastDroppedFrames,l=r-this.lastDecodedFrames,d=1e3*u/a,f=this.hls;f.trigger(s["default"].FPS_DROP,{currentDropped:u,currentDecoded:l,totalDroppedFrames:i});if(d>0){if(u>f.config.fpsDroppedMonitoringThreshold*l){var c=f.currentLevel;o["logger"].warn("drop FPS ratio greater than max allowed value for currentLevel: "+c);if(c>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=c)){c=c-1;f.trigger(s["default"].FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:f.currentLevel});f.autoLevelCapping=c;f.streamController.nextLevelSwitch()}}}}this.lastTime=n;this.lastDroppedFrames=i;this.lastDecodedFrames=r}};r.checkFPSInterval=function e(){var t=this.video;if(t){if(this.isVideoPlaybackQualityAvailable){var r=t.getVideoPlaybackQuality();this.checkFPS(t,r.totalVideoFrames,r.droppedVideoFrames)}else{this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}};return t}(d);var Nt=Mt;var jt=function(){function e(e){if(e&&e.xhrSetup){this.xhrSetup=e.xhrSetup}}var t=e.prototype;t.destroy=function e(){this.abort();this.loader=null};t.abort=function e(){var t=this.loader;if(t&&t.readyState!==4){this.stats.aborted=true;t.abort()}window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null};t.load=function e(t,r,i){this.context=t;this.config=r;this.callbacks=i;this.stats={trequest:window.performance.now(),retry:0};this.retryDelay=r.retryDelay;this.loadInternal()};t.loadInternal=function e(){var t,r=this.context;t=this.loader=new window.XMLHttpRequest;var i=this.stats;i.tfirst=0;i.loaded=0;var n=this.xhrSetup;try{if(n){try{n(t,r.url)}catch(e){t.open("GET",r.url,true);n(t,r.url)}}if(!t.readyState){t.open("GET",r.url,true)}}catch(e){this.callbacks.onError({code:t.status,text:e.message},r,t);return}if(r.rangeEnd){t.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1))}t.onreadystatechange=this.readystatechange.bind(this);t.onprogress=this.loadprogress.bind(this);t.responseType=r.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);t.send()};t.readystatechange=function e(t){var r=t.currentTarget,i=r.readyState,n=this.stats,a=this.context,s=this.config;if(n.aborted){return}if(i>=2){window.clearTimeout(this.requestTimeout);if(n.tfirst===0){n.tfirst=Math.max(window.performance.now(),n.trequest)}if(i===4){var u=r.status;if(u>=200&&u<300){n.tload=Math.max(n.tfirst,window.performance.now());var l,d;if(a.responseType==="arraybuffer"){l=r.response;d=l.byteLength}else{l=r.responseText;d=l.length}n.loaded=n.total=d;var f={url:r.responseURL,data:l};this.callbacks.onSuccess(f,n,a,r)}else{if(n.retry>=s.maxRetry||u>=400&&u<499){o["logger"].error(u+" while loading "+a.url);this.callbacks.onError({code:u,text:r.statusText},a,r)}else{o["logger"].warn(u+" while loading "+a.url+", retrying in "+this.retryDelay+"...");this.destroy();this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay);this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay);n.retry++}}}else{this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)}}};t.loadtimeout=function e(){o["logger"].warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)};t.loadprogress=function e(t){var r=t.currentTarget,i=this.stats;i.loaded=t.loaded;if(t.lengthComputable){i.total=t.total}var n=this.callbacks.onProgress;if(n){n(i,this.context,null,r)}};return e}();var Bt=jt;var Ft=r("./src/empty.js");var Ht;(function(e){e["WIDEVINE"]="com.widevine.alpha";e["PLAYREADY"]="com.microsoft.playready"})(Ht||(Ht={}));var qt=function(){if(typeof window!=="undefined"&&window.navigator&&window.navigator.requestMediaKeySystemAccess){return window.navigator.requestMediaKeySystemAccess.bind(window.navigator)}else{return null}}();function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));r.push.apply(r,i)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){Gt(Object(r),true).forEach((function(t){Wt(e,t,r[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{Gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}}return e}function Wt(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var zt=Vt(Vt({autoStartLoad:true,startPosition:-1,defaultAudioCodec:void 0,debug:false,capLevelOnFPSDrop:false,capLevelToPlayerSize:false,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:false,liveBackBufferLength:Infinity,maxMaxBufferLength:600,enableWorker:true,enableSoftwareAES:true,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:false,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Bt,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Et,bufferController:Ct,capLevelController:Ot,fpsController:Nt,stretchShortVideoTrack:false,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:true,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:false,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:false,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:qt,testBandwidth:true},Kt()),{},{subtitleStreamController:false?undefined:void 0,subtitleTrackController:false?undefined:void 0,timelineController:false?undefined:void 0,audioStreamController:false?undefined:void 0,audioTrackController:false?undefined:void 0,emeController:false?undefined:void 0});function Kt(){return{cueHandler:Ft,enableCEA708Captions:false,enableWebVTT:false,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:true}}function Yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));r.push.apply(r,i)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){Yt(Object(r),true).forEach((function(t){Jt(e,t,r[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{Yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}}return e}function Jt(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function Qt(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function $t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function Zt(e,t,r){if(t)$t(e.prototype,t);if(r)$t(e,r);return e}function er(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var tr=function(e){er(t,e);t.isSupported=function e(){return ft()};Zt(t,null,[{key:"version",get:function e(){return"0.14.16"}},{key:"Events",get:function e(){return s["default"]}},{key:"ErrorTypes",get:function e(){return n["ErrorTypes"]}},{key:"ErrorDetails",get:function e(){return n["ErrorDetails"]}},{key:"DefaultConfig",get:function e(){if(!t.defaultConfig){return zt}return t.defaultConfig},set:function e(r){t.defaultConfig=r}}]);function t(r){var i;if(r===void 0){r={}}i=e.call(this)||this;i.config=void 0;i._autoLevelCapping=void 0;i.abrController=void 0;i.capLevelController=void 0;i.levelController=void 0;i.streamController=void 0;i.networkControllers=void 0;i.audioTrackController=void 0;i.subtitleTrackController=void 0;i.emeController=void 0;i.coreComponents=void 0;i.media=null;i.url=null;var n=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration)){throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration")}i.config=Xt(Xt({},n),r);var a=Qt(i),s=a.config;if(s.liveMaxLatencyDurationCount!==void 0&&s.liveMaxLatencyDurationCount<=s.liveSyncDurationCount){throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"')}if(s.liveMaxLatencyDuration!==void 0&&(s.liveSyncDuration===void 0||s.liveMaxLatencyDuration<=s.liveSyncDuration)){throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"')}Object(o["enableLogs"])(s.debug);i._autoLevelCapping=-1;var u=i.abrController=new s.abrController(Qt(i));var l=new s.bufferController(Qt(i));var d=i.capLevelController=new s.capLevelController(Qt(i));var f=new s.fpsController(Qt(i));var c=new G(Qt(i));var h=new z(Qt(i));var p=new X(Qt(i));var v=new dt(Qt(i));var m=i.levelController=new rt(Qt(i));var g=new $(Qt(i));var y=i.streamController=new Qe(Qt(i),g);var _=[m,y];var b=s.audioStreamController;if(b){_.push(new b(Qt(i),g))}i.networkControllers=_;var T=[c,h,p,u,l,d,f,v,g];b=s.audioTrackController;if(b){var S=new b(Qt(i));i.audioTrackController=S;T.push(S)}b=s.subtitleTrackController;if(b){var E=new b(Qt(i));i.subtitleTrackController=E;_.push(E)}b=s.emeController;if(b){var w=new b(Qt(i));i.emeController=w;T.push(w)}b=s.subtitleStreamController;if(b){_.push(new b(Qt(i),g))}b=s.timelineController;if(b){T.push(new b(Qt(i)))}i.coreComponents=T;return i}var r=t.prototype;r.destroy=function e(){o["logger"].log("destroy");this.trigger(s["default"].DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()}));this.url=null;this.removeAllListeners();this._autoLevelCapping=-1};r.attachMedia=function e(t){o["logger"].log("attachMedia");this.media=t;this.trigger(s["default"].MEDIA_ATTACHING,{media:t})};r.detachMedia=function e(){o["logger"].log("detachMedia");this.trigger(s["default"].MEDIA_DETACHING);this.media=null};r.loadSource=function e(t){t=i["buildAbsoluteURL"](window.location.href,t,{alwaysNormalize:true});o["logger"].log("loadSource:"+t);this.url=t;this.trigger(s["default"].MANIFEST_LOADING,{url:t})};r.startLoad=function e(t){if(t===void 0){t=-1}o["logger"].log("startLoad("+t+")");this.networkControllers.forEach((function(e){e.startLoad(t)}))};r.stopLoad=function e(){o["logger"].log("stopLoad");this.networkControllers.forEach((function(e){e.stopLoad()}))};r.swapAudioCodec=function e(){o["logger"].log("swapAudioCodec");this.streamController.swapAudioCodec()};r.recoverMediaError=function e(){o["logger"].log("recoverMediaError");var t=this.media;this.detachMedia();if(t){this.attachMedia(t)}};r.removeLevel=function e(t,r){if(r===void 0){r=0}this.levelController.removeLevel(t,r)};Zt(t,[{key:"levels",get:function e(){return this.levelController.levels}},{key:"currentLevel",get:function e(){return this.streamController.currentLevel},set:function e(t){o["logger"].log("set currentLevel:"+t);this.loadLevel=t;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function e(){return this.streamController.nextLevel},set:function e(t){o["logger"].log("set nextLevel:"+t);this.levelController.manualLevel=t;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function e(){return this.levelController.level},set:function e(t){o["logger"].log("set loadLevel:"+t);this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function e(){return this.levelController.nextLoadLevel},set:function e(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function e(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function e(t){o["logger"].log("set firstLevel:"+t);this.levelController.firstLevel=t}},{key:"startLevel",get:function e(){return this.levelController.startLevel},set:function e(t){o["logger"].log("set startLevel:"+t);if(t!==-1){t=Math.max(t,this.minAutoLevel)}this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function e(t){var r=!!t;if(r!==this.config.capLevelToPlayerSize){if(r){this.capLevelController.startCapping()}else{this.capLevelController.stopCapping();this.autoLevelCapping=-1;this.streamController.nextLevelSwitch()}this.config.capLevelToPlayerSize=r}}},{key:"autoLevelCapping",get:function e(){return this._autoLevelCapping},set:function e(t){o["logger"].log("set autoLevelCapping:"+t);this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function e(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function e(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function e(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function e(){var t=this.levels,r=this.config.minAutoBitrate;var i=t?t.length:0;for(var n=0;n<i;n++){var a=t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate;if(a>r){return n}}return 0}},{key:"maxAutoLevel",get:function e(){var t=this.levels,r=this.autoLevelCapping;var i;if(r===-1&&t&&t.length){i=t.length-1}else{i=r}return i}},{key:"nextAutoLevel",get:function e(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function e(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function e(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function e(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function e(t){var r=this.audioTrackController;if(r){r.audioTrack=t}}},{key:"liveSyncPosition",get:function e(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function e(t){var r=this.subtitleTrackController;if(r){r.subtitleTrack=t}}},{key:"subtitleDisplay",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleDisplay:false},set:function e(t){var r=this.subtitleTrackController;if(r){r.subtitleDisplay=t}}}]);return t}(ue);tr.defaultConfig=void 0},"./src/polyfills/number.js":function(e,t,r){"use strict";r.r(t);r.d(t,"isFiniteNumber",(function(){return i}));r.d(t,"MAX_SAFE_INTEGER",(function(){return n}));var i=Number.isFinite||function(e){return typeof e==="number"&&isFinite(e)};var n=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(e,t,r){"use strict";r.r(t);r.d(t,"getSelfScope",(function(){return i}));function i(){if(typeof window==="undefined"){return self}else{return window}}},"./src/utils/logger.js":function(e,t,r){"use strict";r.r(t);r.d(t,"enableLogs",(function(){return f}));r.d(t,"logger",(function(){return c}));var i=r("./src/utils/get-self-scope.js");function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n};var s=a;function o(e,t){t="["+e+"] > "+t;return t}var u=Object(i["getSelfScope"])();function l(e){var t=u.console[e];if(t){return function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}if(i[0]){i[0]=o(e,i[0])}t.apply(u.console,i)}}return n}function d(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}r.forEach((function(t){s[t]=e[t]?e[t].bind(e):l(t)}))}var f=function e(t){if(u.console&&t===true||typeof t==="object"){d(t,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else{s=a}};var c=s}})["default"]}))},"./node_modules/mpd-parser/dist/mpd-parser.es.js":function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return ae}));r.d(t,"b",(function(){return se}));var i=r("./node_modules/global/window.js");var n=r.n(i);var a="0.7.0";var s=function e(t){return!!t&&typeof t==="object"};var o=function e(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++){r[i]=arguments[i]}return r.reduce((function(t,r){Object.keys(r).forEach((function(i){if(Array.isArray(t[i])&&Array.isArray(r[i])){t[i]=t[i].concat(r[i])}else if(s(t[i])&&s(r[i])){t[i]=e(t[i],r[i])}else{t[i]=r[i]}}));return t}),{})};var u=function e(t){return Object.keys(t).map((function(e){return t[e]}))};var l=function e(t,r){var i=[];for(var n=t;n<r;n++){i.push(n)}return i};var d=function e(t){return t.reduce((function(e,t){return e.concat(t)}),[])};var f=function e(t){if(!t.length){return[]}var r=[];for(var i=0;i<t.length;i++){r.push(t[i])}return r};var c=function e(t,r){return t.reduce((function(e,t,i){if(t[r]){e.push(i)}return e}),[])};var h=function e(t){var r=u(t.reduce((function(e,t){var r=t.attributes.id+(t.attributes.lang||"");if(e[r]){var i;t.segments[0].discontinuity=true;(i=e[r].segments).push.apply(i,t.segments);if(t.attributes.contentProtection){e[r].attributes.contentProtection=t.attributes.contentProtection}}else{e[r]=t}return e}),{}));return r.map((function(e){e.discontinuityStarts=c(e.segments,"discontinuity");return e}))};var p=function e(t){var r;var i=t.attributes,n=t.segments;var a={attributes:(r={NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs},r["PROGRAM-ID"]=1,r),uri:"",endList:(i.type||"static")==="static",timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};if(i.contentProtection){a.contentProtection=i.contentProtection}return a};var v=function e(t){var r;var i=t.attributes,n=t.segments;if(typeof n==="undefined"){n=[{uri:i.baseUrl,timeline:i.periodIndex,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}];i.duration=i.sourceDuration}return{attributes:(r={NAME:i.id,BANDWIDTH:i.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:(i.type||"static")==="static",timeline:i.periodIndex,resolvedUri:i.baseUrl||"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1}};var m=function e(t){return t.reduce((function(e,t){var r=t.attributes.role&&t.attributes.role.value||"main";var i=t.attributes.lang||"";var n="main";if(i){n=t.attributes.lang+" ("+r+")"}if(e[n]&&e[n].playlists[0].attributes.BANDWIDTH>t.attributes.bandwidth){return e}e[n]={language:i,autoselect:true,default:r==="main",playlists:[p(t)],uri:""};return e}),{})};var g=function e(t){return t.reduce((function(e,t){var r=t.attributes.lang||"text";if(e[r]){return e}e[r]={language:r,default:false,autoselect:false,playlists:[v(t)],uri:""};return e}),{})};var y=function e(t){var r;var i=t.attributes,n=t.segments;var a={attributes:(r={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:(i.type||"static")==="static",timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};if(i.contentProtection){a.contentProtection=i.contentProtection}return a};var _=function e(t){var r;if(!t.length){return{}}var i=t[0].attributes,n=i.sourceDuration,a=i.minimumUpdatePeriod,s=a===void 0?0:a;var o=function e(t){var r=t.attributes;return r.mimeType==="video/mp4"||r.contentType==="video"};var u=function e(t){var r=t.attributes;return r.mimeType==="audio/mp4"||r.contentType==="audio"};var l=function e(t){var r=t.attributes;return r.mimeType==="text/vtt"||r.contentType==="text"};var d=h(t.filter(o)).map(y);var f=h(t.filter(u));var c=t.filter(l);var p={allowCache:true,discontinuityStarts:[],segments:[],endList:true,mediaGroups:(r={AUDIO:{},VIDEO:{}},r["CLOSED-CAPTIONS"]={},r.SUBTITLES={},r),uri:"",duration:n,playlists:d,minimumUpdatePeriod:s*1e3};if(f.length){p.mediaGroups.AUDIO.audio=m(f)}if(c.length){p.mediaGroups.SUBTITLES.subs=g(c)}return p};var b=typeof window!=="undefined"?window:typeof e!=="undefined"?e:typeof self!=="undefined"?self:{};function T(e,t){return t={exports:{}},e(t,t.exports),t.exports}var S=T((function(e,t){(function(t){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;var i=/^([^\/?#]*)(.*)$/;var n=/(?:\/|^)\.(?=\/)/g;var a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;var s={buildAbsoluteURL:function(e,t,r){r=r||{};e=e.trim();t=t.trim();if(!t){if(!r.alwaysNormalize){return e}var n=s.parseURL(e);if(!n){throw new Error("Error trying to parse base URL.")}n.path=s.normalizePath(n.path);return s.buildURLFromParts(n)}var a=s.parseURL(t);if(!a){throw new Error("Error trying to parse relative URL.")}if(a.scheme){if(!r.alwaysNormalize){return t}a.path=s.normalizePath(a.path);return s.buildURLFromParts(a)}var o=s.parseURL(e);if(!o){throw new Error("Error trying to parse base URL.")}if(!o.netLoc&&o.path&&o.path[0]!=="/"){var u=i.exec(o.path);o.netLoc=u[1];o.path=u[2]}if(o.netLoc&&!o.path){o.path="/"}var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){l.netLoc=o.netLoc;if(a.path[0]!=="/"){if(!a.path){l.path=o.path;if(!a.params){l.params=o.params;if(!a.query){l.query=o.query}}}else{var d=o.path;var f=d.substring(0,d.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(f)}}}if(l.path===null){l.path=r.alwaysNormalize?s.normalizePath(a.path):a.path}return s.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);if(!t){return null}return{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(n,"");while(e.length!==(e=e.replace(a,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=s})(b)}));var E=function e(t,r){if(/^[a-z]+:/i.test(r)){return r}if(!/\/\//i.test(t)){t=S.buildAbsoluteURL(n.a.location.href,t)}return S.buildAbsoluteURL(t,r)};var w=function e(t){var r=t.baseUrl,i=r===void 0?"":r,n=t.source,a=n===void 0?"":n,s=t.range,o=s===void 0?"":s;var u={uri:a,resolvedUri:E(i||"",a)};if(o){var l=o.split("-");var d=parseInt(l[0],10);var f=parseInt(l[1],10);u.byterange={length:f-d,offset:d}}return u};var k=function e(t,r,i){var n=t.NOW,a=t.clientOffset,s=t.availabilityStartTime,o=t.timescale,u=o===void 0?1:o,l=t.start,d=l===void 0?0:l,f=t.minimumUpdatePeriod,c=f===void 0?0:f;var h=(n+a)/1e3;var p=s+d;var v=h+c;var m=v-p;return Math.ceil((m*u-r)/i)};var A=function e(t,r){var i=t.type,n=i===void 0?"static":i,a=t.minimumUpdatePeriod,s=a===void 0?0:a,o=t.media,u=o===void 0?"":o,l=t.sourceDuration,d=t.timescale,f=d===void 0?1:d,c=t.startNumber,h=c===void 0?1:c,p=t.periodIndex;var v=[];var m=-1;for(var g=0;g<r.length;g++){var y=r[g];var _=y.d;var b=y.r||0;var T=y.t||0;if(m<0){m=T}if(T&&T>m){m=T}var S=void 0;if(b<0){var E=g+1;if(E===r.length){if(n==="dynamic"&&s>0&&u.indexOf("$Number$")>0){S=k(t,m,_)}else{S=(l*f-m)/_}}else{S=(r[E].t-m)/_}}else{S=b+1}var w=h+v.length+S;var A=h+v.length;while(A<w){v.push({number:A,duration:_/f,time:m,timeline:p});m+=_;A++}}return v};var C={static:function e(t){var r=t.duration,i=t.timescale,n=i===void 0?1:i,a=t.sourceDuration;return{start:0,end:Math.ceil(a/(r/n))}},dynamic:function e(t){var r=t.NOW,i=t.clientOffset,n=t.availabilityStartTime,a=t.timescale,s=a===void 0?1:a,o=t.duration,u=t.start,l=u===void 0?0:u,d=t.minimumUpdatePeriod,f=d===void 0?0:d,c=t.timeShiftBufferDepth,h=c===void 0?Infinity:c;var p=(r+i)/1e3;var v=n+l;var m=p+f;var g=m-v;var y=Math.ceil(g*s/o);var _=Math.floor((p-v-h)*s/o);var b=Math.floor((p-v)*s/o);return{start:Math.max(0,_),end:Math.min(y,b)}}};var L=function e(t){return function(e,r){var i=t.duration,n=t.timescale,a=n===void 0?1:n,s=t.periodIndex,o=t.startNumber,u=o===void 0?1:o;return{number:u+e,duration:i/a,timeline:s,time:r*i}}};var x=function e(t){var r=t.type,i=r===void 0?"static":r,n=t.duration,a=t.timescale,s=a===void 0?1:a,o=t.sourceDuration;var u=C[i](t),d=u.start,f=u.end;var c=l(d,f).map(L(t));if(i==="static"){var h=c.length-1;c[h].duration=o-n/s*h}return c};var D=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g;var I=function e(t){return function(e,r,i,n){if(e==="$$"){return"$"}if(typeof t[r]==="undefined"){return e}var a=""+t[r];if(r==="RepresentationID"){return a}if(!i){n=1}else{n=parseInt(n,10)}if(a.length>=n){return a}return""+new Array(n-a.length+1).join("0")+a}};var O=function e(t,r){return t.replace(D,I(r))};var R=function e(t,r){if(!t.duration&&!r){return[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodIndex}]}if(t.duration){return x(t)}return A(t,r)};var P=function e(t,r){var i={RepresentationID:t.id,Bandwidth:t.bandwidth||0};var n=t.initialization,a=n===void 0?{sourceURL:"",range:""}:n;var s=w({baseUrl:t.baseUrl,source:O(a.sourceURL,i),range:a.range});var o=R(t,r);return o.map((function(e){i.Number=e.number;i.Time=e.time;var r=O(t.media||"",i);return{uri:r,timeline:e.timeline,duration:e.duration,resolvedUri:E(t.baseUrl||"",r),map:s,number:e.number}}))};var U={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};var M=function e(t,r){var i=t.baseUrl,n=t.initialization,a=n===void 0?{}:n;var s=w({baseUrl:i,source:a.sourceURL,range:a.range});var o=w({baseUrl:i,source:r.media,range:r.mediaRange});o.map=s;return o};var N=function e(t,r){var i=t.duration,n=t.segmentUrls,a=n===void 0?[]:n;if(!i&&!r||i&&r){throw new Error(U.SEGMENT_TIME_UNSPECIFIED)}var s=a.map((function(e){return M(t,e)}));var o;if(i){o=x(t)}if(r){o=A(t,r)}var u=o.map((function(e,t){if(s[t]){var r=s[t];r.timeline=e.timeline;r.duration=e.duration;r.number=e.number;return r}})).filter((function(e){return e}));return u};var j=function e(t){var r=t.baseUrl,i=t.initialization,n=i===void 0?{}:i,a=t.sourceDuration,s=t.timescale,o=s===void 0?1:s,u=t.indexRange,l=u===void 0?"":u,d=t.duration;if(!r){throw new Error(U.NO_BASE_URL)}var f=w({baseUrl:r,source:n.sourceURL,range:n.range});var c=w({baseUrl:r,source:r,range:l});c.map=f;if(d){var h=x(t);if(h.length){c.duration=h[0].duration;c.timeline=h[0].timeline}}else if(a){c.duration=a/o;c.timeline=0}c.number=0;return[c]};var B=function e(t){var r=t.attributes,i=t.segmentInfo;var n;var a;if(i.template){a=P;n=o(r,i.template)}else if(i.base){a=j;n=o(r,i.base)}else if(i.list){a=N;n=o(r,i.list)}if(!a){return{attributes:r}}var s=a(n,i.timeline);if(n.duration){var u=n,l=u.duration,d=u.timescale,f=d===void 0?1:d;n.duration=l/f}else if(s.length){n.duration=s.reduce((function(e,t){return Math.max(e,Math.ceil(t.duration))}),0)}else{n.duration=0}return{attributes:n,segments:s}};var F=function e(t){return t.map(B)};var H=function e(t,r){return f(t.childNodes).filter((function(e){var t=e.tagName;return t===r}))};var q=function e(t){return t.textContent.trim()};var G=function e(t){var r=365*24*60*60;var i=30*24*60*60;var n=24*60*60;var a=60*60;var s=60;var o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/;var u=o.exec(t);if(!u){return 0}var l=u.slice(1),d=l[0],f=l[1],c=l[2],h=l[3],p=l[4],v=l[5];return parseFloat(d||0)*r+parseFloat(f||0)*i+parseFloat(c||0)*n+parseFloat(h||0)*a+parseFloat(p||0)*s+parseFloat(v||0)};var V=function e(t){var r=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;if(r.test(t)){t+="Z"}return Date.parse(t)};var W={mediaPresentationDuration:function e(t){return G(t)},availabilityStartTime:function e(t){return V(t)/1e3},minimumUpdatePeriod:function e(t){return G(t)},timeShiftBufferDepth:function e(t){return G(t)},start:function e(t){return G(t)},width:function e(t){return parseInt(t,10)},height:function e(t){return parseInt(t,10)},bandwidth:function e(t){return parseInt(t,10)},startNumber:function e(t){return parseInt(t,10)},timescale:function e(t){return parseInt(t,10)},duration:function e(t){var r=parseInt(t,10);if(isNaN(r)){return G(t)}return r},d:function e(t){return parseInt(t,10)},t:function e(t){return parseInt(t,10)},r:function e(t){return parseInt(t,10)},DEFAULT:function e(t){return t}};var z=function e(t){if(!(t&&t.attributes)){return{}}return f(t.attributes).reduce((function(e,t){var r=W[t.name]||W.DEFAULT;e[t.name]=r(t.value);return e}),{})};function K(e){var t=n.a.atob(e);var r=new Uint8Array(t.length);for(var i=0;i<t.length;i++){r[i]=t.charCodeAt(i)}return r}var Y={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};var X=function e(t,r){if(!r.length){return t}return d(t.map((function(e){return r.map((function(t){return E(e,q(t))}))})))};var J=function e(t){var r=H(t,"SegmentTemplate")[0];var i=H(t,"SegmentList")[0];var n=i&&H(i,"SegmentURL").map((function(e){return o({tag:"SegmentURL"},z(e))}));var a=H(t,"SegmentBase")[0];var s=i||r;var u=s&&H(s,"SegmentTimeline")[0];var l=i||a||r;var d=l&&H(l,"Initialization")[0];var f=r&&z(r);if(f&&d){f.initialization=d&&z(d)}else if(f&&f.initialization){f.initialization={sourceURL:f.initialization}}var c={template:f,timeline:u&&H(u,"S").map((function(e){return z(e)})),list:i&&o(z(i),{segmentUrls:n,initialization:z(d)}),base:a&&o(z(a),{initialization:z(d)})};Object.keys(c).forEach((function(e){if(!c[e]){delete c[e]}}));return c};var Q=function e(t,r,i){return function(e){var n=H(e,"BaseURL");var a=X(r,n);var s=o(t,z(e));var u=J(e);return a.map((function(e){return{segmentInfo:o(i,u),attributes:o(s,{baseUrl:e})}}))}};var $=function e(t){return t.reduce((function(e,t){var r=z(t);var i=Y[r.schemeIdUri];if(i){e[i]={attributes:r};var n=H(t,"cenc:pssh")[0];if(n){var a=q(n);var s=a&&K(a);e[i].pssh=s}}return e}),{})};var Z=function e(t,r,i){return function(e){var n=z(e);var a=X(r,H(e,"BaseURL"));var s=H(e,"Role")[0];var u={role:z(s)};var l=o(t,n,u);var f=$(H(e,"ContentProtection"));if(Object.keys(f).length){l=o(l,{contentProtection:f})}var c=J(e);var h=H(e,"Representation");var p=o(i,c);return d(h.map(Q(l,a,p)))}};var ee=function e(t,r){return function(e,i){var a=X(r,H(e,"BaseURL"));var s=z(e);var u=parseInt(s.id,10);var l=n.a.isNaN(u)?i:u;var f=o(t,{periodIndex:l});var c=H(e,"AdaptationSet");var h=J(e);return d(c.map(Z(f,a,h)))}};var te=function e(t,r){if(r===void 0){r={}}var i=r,n=i.manifestUri,a=n===void 0?"":n,s=i.NOW,o=s===void 0?Date.now():s,u=i.clientOffset,l=u===void 0?0:u;var f=H(t,"Period");if(!f.length){throw new Error(U.INVALID_NUMBER_OF_PERIOD)}var c=z(t);var h=X([a],H(t,"BaseURL"));c.sourceDuration=c.mediaPresentationDuration||0;c.NOW=o;c.clientOffset=l;return d(f.map(ee(c,h)))};var re=function e(t){if(t===""){throw new Error(U.DASH_EMPTY_MANIFEST)}var r=new n.a.DOMParser;var i=r.parseFromString(t,"application/xml");var a=i&&i.documentElement.tagName==="MPD"?i.documentElement:null;if(!a||a&&a.getElementsByTagName("parsererror").length>0){throw new Error(U.DASH_INVALID_XML)}return a};var ie=function e(t){var r=H(t,"UTCTiming")[0];if(!r){return null}var i=z(r);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT";i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(U.UNSUPPORTED_UTC_TIMING_SCHEME)}return i};var ne=a;var ae=function e(t,r){return _(F(te(re(t),r)))};var se=function e(t){return ie(re(t))}}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/mux.js/lib/aac/index.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js");var n=r("./node_modules/mux.js/lib/aac/utils.js");var a;a=function(){var e=new Uint8Array,t=0;a.prototype.init.call(this);this.setTimestamp=function(e){t=e};this.push=function(r){var i=0,a=0,s,o,u,l;if(e.length){l=e.length;e=new Uint8Array(r.byteLength+l);e.set(e.subarray(0,l));e.set(r,l)}else{e=r}while(e.length-a>=3){if(e[a]==="I".charCodeAt(0)&&e[a+1]==="D".charCodeAt(0)&&e[a+2]==="3".charCodeAt(0)){if(e.length-a<10){break}i=n.parseId3TagSize(e,a);if(a+i>e.length){break}o={type:"timed-metadata",data:e.subarray(a,a+i)};this.trigger("data",o);a+=i;continue}else if((e[a]&255)===255&&(e[a+1]&240)===240){if(e.length-a<7){break}i=n.parseAdtsSize(e,a);if(a+i>e.length){break}u={type:"audio",data:e.subarray(a,a+i),pts:t,dts:t};this.trigger("data",u);a+=i;continue}a++}s=e.length-a;if(s>0){e=e.subarray(a)}else{e=new Uint8Array}}};a.prototype=new i;e.exports=a},"./node_modules/mux.js/lib/aac/utils.js":function(e,t,r){"use strict";var i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var n=function(e){if(e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)){return true}return false};var a=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]};var s=function(e,t,r){var i,n="";for(i=t;i<r;i++){n+="%"+("00"+e[i].toString(16)).slice(-2)}return n};var o=function(e,t,r){return unescape(s(e,t,r))};var u=function(e,t){var r=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],i=e[t+5],n=(i&16)>>4;if(n){return r+20}return r+10};var l=function(e,t){var r=(e[t+5]&224)>>5,i=e[t+4]<<3,n=e[t+3]&3<<11;return n|i|r};var d=function(e,t){if(e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)){return"timed-metadata"}else if(e[t]&255===255&&(e[t+1]&240)===240){return"audio"}return null};var f=function(e){var t=0;while(t+5<e.length){if(e[t]!==255||(e[t+1]&246)!==240){t++;continue}return i[(e[t+2]&60)>>>2]}return null};var c=function(e){var t,r,i,n;t=10;if(e[5]&64){t+=4;t+=a(e.subarray(10,14))}do{r=a(e.subarray(t+4,t+8));if(r<1){return null}n=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]);if(n==="PRIV"){i=e.subarray(t+10,t+r+10);for(var s=0;s<i.byteLength;s++){if(i[s]===0){var u=o(i,0,s);if(u==="com.apple.streaming.transportStreamTimestamp"){var l=i.subarray(s+1);var d=(l[3]&1)<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;d*=4;d+=l[7]&3;return d}break}}}t+=10;t+=r}while(t<e.byteLength);return null};e.exports={isLikelyAacData:n,parseId3TagSize:u,parseAdtsSize:l,parseType:d,parseSampleRate:f,parseAacTimestamp:c}},"./node_modules/mux.js/lib/codecs/adts.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js");var n;var a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n=function(){var e;n.prototype.init.call(this);this.push=function(t){var r=0,i=0,n,s,o,u,l,d;if(t.type!=="audio"){return}if(e){u=e;e=new Uint8Array(u.byteLength+t.data.byteLength);e.set(u);e.set(t.data,u.byteLength)}else{e=t.data}while(r+5<e.length){if(e[r]!==255||(e[r+1]&246)!==240){r++;continue}s=(~e[r+1]&1)*2;n=(e[r+3]&3)<<11|e[r+4]<<3|(e[r+5]&224)>>5;l=((e[r+6]&3)+1)*1024;d=l*9e4/a[(e[r+2]&60)>>>2];o=r+n;if(e.byteLength<o){return}this.trigger("data",{pts:t.pts+i*d,dts:t.dts+i*d,sampleCount:l,audioobjecttype:(e[r+2]>>>6&3)+1,channelcount:(e[r+2]&1)<<2|(e[r+3]&192)>>>6,samplerate:a[(e[r+2]&60)>>>2],samplingfrequencyindex:(e[r+2]&60)>>>2,samplesize:16,data:e.subarray(r+7+s,o)});if(e.byteLength===o){e=undefined;return}i++;e=e.subarray(o)}};this.flush=function(){this.trigger("done")}};n.prototype=new i;e.exports=n},"./node_modules/mux.js/lib/codecs/h264.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js");var n=r("./node_modules/mux.js/lib/utils/exp-golomb.js");var a,s;var o;s=function(){var e=0,t,r;s.prototype.init.call(this);this.push=function(i){var n;if(!r){r=i.data}else{n=new Uint8Array(r.byteLength+i.data.byteLength);n.set(r);n.set(i.data,r.byteLength);r=n}for(;e<r.byteLength-3;e++){if(r[e+2]===1){t=e+5;break}}while(t<r.byteLength){switch(r[t]){case 0:if(r[t-1]!==0){t+=2;break}else if(r[t-2]!==0){t++;break}if(e+3!==t-2){this.trigger("data",r.subarray(e+3,t-2))}do{t++}while(r[t]!==1&&t<r.length);e=t-2;t+=3;break;case 1:if(r[t-1]!==0||r[t-2]!==0){t+=3;break}this.trigger("data",r.subarray(e+3,t-2));e=t-2;t+=3;break;default:t+=3;break}}r=r.subarray(e);t-=e;e=0};this.flush=function(){if(r&&r.byteLength>3){this.trigger("data",r.subarray(e+3))}r=null;e=0;this.trigger("done")}};s.prototype=new i;o={100:true,110:true,122:true,244:true,44:true,83:true,86:true,118:true,128:true,138:true,139:true,134:true};a=function(){var e=new s,t,r,i,u,l,d,f;a.prototype.init.call(this);t=this;this.push=function(t){if(t.type!=="video"){return}r=t.trackId;i=t.pts;u=t.dts;e.push(t)};e.on("data",(function(e){var n={trackId:r,pts:i,dts:u,data:e};switch(e[0]&31){case 5:n.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:n.nalUnitType="sei_rbsp";n.escapedRBSP=l(e.subarray(1));break;case 7:n.nalUnitType="seq_parameter_set_rbsp";n.escapedRBSP=l(e.subarray(1));n.config=d(n.escapedRBSP);break;case 8:n.nalUnitType="pic_parameter_set_rbsp";break;case 9:n.nalUnitType="access_unit_delimiter_rbsp";break;default:break}t.trigger("data",n)}));e.on("done",(function(){t.trigger("done")}));this.flush=function(){e.flush()};f=function(e,t){var r=8,i=8,n,a;for(n=0;n<e;n++){if(i!==0){a=t.readExpGolomb();i=(r+a+256)%256}r=i===0?r:i}};l=function(e){var t=e.byteLength,r=[],i=1,n,a;while(i<t-2){if(e[i]===0&&e[i+1]===0&&e[i+2]===3){r.push(i+2);i+=2}else{i++}}if(r.length===0){return e}n=t-r.length;a=new Uint8Array(n);var s=0;for(i=0;i<n;s++,i++){if(s===r[0]){s++;r.shift()}a[i]=e[s]}return a};d=function(e){var t=0,r=0,i=0,a=0,s=1,u,l,d,c,h,p,v,m,g,y,_,b,T,S;u=new n(e);l=u.readUnsignedByte();c=u.readUnsignedByte();d=u.readUnsignedByte();u.skipUnsignedExpGolomb();if(o[l]){h=u.readUnsignedExpGolomb();if(h===3){u.skipBits(1)}u.skipUnsignedExpGolomb();u.skipUnsignedExpGolomb();u.skipBits(1);if(u.readBoolean()){_=h!==3?8:12;for(S=0;S<_;S++){if(u.readBoolean()){if(S<6){f(16,u)}else{f(64,u)}}}}}u.skipUnsignedExpGolomb();p=u.readUnsignedExpGolomb();if(p===0){u.readUnsignedExpGolomb()}else if(p===1){u.skipBits(1);u.skipExpGolomb();u.skipExpGolomb();v=u.readUnsignedExpGolomb();for(S=0;S<v;S++){u.skipExpGolomb()}}u.skipUnsignedExpGolomb();u.skipBits(1);m=u.readUnsignedExpGolomb();g=u.readUnsignedExpGolomb();y=u.readBits(1);if(y===0){u.skipBits(1)}u.skipBits(1);if(u.readBoolean()){t=u.readUnsignedExpGolomb();r=u.readUnsignedExpGolomb();i=u.readUnsignedExpGolomb();a=u.readUnsignedExpGolomb()}if(u.readBoolean()){if(u.readBoolean()){T=u.readUnsignedByte();switch(T){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:{b=[u.readUnsignedByte()<<8|u.readUnsignedByte(),u.readUnsignedByte()<<8|u.readUnsignedByte()];break}}if(b){s=b[0]/b[1]}}}return{profileIdc:l,levelIdc:d,profileCompatibility:c,width:Math.ceil(((m+1)*16-t*2-r*2)*s),height:(2-y)*(g+1)*16-i*2-a*2}}};a.prototype=new i;e.exports={H264Stream:a,NalByteStream:s}},"./node_modules/mux.js/lib/data/silence.js":function(e,t){var r=[33,16,5,32,164,27];var i=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252];var n=function(e){var t=[];while(e--){t.push(0)}return t};var a=function(e){return Object.keys(e).reduce((function(t,r){t[r]=new Uint8Array(e[r].reduce((function(e,t){return e.concat(t)}),[]));return t}),{})};var s={96e3:[r,[227,64],n(154),[56]],88200:[r,[231],n(170),[56]],64e3:[r,[248,192],n(240),[56]],48e3:[r,[255,192],n(268),[55,148,128],n(54),[112]],44100:[r,[255,192],n(268),[55,163,128],n(84),[112]],32e3:[r,[255,192],n(268),[55,234],n(226),[112]],24e3:[r,[255,192],n(268),[55,255,128],n(268),[111,112],n(126),[224]],16e3:[r,[255,192],n(268),[55,255,128],n(268),[111,255],n(269),[223,108],n(195),[1,192]],12e3:[i,n(268),[3,127,248],n(268),[6,255,240],n(268),[13,255,224],n(268),[27,253,128],n(259),[56]],11025:[i,n(268),[3,127,248],n(268),[6,255,240],n(268),[13,255,224],n(268),[27,255,192],n(268),[55,175,128],n(108),[112]],8e3:[i,n(268),[3,121,16],n(47),[7]]};e.exports=a(s)},"./node_modules/mux.js/lib/m2ts/caption-stream.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js");var n=r("./node_modules/mux.js/lib/tools/caption-packet-parser.js");var a=function(){a.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new f(0,0),new f(0,1),new f(1,0),new f(1,1)];this.reset();this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data"));e.on("done",this.trigger.bind(this,"done"))}),this)};a.prototype=new i;a.prototype.push=function(e){var t,r,i;if(e.nalUnitType!=="sei_rbsp"){return}t=n.parseSei(e.escapedRBSP);if(t.payloadType!==n.USER_DATA_REGISTERED_ITU_T_T35){return}r=n.parseUserData(t);if(!r){return}if(e.dts<this.latestDts_){this.ignoreNextEqualDts_=true;return}else if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;if(!this.numSameDts_){this.ignoreNextEqualDts_=false}return}i=n.parseCaptionPackets(e.pts,r);this.captionPackets_=this.captionPackets_.concat(i);if(this.latestDts_!==e.dts){this.numSameDts_=0}this.numSameDts_++;this.latestDts_=e.dts};a.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach((function(e){e.flush()}),this);return}this.captionPackets_.forEach((function(e,t){e.presortIndex=t}));this.captionPackets_.sort((function(e,t){if(e.pts===t.pts){return e.presortIndex-t.presortIndex}return e.pts-t.pts}));this.captionPackets_.forEach((function(e){if(e.type<2){this.dispatchCea608Packet(e)}}),this);this.captionPackets_.length=0;this.ccStreams_.forEach((function(e){e.flush()}),this);return};a.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=false;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach((function(e){e.reset()}))};a.prototype.dispatchCea608Packet=function(e){if(this.setsChannel1Active(e)){this.activeCea608Channel_[e.type]=0}else if(this.setsChannel2Active(e)){this.activeCea608Channel_[e.type]=1}if(this.activeCea608Channel_[e.type]===null){return}this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)};a.prototype.setsChannel1Active=function(e){return(e.ccData&30720)===4096};a.prototype.setsChannel2Active=function(e){return(e.ccData&30720)===6144};var s={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496};var o=function(e){if(e===null){return""}e=s[e]||e;return String.fromCharCode(e)};var u=14;var l=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152];var d=function(){var e=[],t=u+1;while(t--){e.push("")}return e};var f=function(e,t){f.prototype.init.call(this);this.field_=e||0;this.dataChannel_=t||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(e){var t,r,i,n,a;t=e.ccData&32639;if(t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096){this.lastControlCode_=t}else if(t!==this.PADDING_){this.lastControlCode_=null}i=t>>>8;n=t&255;if(t===this.PADDING_){return}else if(t===this.RESUME_CAPTION_LOADING_){this.mode_="popOn"}else if(t===this.END_OF_CAPTION_){this.mode_="popOn";this.clearFormatting(e.pts);this.flushDisplayed(e.pts);r=this.displayed_;this.displayed_=this.nonDisplayed_;this.nonDisplayed_=r;this.startPts_=e.pts}else if(t===this.ROLL_UP_2_ROWS_){this.rollUpRows_=2;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_3_ROWS_){this.rollUpRows_=3;this.setRollUp(e.pts)}else if(t===this.ROLL_UP_4_ROWS_){this.rollUpRows_=4;this.setRollUp(e.pts)}else if(t===this.CARRIAGE_RETURN_){this.clearFormatting(e.pts);this.flushDisplayed(e.pts);this.shiftRowsUp_();this.startPts_=e.pts}else if(t===this.BACKSPACE_){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}}else if(t===this.ERASE_DISPLAYED_MEMORY_){this.flushDisplayed(e.pts);this.displayed_=d()}else if(t===this.ERASE_NON_DISPLAYED_MEMORY_){this.nonDisplayed_=d()}else if(t===this.RESUME_DIRECT_CAPTIONING_){if(this.mode_!=="paintOn"){this.flushDisplayed(e.pts);this.displayed_=d()}this.mode_="paintOn";this.startPts_=e.pts}else if(this.isSpecialCharacter(i,n)){i=(i&3)<<8;a=o(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isExtCharacter(i,n)){if(this.mode_==="popOn"){this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1)}else{this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1)}i=(i&3)<<8;a=o(i|n);this[this.mode_](e.pts,a);this.column_++}else if(this.isMidRowCode(i,n)){this.clearFormatting(e.pts);this[this.mode_](e.pts," ");this.column_++;if((n&14)===14){this.addFormatting(e.pts,["i"])}if((n&1)===1){this.addFormatting(e.pts,["u"])}}else if(this.isOffsetControlCode(i,n)){this.column_+=n&3}else if(this.isPAC(i,n)){var s=l.indexOf(t&7968);if(this.mode_==="rollUp"){if(s-this.rollUpRows_+1<0){s=this.rollUpRows_-1}this.setRollUp(e.pts,s)}if(s!==this.row_){this.clearFormatting(e.pts);this.row_=s}if(n&1&&this.formatting_.indexOf("u")===-1){this.addFormatting(e.pts,["u"])}if((t&16)===16){this.column_=((t&14)>>1)*4}if(this.isColorPAC(n)){if((n&14)===14){this.addFormatting(e.pts,["i"])}}}else if(this.isNormalChar(i)){if(n===0){n=null}a=o(i);a+=o(n);this[this.mode_](e.pts,a);this.column_+=a.length}}};f.prototype=new i;f.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){console.error("Skipping malformed caption.");return""}})).join("\n").replace(/^\n+|\n+$/g,"");if(t.length){this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})}};f.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=d();this.nonDisplayed_=d();this.lastControlCode_=null;this.column_=0;this.row_=u;this.rollUpRows_=2;this.formatting_=[]};f.prototype.setConstants=function(){if(this.dataChannel_===0){this.BASE_=16;this.EXT_=17;this.CONTROL_=(20|this.field_)<<8;this.OFFSET_=23}else if(this.dataChannel_===1){this.BASE_=24;this.EXT_=25;this.CONTROL_=(28|this.field_)<<8;this.OFFSET_=31}this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};f.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63};f.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&(t>=32&&t<=63)};f.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&(t>=32&&t<=47)};f.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&(t>=33&&t<=35)};f.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&(t>=64&&t<=127)};f.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127};f.prototype.isNormalChar=function(e){return e>=32&&e<=127};f.prototype.setRollUp=function(e,t){if(this.mode_!=="rollUp"){this.row_=u;this.mode_="rollUp";this.flushDisplayed(e);this.nonDisplayed_=d();this.displayed_=d()}if(t!==undefined&&t!==this.row_){for(var r=0;r<this.rollUpRows_;r++){this.displayed_[t-r]=this.displayed_[this.row_-r];this.displayed_[this.row_-r]=""}}if(t===undefined){t=this.row_}this.topRow_=t-this.rollUpRows_+1};f.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var r=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,r)};f.prototype.clearFormatting=function(e){if(!this.formatting_.length){return}var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[];this[this.mode_](e,t)};f.prototype.popOn=function(e,t){var r=this.nonDisplayed_[this.row_];r+=t;this.nonDisplayed_[this.row_]=r};f.prototype.rollUp=function(e,t){var r=this.displayed_[this.row_];r+=t;this.displayed_[this.row_]=r};f.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++){this.displayed_[e]=""}for(e=this.row_+1;e<u+1;e++){this.displayed_[e]=""}for(e=this.topRow_;e<this.row_;e++){this.displayed_[e]=this.displayed_[e+1]}this.displayed_[this.row_]=""};f.prototype.paintOn=function(e,t){var r=this.displayed_[this.row_];r+=t;this.displayed_[this.row_]=r};e.exports={CaptionStream:a,Cea608Stream:f}},"./node_modules/mux.js/lib/m2ts/m2ts.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js"),n=r("./node_modules/mux.js/lib/m2ts/caption-stream.js"),a=r("./node_modules/mux.js/lib/m2ts/stream-types.js"),s=r("./node_modules/mux.js/lib/m2ts/timestamp-rollover-stream.js").TimestampRolloverStream;var o=r("./node_modules/mux.js/lib/m2ts/stream-types.js");var u,l,d;var f=188,c=71;u=function(){var e=new Uint8Array(f),t=0;u.prototype.init.call(this);this.push=function(r){var i=0,n=f,a;if(t){a=new Uint8Array(r.byteLength+t);a.set(e.subarray(0,t));a.set(r,t);t=0}else{a=r}while(n<a.byteLength){if(a[i]===c&&a[n]===c){this.trigger("data",a.subarray(i,n));i+=f;n+=f;continue}i++;n++}if(i<a.byteLength){e.set(a.subarray(i),0);t=a.byteLength-i}};this.flush=function(){if(t===f&&e[0]===c){this.trigger("data",e);t=0}this.trigger("done")}};u.prototype=new i;l=function(){var e,t,r,i;l.prototype.init.call(this);i=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;e=function(e,i){var n=0;if(i.payloadUnitStartIndicator){n+=e[n]+1}if(i.type==="pat"){t(e.subarray(n),i)}else{r(e.subarray(n),i)}};t=function(e,t){t.section_number=e[7];t.last_section_number=e[8];i.pmtPid=(e[10]&31)<<8|e[11];t.pmtPid=i.pmtPid};r=function(e,t){var r,n,s,o;if(!(e[5]&1)){return}i.programMapTable={video:null,audio:null,"timed-metadata":{}};r=(e[1]&15)<<8|e[2];n=3+r-4;s=(e[10]&15)<<8|e[11];o=12+s;while(o<n){var u=e[o];var l=(e[o+1]&31)<<8|e[o+2];if(u===a.H264_STREAM_TYPE&&i.programMapTable.video===null){i.programMapTable.video=l}else if(u===a.ADTS_STREAM_TYPE&&i.programMapTable.audio===null){i.programMapTable.audio=l}else if(u===a.METADATA_STREAM_TYPE){i.programMapTable["timed-metadata"][l]=u}o+=((e[o+3]&15)<<8|e[o+4])+5}t.programMapTable=i.programMapTable};this.push=function(t){var r={},i=4;r.payloadUnitStartIndicator=!!(t[1]&64);r.pid=t[1]&31;r.pid<<=8;r.pid|=t[2];if((t[3]&48)>>>4>1){i+=t[i]+1}if(r.pid===0){r.type="pat";e(t.subarray(i),r);this.trigger("data",r)}else if(r.pid===this.pmtPid){r.type="pmt";e(t.subarray(i),r);this.trigger("data",r);while(this.packetsWaitingForPmt.length){this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}}else if(this.programMapTable===undefined){this.packetsWaitingForPmt.push([t,i,r])}else{this.processPes_(t,i,r)}};this.processPes_=function(e,t,r){if(r.pid===this.programMapTable.video){r.streamType=a.H264_STREAM_TYPE}else if(r.pid===this.programMapTable.audio){r.streamType=a.ADTS_STREAM_TYPE}else{r.streamType=this.programMapTable["timed-metadata"][r.pid]}r.type="pes";r.data=e.subarray(t);this.trigger("data",r)}};l.prototype=new i;l.STREAM_TYPES={h264:27,adts:15};d=function(){var e=this,t={data:[],size:0},r={data:[],size:0},i={data:[],size:0},n=function(e,t){var r;t.packetLength=6+(e[4]<<8|e[5]);t.dataAlignmentIndicator=(e[6]&4)!==0;r=e[7];if(r&192){t.pts=(e[9]&14)<<27|(e[10]&255)<<20|(e[11]&254)<<12|(e[12]&255)<<5|(e[13]&254)>>>3;t.pts*=4;t.pts+=(e[13]&6)>>>1;t.dts=t.pts;if(r&64){t.dts=(e[14]&14)<<27|(e[15]&255)<<20|(e[16]&254)<<12|(e[17]&255)<<5|(e[18]&254)>>>3;t.dts*=4;t.dts+=(e[18]&6)>>>1}}t.data=e.subarray(9+e[8])},s=function(t,r,i){var a=new Uint8Array(t.size),s={type:r},o=0,u=0,l=false,d;if(!t.data.length||t.size<9){return}s.trackId=t.data[0].pid;for(o=0;o<t.data.length;o++){d=t.data[o];a.set(d.data,u);u+=d.data.byteLength}n(a,s);l=r==="video"||s.packetLength<=t.size;if(i||l){t.size=0;t.data.length=0}if(l){e.trigger("data",s)}};d.prototype.init.call(this);this.push=function(n){({pat:function(){},pes:function(){var e,u;switch(n.streamType){case a.H264_STREAM_TYPE:case o.H264_STREAM_TYPE:e=t;u="video";break;case a.ADTS_STREAM_TYPE:e=r;u="audio";break;case a.METADATA_STREAM_TYPE:e=i;u="timed-metadata";break;default:return}if(n.payloadUnitStartIndicator){s(e,u,true)}e.data.push(n);e.size+=n.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]},r=n.programMapTable;if(r.video!==null){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+r.video,codec:"avc",type:"video"})}if(r.audio!==null){t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+r.audio,codec:"adts",type:"audio"})}e.trigger("data",t)}})[n.type]()};this.flush=function(){s(t,"video");s(r,"audio");s(i,"timed-metadata");this.trigger("done")}};d.prototype=new i;var h={PAT_PID:0,MP2T_PACKET_LENGTH:f,TransportPacketStream:u,TransportParseStream:l,ElementaryStream:d,TimestampRolloverStream:s,CaptionStream:n.CaptionStream,Cea608Stream:n.Cea608Stream,MetadataStream:r("./node_modules/mux.js/lib/m2ts/metadata-stream.js")};for(var p in a){if(a.hasOwnProperty(p)){h[p]=a[p]}}e.exports=h},"./node_modules/mux.js/lib/m2ts/metadata-stream.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js"),n=r("./node_modules/mux.js/lib/m2ts/stream-types.js"),a=function(e,t,r){var i,n="";for(i=t;i<r;i++){n+="%"+("00"+e[i].toString(16)).slice(-2)}return n},s=function(e,t,r){return decodeURIComponent(a(e,t,r))},o=function(e,t,r){return unescape(a(e,t,r))},u=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},l={TXXX:function(e){var t;if(e.data[0]!==3){return}for(t=1;t<e.data.length;t++){if(e.data[t]===0){e.description=s(e.data,1,t);e.value=s(e.data,t+1,e.data.length).replace(/\0*$/,"");break}}e.data=e.value},WXXX:function(e){var t;if(e.data[0]!==3){return}for(t=1;t<e.data.length;t++){if(e.data[t]===0){e.description=s(e.data,1,t);e.url=s(e.data,t+1,e.data.length);break}}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++){if(e.data[t]===0){e.owner=o(e.data,0,t);break}}e.privateData=e.data.subarray(t+1);e.data=e.privateData}},d;d=function(e){var t={debug:!!(e&&e.debug),descriptor:e&&e.descriptor},r=0,i=[],a=0,s;d.prototype.init.call(this);this.dispatchType=n.METADATA_STREAM_TYPE.toString(16);if(t.descriptor){for(s=0;s<t.descriptor.length;s++){this.dispatchType+=("00"+t.descriptor[s].toString(16)).slice(-2)}}this.push=function(e){var n,s,o,d,f,c;if(e.type!=="timed-metadata"){return}if(e.dataAlignmentIndicator){a=0;i.length=0}if(i.length===0&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0))){if(t.debug){console.log("Skipping unrecognized metadata packet")}return}i.push(e);a+=e.data.byteLength;if(i.length===1){r=u(e.data.subarray(6,10));r+=10}if(a<r){return}n={data:new Uint8Array(r),frames:[],pts:i[0].pts,dts:i[0].dts};for(f=0;f<r;){n.data.set(i[0].data.subarray(0,r-f),f);f+=i[0].data.byteLength;a-=i[0].data.byteLength;i.shift()}s=10;if(n.data[5]&64){s+=4;s+=u(n.data.subarray(10,14));r-=u(n.data.subarray(16,20))}do{o=u(n.data.subarray(s+4,s+8));if(o<1){return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}c=String.fromCharCode(n.data[s],n.data[s+1],n.data[s+2],n.data[s+3]);d={id:c,data:n.data.subarray(s+10,s+o+10)};d.key=d.id;if(l[d.id]){l[d.id](d);if(d.owner==="com.apple.streaming.transportStreamTimestamp"){var h=d.data,p=(h[3]&1)<<30|h[4]<<22|h[5]<<14|h[6]<<6|h[7]>>>2;p*=4;p+=h[7]&3;d.timeStamp=p;if(n.pts===undefined&&n.dts===undefined){n.pts=d.timeStamp;n.dts=d.timeStamp}this.trigger("timestamp",d)}}n.frames.push(d);s+=10;s+=o}while(s<r);this.trigger("data",n)}};d.prototype=new i;e.exports=d},"./node_modules/mux.js/lib/m2ts/probe.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/m2ts/stream-types.js");var n=function(e){var t=e[1]&31;t<<=8;t|=e[2];return t};var a=function(e){return!!(e[1]&64)};var s=function(e){var t=0;if((e[3]&48)>>>4>1){t+=e[4]+1}return t};var o=function(e,t){var r=n(e);if(r===0){return"pat"}else if(r===t){return"pmt"}else if(t){return"pes"}return null};var u=function(e){var t=a(e);var r=4+s(e);if(t){r+=e[r]+1}return(e[r+10]&31)<<8|e[r+11]};var l=function(e){var t={};var r=a(e);var i=4+s(e);if(r){i+=e[i]+1}if(!(e[i+5]&1)){return}var n,o,u;n=(e[i+1]&15)<<8|e[i+2];o=3+n-4;u=(e[i+10]&15)<<8|e[i+11];var l=12+u;while(l<o){var d=i+l;t[(e[d+1]&31)<<8|e[d+2]]=e[d];l+=((e[d+3]&15)<<8|e[d+4])+5}return t};var d=function(e,t){var r=n(e);var a=t[r];switch(a){case i.H264_STREAM_TYPE:return"video";case i.ADTS_STREAM_TYPE:return"audio";case i.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}};var f=function(e){var t=a(e);if(!t){return null}var r=4+s(e);if(r>=e.byteLength){return null}var i=null;var n;n=e[r+7];if(n&192){i={};i.pts=(e[r+9]&14)<<27|(e[r+10]&255)<<20|(e[r+11]&254)<<12|(e[r+12]&255)<<5|(e[r+13]&254)>>>3;i.pts*=4;i.pts+=(e[r+13]&6)>>>1;i.dts=i.pts;if(n&64){i.dts=(e[r+14]&14)<<27|(e[r+15]&255)<<20|(e[r+16]&254)<<12|(e[r+17]&255)<<5|(e[r+18]&254)>>>3;i.dts*=4;i.dts+=(e[r+18]&6)>>>1}}return i};var c=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};var h=function(e){var t=4+s(e);var r=e.subarray(t);var i=0;var n=0;var a=false;var o;for(;n<r.byteLength-3;n++){if(r[n+2]===1){i=n+5;break}}while(i<r.byteLength){switch(r[i]){case 0:if(r[i-1]!==0){i+=2;break}else if(r[i-2]!==0){i++;break}if(n+3!==i-2){o=c(r[n+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){a=true}}do{i++}while(r[i]!==1&&i<r.length);n=i-2;i+=3;break;case 1:if(r[i-1]!==0||r[i-2]!==0){i+=3;break}o=c(r[n+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){a=true}n=i-2;i+=3;break;default:i+=3;break}}r=r.subarray(n);i-=n;n=0;if(r&&r.byteLength>3){o=c(r[n+3]&31);if(o==="slice_layer_without_partitioning_rbsp_idr"){a=true}}return a};e.exports={parseType:o,parsePat:u,parsePmt:l,parsePayloadUnitStartIndicator:a,parsePesType:d,parsePesTime:f,videoPacketContainsKeyFrame:h}},"./node_modules/mux.js/lib/m2ts/stream-types.js":function(e,t,r){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},"./node_modules/mux.js/lib/m2ts/timestamp-rollover-stream.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js");var n=8589934592;var a=4294967296;var s=function(e,t){var r=1;if(e>t){r=-1}while(Math.abs(t-e)>a){e+=r*n}return e};var o=function(e){var t,r;o.prototype.init.call(this);this.type_=e;this.push=function(e){if(e.type!==this.type_){return}if(r===undefined){r=e.dts}e.dts=s(e.dts,r);e.pts=s(e.pts,r);t=e.dts;this.trigger("data",e)};this.flush=function(){r=t;this.trigger("done")};this.discontinuity=function(){r=void 0;t=void 0}};o.prototype=new i;e.exports={TimestampRolloverStream:o,handleRollover:s}},"./node_modules/mux.js/lib/mp4/audio-frame-utils.js":function(e,t,r){var i=r("./node_modules/mux.js/lib/data/silence.js");var n=r("./node_modules/mux.js/lib/utils/clock.js");var a=9e4;var s=function(e){var t,r,i=0;for(t=0;t<e.length;t++){r=e[t];i+=r.data.byteLength}return i};var o=function(e,t,r,s){var o,u=0,l=0,d=0,f=0,c,h;if(!t.length){return}o=n.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate);u=Math.ceil(a/(e.samplerate/1024));if(r&&s){l=o-Math.max(r,s);d=Math.floor(l/u);f=d*u}if(d<1||f>a/2){return}c=i[e.samplerate];if(!c){c=t[0].data}for(h=0;h<d;h++){t.splice(h,0,{data:c})}e.baseMediaDecodeTime-=Math.floor(n.videoTsToAudioTs(f,e.samplerate))};var u=function(e,t,r){if(t.minSegmentDts>=r){return e}t.minSegmentDts=Infinity;return e.filter((function(e){if(e.dts>=r){t.minSegmentDts=Math.min(t.minSegmentDts,e.dts);t.minSegmentPts=t.minSegmentDts;return true}return false}))};var l=function(e){var t,r,i=[];for(t=0;t<e.length;t++){r=e[t];i.push({size:r.data.byteLength,duration:1024})}return i};var d=function(e){var t,r,i=0,n=new Uint8Array(s(e));for(t=0;t<e.length;t++){r=e[t];n.set(r.data,i);i+=r.data.byteLength}return n};e.exports={prefixWithSilence:o,trimAdtsFramesByEarliestDts:u,generateSampleTable:l,concatenateFrameData:d}},"./node_modules/mux.js/lib/mp4/caption-parser.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/tools/caption-packet-parser.js").discardEmulationPreventionBytes;var n=r("./node_modules/mux.js/lib/m2ts/caption-stream.js").CaptionStream;var a=r("./node_modules/mux.js/lib/mp4/probe.js");var s=r("./node_modules/mux.js/lib/tools/mp4-inspector.js");var o=function(e,t){var r=e;for(var i=0;i<t.length;i++){var n=t[i];if(r<n.size){return n}r-=n.size}return null};var u=function(e,t,r){var n=new DataView(e.buffer,e.byteOffset,e.byteLength),a=[],s,u,l,d;for(u=0;u+4<e.length;u+=l){l=n.getUint32(u);u+=4;if(l<=0){continue}switch(e[u]&31){case 6:var f=e.subarray(u+1,u+1+l);var c=o(u,t);s={nalUnitType:"sei_rbsp",size:l,data:f,escapedRBSP:i(f),trackId:r};if(c){s.pts=c.pts;s.dts=c.dts;d=c}else{s.pts=d.pts;s.dts=d.dts}a.push(s);break;default:break}}return a};var l=function(e,t,r){var i=t;var n=r.defaultSampleDuration||0;var a=r.defaultSampleSize||0;var o=r.trackId;var u=[];e.forEach((function(e){var t=s.parseTrun(e);var r=t.samples;r.forEach((function(e){if(e.duration===undefined){e.duration=n}if(e.size===undefined){e.size=a}e.trackId=o;e.dts=i;if(e.compositionTimeOffset===undefined){e.compositionTimeOffset=0}e.pts=i+e.compositionTimeOffset;i+=e.duration}));u=u.concat(r)}));return u};var d=function(e,t){var r=a.findBox(e,["moof","traf"]);var i=a.findBox(e,["mdat"]);var n={};var o=[];i.forEach((function(e,t){var i=r[t];o.push({mdat:e,traf:i})}));o.forEach((function(e){var r=e.mdat;var i=e.traf;var o=a.findBox(i,["tfhd"]);var d=s.parseTfhd(o[0]);var f=d.trackId;var c=a.findBox(i,["tfdt"]);var h=c.length>0?s.parseTfdt(c[0]).baseMediaDecodeTime:0;var p=a.findBox(i,["trun"]);var v;var m;if(t===f&&p.length>0){v=l(p,h,d);m=u(r,v,f);if(!n[f]){n[f]=[]}n[f]=n[f].concat(m)}}));return n};var f=function(e,t,r){var i;if(!t){return null}i=d(e,t);return{seiNals:i[t],timescale:r}};var c=function(){var e=false;var t;var r;var i;var a;var s;this.isInitialized=function(){return e};this.init=function(){t=new n;e=true;t.on("data",(function(e){e.startTime=e.startPts/a;e.endTime=e.endPts/a;s.captions.push(e);s.captionStreams[e.stream]=true}))};this.isNewInit=function(e,t){if(e&&e.length===0||t&&typeof t==="object"&&Object.keys(t).length===0){return false}return i!==e[0]||a!==t[i]};this.parse=function(e,t,n){var o;if(!this.isInitialized()){return null}else if(!t||!n){return null}else if(this.isNewInit(t,n)){i=t[0];a=n[i]}else if(!i||!a){r.push(e);return null}while(r.length>0){var u=r.shift();this.parse(u,t,n)}o=f(e,i,a);if(o===null||!o.seiNals){return null}this.pushNals(o.seiNals);this.flushStream();return s};this.pushNals=function(e){if(!this.isInitialized()||!e||e.length===0){return null}e.forEach((function(e){t.push(e)}))};this.flushStream=function(){if(!this.isInitialized()){return null}t.flush()};this.clearParsedCaptions=function(){s.captions=[];s.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized()){return null}t.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){r=[];i=null;a=null;if(!s){s={captions:[],captionStreams:{}}}else{this.clearParsedCaptions()}this.resetCaptionStream()};this.reset()};e.exports=c},"./node_modules/mux.js/lib/mp4/frame-utils.js":function(e,t){var r=function(e){var t,r,i=[],n=[];i.byteLength=0;for(t=0;t<e.length;t++){r=e[t];if(r.nalUnitType==="access_unit_delimiter_rbsp"){if(i.length){i.duration=r.dts-i.dts;n.push(i)}i=[r];i.byteLength=r.data.byteLength;i.pts=r.pts;i.dts=r.dts}else{if(r.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"){i.keyFrame=true}i.duration=r.dts-i.dts;i.byteLength+=r.data.byteLength;i.push(r)}}if(n.length&&(!i.duration||i.duration<=0)){i.duration=n[n.length-1].duration}n.push(i);return n};var i=function(e){var t,r,i=[],n=[];i.byteLength=0;i.nalCount=0;i.duration=0;i.pts=e[0].pts;i.dts=e[0].dts;n.byteLength=0;n.nalCount=0;n.duration=0;n.pts=e[0].pts;n.dts=e[0].dts;for(t=0;t<e.length;t++){r=e[t];if(r.keyFrame){if(i.length){n.push(i);n.byteLength+=i.byteLength;n.nalCount+=i.nalCount;n.duration+=i.duration}i=[r];i.nalCount=r.length;i.byteLength=r.byteLength;i.pts=r.pts;i.dts=r.dts;i.duration=r.duration}else{i.duration+=r.duration;i.nalCount+=r.length;i.byteLength+=r.byteLength;i.push(r)}}if(n.length&&i.duration<=0){i.duration=n[n.length-1].duration}n.byteLength+=i.byteLength;n.nalCount+=i.nalCount;n.duration+=i.duration;n.push(i);return n};var n=function(e){var t;if(!e[0][0].keyFrame&&e.length>1){t=e.shift();e.byteLength-=t.byteLength;e.nalCount-=t.nalCount;e[0][0].dts=t.dts;e[0][0].pts=t.pts;e[0][0].duration+=t.duration}return e};var a=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}};var s=function(e,t){var r=a();r.dataOffset=t;r.compositionTimeOffset=e.pts-e.dts;r.duration=e.duration;r.size=4*e.length;r.size+=e.byteLength;if(e.keyFrame){r.flags.dependsOn=2;r.flags.isNonSyncSample=0}return r};var o=function(e,t){var r,i,n,a,o,u=t||0,l=[];for(r=0;r<e.length;r++){a=e[r];for(i=0;i<a.length;i++){o=a[i];n=s(o,u);u+=n.size;l.push(n)}}return l};var u=function(e){var t,r,i,n,a,s,o=0,u=e.byteLength,l=e.nalCount,d=u+4*l,f=new Uint8Array(d),c=new DataView(f.buffer);for(t=0;t<e.length;t++){n=e[t];for(r=0;r<n.length;r++){a=n[r];for(i=0;i<a.length;i++){s=a[i];c.setUint32(o,s.data.byteLength);o+=4;f.set(s.data,o);o+=s.data.byteLength}}}return f};e.exports={groupNalsIntoFrames:r,groupFramesIntoGops:i,extendFirstKeyFrame:n,generateSampleTable:o,concatenateNalData:u}},"./node_modules/mux.js/lib/mp4/index.js":function(e,t,r){e.exports={generator:r("./node_modules/mux.js/lib/mp4/mp4-generator.js"),probe:r("./node_modules/mux.js/lib/mp4/probe.js"),Transmuxer:r("./node_modules/mux.js/lib/mp4/transmuxer.js").Transmuxer,AudioSegmentStream:r("./node_modules/mux.js/lib/mp4/transmuxer.js").AudioSegmentStream,VideoSegmentStream:r("./node_modules/mux.js/lib/mp4/transmuxer.js").VideoSegmentStream,CaptionParser:r("./node_modules/mux.js/lib/mp4/caption-parser.js")}},"./node_modules/mux.js/lib/mp4/mp4-generator.js":function(e,t,r){"use strict";var i=Math.pow(2,32)-1;var n,a,s,o,u,l,d,f,c,h,p,v,m,g,y,_,b,T,S,E,w,k,A,C,L,x,D,I,O,R,P,U,M,N,j,B;(function(){var e;A={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if(typeof Uint8Array==="undefined"){return}for(e in A){if(A.hasOwnProperty(e)){A[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]}}C=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);x=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);L=new Uint8Array([0,0,0,1]);D=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);I=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);O={video:D,audio:I};U=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);P=new Uint8Array([0,0,0,0,0,0,0,0]);M=new Uint8Array([0,0,0,0,0,0,0,0]);N=M;j=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);B=M;R=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])})();n=function(e){var t=[],r=0,i,n,a;for(i=1;i<arguments.length;i++){t.push(arguments[i])}i=t.length;while(i--){r+=t[i].byteLength}n=new Uint8Array(r+8);a=new DataView(n.buffer,n.byteOffset,n.byteLength);a.setUint32(0,n.byteLength);n.set(e,4);for(i=0,r=8;i<t.length;i++){n.set(t[i],r);r+=t[i].byteLength}return n};a=function(){return n(A.dinf,n(A.dref,U))};s=function(e){return n(A.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))};o=function(){return n(A.ftyp,C,L,C,x)};_=function(e){return n(A.hdlr,O[e])};u=function(e){return n(A.mdat,e)};y=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,e.duration&255,85,196,0,0]);if(e.samplerate){t[12]=e.samplerate>>>24&255;t[13]=e.samplerate>>>16&255;t[14]=e.samplerate>>>8&255;t[15]=e.samplerate&255}return n(A.mdhd,t)};g=function(e){return n(A.mdia,y(e),_(e.type),d(e))};l=function(e){return n(A.mfhd,new Uint8Array([0,0,0,0,(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255]))};d=function(e){return n(A.minf,e.type==="video"?n(A.vmhd,R):n(A.smhd,P),a(),T(e))};f=function(e,t){var r=[],i=t.length;while(i--){r[i]=E(t[i])}return n.apply(null,[A.moof,l(e)].concat(r))};c=function(e){var t=e.length,r=[];while(t--){r[t]=v(e[t])}return n.apply(null,[A.moov,p(4294967295)].concat(r).concat(h(e)))};h=function(e){var t=e.length,r=[];while(t--){r[t]=w(e[t])}return n.apply(null,[A.mvex].concat(r))};p=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n(A.mvhd,t)};b=function(e){var t=e.samples||[],r=new Uint8Array(4+t.length),i,a;for(a=0;a<t.length;a++){i=t[a].flags;r[a+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy}return n(A.sdtp,r)};T=function(e){return n(A.stbl,S(e),n(A.stts,B),n(A.stsc,N),n(A.stsz,j),n(A.stco,M))};(function(){var e,t;S=function(r){return n(A.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),r.type==="video"?e(r):t(r))};e=function(e){var t=e.sps||[],r=e.pps||[],i=[],a=[],s;for(s=0;s<t.length;s++){i.push((t[s].byteLength&65280)>>>8);i.push(t[s].byteLength&255);i=i.concat(Array.prototype.slice.call(t[s]))}for(s=0;s<r.length;s++){a.push((r[s].byteLength&65280)>>>8);a.push(r[s].byteLength&255);a=a.concat(Array.prototype.slice.call(r[s]))}return n(A.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(e.width&65280)>>8,e.width&255,(e.height&65280)>>8,e.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n(A.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([t.length]).concat(i).concat([r.length]).concat(a))),n(A.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};t=function(e){return n(A.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(e.channelcount&65280)>>8,e.channelcount&255,(e.samplesize&65280)>>8,e.samplesize&255,0,0,0,0,(e.samplerate&65280)>>8,e.samplerate&255,0,0]),s(e))}})();m=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(e.id&4278190080)>>24,(e.id&16711680)>>16,(e.id&65280)>>8,e.id&255,0,0,0,0,(e.duration&4278190080)>>24,(e.duration&16711680)>>16,(e.duration&65280)>>8,e.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(e.width&65280)>>8,e.width&255,0,0,(e.height&65280)>>8,e.height&255,0,0]);return n(A.tkhd,t)};E=function(e){var t,r,a,s,o,u,l;t=n(A.tfhd,new Uint8Array([0,0,0,58,(e.id&4278190080)>>24,(e.id&16711680)>>16,(e.id&65280)>>8,e.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));u=Math.floor(e.baseMediaDecodeTime/(i+1));l=Math.floor(e.baseMediaDecodeTime%(i+1));r=n(A.tfdt,new Uint8Array([1,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,l>>>24&255,l>>>16&255,l>>>8&255,l&255]));o=32+20+8+16+8+8;if(e.type==="audio"){a=k(e,o);return n(A.traf,t,r,a)}s=b(e);a=k(e,s.length+o);return n(A.traf,t,r,a,s)};v=function(e){e.duration=e.duration||4294967295;return n(A.trak,m(e),g(e))};w=function(e){var t=new Uint8Array([0,0,0,0,(e.id&4278190080)>>24,(e.id&16711680)>>16,(e.id&65280)>>8,e.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);if(e.type!=="video"){t[t.length-1]=0}return n(A.trex,t)};(function(){var e,t,r;r=function(e,t){var r=0,i=0,n=0,a=0;if(e.length){if(e[0].duration!==undefined){r=1}if(e[0].size!==undefined){i=2}if(e[0].flags!==undefined){n=4}if(e[0].compositionTimeOffset!==undefined){a=8}}return[0,0,r|i|n|a,1,(e.length&4278190080)>>>24,(e.length&16711680)>>>16,(e.length&65280)>>>8,e.length&255,(t&4278190080)>>>24,(t&16711680)>>>16,(t&65280)>>>8,t&255]};t=function(e,t){var i,a,s,o;a=e.samples||[];t+=8+12+16*a.length;i=r(a,t);for(o=0;o<a.length;o++){s=a[o];i=i.concat([(s.duration&4278190080)>>>24,(s.duration&16711680)>>>16,(s.duration&65280)>>>8,s.duration&255,(s.size&4278190080)>>>24,(s.size&16711680)>>>16,(s.size&65280)>>>8,s.size&255,s.flags.isLeading<<2|s.flags.dependsOn,s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,s.flags.degradationPriority&240<<8,s.flags.degradationPriority&15,(s.compositionTimeOffset&4278190080)>>>24,(s.compositionTimeOffset&16711680)>>>16,(s.compositionTimeOffset&65280)>>>8,s.compositionTimeOffset&255])}return n(A.trun,new Uint8Array(i))};e=function(e,t){var i,a,s,o;a=e.samples||[];t+=8+12+8*a.length;i=r(a,t);for(o=0;o<a.length;o++){s=a[o];i=i.concat([(s.duration&4278190080)>>>24,(s.duration&16711680)>>>16,(s.duration&65280)>>>8,s.duration&255,(s.size&4278190080)>>>24,(s.size&16711680)>>>16,(s.size&65280)>>>8,s.size&255])}return n(A.trun,new Uint8Array(i))};k=function(r,i){if(r.type==="audio"){return e(r,i)}return t(r,i)}})();e.exports={ftyp:o,mdat:u,moof:f,moov:c,initSegment:function(e){var t=o(),r=c(e),i;i=new Uint8Array(t.byteLength+r.byteLength);i.set(t);i.set(r,t.byteLength);return i}}},"./node_modules/mux.js/lib/mp4/probe.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/bin.js").toUnsigned;var n,a,s,o,u;n=function(e,t){var r=[],s,o,u,l,d;if(!t.length){return null}for(s=0;s<e.byteLength;){o=i(e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3]);u=a(e.subarray(s+4,s+8));l=o>1?s+o:e.byteLength;if(u===t[0]){if(t.length===1){r.push(e.subarray(s+8,l))}else{d=n(e.subarray(s+8,l),t.slice(1));if(d.length){r=r.concat(d)}}}s=l}return r};a=function(e){var t="";t+=String.fromCharCode(e[0]);t+=String.fromCharCode(e[1]);t+=String.fromCharCode(e[2]);t+=String.fromCharCode(e[3]);return t};s=function(e){var t={},r=n(e,["moov","trak"]);return r.reduce((function(e,t){var r,a,s,o,u;r=n(t,["tkhd"])[0];if(!r){return null}a=r[0];s=a===0?12:20;o=i(r[s]<<24|r[s+1]<<16|r[s+2]<<8|r[s+3]);u=n(t,["mdia","mdhd"])[0];if(!u){return null}a=u[0];s=a===0?12:20;e[o]=i(u[s]<<24|u[s+1]<<16|u[s+2]<<8|u[s+3]);return e}),t)};o=function(e,t){var r,a,s;r=n(t,["moof","traf"]);a=[].concat.apply([],r.map((function(t){return n(t,["tfhd"]).map((function(r){var a,s,o;a=i(r[4]<<24|r[5]<<16|r[6]<<8|r[7]);s=e[a]||9e4;o=n(t,["tfdt"]).map((function(e){var t,r;t=e[0];r=i(e[4]<<24|e[5]<<16|e[6]<<8|e[7]);if(t===1){r*=Math.pow(2,32);r+=i(e[8]<<24|e[9]<<16|e[10]<<8|e[11])}return r}))[0];o=o||Infinity;return o/s}))})));s=Math.min.apply(null,a);return isFinite(s)?s:0};u=function(e){var t=n(e,["moov","trak"]);var r=[];t.forEach((function(e){var t=n(e,["mdia","hdlr"]);var i=n(e,["tkhd"]);t.forEach((function(e,t){var n=a(e.subarray(8,12));var s=i[t];var o;var u;var l;if(n==="vide"){o=new DataView(s.buffer,s.byteOffset,s.byteLength);u=o.getUint8(0);l=u===0?o.getUint32(12):o.getUint32(20);r.push(l)}}))}));return r};e.exports={findBox:n,parseType:a,timescale:s,startTime:o,videoTrackIds:u}},"./node_modules/mux.js/lib/mp4/track-decode-info.js":function(e,t){var r=9e4;var i=function(e,t){if(typeof t.pts==="number"){if(e.timelineStartInfo.pts===undefined){e.timelineStartInfo.pts=t.pts}if(e.minSegmentPts===undefined){e.minSegmentPts=t.pts}else{e.minSegmentPts=Math.min(e.minSegmentPts,t.pts)}if(e.maxSegmentPts===undefined){e.maxSegmentPts=t.pts}else{e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)}}if(typeof t.dts==="number"){if(e.timelineStartInfo.dts===undefined){e.timelineStartInfo.dts=t.dts}if(e.minSegmentDts===undefined){e.minSegmentDts=t.dts}else{e.minSegmentDts=Math.min(e.minSegmentDts,t.dts)}if(e.maxSegmentDts===undefined){e.maxSegmentDts=t.dts}else{e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts)}}};var n=function(e){delete e.minSegmentDts;delete e.maxSegmentDts;delete e.minSegmentPts;delete e.maxSegmentPts};var a=function(e,t){var i,n,a=e.minSegmentDts;if(!t){a-=e.timelineStartInfo.dts}i=e.timelineStartInfo.baseMediaDecodeTime;i+=a;i=Math.max(0,i);if(e.type==="audio"){n=e.samplerate/r;i*=n;i=Math.floor(i)}return i};e.exports={clearDtsInfo:n,calculateTrackBaseMediaDecodeTime:a,collectDtsInfo:i}},"./node_modules/mux.js/lib/mp4/transmuxer.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/utils/stream.js");var n=r("./node_modules/mux.js/lib/mp4/mp4-generator.js");var a=r("./node_modules/mux.js/lib/mp4/frame-utils.js");var s=r("./node_modules/mux.js/lib/mp4/audio-frame-utils.js");var o=r("./node_modules/mux.js/lib/mp4/track-decode-info.js");var u=r("./node_modules/mux.js/lib/m2ts/m2ts.js");var l=r("./node_modules/mux.js/lib/codecs/adts.js");var d=r("./node_modules/mux.js/lib/codecs/h264.js").H264Stream;var f=r("./node_modules/mux.js/lib/aac/index.js");var c=r("./node_modules/mux.js/lib/aac/utils.js").isLikelyAacData;var h=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"];var p=["width","height","profileIdc","levelIdc","profileCompatibility"];var v,m,g,y;var _=function(e,t){var r;if(e.length!==t.length){return false}for(r=0;r<e.length;r++){if(e[r]!==t[r]){return false}}return true};var b=function(e,t,r,i,n){return{start:{dts:e,pts:t},end:{dts:r,pts:i},prependedContentDuration:n}};m=function(e,t){var r=[],i=0,a=0,u=0,l=Infinity;t=t||{};m.prototype.init.call(this);this.push=function(t){o.collectDtsInfo(e,t);if(e){h.forEach((function(r){e[r]=t[r]}))}r.push(t)};this.setEarliestDts=function(t){a=t-e.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(e){l=e};this.setAudioAppendStart=function(e){u=e};this.flush=function(){var d,f,c,h;if(r.length===0){this.trigger("done","AudioSegmentStream");return}d=s.trimAdtsFramesByEarliestDts(r,e,a);e.baseMediaDecodeTime=o.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);s.prefixWithSilence(e,d,u,l);e.samples=s.generateSampleTable(d);c=n.mdat(s.concatenateFrameData(d));r=[];f=n.moof(i,[e]);h=new Uint8Array(f.byteLength+c.byteLength);i++;h.set(f);h.set(c,f.byteLength);o.clearDtsInfo(e);this.trigger("data",{track:e,boxes:h});this.trigger("done","AudioSegmentStream")}};m.prototype=new i;v=function(e,t){var r=0,i=[],s=[],u,l;t=t||{};v.prototype.init.call(this);delete e.minPTS;this.gopCache_=[];this.push=function(t){o.collectDtsInfo(e,t);if(t.nalUnitType==="seq_parameter_set_rbsp"&&!u){u=t.config;e.sps=[t.data];p.forEach((function(t){e[t]=u[t]}),this)}if(t.nalUnitType==="pic_parameter_set_rbsp"&&!l){l=t.data;e.pps=[t.data]}i.push(t)};this.flush=function(){var u,l,d,f,c,h,p=0,v,m;while(i.length){if(i[0].nalUnitType==="access_unit_delimiter_rbsp"){break}i.shift()}if(i.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}u=a.groupNalsIntoFrames(i);d=a.groupFramesIntoGops(u);if(!d[0][0].keyFrame){l=this.getGopForFusion_(i[0],e);if(l){p=l.duration;d.unshift(l);d.byteLength+=l.byteLength;d.nalCount+=l.nalCount;d.pts=l.pts;d.dts=l.dts;d.duration+=l.duration}else{d=a.extendFirstKeyFrame(d)}}if(s.length){var g;if(t.alignGopsAtEnd){g=this.alignGopsAtEnd_(d)}else{g=this.alignGopsAtStart_(d)}if(!g){this.gopCache_.unshift({gop:d.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}o.clearDtsInfo(e);d=g}o.collectDtsInfo(e,d);e.samples=a.generateSampleTable(d);c=n.mdat(a.concatenateNalData(d));e.baseMediaDecodeTime=o.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",d.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})));v=d[0];m=d[d.length-1];this.trigger("segmentTimingInfo",b(v.dts,v.pts,m.dts+m.duration,m.pts+m.duration,p));this.gopCache_.unshift({gop:d.pop(),pps:e.pps,sps:e.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime);this.trigger("timelineStartInfo",e.timelineStartInfo);f=n.moof(r,[e]);h=new Uint8Array(f.byteLength+c.byteLength);r++;h.set(f);h.set(c,f.byteLength);this.trigger("data",{track:e,boxes:h});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){o.clearDtsInfo(e);u=undefined;l=undefined};this.getGopForFusion_=function(t){var r=45e3,i=1e4,n=Infinity,a,s,o,u,l;for(l=0;l<this.gopCache_.length;l++){u=this.gopCache_[l];o=u.gop;if(!(e.pps&&_(e.pps[0],u.pps[0]))||!(e.sps&&_(e.sps[0],u.sps[0]))){continue}if(o.dts<e.timelineStartInfo.dts){continue}a=t.dts-o.dts-o.duration;if(a>=-i&&a<=r){if(!s||n>a){s=u;n=a}}}if(s){return s.gop}return null};this.alignGopsAtStart_=function(e){var t,r,i,n,a,o,u,l;a=e.byteLength;o=e.nalCount;u=e.duration;t=r=0;while(t<s.length&&r<e.length){i=s[t];n=e[r];if(i.pts===n.pts){break}if(n.pts>i.pts){t++;continue}r++;a-=n.byteLength;o-=n.nalCount;u-=n.duration}if(r===0){return e}if(r===e.length){return null}l=e.slice(r);l.byteLength=a;l.duration=u;l.nalCount=o;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsAtEnd_=function(e){var t,r,i,n,a,o;t=s.length-1;r=e.length-1;a=null;o=false;while(t>=0&&r>=0){i=s[t];n=e[r];if(i.pts===n.pts){o=true;break}if(i.pts>n.pts){t--;continue}if(t===s.length-1){a=r}r--}if(!o&&a===null){return null}var u;if(o){u=r}else{u=a}if(u===0){return e}var l=e.slice(u);var d=l.reduce((function(e,t){e.byteLength+=t.byteLength;e.duration+=t.duration;e.nalCount+=t.nalCount;return e}),{byteLength:0,duration:0,nalCount:0});l.byteLength=d.byteLength;l.duration=d.duration;l.nalCount=d.nalCount;l.pts=l[0].pts;l.dts=l[0].dts;return l};this.alignGopsWith=function(e){s=e}};v.prototype=new i;y=function(e,t){this.numberOfTracks=0;this.metadataStream=t;e=e||{};if(typeof e.remux!=="undefined"){this.remuxTracks=!!e.remux}else{this.remuxTracks=true}if(typeof e.keepOriginalTimestamps==="boolean"){this.keepOriginalTimestamps=e.keepOriginalTimestamps}this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;y.prototype.init.call(this);this.push=function(e){if(e.text){return this.pendingCaptions.push(e)}if(e.frames){return this.pendingMetadata.push(e)}this.pendingTracks.push(e.track);this.pendingBoxes.push(e.boxes);this.pendingBytes+=e.boxes.byteLength;if(e.track.type==="video"){this.videoTrack=e.track}if(e.track.type==="audio"){this.audioTrack=e.track}}};y.prototype=new i;y.prototype.flush=function(e){var t=0,r={captions:[],captionStreams:{},metadata:[],info:{}},i,a,s,o=0,u;if(this.pendingTracks.length<this.numberOfTracks){if(e!=="VideoSegmentStream"&&e!=="AudioSegmentStream"){return}else if(this.remuxTracks){return}else if(this.pendingTracks.length===0){this.emittedTracks++;if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}return}}if(this.videoTrack){o=this.videoTrack.timelineStartInfo.pts;p.forEach((function(e){r.info[e]=this.videoTrack[e]}),this)}else if(this.audioTrack){o=this.audioTrack.timelineStartInfo.pts;h.forEach((function(e){r.info[e]=this.audioTrack[e]}),this)}if(this.pendingTracks.length===1){r.type=this.pendingTracks[0].type}else{r.type="combined"}this.emittedTracks+=this.pendingTracks.length;s=n.initSegment(this.pendingTracks);r.initSegment=new Uint8Array(s.byteLength);r.initSegment.set(s);r.data=new Uint8Array(this.pendingBytes);for(u=0;u<this.pendingBoxes.length;u++){r.data.set(this.pendingBoxes[u],t);t+=this.pendingBoxes[u].byteLength}for(u=0;u<this.pendingCaptions.length;u++){i=this.pendingCaptions[u];i.startTime=i.startPts;if(!this.keepOriginalTimestamps){i.startTime-=o}i.startTime/=9e4;i.endTime=i.endPts;if(!this.keepOriginalTimestamps){i.endTime-=o}i.endTime/=9e4;r.captionStreams[i.stream]=true;r.captions.push(i)}for(u=0;u<this.pendingMetadata.length;u++){a=this.pendingMetadata[u];a.cueTime=a.pts;if(!this.keepOriginalTimestamps){a.cueTime-=o}a.cueTime/=9e4;r.metadata.push(a)}r.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",r);if(this.emittedTracks>=this.numberOfTracks){this.trigger("done");this.emittedTracks=0}};g=function(e){var t=this,r=true,i,n;g.prototype.init.call(this);e=e||{};this.baseMediaDecodeTime=e.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var r={};this.transmuxPipeline_=r;r.type="aac";r.metadataStream=new u.MetadataStream;r.aacStream=new f;r.audioTimestampRolloverStream=new u.TimestampRolloverStream("audio");r.timedMetadataTimestampRolloverStream=new u.TimestampRolloverStream("timed-metadata");r.adtsStream=new l;r.coalesceStream=new y(e,r.metadataStream);r.headOfPipeline=r.aacStream;r.aacStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream);r.aacStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream);r.metadataStream.on("timestamp",(function(e){r.aacStream.setTimestamp(e.timeStamp)}));r.aacStream.on("data",(function(i){if(i.type==="timed-metadata"&&!r.audioSegmentStream){n=n||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"};r.coalesceStream.numberOfTracks++;r.audioSegmentStream=new m(n,e);r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)}}));r.coalesceStream.on("data",this.trigger.bind(this,"data"));r.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r;r.type="ts";r.metadataStream=new u.MetadataStream;r.packetStream=new u.TransportPacketStream;r.parseStream=new u.TransportParseStream;r.elementaryStream=new u.ElementaryStream;r.videoTimestampRolloverStream=new u.TimestampRolloverStream("video");r.audioTimestampRolloverStream=new u.TimestampRolloverStream("audio");r.timedMetadataTimestampRolloverStream=new u.TimestampRolloverStream("timed-metadata");r.adtsStream=new l;r.h264Stream=new d;r.captionStream=new u.CaptionStream;r.coalesceStream=new y(e,r.metadataStream);r.headOfPipeline=r.packetStream;r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream);r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream);r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream);r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream);r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream);r.elementaryStream.on("data",(function(a){var s;if(a.type==="metadata"){s=a.tracks.length;while(s--){if(!i&&a.tracks[s].type==="video"){i=a.tracks[s];i.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}else if(!n&&a.tracks[s].type==="audio"){n=a.tracks[s];n.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}}if(i&&!r.videoSegmentStream){r.coalesceStream.numberOfTracks++;r.videoSegmentStream=new v(i,e);r.videoSegmentStream.on("timelineStartInfo",(function(e){if(n){n.timelineStartInfo=e;r.audioSegmentStream.setEarliestDts(e.dts)}}));r.videoSegmentStream.on("processedGopsInfo",t.trigger.bind(t,"gopInfo"));r.videoSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"videoSegmentTimingInfo"));r.videoSegmentStream.on("baseMediaDecodeTime",(function(e){if(n){r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}}));r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)}if(n&&!r.audioSegmentStream){r.coalesceStream.numberOfTracks++;r.audioSegmentStream=new m(n,e);r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)}}}));r.coalesceStream.on("data",this.trigger.bind(this,"data"));r.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(t){var r=this.transmuxPipeline_;if(!e.keepOriginalTimestamps){this.baseMediaDecodeTime=t}if(n){n.timelineStartInfo.dts=undefined;n.timelineStartInfo.pts=undefined;o.clearDtsInfo(n);if(!e.keepOriginalTimestamps){n.timelineStartInfo.baseMediaDecodeTime=t}if(r.audioTimestampRolloverStream){r.audioTimestampRolloverStream.discontinuity()}}if(i){if(r.videoSegmentStream){r.videoSegmentStream.gopCache_=[];r.videoTimestampRolloverStream.discontinuity()}i.timelineStartInfo.dts=undefined;i.timelineStartInfo.pts=undefined;o.clearDtsInfo(i);r.captionStream.reset();if(!e.keepOriginalTimestamps){i.timelineStartInfo.baseMediaDecodeTime=t}}if(r.timedMetadataTimestampRolloverStream){r.timedMetadataTimestampRolloverStream.discontinuity()}};this.setAudioAppendStart=function(e){if(n){this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)}};this.alignGopsWith=function(e){if(i&&this.transmuxPipeline_.videoSegmentStream){this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)}};this.push=function(e){if(r){var t=c(e);if(t&&this.transmuxPipeline_.type!=="aac"){this.setupAacPipeline()}else if(!t&&this.transmuxPipeline_.type!=="ts"){this.setupTsPipeline()}r=false}this.transmuxPipeline_.headOfPipeline.push(e)};this.flush=function(){r=true;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){if(this.transmuxPipeline_.captionStream){this.transmuxPipeline_.captionStream.reset()}}};g.prototype=new i;e.exports={Transmuxer:g,VideoSegmentStream:v,AudioSegmentStream:m,AUDIO_PROPERTIES:h,VIDEO_PROPERTIES:p,generateVideoSegmentTimingInfo:b}},"./node_modules/mux.js/lib/tools/caption-packet-parser.js":function(e,t,r){"use strict";var i=4,n=128;var a=function(e){var t=0,r={payloadType:-1,payloadSize:0},a=0,s=0;while(t<e.byteLength){if(e[t]===n){break}while(e[t]===255){a+=255;t++}a+=e[t++];while(e[t]===255){s+=255;t++}s+=e[t++];if(!r.payload&&a===i){r.payloadType=a;r.payloadSize=s;r.payload=e.subarray(t,t+s);break}t+=s;a=0;s=0}return r};var s=function(e){if(e.payload[0]!==181){return null}if((e.payload[1]<<8|e.payload[2])!==49){return null}if(String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])!=="GA94"){return null}if(e.payload[7]!==3){return null}return e.payload.subarray(8,e.payload.length-1)};var o=function(e,t){var r=[],i,n,a,s;if(!(t[0]&64)){return r}n=t[0]&31;for(i=0;i<n;i++){a=i*3;s={type:t[a+2]&3,pts:e};if(t[a+2]&4){s.ccData=t[a+3]<<8|t[a+4];r.push(s)}}return r};var u=function(e){var t=e.byteLength,r=[],i=1,n,a;while(i<t-2){if(e[i]===0&&e[i+1]===0&&e[i+2]===3){r.push(i+2);i+=2}else{i++}}if(r.length===0){return e}n=t-r.length;a=new Uint8Array(n);var s=0;for(i=0;i<n;s++,i++){if(s===r[0]){s++;r.shift()}a[i]=e[s]}return a};e.exports={parseSei:a,parseUserData:s,parseCaptionPackets:o,discardEmulationPreventionBytes:u,USER_DATA_REGISTERED_ITU_T_T35:i}},"./node_modules/mux.js/lib/tools/mp4-inspector.js":function(e,t,r){"use strict";var i,n,a=r("./node_modules/mux.js/lib/mp4/probe.js").parseType,s=function(e){return new Date(e*1e3-20828448e5)},o=function(e){return{isLeading:(e[0]&12)>>>2,dependsOn:e[0]&3,isDependedOn:(e[1]&192)>>>6,hasRedundancy:(e[1]&48)>>>4,paddingValue:(e[1]&14)>>>1,isNonSyncSample:e[1]&1,degradationPriority:e[2]<<8|e[3]}},u=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[],i,n;for(i=0;i+4<e.length;i+=n){n=t.getUint32(i);i+=4;if(n<=0){r.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(e[i]&31){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[i]&31);break}}return r},l={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:i(e.subarray(78,e.byteLength))}},avcC:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:e[4]&3,sps:[],pps:[]},i=e[5]&31,n,a,s,o;s=6;for(o=0;o<i;o++){a=t.getUint16(s);s+=2;r.sps.push(new Uint8Array(e.subarray(s,s+a)));s+=a}n=e[s];s++;for(o=0;o<n;o++){a=t.getUint16(s);s+=2;r.pps.push(new Uint8Array(e.subarray(s,s+a)));s+=a}return r},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:e[8]&31,decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(e[26]&7)<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={majorBrand:a(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;while(i<e.byteLength){r.compatibleBrands.push(a(e.subarray(i,i+4)));i+=4}return r},dinf:function(e){return{boxes:i(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:i(e.subarray(8))}},hdlr:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:a(e.subarray(8,12)),name:""},i=8;for(i=24;i<e.byteLength;i++){if(e[i]===0){i++;break}r.name+=String.fromCharCode(e[i])}r.name=decodeURIComponent(escape(r.name));return r},mdat:function(e){return{byteLength:e.byteLength,nals:u(e)}},mdhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,i,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};if(n.version===1){r+=4;n.creationTime=s(t.getUint32(r));r+=8;n.modificationTime=s(t.getUint32(r));r+=4;n.timescale=t.getUint32(r);r+=8;n.duration=t.getUint32(r)}else{n.creationTime=s(t.getUint32(r));r+=4;n.modificationTime=s(t.getUint32(r));r+=4;n.timescale=t.getUint32(r);r+=4;n.duration=t.getUint32(r)}r+=4;i=t.getUint16(r);n.language+=String.fromCharCode((i>>10)+96);n.language+=String.fromCharCode(((i&992)>>5)+96);n.language+=String.fromCharCode((i&31)+96);return n},mdia:function(e){return{boxes:i(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:i(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};if(e.byteLength>28){r.streamDescriptor=i(e.subarray(28))[0]}return r},moof:function(e){return{boxes:i(e)}},moov:function(e){return{boxes:i(e)}},mvex:function(e){return{boxes:i(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(i.version===1){r+=4;i.creationTime=s(t.getUint32(r));r+=8;i.modificationTime=s(t.getUint32(r));r+=4;i.timescale=t.getUint32(r);r+=8;i.duration=t.getUint32(r)}else{i.creationTime=s(t.getUint32(r));r+=4;i.modificationTime=s(t.getUint32(r));r+=4;i.timescale=t.getUint32(r);r+=4;i.duration=t.getUint32(r)}r+=4;i.rate=t.getUint16(r)+t.getUint16(r+2)/16;r+=4;i.volume=t.getUint8(r)+t.getUint8(r+1)/8;r+=2;r+=2;r+=2*4;i.matrix=new Uint32Array(e.subarray(r,r+9*4));r+=9*4;r+=6*4;i.nextTrackId=t.getUint32(r);return i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r;for(r=4;r<e.byteLength;r++){t.samples.push({dependsOn:(e[r]&48)>>4,isDependedOn:(e[r]&12)>>2,hasRedundancy:e[r]&3})}return t},sidx:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8),earliestPresentationTime:t.getUint32(12),firstOffset:t.getUint32(16)},i=t.getUint16(22),n;for(n=24;i;n+=12,i--){r.references.push({referenceType:(e[n]&128)>>>7,referencedSize:t.getUint32(n)&2147483647,subsegmentDuration:t.getUint32(n+4),startsWithSap:!!(e[n+8]&128),sapType:(e[n+8]&112)>>>4,sapDeltaTime:t.getUint32(n+8)&268435455})}return r},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:i(e)}},stco:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},i=t.getUint32(4),n;for(n=8;i;n+=4,i--){r.chunkOffsets.push(t.getUint32(n))}return r},stsc:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=t.getUint32(4),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]},n;for(n=8;r;n+=12,r--){i.sampleToChunks.push({firstChunk:t.getUint32(n),samplesPerChunk:t.getUint32(n+4),sampleDescriptionIndex:t.getUint32(n+8)})}return i},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:i(e.subarray(8))}},stsz:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:t.getUint32(4),entries:[]},i;for(i=12;i<e.byteLength;i+=4){r.entries.push(t.getUint32(i))}return r},stts:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},i=t.getUint32(4),n;for(n=8;i;n+=8,i--){r.timeToSamples.push({sampleCount:t.getUint32(n),sampleDelta:t.getUint32(n+4)})}return r},styp:function(e){return l.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};if(t.version===1){t.baseMediaDecodeTime*=Math.pow(2,32);t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]}return t},tfhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4)},i=r.flags[2]&1,n=r.flags[2]&2,a=r.flags[2]&8,s=r.flags[2]&16,o=r.flags[2]&32,u=r.flags[0]&65536,l=r.flags[0]&131072,d;d=8;if(i){d+=4;r.baseDataOffset=t.getUint32(12);d+=4}if(n){r.sampleDescriptionIndex=t.getUint32(d);d+=4}if(a){r.defaultSampleDuration=t.getUint32(d);d+=4}if(s){r.defaultSampleSize=t.getUint32(d);d+=4}if(o){r.defaultSampleFlags=t.getUint32(d)}if(u){r.durationIsEmpty=true}if(!i&&l){r.baseDataOffsetIsMoof=true}return r},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};if(i.version===1){r+=4;i.creationTime=s(t.getUint32(r));r+=8;i.modificationTime=s(t.getUint32(r));r+=4;i.trackId=t.getUint32(r);r+=4;r+=8;i.duration=t.getUint32(r)}else{i.creationTime=s(t.getUint32(r));r+=4;i.modificationTime=s(t.getUint32(r));r+=4;i.trackId=t.getUint32(r);r+=4;r+=4;i.duration=t.getUint32(r)}r+=4;r+=2*4;i.layer=t.getUint16(r);r+=2;i.alternateGroup=t.getUint16(r);r+=2;i.volume=t.getUint8(r)+t.getUint8(r+1)/8;r+=2;r+=2;i.matrix=new Uint32Array(e.subarray(r,r+9*4));r+=9*4;i.width=t.getUint16(r)+t.getUint16(r+2)/16;r+=4;i.height=t.getUint16(r)+t.getUint16(r+2)/16;return i},traf:function(e){return{boxes:i(e)}},trak:function(e){return{boxes:i(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:e[20]&3,sampleIsDependedOn:(e[21]&192)>>6,sampleHasRedundancy:(e[21]&48)>>4,samplePaddingValue:(e[21]&14)>>1,sampleIsDifferenceSample:!!(e[21]&1),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=t.flags[2]&1,n=t.flags[2]&4,a=t.flags[1]&1,s=t.flags[1]&2,u=t.flags[1]&4,l=t.flags[1]&8,d=r.getUint32(4),f=8,c;if(i){t.dataOffset=r.getInt32(f);f+=4}if(n&&d){c={flags:o(e.subarray(f,f+4))};f+=4;if(a){c.duration=r.getUint32(f);f+=4}if(s){c.size=r.getUint32(f);f+=4}if(l){c.compositionTimeOffset=r.getUint32(f);f+=4}t.samples.push(c);d--}while(d--){c={};if(a){c.duration=r.getUint32(f);f+=4}if(s){c.size=r.getUint32(f);f+=4}if(u){c.flags=o(e.subarray(f,f+4));f+=4}if(l){c.compositionTimeOffset=r.getUint32(f);f+=4}t.samples.push(c)}return t},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};i=function(e){var t=0,r=[],i,n,s,o,u;var d=new ArrayBuffer(e.length);var f=new Uint8Array(d);for(var c=0;c<e.length;++c){f[c]=e[c]}i=new DataView(d);while(t<e.byteLength){n=i.getUint32(t);s=a(e.subarray(t+4,t+8));o=n>1?t+n:e.byteLength;u=(l[s]||function(e){return{data:e}})(e.subarray(t+8,o));u.size=n;u.type=s;r.push(u);t=o}return r};n=function(e,t){var r;t=t||0;r=new Array(t*2+1).join(" ");return e.map((function(e,i){return r+e.type+"\n"+Object.keys(e).filter((function(e){return e!=="type"&&e!=="boxes"})).map((function(t){var i=r+"  "+t+": ",n=e[t];if(n instanceof Uint8Array||n instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);if(!a){return i+"<>"}if(a.length===1){return i+"<"+a.join("").slice(1)+">"}return i+"<\n"+a.map((function(e){return r+"  "+e})).join("\n")+"\n"+r+"  >"}return i+JSON.stringify(n,null,2).split("\n").map((function(e,t){if(t===0){return e}return r+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+n(e.boxes,t+1):"")})).join("\n")};e.exports={inspect:i,textify:n,parseTfdt:l.tfdt,parseHdlr:l.hdlr,parseTfhd:l.tfhd,parseTrun:l.trun,parseSidx:l.sidx}},"./node_modules/mux.js/lib/tools/ts-inspector.js":function(e,t,r){"use strict";var i=r("./node_modules/mux.js/lib/m2ts/stream-types.js");var n=r("./node_modules/mux.js/lib/m2ts/timestamp-rollover-stream.js").handleRollover;var a={};a.ts=r("./node_modules/mux.js/lib/m2ts/probe.js");a.aac=r("./node_modules/mux.js/lib/aac/utils.js");var s=9e4,o=188,u=71;var l=function(e,t){var r=0,i=o,n,s;while(i<e.byteLength){if(e[r]===u&&e[i]===u){n=e.subarray(r,i);s=a.ts.parseType(n,t.pid);switch(s){case"pat":if(!t.pid){t.pid=a.ts.parsePat(n)}break;case"pmt":if(!t.table){t.table=a.ts.parsePmt(n)}break;default:break}if(t.pid&&t.table){return}r+=o;i+=o;continue}r++;i++}};var d=function(e,t,r){var i=0,n=o,s,l,d,f,c;var h=false;while(n<=e.byteLength){if(e[i]===u&&(e[n]===u||n===e.byteLength)){s=e.subarray(i,n);l=a.ts.parseType(s,t.pid);switch(l){case"pes":d=a.ts.parsePesType(s,t.table);f=a.ts.parsePayloadUnitStartIndicator(s);if(d==="audio"&&f){c=a.ts.parsePesTime(s);if(c){c.type="audio";r.audio.push(c);h=true}}break;default:break}if(h){break}i+=o;n+=o;continue}i++;n++}n=e.byteLength;i=n-o;h=false;while(i>=0){if(e[i]===u&&(e[n]===u||n===e.byteLength)){s=e.subarray(i,n);l=a.ts.parseType(s,t.pid);switch(l){case"pes":d=a.ts.parsePesType(s,t.table);f=a.ts.parsePayloadUnitStartIndicator(s);if(d==="audio"&&f){c=a.ts.parsePesTime(s);if(c){c.type="audio";r.audio.push(c);h=true}}break;default:break}if(h){break}i-=o;n-=o;continue}i--;n--}};var f=function(e,t,r){var i=0,n=o,s,l,d,f,c,h,p,v;var m=false;var g={data:[],size:0};while(n<e.byteLength){if(e[i]===u&&e[n]===u){s=e.subarray(i,n);l=a.ts.parseType(s,t.pid);switch(l){case"pes":d=a.ts.parsePesType(s,t.table);f=a.ts.parsePayloadUnitStartIndicator(s);if(d==="video"){if(f&&!m){c=a.ts.parsePesTime(s);if(c){c.type="video";r.video.push(c);m=true}}if(!r.firstKeyFrame){if(f){if(g.size!==0){h=new Uint8Array(g.size);p=0;while(g.data.length){v=g.data.shift();h.set(v,p);p+=v.byteLength}if(a.ts.videoPacketContainsKeyFrame(h)){r.firstKeyFrame=a.ts.parsePesTime(h);r.firstKeyFrame.type="video"}g.size=0}}g.data.push(s);g.size+=s.byteLength}}break;default:break}if(m&&r.firstKeyFrame){break}i+=o;n+=o;continue}i++;n++}n=e.byteLength;i=n-o;m=false;while(i>=0){if(e[i]===u&&e[n]===u){s=e.subarray(i,n);l=a.ts.parseType(s,t.pid);switch(l){case"pes":d=a.ts.parsePesType(s,t.table);f=a.ts.parsePayloadUnitStartIndicator(s);if(d==="video"&&f){c=a.ts.parsePesTime(s);if(c){c.type="video";r.video.push(c);m=true}}break;default:break}if(m){break}i-=o;n-=o;continue}i--;n--}};var c=function(e,t){if(e.audio&&e.audio.length){var r=t;if(typeof r==="undefined"){r=e.audio[0].dts}e.audio.forEach((function(e){e.dts=n(e.dts,r);e.pts=n(e.pts,r);e.dtsTime=e.dts/s;e.ptsTime=e.pts/s}))}if(e.video&&e.video.length){var i=t;if(typeof i==="undefined"){i=e.video[0].dts}e.video.forEach((function(e){e.dts=n(e.dts,i);e.pts=n(e.pts,i);e.dtsTime=e.dts/s;e.ptsTime=e.pts/s}));if(e.firstKeyFrame){var a=e.firstKeyFrame;a.dts=n(a.dts,i);a.pts=n(a.pts,i);a.dtsTime=a.dts/s;a.ptsTime=a.dts/s}}};var h=function(e){var t=false,r=0,i=null,n=null,o=0,u=0,l;while(e.length-u>=3){var d=a.aac.parseType(e,u);switch(d){case"timed-metadata":if(e.length-u<10){t=true;break}o=a.aac.parseId3TagSize(e,u);if(o>e.length){t=true;break}if(n===null){l=e.subarray(u,u+o);n=a.aac.parseAacTimestamp(l)}u+=o;break;case"audio":if(e.length-u<7){t=true;break}o=a.aac.parseAdtsSize(e,u);if(o>e.length){t=true;break}if(i===null){l=e.subarray(u,u+o);i=a.aac.parseSampleRate(l)}r++;u+=o;break;default:u++;break}if(t){return null}}if(i===null||n===null){return null}var f=s/i;var c={audio:[{type:"audio",dts:n,pts:n},{type:"audio",dts:n+r*1024*f,pts:n+r*1024*f}]};return c};var p=function(e){var t={pid:null,table:null};var r={};l(e,t);for(var n in t.table){if(t.table.hasOwnProperty(n)){var a=t.table[n];switch(a){case i.H264_STREAM_TYPE:r.video=[];f(e,t,r);if(r.video.length===0){delete r.video}break;case i.ADTS_STREAM_TYPE:r.audio=[];d(e,t,r);if(r.audio.length===0){delete r.audio}break;default:break}}}return r};var v=function(e,t){var r=a.aac.isLikelyAacData(e);var i;if(r){i=h(e)}else{i=p(e)}if(!i||!i.audio&&!i.video){return null}c(i,t);return i};e.exports={inspect:v,parseAudioPes_:d}},"./node_modules/mux.js/lib/utils/bin.js":function(e,t){var r=function(e){return e>>>0};e.exports={toUnsigned:r}},"./node_modules/mux.js/lib/utils/clock.js":function(e,t){var r=9e4,i,n,a,s,o,u;i=function(e){return e*r};n=function(e,t){return e*t};a=function(e){return e/r};s=function(e,t){return e/t};o=function(e,t){return i(s(e,t))};u=function(e,t){return n(a(e),t)};e.exports={secondsToVideoTs:i,secondsToAudioTs:n,videoTsToSeconds:a,audioTsToSeconds:s,audioTsToVideoTs:o,videoTsToAudioTs:u}},"./node_modules/mux.js/lib/utils/exp-golomb.js":function(e,t,r){"use strict";var i;i=function(e){var t=e.byteLength,r=0,i=0;this.length=function(){return 8*t};this.bitsAvailable=function(){return 8*t+i};this.loadWord=function(){var n=e.byteLength-t,a=new Uint8Array(4),s=Math.min(4,t);if(s===0){throw new Error("no bytes available")}a.set(e.subarray(n,n+s));r=new DataView(a.buffer).getUint32(0);i=s*8;t-=s};this.skipBits=function(e){var n;if(i>e){r<<=e;i-=e}else{e-=i;n=Math.floor(e/8);e-=n*8;t-=n;this.loadWord();r<<=e;i-=e}};this.readBits=function(e){var n=Math.min(i,e),a=r>>>32-n;i-=n;if(i>0){r<<=n}else if(t>0){this.loadWord()}n=e-n;if(n>0){return a<<n|this.readBits(n)}return a};this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e){if((r&2147483648>>>e)!==0){r<<=e;i-=e;return e}}this.loadWord();return e+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1};this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();if(1&e){return 1+e>>>1}return-1*(e>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};e.exports=i},"./node_modules/mux.js/lib/utils/stream.js":function(e,t,r){"use strict";var i=function(){this.init=function(){var e={};this.on=function(t,r){if(!e[t]){e[t]=[]}e[t]=e[t].concat(r)};this.off=function(t,r){var i;if(!e[t]){return false}i=e[t].indexOf(r);e[t]=e[t].slice();e[t].splice(i,1);return i>-1};this.trigger=function(t){var r,i,n,a;r=e[t];if(!r){return}if(arguments.length===2){n=r.length;for(i=0;i<n;++i){r[i].call(this,arguments[1])}}else{a=[];i=arguments.length;for(i=1;i<arguments.length;++i){a.push(arguments[i])}n=r.length;for(i=0;i<n;++i){r[i].apply(this,a)}}};this.dispose=function(){e={}}}};i.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}));this.on("done",(function(t){e.flush(t)}));return e};i.prototype.push=function(e){this.trigger("data",e)};i.prototype.flush=function(e){this.trigger("done",e)};e.exports=i},"./node_modules/video.js/dist/video.cjs.js":function(e,t,r){function i(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var n=i(r("./node_modules/global/window.js"));var a=i(r("./node_modules/global/document.js"));var s=i(r("./node_modules/tsml/tsml.js"));var o=i(r("./node_modules/safe-json-parse/tuple.js"));var u=i(r("./node_modules/xhr/index.js"));var l=i(r("./node_modules/videojs-vtt.js/lib/browser-index.js"));var d="6.12.1";var f=n.navigator&&n.navigator.userAgent||"";var c=/AppleWebKit\/([\d.]+)/i.exec(f);var h=c?parseFloat(c.pop()):null;var p=/iPad/i.test(f);var v=/iPhone/i.test(f)&&!p;var m=/iPod/i.test(f);var g=v||p||m;var y=function(){var e=f.match(/OS (\d+)_/i);if(e&&e[1]){return e[1]}return null}();var _=/Android/i.test(f);var b=function(){var e=f.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e){return null}var t=e[1]&&parseFloat(e[1]);var r=e[2]&&parseFloat(e[2]);if(t&&r){return parseFloat(e[1]+"."+e[2])}else if(t){return t}return null}();var T=_&&/webkit/i.test(f)&&b<2.3;var S=_&&b<5&&h<537;var E=/Firefox/i.test(f);var w=/Edge/i.test(f);var k=!w&&(/Chrome/i.test(f)||/CriOS/i.test(f));var A=function(){var e=f.match(/(Chrome|CriOS)\/(\d+)/);if(e&&e[2]){return parseFloat(e[2])}return null}();var C=/MSIE\s8\.0/.test(f);var L=function(){var e=/MSIE\s(\d+)\.\d/.exec(f);var t=e&&parseFloat(e[1]);if(!t&&/Trident\/7.0/i.test(f)&&/rv:11.0/.test(f)){t=11}return t}();var x=/Safari/i.test(f)&&!k&&!_&&!w;var D=(x||g)&&!k;var I=re()&&("ontouchstart"in n||n.navigator.maxTouchPoints||n.DocumentTouch&&n.document instanceof n.DocumentTouch);var O=re()&&"backgroundSize"in n.document.createElement("video").style;var R=(Object.freeze||Object)({IS_IPAD:p,IS_IPHONE:v,IS_IPOD:m,IS_IOS:g,IOS_VERSION:y,IS_ANDROID:_,ANDROID_VERSION:b,IS_OLD_ANDROID:T,IS_NATIVE_ANDROID:S,IS_FIREFOX:E,IS_EDGE:w,IS_CHROME:k,CHROME_VERSION:A,IS_IE8:C,IE_VERSION:L,IS_SAFARI:x,IS_ANY_SAFARI:D,TOUCH_ENABLED:I,BACKGROUND_SIZE_SUPPORTED:O});var P=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var U=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var M=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var N=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var j=function(e,t){e.raw=t;return e};var B=Object.prototype.toString;var F=function e(t){return V(t)?Object.keys(t):[]};function H(e,t){F(e).forEach((function(r){return t(e[r],r)}))}function q(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;return F(e).reduce((function(r,i){return t(r,e[i],i)}),r)}function G(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}if(Object.assign){return Object.assign.apply(Object,[e].concat(r))}r.forEach((function(t){if(!t){return}H(t,(function(t,r){e[r]=t}))}));return e}function V(e){return!!e&&(typeof e==="undefined"?"undefined":P(e))==="object"}function W(e){return V(e)&&B.call(e)==="[object Object]"&&e.constructor===Object}var z=void 0;var K="info";var Y=[];var X=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!!L&&L<11;var a=z.levels[K];var s=new RegExp("^("+a+")$");if(t!=="log"){r.unshift(t.toUpperCase()+":")}if(Y){Y.push([].concat(r))}r.unshift("VIDEOJS:");if(!n.console){return}var o=n.console[t];if(!o&&t==="debug"){o=n.console.info||n.console.log}if(!o||!a||!s.test(t)){return}if(i){r=r.map((function(e){if(V(e)||Array.isArray(e)){try{return JSON.stringify(e)}catch(t){return String(e)}}return String(e)})).join(" ")}if(!o.apply){o(r)}else{o[Array.isArray(r)?"apply":"call"](n.console,r)}};z=function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}X("log",r)};z.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:K};z.level=function(e){if(typeof e==="string"){if(!z.levels.hasOwnProperty(e)){throw new Error('"'+e+'" in not a valid log level')}K=e}return K};z.history=function(){return Y?[].concat(Y):[]};z.history.clear=function(){if(Y){Y.length=0}};z.history.disable=function(){if(Y!==null){Y.length=0;Y=null}};z.history.enable=function(){if(Y===null){Y=[]}};z.error=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}return X("error",t)};z.warn=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}return X("warn",t)};z.debug=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}return X("debug",t)};var J=z;function Q(e,t){if(!e||!t){return""}if(typeof n.getComputedStyle==="function"){var r=n.getComputedStyle(e);return r?r[t]:""}return e.currentStyle[t]||""}var $=j(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);function Z(e){return typeof e==="string"&&/\S/.test(e)}function ee(e){if(/\s/.test(e)){throw new Error("class has illegal whitespace characters")}}function te(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}function re(){return a===n.document&&typeof a.createElement!=="undefined"}function ie(e){return V(e)&&e.nodeType===1}function ne(){try{return n.parent!==n.self}catch(e){return true}}function ae(e){return function(t,r){if(!Z(t)){return a[e](null)}if(Z(r)){r=a.querySelector(r)}var i=ie(r)?r:a;return i[e]&&i[e](t)}}function se(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"div";var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=arguments[3];var n=a.createElement(e);Object.getOwnPropertyNames(t).forEach((function(e){var r=t[e];if(e.indexOf("aria-")!==-1||e==="role"||e==="type"){J.warn(s($,e,r));n.setAttribute(e,r)}else if(e==="textContent"){oe(n,r)}else{n[e]=r}}));Object.getOwnPropertyNames(r).forEach((function(e){n.setAttribute(e,r[e])}));if(i){Ae(n,i)}return n}function oe(e,t){if(typeof e.textContent==="undefined"){e.innerText=t}else{e.textContent=t}return e}function ue(e,t){if(t.firstChild){t.insertBefore(e,t.firstChild)}else{t.appendChild(e)}}function le(e,t){ee(t);if(e.classList){return e.classList.contains(t)}return te(t).test(e.className)}function de(e,t){if(e.classList){e.classList.add(t)}else if(!le(e,t)){e.className=(e.className+" "+t).trim()}return e}function fe(e,t){if(e.classList){e.classList.remove(t)}else{ee(t);e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")}return e}function ce(e,t,r){var i=le(e,t);if(typeof r==="function"){r=r(e,t)}if(typeof r!=="boolean"){r=!i}if(r===i){return}if(r){de(e,t)}else{fe(e,t)}return e}function he(e,t){Object.getOwnPropertyNames(t).forEach((function(r){var i=t[r];if(i===null||typeof i==="undefined"||i===false){e.removeAttribute(r)}else{e.setAttribute(r,i===true?"":i)}}))}function pe(e){var t={};var r=","+"autoplay,controls,playsinline,loop,muted,default,defaultMuted"+",";if(e&&e.attributes&&e.attributes.length>0){var i=e.attributes;for(var n=i.length-1;n>=0;n--){var a=i[n].name;var s=i[n].value;if(typeof e[a]==="boolean"||r.indexOf(","+a+",")!==-1){s=s!==null?true:false}t[a]=s}}return t}function ve(e,t){return e.getAttribute(t)}function me(e,t,r){e.setAttribute(t,r)}function ge(e,t){e.removeAttribute(t)}function ye(){a.body.focus();a.onselectstart=function(){return false}}function _e(){a.onselectstart=function(){return true}}function be(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect();var r={};["bottom","height","left","right","top","width"].forEach((function(e){if(t[e]!==undefined){r[e]=t[e]}}));if(!r.height){r.height=parseFloat(Q(e,"height"))}if(!r.width){r.width=parseFloat(Q(e,"width"))}return r}}function Te(e){var t=void 0;if(e.getBoundingClientRect&&e.parentNode){t=e.getBoundingClientRect()}if(!t){return{left:0,top:0}}var r=a.documentElement;var i=a.body;var s=r.clientLeft||i.clientLeft||0;var o=n.pageXOffset||i.scrollLeft;var u=t.left+o-s;var l=r.clientTop||i.clientTop||0;var d=n.pageYOffset||i.scrollTop;var f=t.top+d-l;return{left:Math.round(u),top:Math.round(f)}}function Se(e,t){var r={};var i=Te(e);var n=e.offsetWidth;var a=e.offsetHeight;var s=i.top;var o=i.left;var u=t.pageY;var l=t.pageX;if(t.changedTouches){l=t.changedTouches[0].pageX;u=t.changedTouches[0].pageY}r.y=Math.max(0,Math.min(1,(s-u+a)/a));r.x=Math.max(0,Math.min(1,(l-o)/n));return r}function Ee(e){return V(e)&&e.nodeType===3}function we(e){while(e.firstChild){e.removeChild(e.firstChild)}return e}function ke(e){if(typeof e==="function"){e=e()}return(Array.isArray(e)?e:[e]).map((function(e){if(typeof e==="function"){e=e()}if(ie(e)||Ee(e)){return e}if(typeof e==="string"&&/\S/.test(e)){return a.createTextNode(e)}})).filter((function(e){return e}))}function Ae(e,t){ke(t).forEach((function(t){return e.appendChild(t)}));return e}function Ce(e,t){return Ae(we(e),t)}function Le(e){if(e.button===undefined&&e.buttons===undefined){return true}if(e.button===0&&e.buttons===undefined){return true}if(L===9){return true}if(e.button!==0||e.buttons!==1){return false}return true}var xe=ae("querySelector");var De=ae("querySelectorAll");var Ie=(Object.freeze||Object)({isReal:re,isEl:ie,isInFrame:ne,createEl:se,textContent:oe,prependTo:ue,hasClass:le,addClass:de,removeClass:fe,toggleClass:ce,setAttributes:he,getAttributes:pe,getAttribute:ve,setAttribute:me,removeAttribute:ge,blockTextSelection:ye,unblockTextSelection:_e,getBoundingClientRect:be,findPosition:Te,getPointerPosition:Se,isTextNode:Ee,emptyEl:we,normalizeContent:ke,appendContent:Ae,insertContent:Ce,isSingleLeftClick:Le,$:xe,$$:De});var Oe=1;function Re(){return Oe++}var Pe={};var Ue="vdata"+(new Date).getTime();function Me(e){var t=e[Ue];if(!t){t=e[Ue]=Re()}if(!Pe[t]){Pe[t]={}}return Pe[t]}function Ne(e){var t=e[Ue];if(!t){return false}return!!Object.getOwnPropertyNames(Pe[t]).length}function je(e){var t=e[Ue];if(!t){return}delete Pe[t];try{delete e[Ue]}catch(t){if(e.removeAttribute){e.removeAttribute(Ue)}else{e[Ue]=null}}}function Be(e,t){var r=Me(e);if(r.handlers[t].length===0){delete r.handlers[t];if(e.removeEventListener){e.removeEventListener(t,r.dispatcher,false)}else if(e.detachEvent){e.detachEvent("on"+t,r.dispatcher)}}if(Object.getOwnPropertyNames(r.handlers).length<=0){delete r.handlers;delete r.dispatcher;delete r.disabled}if(Object.getOwnPropertyNames(r).length===0){je(e)}}function Fe(e,t,r,i){r.forEach((function(r){e(t,r,i)}))}function He(e){function t(){return true}function r(){return false}if(!e||!e.isPropagationStopped){var i=e||n.event;e={};for(var s in i){if(s!=="layerX"&&s!=="layerY"&&s!=="keyLocation"&&s!=="webkitMovementX"&&s!=="webkitMovementY"){if(!(s==="returnValue"&&i.preventDefault)){e[s]=i[s]}}}if(!e.target){e.target=e.srcElement||a}if(!e.relatedTarget){e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement}e.preventDefault=function(){if(i.preventDefault){i.preventDefault()}e.returnValue=false;i.returnValue=false;e.defaultPrevented=true};e.defaultPrevented=false;e.stopPropagation=function(){if(i.stopPropagation){i.stopPropagation()}e.cancelBubble=true;i.cancelBubble=true;e.isPropagationStopped=t};e.isPropagationStopped=r;e.stopImmediatePropagation=function(){if(i.stopImmediatePropagation){i.stopImmediatePropagation()}e.isImmediatePropagationStopped=t;e.stopPropagation()};e.isImmediatePropagationStopped=r;if(e.clientX!==null&&e.clientX!==undefined){var o=a.documentElement;var u=a.body;e.pageX=e.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0);e.pageY=e.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}e.which=e.charCode||e.keyCode;if(e.button!==null&&e.button!==undefined){e.button=e.button&1?0:e.button&4?1:e.button&2?2:0}}return e}var qe=false;(function(){try{var e=Object.defineProperty({},"passive",{get:function e(){qe=true}});n.addEventListener("test",null,e);n.removeEventListener("test",null,e)}catch(e){}})();var Ge=["touchstart","touchmove"];function Ve(e,t,r){if(Array.isArray(t)){return Fe(Ve,e,t,r)}var i=Me(e);if(!i.handlers){i.handlers={}}if(!i.handlers[t]){i.handlers[t]=[]}if(!r.guid){r.guid=Re()}i.handlers[t].push(r);if(!i.dispatcher){i.disabled=false;i.dispatcher=function(t,r){if(i.disabled){return}t=He(t);var n=i.handlers[t.type];if(n){var a=n.slice(0);for(var s=0,o=a.length;s<o;s++){if(t.isImmediatePropagationStopped()){break}else{try{a[s].call(e,t,r)}catch(e){J.error(e)}}}}}}if(i.handlers[t].length===1){if(e.addEventListener){var n=false;if(qe&&Ge.indexOf(t)>-1){n={passive:true}}e.addEventListener(t,i.dispatcher,n)}else if(e.attachEvent){e.attachEvent("on"+t,i.dispatcher)}}}function We(e,t,r){if(!Ne(e)){return}var i=Me(e);if(!i.handlers){return}if(Array.isArray(t)){return Fe(We,e,t,r)}var n=function e(t,r){i.handlers[r]=[];Be(t,r)};if(t===undefined){for(var a in i.handlers){if(Object.prototype.hasOwnProperty.call(i.handlers||{},a)){n(e,a)}}return}var s=i.handlers[t];if(!s){return}if(!r){n(e,t);return}if(r.guid){for(var o=0;o<s.length;o++){if(s[o].guid===r.guid){s.splice(o--,1)}}}Be(e,t)}function ze(e,t,r){var i=Ne(e)?Me(e):{};var n=e.parentNode||e.ownerDocument;if(typeof t==="string"){t={type:t,target:e}}else if(!t.target){t.target=e}t=He(t);if(i.dispatcher){i.dispatcher.call(e,t,r)}if(n&&!t.isPropagationStopped()&&t.bubbles===true){ze.call(null,n,t,r)}else if(!n&&!t.defaultPrevented){var a=Me(t.target);if(t.target[t.type]){a.disabled=true;if(typeof t.target[t.type]==="function"){t.target[t.type]()}a.disabled=false}}return!t.defaultPrevented}function Ke(e,t,r){if(Array.isArray(t)){return Fe(Ke,e,t,r)}var i=function i(){We(e,t,i);r.apply(this,arguments)};i.guid=r.guid=r.guid||Re();Ve(e,t,i)}var Ye=(Object.freeze||Object)({fixEvent:He,on:Ve,off:We,trigger:ze,one:Ke});var Xe=false;var Je=void 0;var Qe=function e(){if(!re()||Je.options.autoSetup===false){return}var t=a.getElementsByTagName("video");var r=a.getElementsByTagName("audio");var i=a.getElementsByTagName("video-js");var n=[];if(t&&t.length>0){for(var s=0,o=t.length;s<o;s++){n.push(t[s])}}if(r&&r.length>0){for(var u=0,l=r.length;u<l;u++){n.push(r[u])}}if(i&&i.length>0){for(var d=0,f=i.length;d<f;d++){n.push(i[d])}}if(n&&n.length>0){for(var c=0,h=n.length;c<h;c++){var p=n[c];if(p&&p.getAttribute){if(p.player===undefined){var v=p.getAttribute("data-setup");if(v!==null){Je(p)}}}else{$e(1);break}}}else if(!Xe){$e(1)}};function $e(e,t){if(t){Je=t}n.setTimeout(Qe,e)}if(re()&&a.readyState==="complete"){Xe=true}else{Ke(n,"load",(function(){Xe=true}))}var Ze=function e(t){var r=a.createElement("style");r.className=t;return r};var et=function e(t,r){if(t.styleSheet){t.styleSheet.cssText=r}else{t.textContent=r}};var tt=function e(t,r,i){if(!r.guid){r.guid=Re()}var n=function e(){return r.apply(t,arguments)};n.guid=i?i+"_"+r.guid:r.guid;return n};var rt=function e(t,r){var i=Date.now();var n=function e(){var n=Date.now();if(n-i>=r){t.apply(undefined,arguments);i=n}};return n};var it=function e(t,r,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:n;var s=void 0;return function(){var e=this;var n=arguments;var o=function r(){s=null;o=null;if(!i){t.apply(e,n)}};if(!s&&i){t.apply(e,n)}a.clearTimeout(s);s=a.setTimeout(o,r)}};var nt=function e(){};nt.prototype.allowedEvents_={};nt.prototype.on=function(e,t){var r=this.addEventListener;this.addEventListener=function(){};Ve(this,e,t);this.addEventListener=r};nt.prototype.addEventListener=nt.prototype.on;nt.prototype.off=function(e,t){We(this,e,t)};nt.prototype.removeEventListener=nt.prototype.off;nt.prototype.one=function(e,t){var r=this.addEventListener;this.addEventListener=function(){};Ke(this,e,t);this.addEventListener=r};nt.prototype.trigger=function(e){var t=e.type||e;if(typeof e==="string"){e={type:t}}e=He(e);if(this.allowedEvents_[t]&&this["on"+t]){this["on"+t](e)}ze(this,e)};nt.prototype.dispatchEvent=nt.prototype.trigger;var at=function e(t){return t instanceof nt||!!t.eventBusEl_&&["on","one","off","trigger"].every((function(e){return typeof t[e]==="function"}))};var st=function e(t){return typeof t==="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length};var ot=function e(t){if(!t.nodeName&&!at(t)){throw new Error("Invalid target; must be a DOM node or evented object.")}};var ut=function e(t){if(!st(t)){throw new Error("Invalid event type; must be a non-empty string or array.")}};var lt=function e(t){if(typeof t!=="function"){throw new Error("Invalid listener; must be a function.")}};var dt=function e(t,r){var i=r.length<3||r[0]===t||r[0]===t.eventBusEl_;var n=void 0;var a=void 0;var s=void 0;if(i){n=t.eventBusEl_;if(r.length>=3){r.shift()}a=r[0];s=r[1]}else{n=r[0];a=r[1];s=r[2]}ot(n);ut(a);lt(s);s=tt(t,s);return{isTargetingSelf:i,target:n,type:a,listener:s}};var ft=function e(t,r,i,n){ot(t);if(t.nodeName){Ye[r](t,i,n)}else{t[r](i,n)}};var ct={on:function e(){var t=this;for(var r=arguments.length,i=Array(r),n=0;n<r;n++){i[n]=arguments[n]}var a=dt(this,i),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;ft(o,"on",u,l);if(!s){var d=function e(){return t.off(o,u,l)};d.guid=l.guid;var f=function e(){return t.off("dispose",d)};f.guid=l.guid;ft(this,"on","dispose",d);ft(o,"on","dispose",f)}},one:function e(){var t=this;for(var r=arguments.length,i=Array(r),n=0;n<r;n++){i[n]=arguments[n]}var a=dt(this,i),s=a.isTargetingSelf,o=a.target,u=a.type,l=a.listener;if(s){ft(o,"one",u,l)}else{var d=function e(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++){i[n]=arguments[n]}t.off(o,u,e);l.apply(null,i)};d.guid=l.guid;ft(o,"one",u,d)}},off:function e(t,r,i){if(!t||st(t)){We(this.eventBusEl_,t,r)}else{var n=t;var a=r;ot(n);ut(a);lt(i);i=tt(this,i);this.off("dispose",i);if(n.nodeName){We(n,a,i);We(n,"dispose",i)}else if(at(n)){n.off(a,i);n.off("dispose",i)}}},trigger:function e(t,r){return ze(this.eventBusEl_,t,r)}};function ht(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=t.eventBusKey;if(r){if(!e[r].nodeName){throw new Error('The eventBusKey "'+r+'" does not refer to an element.')}e.eventBusEl_=e[r]}else{e.eventBusEl_=se("span",{className:"vjs-event-bus"})}G(e,ct);e.on("dispose",(function(){e.off();n.setTimeout((function(){e.eventBusEl_=null}),0)}));return e}var pt={state:{},setState:function e(t){var r=this;if(typeof t==="function"){t=t()}var i=void 0;H(t,(function(e,t){if(r.state[t]!==e){i=i||{};i[t]={from:r.state[t],to:e}}r.state[t]=e}));if(i&&at(this)){this.trigger({changes:i,type:"statechanged"})}return i}};function vt(e,t){G(e,pt);e.state=G({},e.state,t);if(typeof e.handleStateChanged==="function"&&at(e)){e.on("statechanged",e.handleStateChanged)}return e}function mt(e){if(typeof e!=="string"){return e}return e.charAt(0).toUpperCase()+e.slice(1)}function gt(e,t){return mt(e)===mt(t)}function yt(){var e={};for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}r.forEach((function(t){if(!t){return}H(t,(function(t,r){if(!W(t)){e[r]=t;return}if(!W(e[r])){e[r]={}}e[r]=yt(e[r],t)}))}));return e}var _t=function(){function e(t,r,i){U(this,e);if(!t&&this.play){this.player_=t=this}else{this.player_=t}this.options_=yt({},this.options_);r=this.options_=yt(this.options_,r);this.id_=r.id||r.el&&r.el.id;if(!this.id_){var n=t&&t.id&&t.id()||"no_player";this.id_=n+"_component_"+Re()}this.name_=r.name||null;if(r.el){this.el_=r.el}else if(r.createEl!==false){this.el_=this.createEl()}if(r.evented!==false){ht(this,{eventBusKey:this.el_?"el_":null})}vt(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};if(r.initChildren!==false){this.initChildren()}this.ready(i);if(r.reportTouchActivity!==false){this.enableTouchActivity()}}e.prototype.dispose=function e(){this.trigger({type:"dispose",bubbles:false});if(this.children_){for(var t=this.children_.length-1;t>=0;t--){if(this.children_[t].dispose){this.children_[t].dispose()}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;if(this.el_){if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_)}je(this.el_);this.el_=null}this.player_=null};e.prototype.player=function e(){return this.player_};e.prototype.options=function e(t){J.warn("this.options() has been deprecated and will be moved to the constructor in 6.0");if(!t){return this.options_}this.options_=yt(this.options_,t);return this.options_};e.prototype.el=function e(){return this.el_};e.prototype.createEl=function e(t,r,i){return se(t,r,i)};e.prototype.localize=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:t;var n=this.player_.language&&this.player_.language();var a=this.player_.languages&&this.player_.languages();var s=a&&a[n];var o=n&&n.split("-")[0];var u=a&&a[o];var l=i;if(s&&s[t]){l=s[t]}else if(u&&u[t]){l=u[t]}if(r){l=l.replace(/\{(\d+)\}/g,(function(e,t){var i=r[t-1];var n=i;if(typeof i==="undefined"){n=e}return n}))}return l};e.prototype.contentEl=function e(){return this.contentEl_||this.el_};e.prototype.id=function e(){return this.id_};e.prototype.name=function e(){return this.name_};e.prototype.children=function e(){return this.children_};e.prototype.getChildById=function e(t){return this.childIndex_[t]};e.prototype.getChild=function e(t){if(!t){return}t=mt(t);return this.childNameIndex_[t]};e.prototype.addChild=function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.children_.length;var a=void 0;var s=void 0;if(typeof r==="string"){s=mt(r);var o=i.componentClass||s;i.name=s;var u=e.getComponent(o);if(!u){throw new Error("Component "+o+" does not exist")}if(typeof u!=="function"){return null}a=new u(this.player_||this,i)}else{a=r}this.children_.splice(n,0,a);if(typeof a.id==="function"){this.childIndex_[a.id()]=a}s=s||a.name&&mt(a.name());if(s){this.childNameIndex_[s]=a}if(typeof a.el==="function"&&a.el()){var l=this.contentEl().children;var d=l[n]||null;this.contentEl().insertBefore(a.el(),d)}return a};e.prototype.removeChild=function e(t){if(typeof t==="string"){t=this.getChild(t)}if(!t||!this.children_){return}var r=false;for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i]===t){r=true;this.children_.splice(i,1);break}}if(!r){return}this.childIndex_[t.id()]=null;this.childNameIndex_[t.name()]=null;var n=t.el();if(n&&n.parentNode===this.contentEl()){this.contentEl().removeChild(t.el())}};e.prototype.initChildren=function t(){var r=this;var i=this.options_.children;if(i){var n=this.options_;var a=function e(t){var i=t.name;var a=t.opts;if(n[i]!==undefined){a=n[i]}if(a===false){return}if(a===true){a={}}a.playerOptions=r.options_.playerOptions;var s=r.addChild(i,a);if(s){r[i]=s}};var s=void 0;var o=e.getComponent("Tech");if(Array.isArray(i)){s=i}else{s=Object.keys(i)}s.concat(Object.keys(this.options_).filter((function(e){return!s.some((function(t){if(typeof t==="string"){return e===t}return e===t.name}))}))).map((function(e){var t=void 0;var n=void 0;if(typeof e==="string"){t=e;n=i[t]||r.options_[t]||{}}else{t=e.name;n=e}return{name:t,opts:n}})).filter((function(t){var r=e.getComponent(t.opts.componentClass||mt(t.name));return r&&!o.isTech(r)})).forEach(a)}};e.prototype.buildCSSClass=function e(){return""};e.prototype.ready=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!t){return}if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(t);return}if(r){t.call(this)}else{this.setTimeout(t,1)}};e.prototype.triggerReady=function e(){this.isReady_=true;this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[];if(e&&e.length>0){e.forEach((function(e){e.call(this)}),this)}this.trigger("ready")}),1)};e.prototype.$=function e(t,r){return xe(t,r||this.contentEl())};e.prototype.$$=function e(t,r){return De(t,r||this.contentEl())};e.prototype.hasClass=function e(t){return le(this.el_,t)};e.prototype.addClass=function e(t){de(this.el_,t)};e.prototype.removeClass=function e(t){fe(this.el_,t)};e.prototype.toggleClass=function e(t,r){ce(this.el_,t,r)};e.prototype.show=function e(){this.removeClass("vjs-hidden")};e.prototype.hide=function e(){this.addClass("vjs-hidden")};e.prototype.lockShowing=function e(){this.addClass("vjs-lock-showing")};e.prototype.unlockShowing=function e(){this.removeClass("vjs-lock-showing")};e.prototype.getAttribute=function e(t){return ve(this.el_,t)};e.prototype.setAttribute=function e(t,r){me(this.el_,t,r)};e.prototype.removeAttribute=function e(t){ge(this.el_,t)};e.prototype.width=function e(t,r){return this.dimension("width",t,r)};e.prototype.height=function e(t,r){return this.dimension("height",t,r)};e.prototype.dimensions=function e(t,r){this.width(t,true);this.height(r)};e.prototype.dimension=function e(t,r,i){if(r!==undefined){if(r===null||r!==r){r=0}if((""+r).indexOf("%")!==-1||(""+r).indexOf("px")!==-1){this.el_.style[t]=r}else if(r==="auto"){this.el_.style[t]=""}else{this.el_.style[t]=r+"px"}if(!i){this.trigger("componentresize")}return}if(!this.el_){return 0}var n=this.el_.style[t];var a=n.indexOf("px");if(a!==-1){return parseInt(n.slice(0,a),10)}return parseInt(this.el_["offset"+mt(t)],10)};e.prototype.currentDimension=function e(t){var r=0;if(t!=="width"&&t!=="height"){throw new Error("currentDimension only accepts width or height value")}if(typeof n.getComputedStyle==="function"){var i=n.getComputedStyle(this.el_);r=i.getPropertyValue(t)||i[t]}r=parseFloat(r);if(r===0){var a="offset"+mt(t);r=this.el_[a]}return r};e.prototype.currentDimensions=function e(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};e.prototype.currentWidth=function e(){return this.currentDimension("width")};e.prototype.currentHeight=function e(){return this.currentDimension("height")};e.prototype.focus=function e(){this.el_.focus()};e.prototype.blur=function e(){this.el_.blur()};e.prototype.emitTapEvents=function e(){var t=0;var r=null;var i=10;var n=200;var a=void 0;this.on("touchstart",(function(e){if(e.touches.length===1){r={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY};t=(new Date).getTime();a=true}}));this.on("touchmove",(function(e){if(e.touches.length>1){a=false}else if(r){var t=e.touches[0].pageX-r.pageX;var n=e.touches[0].pageY-r.pageY;var s=Math.sqrt(t*t+n*n);if(s>i){a=false}}}));var s=function e(){a=false};this.on("touchleave",s);this.on("touchcancel",s);this.on("touchend",(function(e){r=null;if(a===true){var i=(new Date).getTime()-t;if(i<n){e.preventDefault();this.trigger("tap")}}}))};e.prototype.enableTouchActivity=function e(){if(!this.player()||!this.player().reportUserActivity){return}var t=tt(this.player(),this.player().reportUserActivity);var r=void 0;this.on("touchstart",(function(){t();this.clearInterval(r);r=this.setInterval(t,250)}));var i=function e(i){t();this.clearInterval(r)};this.on("touchmove",t);this.on("touchend",i);this.on("touchcancel",i)};e.prototype.setTimeout=function e(t,r){var i=this;var a,s;t=tt(this,t);a=n.setTimeout((function(){i.off("dispose",s);t()}),r);s=function e(){return i.clearTimeout(a)};s.guid="vjs-timeout-"+a;this.on("dispose",s);return a};e.prototype.clearTimeout=function e(t){n.clearTimeout(t);var r=function e(){};r.guid="vjs-timeout-"+t;this.off("dispose",r);return t};e.prototype.setInterval=function e(t,r){var i=this;t=tt(this,t);var a=n.setInterval(t,r);var s=function e(){return i.clearInterval(a)};s.guid="vjs-interval-"+a;this.on("dispose",s);return a};e.prototype.clearInterval=function e(t){n.clearInterval(t);var r=function e(){};r.guid="vjs-interval-"+t;this.off("dispose",r);return t};e.prototype.requestAnimationFrame=function e(t){var r=this;var i,a;if(this.supportsRaf_){t=tt(this,t);i=n.requestAnimationFrame((function(){r.off("dispose",a);t()}));a=function e(){return r.cancelAnimationFrame(i)};a.guid="vjs-raf-"+i;this.on("dispose",a);return i}return this.setTimeout(t,1e3/60)};e.prototype.cancelAnimationFrame=function e(t){if(this.supportsRaf_){n.cancelAnimationFrame(t);var r=function e(){};r.guid="vjs-raf-"+t;this.off("dispose",r);return t}return this.clearTimeout(t)};e.registerComponent=function t(r,i){if(typeof r!=="string"||!r){throw new Error('Illegal component name, "'+r+'"; must be a non-empty string.')}var n=e.getComponent("Tech");var a=n&&n.isTech(i);var s=e===i||e.prototype.isPrototypeOf(i.prototype);if(a||!s){var o=void 0;if(a){o="techs must be registered using Tech.registerTech()"}else{o="must be a Component subclass"}throw new Error('Illegal component, "'+r+'"; '+o+".")}r=mt(r);if(!e.components_){e.components_={}}var u=e.getComponent("Player");if(r==="Player"&&u&&u.players){var l=u.players;var d=Object.keys(l);if(l&&d.length>0&&d.map((function(e){return l[e]})).every(Boolean)){throw new Error("Can not register Player component after player has been created.")}}e.components_[r]=i;return i};e.getComponent=function t(r){if(!r){return}r=mt(r);if(e.components_&&e.components_[r]){return e.components_[r]}};return e}();_t.prototype.supportsRaf_=typeof n.requestAnimationFrame==="function"&&typeof n.cancelAnimationFrame==="function";_t.registerComponent("Component",_t);function bt(e,t,r){if(typeof t!=="number"||t<0||t>r){throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+r+").")}}function Tt(e,t,r,i){bt(e,i,r.length-1);return r[i][t]}function St(e){if(e===undefined||e.length===0){return{length:0,start:function e(){throw new Error("This TimeRanges object is empty")},end:function e(){throw new Error("This TimeRanges object is empty")}}}return{length:e.length,start:Tt.bind(null,"start",0,e),end:Tt.bind(null,"end",1,e)}}function Et(e,t){if(Array.isArray(e)){return St(e)}else if(e===undefined||t===undefined){return St()}return St([[e,t]])}function wt(e,t){var r=0;var i=void 0;var n=void 0;if(!t){return 0}if(!e||!e.length){e=Et(0,0)}for(var a=0;a<e.length;a++){i=e.start(a);n=e.end(a);if(n>t){n=t}r+=n-i}return r/t}var kt={};var At=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var Ct=At[0];var Lt=void 0;for(var xt=0;xt<At.length;xt++){if(At[xt][1]in a){Lt=At[xt];break}}if(Lt){for(var Dt=0;Dt<Lt.length;Dt++){kt[Ct[Dt]]=Lt[Dt]}}function It(e){if(e instanceof It){return e}if(typeof e==="number"){this.code=e}else if(typeof e==="string"){this.message=e}else if(V(e)){if(typeof e.code==="number"){this.code=e.code}G(this,e)}if(!this.message){this.message=It.defaultMessages[this.code]||""}}It.prototype.code=0;It.prototype.message="";It.prototype.status=null;It.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];It.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Ot=0;Ot<It.errorTypes.length;Ot++){It[It.errorTypes[Ot]]=Ot;It.prototype[It.errorTypes[Ot]]=Ot}function Rt(e){return e!==undefined&&e!==null&&typeof e.then==="function"}function Pt(e){if(Rt(e)){e.then(null,(function(e){}))}}var Ut=function e(t){var r=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(e,r,i){if(t[r]){e[r]=t[r]}return e}),{cues:t.cues&&Array.prototype.map.call(t.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))});return r};var Mt=function e(t){var r=t.$$("track");var i=Array.prototype.map.call(r,(function(e){return e.track}));var n=Array.prototype.map.call(r,(function(e){var t=Ut(e.track);if(e.src){t.src=e.src}return t}));return n.concat(Array.prototype.filter.call(t.textTracks(),(function(e){return i.indexOf(e)===-1})).map(Ut))};var Nt=function e(t,r){t.forEach((function(e){var t=r.addRemoteTextTrack(e).track;if(!e.src&&e.cues){e.cues.forEach((function(e){return t.addCue(e)}))}}));return r.textTracks()};var jt={textTracksToJson:Mt,jsonToTextTracks:Nt,trackToJson_:Ut};var Bt="vjs-modal-dialog";var Ft=27;var Ht=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.opened_=n.hasBeenOpened_=n.hasBeenFilled_=false;n.closeable(!n.options_.uncloseable);n.content(n.options_.content);n.contentEl_=se("div",{className:Bt+"-content"},{role:"document"});n.descEl_=se("p",{className:Bt+"-description vjs-control-text",id:n.el().getAttribute("aria-describedby")});oe(n.descEl_,n.description());n.el_.appendChild(n.descEl_);n.el_.appendChild(n.contentEl_);return n}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};t.prototype.dispose=function t(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;e.prototype.dispose.call(this)};t.prototype.buildCSSClass=function t(){return Bt+" vjs-hidden "+e.prototype.buildCSSClass.call(this)};t.prototype.handleKeyPress=function e(t){if(t.which===Ft&&this.closeable()){this.close()}};t.prototype.label=function e(){return this.localize(this.options_.label||"Modal Window")};t.prototype.description=function e(){var t=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")}return t};t.prototype.open=function e(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill()}this.wasPlaying_=!t.paused();if(this.options_.pauseOnOpen&&this.wasPlaying_){t.pause()}if(this.closeable()){this.on(this.el_.ownerDocument,"keydown",tt(this,this.handleKeyPress))}this.hadControls_=t.controls();t.controls(false);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true}};t.prototype.opened=function e(t){if(typeof t==="boolean"){this[t?"open":"close"]()}return this.opened_};t.prototype.close=function e(){if(!this.opened_){return}var t=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_&&this.options_.pauseOnOpen){t.play()}if(this.closeable()){this.off(this.el_.ownerDocument,"keydown",tt(this,this.handleKeyPress))}if(this.hadControls_){t.controls(true)}this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();if(this.options_.temporary){this.dispose()}};t.prototype.closeable=function e(t){if(typeof t==="boolean"){var e=this.closeable_=!!t;var r=this.getChild("closeButton");if(e&&!r){var i=this.contentEl_;this.contentEl_=this.el_;r=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=i;this.on(r,"close",this.close)}if(!e&&r){this.off(r,"close",this.close);this.removeChild(r);r.dispose()}}return this.closeable_};t.prototype.fill=function e(){this.fillWith(this.content())};t.prototype.fillWith=function e(t){var r=this.contentEl();var i=r.parentNode;var n=r.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;i.removeChild(r);this.empty();Ce(r,t);this.trigger("modalfill");if(n){i.insertBefore(r,n)}else{i.appendChild(r)}var a=this.getChild("closeButton");if(a){i.appendChild(a.el_)}};t.prototype.empty=function e(){this.trigger("beforemodalempty");we(this.contentEl());this.trigger("modalempty")};t.prototype.content=function e(t){if(typeof t!=="undefined"){this.content_=t}return this.content_};t.prototype.conditionalFocus_=function e(){var t=a.activeElement;var r=this.player_.el_;this.previouslyActiveEl_=null;if(r.contains(t)||r===t){this.previouslyActiveEl_=t;this.focus();this.on(a,"keydown",this.handleKeyDown)}};t.prototype.conditionalBlur_=function e(){if(this.previouslyActiveEl_){this.previouslyActiveEl_.focus();this.previouslyActiveEl_=null}this.off(a,"keydown",this.handleKeyDown)};t.prototype.handleKeyDown=function e(t){if(t.which!==9){return}var r=this.focusableEls_();var i=this.el_.querySelector(":focus");var n=void 0;for(var s=0;s<r.length;s++){if(i===r[s]){n=s;break}}if(a.activeElement===this.el_){n=0}if(t.shiftKey&&n===0){r[r.length-1].focus();t.preventDefault()}else if(!t.shiftKey&&n===r.length-1){r[0].focus();t.preventDefault()}};t.prototype.focusableEls_=function e(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,(function(e){return(e instanceof n.HTMLAnchorElement||e instanceof n.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof n.HTMLInputElement||e instanceof n.HTMLSelectElement||e instanceof n.HTMLTextAreaElement||e instanceof n.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof n.HTMLIFrameElement||e instanceof n.HTMLObjectElement||e instanceof n.HTMLEmbedElement||e.hasAttribute("tabindex")&&e.getAttribute("tabindex")!==-1||e.hasAttribute("contenteditable")}))};return t}(_t);Ht.prototype.options_={pauseOnOpen:true,temporary:true};_t.registerComponent("ModalDialog",Ht);var qt=function(e){M(t,e);function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var i;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;U(this,t);var s=N(this,e.call(this));if(!n){n=s;if(C){n=a.createElement("custom");for(var o in t.prototype){if(o!=="constructor"){n[o]=t.prototype[o]}}}}n.tracks_=[];Object.defineProperty(n,"length",{get:function e(){return this.tracks_.length}});for(var u=0;u<r.length;u++){n.addTrack(r[u])}return i=n,N(s,i)}t.prototype.addTrack=function e(t){var r=this.tracks_.length;if(!(""+r in this)){Object.defineProperty(this,r,{get:function e(){return this.tracks_[r]}})}if(this.tracks_.indexOf(t)===-1){this.tracks_.push(t);this.trigger({track:t,type:"addtrack"})}};t.prototype.removeTrack=function e(t){var r=void 0;for(var i=0,n=this.length;i<n;i++){if(this[i]===t){r=this[i];if(r.off){r.off()}this.tracks_.splice(i,1);break}}if(!r){return}this.trigger({track:r,type:"removetrack"})};t.prototype.getTrackById=function e(t){var r=null;for(var i=0,n=this.length;i<n;i++){var a=this[i];if(a.id===t){r=a;break}}return r};return t}(nt);qt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var Gt in qt.prototype.allowedEvents_){qt.prototype["on"+Gt]=null}var Vt=function e(t,r){for(var i=0;i<t.length;i++){if(!Object.keys(t[i]).length||r.id===t[i].id){continue}t[i].enabled=false}};var Wt=function(e){M(t,e);function t(){var r,i;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];U(this,t);var s=void 0;for(var o=n.length-1;o>=0;o--){if(n[o].enabled){Vt(n,n[o]);break}}if(C){s=a.createElement("custom");for(var u in qt.prototype){if(u!=="constructor"){s[u]=qt.prototype[u]}}for(var l in t.prototype){if(l!=="constructor"){s[l]=t.prototype[l]}}}s=(r=N(this,e.call(this,n,s)),r);s.changing_=false;return i=s,N(r,i)}t.prototype.addTrack=function t(r){var i=this;if(r.enabled){Vt(this,r)}e.prototype.addTrack.call(this,r);if(!r.addEventListener){return}r.addEventListener("enabledchange",(function(){if(i.changing_){return}i.changing_=true;Vt(i,r);i.changing_=false;i.trigger("change")}))};return t}(qt);var zt=function e(t,r){for(var i=0;i<t.length;i++){if(!Object.keys(t[i]).length||r.id===t[i].id){continue}t[i].selected=false}};var Kt=function(e){M(t,e);function t(){var r,i;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];U(this,t);var s=void 0;for(var o=n.length-1;o>=0;o--){if(n[o].selected){zt(n,n[o]);break}}if(C){s=a.createElement("custom");for(var u in qt.prototype){if(u!=="constructor"){s[u]=qt.prototype[u]}}for(var l in t.prototype){if(l!=="constructor"){s[l]=t.prototype[l]}}}s=(r=N(this,e.call(this,n,s)),r);s.changing_=false;Object.defineProperty(s,"selectedIndex",{get:function e(){for(var t=0;t<this.length;t++){if(this[t].selected){return t}}return-1},set:function e(){}});return i=s,N(r,i)}t.prototype.addTrack=function t(r){var i=this;if(r.selected){zt(this,r)}e.prototype.addTrack.call(this,r);if(!r.addEventListener){return}r.addEventListener("selectedchange",(function(){if(i.changing_){return}i.changing_=true;zt(i,r);i.changing_=false;i.trigger("change")}))};return t}(qt);var Yt=function(e){M(t,e);function t(){var r,i;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];U(this,t);var s=void 0;if(C){s=a.createElement("custom");for(var o in qt.prototype){if(o!=="constructor"){s[o]=qt.prototype[o]}}for(var u in t.prototype){if(u!=="constructor"){s[u]=t.prototype[u]}}}s=(r=N(this,e.call(this,n,s)),r);return i=s,N(r,i)}t.prototype.addTrack=function t(r){e.prototype.addTrack.call(this,r);r.addEventListener("modechange",tt(this,(function(){this.trigger("change")})));var i=["metadata","chapters"];if(i.indexOf(r.kind)===-1){r.addEventListener("modechange",tt(this,(function(){this.trigger("selectedlanguagechange")})))}};return t}(qt);var Xt=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];U(this,e);var r=this;if(C){r=a.createElement("custom");for(var i in e.prototype){if(i!=="constructor"){r[i]=e.prototype[i]}}}r.trackElements_=[];Object.defineProperty(r,"length",{get:function e(){return this.trackElements_.length}});for(var n=0,s=t.length;n<s;n++){r.addTrackElement_(t[n])}if(C){return r}}e.prototype.addTrackElement_=function e(t){var r=this.trackElements_.length;if(!(""+r in this)){Object.defineProperty(this,r,{get:function e(){return this.trackElements_[r]}})}if(this.trackElements_.indexOf(t)===-1){this.trackElements_.push(t)}};e.prototype.getTrackElementByTrack_=function e(t){var r=void 0;for(var i=0,n=this.trackElements_.length;i<n;i++){if(t===this.trackElements_[i].track){r=this.trackElements_[i];break}}return r};e.prototype.removeTrackElement_=function e(t){for(var r=0,i=this.trackElements_.length;r<i;r++){if(t===this.trackElements_[r]){this.trackElements_.splice(r,1);break}}};return e}();var Jt=function(){function e(t){U(this,e);var r=this;if(C){r=a.createElement("custom");for(var i in e.prototype){if(i!=="constructor"){r[i]=e.prototype[i]}}}e.prototype.setCues_.call(r,t);Object.defineProperty(r,"length",{get:function e(){return this.length_}});if(C){return r}}e.prototype.setCues_=function e(t){var r=this.length||0;var i=0;var n=t.length;this.cues_=t;this.length_=t.length;var a=function e(t){if(!(""+t in this)){Object.defineProperty(this,""+t,{get:function e(){return this.cues_[t]}})}};if(r<n){i=r;for(;i<n;i++){a.call(this,i)}}};e.prototype.getCueById=function e(t){var r=null;for(var i=0,n=this.length;i<n;i++){var a=this[i];if(a.id===t){r=a;break}}return r};return e}();var Qt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"};var $t={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"};var Zt={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};var er={disabled:"disabled",hidden:"hidden",showing:"showing"};var tr=function(e){M(t,e);function t(){var r;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};U(this,t);var n=N(this,e.call(this));var s=n;if(C){s=a.createElement("custom");for(var o in t.prototype){if(o!=="constructor"){s[o]=t.prototype[o]}}}var u={id:i.id||"vjs_track_"+Re(),kind:i.kind||"",label:i.label||"",language:i.language||""};var l=function e(t){Object.defineProperty(s,t,{get:function e(){return u[t]},set:function e(){}})};for(var d in u){l(d)}return r=s,N(n,r)}return t}(nt);var rr=function e(t){var r=["protocol","hostname","port","pathname","search","hash","host"];var i=a.createElement("a");i.href=t;var s=i.host===""&&i.protocol!=="file:";var o=void 0;if(s){o=a.createElement("div");o.innerHTML='<a href="'+t+'"></a>';i=o.firstChild;o.setAttribute("style","display:none; position:absolute;");a.body.appendChild(o)}var u={};for(var l=0;l<r.length;l++){u[r[l]]=i[r[l]]}if(u.protocol==="http:"){u.host=u.host.replace(/:80$/,"")}if(u.protocol==="https:"){u.host=u.host.replace(/:443$/,"")}if(!u.protocol){u.protocol=n.location.protocol}if(s){a.body.removeChild(o)}return u};var ir=function e(t){if(!t.match(/^https?:\/\//)){var r=a.createElement("div");r.innerHTML='<a href="'+t+'">x</a>';t=r.firstChild.href}return t};var nr=function e(t){if(typeof t==="string"){var r=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i;var i=r.exec(t);if(i){return i.pop().toLowerCase()}}return""};var ar=function e(t){var r=n.location;var i=rr(t);var a=i.protocol===":"?r.protocol:i.protocol;var s=a+i.host!==r.protocol+r.host;return s};var sr=(Object.freeze||Object)({parseUrl:rr,getAbsoluteURL:ir,getFileExtension:nr,isCrossOrigin:ar});var or=function e(t,r){var i=new n.WebVTT.Parser(n,n.vttjs,n.WebVTT.StringDecoder());var a=[];i.oncue=function(e){r.addCue(e)};i.onparsingerror=function(e){a.push(e)};i.onflush=function(){r.trigger({type:"loadeddata",target:r})};i.parse(t);if(a.length>0){if(n.console&&n.console.groupCollapsed){n.console.groupCollapsed("Text Track parsing errors for "+r.src)}a.forEach((function(e){return J.error(e)}));if(n.console&&n.console.groupEnd){n.console.groupEnd()}}i.flush()};var ur=function e(t,r){var i={uri:t};var a=ar(t);if(a){i.cors=a}u(i,tt(this,(function(e,t,i){if(e){return J.error(e,t)}r.loaded_=true;if(typeof n.WebVTT!=="function"){if(r.tech_){var a=function e(){return or(i,r)};r.tech_.on("vttjsloaded",a);r.tech_.on("vttjserror",(function(){J.error("vttjs failed to load, stopping trying to process "+r.src);r.tech_.off("vttjsloaded",a)}))}}else{or(i,r)}})))};var lr=function(e){M(t,e);function t(){var r,i;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};U(this,t);if(!n.tech){throw new Error("A tech was not provided.")}var a=yt(n,{kind:Zt[n.kind]||"subtitles",language:n.language||n.srclang||""});var s=er[a.mode]||"disabled";var o=a["default"];if(a.kind==="metadata"||a.kind==="chapters"){s="hidden"}var u=(r=N(this,e.call(this,a)),r);u.tech_=a.tech;if(C){for(var l in t.prototype){if(l!=="constructor"){u[l]=t.prototype[l]}}}u.cues_=[];u.activeCues_=[];var d=new Jt(u.cues_);var f=new Jt(u.activeCues_);var c=false;var h=tt(u,(function(){this.activeCues=this.activeCues;if(c){this.trigger("cuechange");c=false}}));if(s!=="disabled"){u.tech_.ready((function(){u.tech_.on("timeupdate",h)}),true)}Object.defineProperty(u,"default",{get:function e(){return o},set:function e(){}});Object.defineProperty(u,"mode",{get:function e(){return s},set:function e(t){var r=this;if(!er[t]){return}s=t;if(s==="showing"){this.tech_.ready((function(){r.tech_.on("timeupdate",h)}),true)}this.trigger("modechange")}});Object.defineProperty(u,"cues",{get:function e(){if(!this.loaded_){return null}return d},set:function e(){}});Object.defineProperty(u,"activeCues",{get:function e(){if(!this.loaded_){return null}if(this.cues.length===0){return f}var t=this.tech_.currentTime();var r=[];for(var i=0,n=this.cues.length;i<n;i++){var a=this.cues[i];if(a.startTime<=t&&a.endTime>=t){r.push(a)}else if(a.startTime===a.endTime&&a.startTime<=t&&a.startTime+.5>=t){r.push(a)}}c=false;if(r.length!==this.activeCues_.length){c=true}else{for(var s=0;s<r.length;s++){if(this.activeCues_.indexOf(r[s])===-1){c=true}}}this.activeCues_=r;f.setCues_(this.activeCues_);return f},set:function e(){}});if(a.src){u.src=a.src;ur(a.src,u)}else{u.loaded_=true}return i=u,N(r,i)}t.prototype.addCue=function e(t){var r=t;if(n.vttjs&&!(t instanceof n.vttjs.VTTCue)){r=new n.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(var i in t){if(!(i in r)){r[i]=t[i]}}r.id=t.id;r.originalCue_=t}var a=this.tech_.textTracks();for(var s=0;s<a.length;s++){if(a[s]!==this){a[s].removeCue(r)}}this.cues_.push(r);this.cues.setCues_(this.cues_)};t.prototype.removeCue=function e(t){var r=this.cues_.length;while(r--){var i=this.cues_[r];if(i===t||i.originalCue_&&i.originalCue_===t){this.cues_.splice(r,1);this.cues.setCues_(this.cues_);break}}};return t}(tr);lr.prototype.allowedEvents_={cuechange:"cuechange"};var dr=function(e){M(t,e);function t(){var r,i;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};U(this,t);var a=yt(n,{kind:$t[n.kind]||""});var s=(r=N(this,e.call(this,a)),r);var o=false;if(C){for(var u in t.prototype){if(u!=="constructor"){s[u]=t.prototype[u]}}}Object.defineProperty(s,"enabled",{get:function e(){return o},set:function e(t){if(typeof t!=="boolean"||t===o){return}o=t;this.trigger("enabledchange")}});if(a.enabled){s.enabled=a.enabled}s.loaded_=true;return i=s,N(r,i)}return t}(tr);var fr=function(e){M(t,e);function t(){var r,i;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};U(this,t);var a=yt(n,{kind:Qt[n.kind]||""});var s=(r=N(this,e.call(this,a)),r);var o=false;if(C){for(var u in t.prototype){if(u!=="constructor"){s[u]=t.prototype[u]}}}Object.defineProperty(s,"selected",{get:function e(){return o},set:function e(t){if(typeof t!=="boolean"||t===o){return}o=t;this.trigger("selectedchange")}});if(a.selected){s.selected=a.selected}return i=s,N(r,i)}return t}(tr);var cr=0;var hr=1;var pr=2;var vr=3;var mr=function(e){M(t,e);function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};U(this,t);var i=N(this,e.call(this));var n=void 0;var s=i;if(C){s=a.createElement("custom");for(var o in t.prototype){if(o!=="constructor"){s[o]=t.prototype[o]}}}var u=new lr(r);s.kind=u.kind;s.src=u.src;s.srclang=u.language;s.label=u.label;s["default"]=u["default"];Object.defineProperty(s,"readyState",{get:function e(){return n}});Object.defineProperty(s,"track",{get:function e(){return u}});n=cr;u.addEventListener("loadeddata",(function(){n=pr;s.trigger({type:"load",target:s})}));if(C){var l;return l=s,N(i,l)}return i}return t}(nt);mr.prototype.allowedEvents_={load:"load"};mr.NONE=cr;mr.LOADING=hr;mr.LOADED=pr;mr.ERROR=vr;var gr={audio:{ListClass:Wt,TrackClass:dr,capitalName:"Audio"},video:{ListClass:Kt,TrackClass:fr,capitalName:"Video"},text:{ListClass:Yt,TrackClass:lr,capitalName:"Text"}};Object.keys(gr).forEach((function(e){gr[e].getterName=e+"Tracks";gr[e].privateName=e+"Tracks_"}));var yr={remoteText:{ListClass:Yt,TrackClass:lr,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Xt,TrackClass:mr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}};var _r=yt(gr,yr);yr.names=Object.keys(yr);gr.names=Object.keys(gr);_r.names=[].concat(yr.names).concat(gr.names);function br(e,t,r,i){var n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};var a=e.textTracks();n.kind=t;if(r){n.label=r}if(i){n.language=i}n.tech=e;var s=new _r.text.TrackClass(n);a.addTrack(s);return s}var Tr=function(e){M(t,e);function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};U(this,t);r.reportTouchActivity=false;var n=N(this,e.call(this,null,r,i));n.hasStarted_=false;n.on("playing",(function(){this.hasStarted_=true}));n.on("loadstart",(function(){this.hasStarted_=false}));_r.names.forEach((function(e){var t=_r[e];if(r&&r[t.getterName]){n[t.privateName]=r[t.getterName]}}));if(!n.featuresProgressEvents){n.manualProgressOn()}if(!n.featuresTimeupdateEvents){n.manualTimeUpdatesOn()}["Text","Audio","Video"].forEach((function(e){if(r["native"+e+"Tracks"]===false){n["featuresNative"+e+"Tracks"]=false}}));if(r.nativeCaptions===false||r.nativeTextTracks===false){n.featuresNativeTextTracks=false}else if(r.nativeCaptions===true||r.nativeTextTracks===true){n.featuresNativeTextTracks=true}if(!n.featuresNativeTextTracks){n.emulateTextTracks()}n.autoRemoteTextTracks_=new _r.text.ListClass;n.initTrackListeners();if(!r.nativeControlsForTouch){n.emitTapEvents()}if(n.constructor){n.name_=n.constructor.name||"Unknown Tech"}return n}t.prototype.triggerSourceset=function e(t){var r=this;if(!this.isReady_){this.one("ready",(function(){return r.setTimeout((function(){return r.triggerSourceset(t)}),1)}))}this.trigger({src:t,type:"sourceset"})};t.prototype.manualProgressOn=function e(){this.on("durationchange",this.onDurationChange);this.manualProgress=true;this.one("ready",this.trackProgress)};t.prototype.manualProgressOff=function e(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)};t.prototype.trackProgress=function e(t){this.stopTrackingProgress();this.progressInterval=this.setInterval(tt(this,(function(){var e=this.bufferedPercent();if(this.bufferedPercent_!==e){this.trigger("progress")}this.bufferedPercent_=e;if(e===1){this.stopTrackingProgress()}})),500)};t.prototype.onDurationChange=function e(t){this.duration_=this.duration()};t.prototype.buffered=function e(){return Et(0,0)};t.prototype.bufferedPercent=function e(){return wt(this.buffered(),this.duration_)};t.prototype.stopTrackingProgress=function e(){this.clearInterval(this.progressInterval)};t.prototype.manualTimeUpdatesOn=function e(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)};t.prototype.manualTimeUpdatesOff=function e(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)};t.prototype.trackCurrentTime=function e(){if(this.currentTimeInterval){this.stopTrackingCurrentTime()}this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}),250)};t.prototype.stopTrackingCurrentTime=function e(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})};t.prototype.dispose=function t(){this.clearTracks(gr.names);if(this.manualProgress){this.manualProgressOff()}if(this.manualTimeUpdates){this.manualTimeUpdatesOff()}e.prototype.dispose.call(this)};t.prototype.clearTracks=function e(t){var r=this;t=[].concat(t);t.forEach((function(e){var t=r[e+"Tracks"]()||[];var i=t.length;while(i--){var n=t[i];if(e==="text"){r.removeRemoteTextTrack(n)}t.removeTrack(n)}}))};t.prototype.cleanupAutoTextTracks=function e(){var t=this.autoRemoteTextTracks_||[];var r=t.length;while(r--){var i=t[r];this.removeRemoteTextTrack(i)}};t.prototype.reset=function e(){};t.prototype.error=function e(t){if(t!==undefined){this.error_=new It(t);this.trigger("error")}return this.error_};t.prototype.played=function e(){if(this.hasStarted_){return Et(0,0)}return Et()};t.prototype.setCurrentTime=function e(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}};t.prototype.initTrackListeners=function e(){var t=this;gr.names.forEach((function(e){var r=gr[e];var i=function r(){t.trigger(e+"trackchange")};var n=t[r.getterName]();n.addEventListener("removetrack",i);n.addEventListener("addtrack",i);t.on("dispose",(function(){n.removeEventListener("removetrack",i);n.removeEventListener("addtrack",i)}))}))};t.prototype.addWebVttScript_=function e(){var t=this;if(n.WebVTT){return}if(a.body.contains(this.el())){if(!this.options_["vtt.js"]&&W(l)&&Object.keys(l).length>0){this.trigger("vttjsloaded");return}var r=a.createElement("script");r.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.12.4/vtt.min.js";r.onload=function(){t.trigger("vttjsloaded")};r.onerror=function(){t.trigger("vttjserror")};this.on("dispose",(function(){r.onload=null;r.onerror=null}));n.WebVTT=true;this.el().parentNode.appendChild(r)}else{this.ready(this.addWebVttScript_)}};t.prototype.emulateTextTracks=function e(){var t=this;var r=this.textTracks();var i=this.remoteTextTracks();var n=function e(t){return r.addTrack(t.track)};var a=function e(t){return r.removeTrack(t.track)};i.on("addtrack",n);i.on("removetrack",a);this.addWebVttScript_();var s=function e(){return t.trigger("texttrackchange")};var o=function e(){s();for(var t=0;t<r.length;t++){var i=r[t];i.removeEventListener("cuechange",s);if(i.mode==="showing"){i.addEventListener("cuechange",s)}}};o();r.addEventListener("change",o);r.addEventListener("addtrack",o);r.addEventListener("removetrack",o);this.on("dispose",(function(){i.off("addtrack",n);i.off("removetrack",a);r.removeEventListener("change",o);r.removeEventListener("addtrack",o);r.removeEventListener("removetrack",o);for(var e=0;e<r.length;e++){var t=r[e];t.removeEventListener("cuechange",s)}}))};t.prototype.addTextTrack=function e(t,r,i){if(!t){throw new Error("TextTrack kind is required but was not provided")}return br(this,t,r,i)};t.prototype.createRemoteTextTrack=function e(t){var r=yt(t,{tech:this});return new yr.remoteTextEl.TrackClass(r)};t.prototype.addRemoteTextTrack=function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var i=arguments[1];var n=this.createRemoteTextTrack(r);if(i!==true&&i!==false){J.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js');i=true}this.remoteTextTrackEls().addTrackElement_(n);this.remoteTextTracks().addTrack(n.track);if(i!==true){this.ready((function(){return t.autoRemoteTextTracks_.addTrack(n.track)}))}return n};t.prototype.removeRemoteTextTrack=function e(t){var r=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(r);this.remoteTextTracks().removeTrack(t);this.autoRemoteTextTracks_.removeTrack(t)};t.prototype.getVideoPlaybackQuality=function e(){return{}};t.prototype.setPoster=function e(){};t.prototype.playsinline=function e(){};t.prototype.setPlaysinline=function e(){};t.prototype.canPlayType=function e(){return""};t.canPlayType=function e(){return""};t.canPlaySource=function e(r,i){return t.canPlayType(r.type)};t.isTech=function e(r){return r.prototype instanceof t||r instanceof t||r===t};t.registerTech=function e(r,i){if(!t.techs_){t.techs_={}}if(!t.isTech(i)){throw new Error("Tech "+r+" must be a Tech")}if(!t.canPlayType){throw new Error("Techs must have a static canPlayType method on them")}if(!t.canPlaySource){throw new Error("Techs must have a static canPlaySource method on them")}r=mt(r);t.techs_[r]=i;if(r!=="Tech"){t.defaultTechOrder_.push(r)}return i};t.getTech=function e(r){if(!r){return}r=mt(r);if(t.techs_&&t.techs_[r]){return t.techs_[r]}if(n&&n.videojs&&n.videojs[r]){J.warn("The "+r+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return n.videojs[r]}};return t}(_t);_r.names.forEach((function(e){var t=_r[e];Tr.prototype[t.getterName]=function(){this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}}));Tr.prototype.featuresVolumeControl=true;Tr.prototype.featuresMuteControl=true;Tr.prototype.featuresFullscreenResize=false;Tr.prototype.featuresPlaybackRate=false;Tr.prototype.featuresProgressEvents=false;Tr.prototype.featuresSourceset=false;Tr.prototype.featuresTimeupdateEvents=false;Tr.prototype.featuresNativeTextTracks=false;Tr.withSourceHandlers=function(e){e.registerSourceHandler=function(t,r){var i=e.sourceHandlers;if(!i){i=e.sourceHandlers=[]}if(r===undefined){r=i.length}i.splice(r,0,t)};e.canPlayType=function(t){var r=e.sourceHandlers||[];var i=void 0;for(var n=0;n<r.length;n++){i=r[n].canPlayType(t);if(i){return i}}return""};e.selectSourceHandler=function(t,r){var i=e.sourceHandlers||[];var n=void 0;for(var a=0;a<i.length;a++){n=i[a].canHandleSource(t,r);if(n){return i[a]}}return null};e.canPlaySource=function(t,r){var i=e.selectSourceHandler(t,r);if(i){return i.canHandleSource(t,r)}return""};var t=["seekable","seeking","duration"];t.forEach((function(e){var t=this[e];if(typeof t!=="function"){return}this[e]=function(){if(this.sourceHandler_&&this.sourceHandler_[e]){return this.sourceHandler_[e].apply(this.sourceHandler_,arguments)}return t.apply(this,arguments)}}),e.prototype);e.prototype.setSource=function(t){var r=e.selectSourceHandler(t,this.options_);if(!r){if(e.nativeSourceHandler){r=e.nativeSourceHandler}else{J.error("No source hander found for the current source.")}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);if(r!==e.nativeSourceHandler){this.currentSource_=t}this.sourceHandler_=r.handleSource(t,this,this.options_);this.on("dispose",this.disposeSourceHandler)};e.prototype.disposeSourceHandler=function(){if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null}this.cleanupAutoTextTracks();if(this.sourceHandler_){if(this.sourceHandler_.dispose){this.sourceHandler_.dispose()}this.sourceHandler_=null}}};_t.registerComponent("Tech",Tr);Tr.registerTech("Tech",Tr);Tr.defaultTechOrder_=[];var Sr={};var Er={};var wr={};function kr(e,t){Sr[e]=Sr[e]||[];Sr[e].push(t)}function Ar(e,t,r){e.setTimeout((function(){return jr(t,Sr[t.type],r,e)}),1)}function Cr(e,t){e.forEach((function(e){return e.setTech&&e.setTech(t)}))}function Lr(e,t,r){return e.reduceRight(Pr(r),t[r]())}function xr(e,t,r,i){return t[r](e.reduce(Pr(r),i))}function Dr(e,t,r){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var n="call"+mt(r);var a=e.reduce(Pr(n),i);var s=a===wr;var o=s?null:t[r](a);Ur(e,r,o,s);return o}var Ir={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1};var Or={setCurrentTime:1};var Rr={play:1,pause:1};function Pr(e){return function(t,r){if(t===wr){return wr}if(r[e]){return r[e](t)}return t}}function Ur(e,t,r,i){for(var n=e.length-1;n>=0;n--){var a=e[n];if(a[t]){a[t](i,r)}}}function Mr(e){Er[e.id()]=null}function Nr(e,t){var r=Er[e.id()];var i=null;if(r===undefined||r===null){i=t(e);Er[e.id()]=[[t,i]];return i}for(var n=0;n<r.length;n++){var a=r[n],s=a[0],o=a[1];if(s!==t){continue}i=o}if(i===null){i=t(e);r.push([t,i])}return i}function jr(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r=arguments[2];var i=arguments[3];var n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:[];var a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;var s=t[0],o=t.slice(1);if(typeof s==="string"){jr(e,Sr[s],r,i,n,a)}else if(s){var u=Nr(i,s);if(!u.setSource){n.push(u);return jr(e,o,r,i,n,a)}u.setSource(G({},e),(function(t,s){if(t){return jr(e,o,r,i,n,a)}n.push(u);jr(s,e.type===s.type?o:Sr[s.type],r,i,n,a)}))}else if(o.length){jr(e,o,r,i,n,a)}else if(a){r(e,n)}else{jr(e,Sr["*"],r,i,n,true)}}var Br={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"};var Fr=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=nr(t);var i=Br[r.toLowerCase()];return i||""};var Hr=function e(t,r){if(!r){return""}if(t.cache_.source.src===r&&t.cache_.source.type){return t.cache_.source.type}var i=t.cache_.sources.filter((function(e){return e.src===r}));if(i.length){return i[0].type}var n=t.$$("source");for(var a=0;a<n.length;a++){var s=n[a];if(s.type&&s.src&&s.src===r){return s.type}}return Fr(r)};var qr=function e(t){if(Array.isArray(t)){var r=[];t.forEach((function(t){t=e(t);if(Array.isArray(t)){r=r.concat(t)}else if(V(t)){r.push(t)}}));t=r}else if(typeof t==="string"&&t.trim()){t=[Gr({src:t})]}else if(V(t)&&typeof t.src==="string"&&t.src&&t.src.trim()){t=[Gr(t)]}else{t=[]}return t};function Gr(e){var t=Fr(e.src);if(!e.type&&t){e.type=t}return e}var Vr=function(e){M(t,e);function t(r,i,n){U(this,t);var a=yt({createEl:false},i);var s=N(this,e.call(this,r,a,n));if(!i.playerOptions.sources||i.playerOptions.sources.length===0){for(var o=0,u=i.playerOptions.techOrder;o<u.length;o++){var l=mt(u[o]);var d=Tr.getTech(l);if(!l){d=_t.getComponent(l)}if(d&&d.isSupported()){r.loadTech_(l);break}}}else{r.src(i.playerOptions.sources)}return s}return t}(_t);_t.registerComponent("MediaLoader",Vr);var Wr=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.emitTapEvents();n.enable();return n}t.prototype.createEl=function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"div";var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};i=G({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},i);if(r==="button"){J.error("Creating a ClickableComponent with an HTML element of "+r+" is not supported; use a Button instead.")}n=G({role:"button"},n);this.tabIndex_=i.tabIndex;var a=e.prototype.createEl.call(this,r,i,n);this.createControlTextEl(a);return a};t.prototype.dispose=function t(){this.controlTextEl_=null;e.prototype.dispose.call(this)};t.prototype.createControlTextEl=function e(t){this.controlTextEl_=se("span",{className:"vjs-control-text"},{"aria-live":"polite"});if(t){t.appendChild(this.controlTextEl_)}this.controlText(this.controlText_,t);return this.controlTextEl_};t.prototype.controlText=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.el();if(t===undefined){return this.controlText_||"Need Text"}var i=this.localize(t);this.controlText_=t;oe(this.controlTextEl_,i);if(!this.nonIconControl){r.setAttribute("title",i)}};t.prototype.buildCSSClass=function t(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)};t.prototype.enable=function e(){if(!this.enabled_){this.enabled_=true;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");if(typeof this.tabIndex_!=="undefined"){this.el_.setAttribute("tabIndex",this.tabIndex_)}this.on(["tap","click"],this.handleClick);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur)}};t.prototype.disable=function e(){this.enabled_=false;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");if(typeof this.tabIndex_!=="undefined"){this.el_.removeAttribute("tabIndex")}this.off(["tap","click"],this.handleClick);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur)};t.prototype.handleClick=function e(t){};t.prototype.handleFocus=function e(t){Ve(a,"keydown",tt(this,this.handleKeyPress))};t.prototype.handleKeyPress=function t(r){if(r.which===32||r.which===13){r.preventDefault();this.trigger("click")}else if(e.prototype.handleKeyPress){e.prototype.handleKeyPress.call(this,r)}};t.prototype.handleBlur=function e(t){We(a,"keydown",tt(this,this.handleKeyPress))};return t}(_t);_t.registerComponent("ClickableComponent",Wr);var zr=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.update();r.on("posterchange",tt(n,n.update));return n}t.prototype.dispose=function t(){this.player().off("posterchange",this.update);e.prototype.dispose.call(this)};t.prototype.createEl=function e(){var t=se("div",{className:"vjs-poster",tabIndex:-1});if(!O){this.fallbackImg_=se("img");t.appendChild(this.fallbackImg_)}return t};t.prototype.update=function e(t){var r=this.player().poster();this.setSrc(r);if(r){this.show()}else{this.hide()}};t.prototype.setSrc=function e(t){if(this.fallbackImg_){this.fallbackImg_.src=t}else{var r="";if(t){r='url("'+t+'")'}this.el_.style.backgroundImage=r}};t.prototype.handleClick=function e(t){if(!this.player_.controls()){return}if(this.player_.paused()){Pt(this.player_.play())}else{this.player_.pause()}};return t}(Wr);_t.registerComponent("PosterImage",zr);var Kr="#222";var Yr="#ccc";var Xr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Jr(e,t){var r=void 0;if(e.length===4){r=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]}else if(e.length===7){r=e.slice(1)}else{throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.")}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+t+")"}function Qr(e,t,r){try{e.style[t]=r}catch(e){return}}var $r=function(e){M(t,e);function t(r,i,n){U(this,t);var a=N(this,e.call(this,r,i,n));r.on("loadstart",tt(a,a.toggleDisplay));r.on("texttrackchange",tt(a,a.updateDisplay));r.on("loadstart",tt(a,a.preselectTrack));r.ready(tt(a,(function(){if(r.tech_&&r.tech_.featuresNativeTextTracks){this.hide();return}r.on("fullscreenchange",tt(this,this.updateDisplay));var e=this.options_.playerOptions.tracks||[];for(var t=0;t<e.length;t++){this.player_.addRemoteTextTrack(e[t],true)}this.preselectTrack()})));return a}t.prototype.preselectTrack=function e(){var t={captions:1,subtitles:1};var r=this.player_.textTracks();var i=this.player_.cache_.selectedLanguage;var n=void 0;var a=void 0;var s=void 0;for(var o=0;o<r.length;o++){var u=r[o];if(i&&i.enabled&&i.language===u.language){if(u.kind===i.kind){s=u}else if(!s){s=u}}else if(i&&!i.enabled){s=null;n=null;a=null}else if(u["default"]){if(u.kind==="descriptions"&&!n){n=u}else if(u.kind in t&&!a){a=u}}}if(s){s.mode="showing"}else if(a){a.mode="showing"}else if(n){n.mode="showing"}};t.prototype.toggleDisplay=function e(){if(this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks){this.hide()}else{this.show()}};t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})};t.prototype.clearDisplay=function e(){if(typeof n.WebVTT==="function"){n.WebVTT.processCues(n,[],this.el_)}};t.prototype.updateDisplay=function e(){var t=this.player_.textTracks();this.clearDisplay();var r=null;var i=null;var n=t.length;while(n--){var a=t[n];if(a.mode==="showing"){if(a.kind==="descriptions"){r=a}else{i=a}}}if(i){if(this.getAttribute("aria-live")!=="off"){this.setAttribute("aria-live","off")}this.updateForTrack(i)}else if(r){if(this.getAttribute("aria-live")!=="assertive"){this.setAttribute("aria-live","assertive")}this.updateForTrack(r)}};t.prototype.updateForTrack=function e(t){if(typeof n.WebVTT!=="function"||!t.activeCues){return}var r=[];for(var i=0;i<t.activeCues.length;i++){r.push(t.activeCues[i])}n.WebVTT.processCues(n,r,this.el_);if(!this.player_.textTrackSettings){return}var a=this.player_.textTrackSettings.getValues();var s=r.length;while(s--){var o=r[s];if(!o){continue}var u=o.displayState;if(a.color){u.firstChild.style.color=a.color}if(a.textOpacity){Qr(u.firstChild,"color",Jr(a.color||"#fff",a.textOpacity))}if(a.backgroundColor){u.firstChild.style.backgroundColor=a.backgroundColor}if(a.backgroundOpacity){Qr(u.firstChild,"backgroundColor",Jr(a.backgroundColor||"#000",a.backgroundOpacity))}if(a.windowColor){if(a.windowOpacity){Qr(u,"backgroundColor",Jr(a.windowColor,a.windowOpacity))}else{u.style.backgroundColor=a.windowColor}}if(a.edgeStyle){if(a.edgeStyle==="dropshadow"){u.firstChild.style.textShadow="2px 2px 3px "+Kr+", 2px 2px 4px "+Kr+", 2px 2px 5px "+Kr}else if(a.edgeStyle==="raised"){u.firstChild.style.textShadow="1px 1px "+Kr+", 2px 2px "+Kr+", 3px 3px "+Kr}else if(a.edgeStyle==="depressed"){u.firstChild.style.textShadow="1px 1px "+Yr+", 0 1px "+Yr+", -1px -1px "+Kr+", 0 -1px "+Kr}else if(a.edgeStyle==="uniform"){u.firstChild.style.textShadow="0 0 4px "+Kr+", 0 0 4px "+Kr+", 0 0 4px "+Kr+", 0 0 4px "+Kr}}if(a.fontPercent&&a.fontPercent!==1){var l=n.parseFloat(u.style.fontSize);u.style.fontSize=l*a.fontPercent+"px";u.style.height="auto";u.style.top="auto";u.style.bottom="2px"}if(a.fontFamily&&a.fontFamily!=="default"){if(a.fontFamily==="small-caps"){u.firstChild.style.fontVariant="small-caps"}else{u.firstChild.style.fontFamily=Xr[a.fontFamily]}}}};return t}(_t);_t.registerComponent("TextTrackDisplay",$r);var Zr=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(){var r=this.player_.isAudio();var i=this.localize(r?"Audio Player":"Video Player");var n=se("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[i])});var a=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});a.appendChild(n);return a};return t}(_t);_t.registerComponent("LoadingSpinner",Zr);var ei=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};t="button";r=G({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},r);i=G({type:"button"},i);var n=_t.prototype.createEl.call(this,t,r,i);this.createControlTextEl(n);return n};t.prototype.addChild=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.constructor.name;J.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead.");return _t.prototype.addChild.call(this,t,r)};t.prototype.enable=function t(){e.prototype.enable.call(this);this.el_.removeAttribute("disabled")};t.prototype.disable=function t(){e.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")};t.prototype.handleKeyPress=function t(r){if(r.which===32||r.which===13){return}e.prototype.handleKeyPress.call(this,r)};return t}(Wr);_t.registerComponent("Button",ei);var ti=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.mouseused_=false;n.on("mousedown",n.handleMouseDown);return n}t.prototype.buildCSSClass=function e(){return"vjs-big-play-button"};t.prototype.handleClick=function e(t){var r=this.player_.play();if(this.mouseused_&&t.clientX&&t.clientY){Pt(r);return}var i=this.player_.getChild("controlBar");var n=i&&i.getChild("playToggle");if(!n){this.player_.focus();return}var a=function e(){return n.focus()};if(Rt(r)){r.then(a,(function(){}))}else{this.setTimeout(a,1)}};t.prototype.handleKeyPress=function t(r){this.mouseused_=false;e.prototype.handleKeyPress.call(this,r)};t.prototype.handleMouseDown=function e(t){this.mouseused_=true};return t}(ei);ti.prototype.controlText_="Play Video";_t.registerComponent("BigPlayButton",ti);var ri=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.controlText(i&&i.controlText||n.localize("Close"));return n}t.prototype.buildCSSClass=function t(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)};t.prototype.handleClick=function e(t){this.trigger({type:"close",bubbles:false})};return t}(ei);_t.registerComponent("CloseButton",ri);var ii=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on(r,"play",n.handlePlay);n.on(r,"pause",n.handlePause);n.on(r,"ended",n.handleEnded);return n}t.prototype.buildCSSClass=function t(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)};t.prototype.handleClick=function e(t){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};t.prototype.handleSeeked=function e(t){this.removeClass("vjs-ended");if(this.player_.paused()){this.handlePause(t)}else{this.handlePlay(t)}};t.prototype.handlePlay=function e(t){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};t.prototype.handlePause=function e(t){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};t.prototype.handleEnded=function e(t){this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",this.handleSeeked)};return t}(ei);ii.prototype.controlText_="Play";_t.registerComponent("PlayToggle",ii);var ni=function e(t,r){t=t<0?0:t;var i=Math.floor(t%60);var n=Math.floor(t/60%60);var a=Math.floor(t/3600);var s=Math.floor(r/60%60);var o=Math.floor(r/3600);if(isNaN(t)||t===Infinity){a=n=i="-"}a=a>0||o>0?a+":":"";n=((a||s>=10)&&n<10?"0"+n:n)+":";i=i<10?"0"+i:i;return a+n+i};var ai=ni;function si(e){ai=e}function oi(){ai=ni}var ui=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;return ai(e,t)};var li=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.throttledUpdateContent=rt(tt(n,n.updateContent),25);n.on(r,"timeupdate",n.throttledUpdateContent);return n}t.prototype.createEl=function t(r){var i=this.buildCSSClass();var n=e.prototype.createEl.call(this,"div",{className:i+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text">'+this.localize(this.labelText_)+" </span>"});this.contentEl_=se("span",{className:i+"-display"},{"aria-live":"off"});this.updateTextNode_();n.appendChild(this.contentEl_);return n};t.prototype.dispose=function t(){this.contentEl_=null;this.textNode_=null;e.prototype.dispose.call(this)};t.prototype.updateTextNode_=function e(){if(!this.contentEl_){return}while(this.contentEl_.firstChild){this.contentEl_.removeChild(this.contentEl_.firstChild)}this.textNode_=a.createTextNode(this.formattedTime_||this.formatTime_(0));this.contentEl_.appendChild(this.textNode_)};t.prototype.formatTime_=function e(t){return ui(t)};t.prototype.updateFormattedTime_=function e(t){var r=this.formatTime_(t);if(r===this.formattedTime_){return}this.formattedTime_=r;this.requestAnimationFrame(this.updateTextNode_)};t.prototype.updateContent=function e(t){};return t}(_t);li.prototype.labelText_="Time";li.prototype.controlText_="Time";_t.registerComponent("TimeDisplay",li);var di=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on(r,"ended",n.handleEnded);return n}t.prototype.buildCSSClass=function e(){return"vjs-current-time"};t.prototype.updateContent=function e(t){var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(r)};t.prototype.handleEnded=function e(t){if(!this.player_.duration()){return}this.updateFormattedTime_(this.player_.duration())};return t}(li);di.prototype.labelText_="Current Time";di.prototype.controlText_="Current Time";_t.registerComponent("CurrentTimeDisplay",di);var fi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on(r,"durationchange",n.updateContent);n.on(r,"loadedmetadata",n.throttledUpdateContent);return n}t.prototype.buildCSSClass=function e(){return"vjs-duration"};t.prototype.updateContent=function e(t){var r=this.player_.duration();if(r&&this.duration_!==r){this.duration_=r;this.updateFormattedTime_(r)}};return t}(li);fi.prototype.labelText_="Duration";fi.prototype.controlText_="Duration";_t.registerComponent("DurationDisplay",fi);var ci=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})};return t}(_t);_t.registerComponent("TimeDivider",ci);var hi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on(r,"durationchange",n.throttledUpdateContent);n.on(r,"ended",n.handleEnded);return n}t.prototype.buildCSSClass=function e(){return"vjs-remaining-time"};t.prototype.formatTime_=function t(r){return"-"+e.prototype.formatTime_.call(this,r)};t.prototype.updateContent=function e(t){if(!this.player_.duration()){return}if(this.player_.remainingTimeDisplay){this.updateFormattedTime_(this.player_.remainingTimeDisplay())}else{this.updateFormattedTime_(this.player_.remainingTime())}};t.prototype.handleEnded=function e(t){if(!this.player_.duration()){return}this.updateFormattedTime_(0)};return t}(li);hi.prototype.labelText_="Remaining Time";hi.prototype.controlText_="Remaining Time";_t.registerComponent("RemainingTimeDisplay",hi);var pi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.updateShowing();n.on(n.player(),"durationchange",n.updateShowing);return n}t.prototype.createEl=function t(){var r=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=se("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"});r.appendChild(this.contentEl_);return r};t.prototype.dispose=function t(){this.contentEl_=null;e.prototype.dispose.call(this)};t.prototype.updateShowing=function e(t){if(this.player().duration()===Infinity){this.show()}else{this.hide()}};return t}(_t);_t.registerComponent("LiveDisplay",pi);var vi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.bar=n.getChild(n.options_.barName);n.vertical(!!n.options_.vertical);n.enable();return n}t.prototype.enabled=function e(){return this.enabled_};t.prototype.enable=function e(){if(this.enabled()){return}this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);this.on("click",this.handleClick);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent){this.on(this.player_,this.playerEvent,this.update)}this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=true};t.prototype.disable=function e(){if(!this.enabled()){return}var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown);this.off("touchstart",this.handleMouseDown);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur);this.off("click",this.handleClick);this.off(this.player_,"controlsvisible",this.update);this.off(t,"mousemove",this.handleMouseMove);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchmove",this.handleMouseMove);this.off(t,"touchend",this.handleMouseUp);this.removeAttribute("tabindex");this.addClass("disabled");if(this.playerEvent){this.off(this.player_,this.playerEvent,this.update)}this.enabled_=false};t.prototype.createEl=function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};i.className=i.className+" vjs-slider";i=G({tabIndex:0},i);n=G({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n);return e.prototype.createEl.call(this,r,i,n)};t.prototype.handleMouseDown=function e(t){var r=this.bar.el_.ownerDocument;if(t.type==="mousedown"){t.preventDefault()}if(t.type==="touchstart"&&!k){t.preventDefault()}ye();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(r,"mousemove",this.handleMouseMove);this.on(r,"mouseup",this.handleMouseUp);this.on(r,"touchmove",this.handleMouseMove);this.on(r,"touchend",this.handleMouseUp);this.handleMouseMove(t)};t.prototype.handleMouseMove=function e(t){};t.prototype.handleMouseUp=function e(){var t=this.bar.el_.ownerDocument;_e();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(t,"mousemove",this.handleMouseMove);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchmove",this.handleMouseMove);this.off(t,"touchend",this.handleMouseUp);this.update()};t.prototype.update=function e(){if(!this.el_){return}var t=this.getPercent();var r=this.bar;if(!r){return}if(typeof t!=="number"||t!==t||t<0||t===Infinity){t=0}var i=(t*100).toFixed(2)+"%";var n=r.el().style;if(this.vertical()){n.height=i}else{n.width=i}return t};t.prototype.calculateDistance=function e(t){var r=Se(this.el_,t);if(this.vertical()){return r.y}return r.x};t.prototype.handleFocus=function e(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};t.prototype.handleKeyPress=function e(t){if(t.which===37||t.which===40){t.preventDefault();this.stepBack()}else if(t.which===38||t.which===39){t.preventDefault();this.stepForward()}};t.prototype.handleBlur=function e(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};t.prototype.handleClick=function e(t){t.stopImmediatePropagation();t.preventDefault()};t.prototype.vertical=function e(t){if(t===undefined){return this.vertical_||false}this.vertical_=!!t;if(this.vertical_){this.addClass("vjs-slider-vertical")}else{this.addClass("vjs-slider-horizontal")}};return t}(_t);_t.registerComponent("Slider",vi);var mi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.partEls_=[];n.on(r,"progress",n.update);return n}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})};t.prototype.dispose=function t(){this.partEls_=null;e.prototype.dispose.call(this)};t.prototype.update=function e(t){var r=this.player_.buffered();var i=this.player_.duration();var n=this.player_.bufferedEnd();var a=this.partEls_;var s=function e(t,r){var i=t/r||0;return(i>=1?1:i)*100+"%"};this.el_.style.width=s(n,i);for(var o=0;o<r.length;o++){var u=r.start(o);var l=r.end(o);var d=a[o];if(!d){d=this.el_.appendChild(se());a[o]=d}d.style.left=s(u,n);d.style.width=s(l-u,n)}for(var f=a.length;f>r.length;f--){this.el_.removeChild(a[f-1])}a.length=r.length};return t}(_t);_t.registerComponent("LoadProgressBar",mi);var gi=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})};t.prototype.update=function e(t,r,i){var n=be(this.el_);var a=be(this.player_.el());var s=t.width*r;if(!a||!n){return}var o=t.left-a.left+s;var u=t.width-s+(a.right-t.right);var l=n.width/2;if(o<l){l+=l-o}else if(u<l){l=u}if(l<0){l=0}else if(l>n.width){l=n.width}this.el_.style.right="-"+l+"px";oe(this.el_,i)};return t}(_t);_t.registerComponent("TimeTooltip",gi);var yi=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})};t.prototype.update=function e(t,r){var i=this;if(this.rafId_){this.cancelAnimationFrame(this.rafId_)}this.rafId_=this.requestAnimationFrame((function(){var e=i.player_.scrubbing()?i.player_.getCache().currentTime:i.player_.currentTime();var n=ui(e,i.player_.duration());var a=i.getChild("timeTooltip");if(a){a.update(t,r,n)}}))};return t}(_t);yi.prototype.options_={children:[]};if((!L||L>8)&&!g&&!_){yi.prototype.options_.children.push("timeTooltip")}_t.registerComponent("PlayProgressBar",yi);var _i=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.update=rt(tt(n,n.update),25);return n}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})};t.prototype.update=function e(t,r){var i=this;if(this.rafId_){this.cancelAnimationFrame(this.rafId_)}this.rafId_=this.requestAnimationFrame((function(){var e=i.player_.duration();var n=ui(r*e,e);i.el_.style.left=t.width*r+"px";i.getChild("timeTooltip").update(t,r,n)}))};return t}(_t);_i.prototype.options_={children:["timeTooltip"]};_t.registerComponent("MouseTimeDisplay",_i);var bi=5;var Ti=30;var Si=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.setEventHandlers_();return n}t.prototype.setEventHandlers_=function e(){var t=this;this.update=rt(tt(this,this.update),Ti);this.on(this.player_,"timeupdate",this.update);this.on(this.player_,"ended",this.handleEnded);this.updateInterval=null;this.on(this.player_,["playing"],(function(){t.clearInterval(t.updateInterval);t.updateInterval=t.setInterval((function(){t.requestAnimationFrame((function(){t.update()}))}),Ti)}));this.on(this.player_,["ended","pause","waiting"],(function(){t.clearInterval(t.updateInterval)}));this.on(this.player_,["timeupdate","ended"],this.update)};t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})};t.prototype.update_=function e(t,r){var i=this.player_.duration();this.el_.setAttribute("aria-valuenow",(r*100).toFixed(2));this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[ui(t,i),ui(i,i)],"{1} of {2}"));this.bar.update(be(this.el_),r)};t.prototype.update=function t(r){var i=e.prototype.update.call(this);this.update_(this.getCurrentTime_(),i);return i};t.prototype.getCurrentTime_=function e(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()};t.prototype.handleEnded=function e(t){this.update_(this.player_.duration(),1)};t.prototype.getPercent=function e(){var t=this.getCurrentTime_()/this.player_.duration();return t>=1?1:t};t.prototype.handleMouseDown=function t(r){if(!Le(r)){return}r.stopPropagation();this.player_.scrubbing(true);this.videoWasPlaying=!this.player_.paused();this.player_.pause();e.prototype.handleMouseDown.call(this,r)};t.prototype.handleMouseMove=function e(t){if(!Le(t)){return}var r=this.calculateDistance(t)*this.player_.duration();if(r===this.player_.duration()){r=r-.1}this.player_.currentTime(r)};t.prototype.enable=function t(){e.prototype.enable.call(this);var r=this.getChild("mouseTimeDisplay");if(!r){return}r.show()};t.prototype.disable=function t(){e.prototype.disable.call(this);var r=this.getChild("mouseTimeDisplay");if(!r){return}r.hide()};t.prototype.handleMouseUp=function t(r){e.prototype.handleMouseUp.call(this,r);if(r){r.stopPropagation()}this.player_.scrubbing(false);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:true});if(this.videoWasPlaying){Pt(this.player_.play())}};t.prototype.stepForward=function e(){this.player_.currentTime(this.player_.currentTime()+bi)};t.prototype.stepBack=function e(){this.player_.currentTime(this.player_.currentTime()-bi)};t.prototype.handleAction=function e(t){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};t.prototype.handleKeyPress=function t(r){if(r.which===32||r.which===13){r.preventDefault();this.handleAction(r)}else if(e.prototype.handleKeyPress){e.prototype.handleKeyPress.call(this,r)}};return t}(vi);Si.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};if((!L||L>8)&&!g&&!_){Si.prototype.options_.children.splice(1,0,"mouseTimeDisplay")}Si.prototype.playerEvent="timeupdate";_t.registerComponent("SeekBar",Si);var Ei=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.handleMouseMove=rt(tt(n,n.handleMouseMove),25);n.throttledHandleMouseSeek=rt(tt(n,n.handleMouseSeek),25);n.enable();return n}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};t.prototype.handleMouseMove=function e(t){var r=this.getChild("seekBar");if(r){var i=r.getChild("mouseTimeDisplay");var n=r.el();var a=be(n);var s=Se(n,t).x;if(s>1){s=1}else if(s<0){s=0}if(i){i.update(a,s)}}};t.prototype.handleMouseSeek=function e(t){var r=this.getChild("seekBar");if(r){r.handleMouseMove(t)}};t.prototype.enabled=function e(){return this.enabled_};t.prototype.disable=function e(){this.children().forEach((function(e){return e.disable&&e.disable()}));if(!this.enabled()){return}this.off(["mousedown","touchstart"],this.handleMouseDown);this.off(this.el_,"mousemove",this.handleMouseMove);this.handleMouseUp();this.addClass("disabled");this.enabled_=false};t.prototype.enable=function e(){this.children().forEach((function(e){return e.enable&&e.enable()}));if(this.enabled()){return}this.on(["mousedown","touchstart"],this.handleMouseDown);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=true};t.prototype.handleMouseDown=function e(t){var r=this.el_.ownerDocument;var i=this.getChild("seekBar");if(i){i.handleMouseDown(t)}this.on(r,"mousemove",this.throttledHandleMouseSeek);this.on(r,"touchmove",this.throttledHandleMouseSeek);this.on(r,"mouseup",this.handleMouseUp);this.on(r,"touchend",this.handleMouseUp)};t.prototype.handleMouseUp=function e(t){var r=this.el_.ownerDocument;var i=this.getChild("seekBar");if(i){i.handleMouseUp(t)}this.off(r,"mousemove",this.throttledHandleMouseSeek);this.off(r,"touchmove",this.throttledHandleMouseSeek);this.off(r,"mouseup",this.handleMouseUp);this.off(r,"touchend",this.handleMouseUp)};return t}(_t);Ei.prototype.options_={children:["seekBar"]};_t.registerComponent("ProgressControl",Ei);var wi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on(r,"fullscreenchange",n.handleFullscreenChange);if(a[kt.fullscreenEnabled]===false){n.disable()}return n}t.prototype.buildCSSClass=function t(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)};t.prototype.handleFullscreenChange=function e(t){if(this.player_.isFullscreen()){this.controlText("Non-Fullscreen")}else{this.controlText("Fullscreen")}};t.prototype.handleClick=function e(t){if(!this.player_.isFullscreen()){this.player_.requestFullscreen()}else{this.player_.exitFullscreen()}};return t}(ei);wi.prototype.controlText_="Fullscreen";_t.registerComponent("FullscreenToggle",wi);var ki=function e(t,r){if(r.tech_&&!r.tech_.featuresVolumeControl){t.addClass("vjs-hidden")}t.on(r,"loadstart",(function(){if(!r.tech_.featuresVolumeControl){t.addClass("vjs-hidden")}else{t.removeClass("vjs-hidden")}}))};var Ai=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})};return t}(_t);_t.registerComponent("VolumeLevel",Ai);var Ci=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on("slideractive",n.updateLastVolume_);n.on(r,"volumechange",n.updateARIAAttributes);r.ready((function(){return n.updateARIAAttributes()}));return n}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})};t.prototype.handleMouseDown=function t(r){if(!Le(r)){return}e.prototype.handleMouseDown.call(this,r)};t.prototype.handleMouseMove=function e(t){if(!Le(t)){return}this.checkMuted();this.player_.volume(this.calculateDistance(t))};t.prototype.checkMuted=function e(){if(this.player_.muted()){this.player_.muted(false)}};t.prototype.getPercent=function e(){if(this.player_.muted()){return 0}return this.player_.volume()};t.prototype.stepForward=function e(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};t.prototype.stepBack=function e(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};t.prototype.updateARIAAttributes=function e(t){var r=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",r);this.el_.setAttribute("aria-valuetext",r+"%")};t.prototype.volumeAsPercentage_=function e(){return Math.round(this.player_.volume()*100)};t.prototype.updateLastVolume_=function e(){var t=this;var r=this.player_.volume();this.one("sliderinactive",(function(){if(t.player_.volume()===0){t.player_.lastVolume_(r)}}))};return t}(vi);Ci.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};Ci.prototype.playerEvent="volumechange";_t.registerComponent("VolumeBar",Ci);var Li=function(e){M(t,e);function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};U(this,t);i.vertical=i.vertical||false;if(typeof i.volumeBar==="undefined"||W(i.volumeBar)){i.volumeBar=i.volumeBar||{};i.volumeBar.vertical=i.vertical}var n=N(this,e.call(this,r,i));ki(n,r);n.throttledHandleMouseMove=rt(tt(n,n.handleMouseMove),25);n.on("mousedown",n.handleMouseDown);n.on("touchstart",n.handleMouseDown);n.on(n.volumeBar,["focus","slideractive"],(function(){n.volumeBar.addClass("vjs-slider-active");n.addClass("vjs-slider-active");n.trigger("slideractive")}));n.on(n.volumeBar,["blur","sliderinactive"],(function(){n.volumeBar.removeClass("vjs-slider-active");n.removeClass("vjs-slider-active");n.trigger("sliderinactive")}));return n}t.prototype.createEl=function t(){var r="vjs-volume-horizontal";if(this.options_.vertical){r="vjs-volume-vertical"}return e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+r})};t.prototype.handleMouseDown=function e(t){var r=this.el_.ownerDocument;this.on(r,"mousemove",this.throttledHandleMouseMove);this.on(r,"touchmove",this.throttledHandleMouseMove);this.on(r,"mouseup",this.handleMouseUp);this.on(r,"touchend",this.handleMouseUp)};t.prototype.handleMouseUp=function e(t){var r=this.el_.ownerDocument;this.off(r,"mousemove",this.throttledHandleMouseMove);this.off(r,"touchmove",this.throttledHandleMouseMove);this.off(r,"mouseup",this.handleMouseUp);this.off(r,"touchend",this.handleMouseUp)};t.prototype.handleMouseMove=function e(t){this.volumeBar.handleMouseMove(t)};return t}(_t);Li.prototype.options_={children:["volumeBar"]};_t.registerComponent("VolumeControl",Li);var xi=function e(t,r){if(r.tech_&&!r.tech_.featuresMuteControl){t.addClass("vjs-hidden")}t.on(r,"loadstart",(function(){if(!r.tech_.featuresMuteControl){t.addClass("vjs-hidden")}else{t.removeClass("vjs-hidden")}}))};var Di=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));xi(n,r);n.on(r,["loadstart","volumechange"],n.update);return n}t.prototype.buildCSSClass=function t(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)};t.prototype.handleClick=function e(t){var r=this.player_.volume();var i=this.player_.lastVolume_();if(r===0){var n=i<.1?.1:i;this.player_.volume(n);this.player_.muted(false)}else{this.player_.muted(this.player_.muted()?false:true)}};t.prototype.update=function e(t){this.updateIcon_();this.updateControlText_()};t.prototype.updateIcon_=function e(){var t=this.player_.volume();var r=3;if(g){this.player_.muted(this.player_.tech_.el_.muted)}if(t===0||this.player_.muted()){r=0}else if(t<.33){r=1}else if(t<.67){r=2}for(var i=0;i<4;i++){fe(this.el_,"vjs-vol-"+i)}de(this.el_,"vjs-vol-"+r)};t.prototype.updateControlText_=function e(){var t=this.player_.muted()||this.player_.volume()===0;var r=t?"Unmute":"Mute";if(this.controlText()!==r){this.controlText(r)}};return t}(ei);Di.prototype.controlText_="Mute";_t.registerComponent("MuteToggle",Di);var Ii=function(e){M(t,e);function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};U(this,t);if(typeof i.inline!=="undefined"){i.inline=i.inline}else{i.inline=true}if(typeof i.volumeControl==="undefined"||W(i.volumeControl)){i.volumeControl=i.volumeControl||{};i.volumeControl.vertical=!i.inline}var n=N(this,e.call(this,r,i));n.on(r,["loadstart"],n.volumePanelState_);n.on(n.volumeControl,["slideractive"],n.sliderActive_);n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_);return n}t.prototype.sliderActive_=function e(){this.addClass("vjs-slider-active")};t.prototype.sliderInactive_=function e(){this.removeClass("vjs-slider-active")};t.prototype.volumePanelState_=function e(){if(this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-hidden")}if(this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")){this.addClass("vjs-mute-toggle-only")}};t.prototype.createEl=function t(){var r="vjs-volume-panel-horizontal";if(!this.options_.inline){r="vjs-volume-panel-vertical"}return e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+r})};return t}(_t);Ii.prototype.options_={children:["muteToggle","volumeControl"]};_t.registerComponent("VolumePanel",Ii);var Oi=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));if(i){n.menuButton_=i.menuButton}n.focusedChild_=-1;n.on("keydown",n.handleKeyPress);return n}t.prototype.addItem=function e(t){this.addChild(t);t.on("click",tt(this,(function(e){if(this.menuButton_){this.menuButton_.unpressButton();if(t.name()!=="CaptionSettingsMenuItem"){this.menuButton_.focus()}}})))};t.prototype.createEl=function t(){var r=this.options_.contentElType||"ul";this.contentEl_=se(r,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var i=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});i.appendChild(this.contentEl_);Ve(i,"click",(function(e){e.preventDefault();e.stopImmediatePropagation()}));return i};t.prototype.dispose=function t(){this.contentEl_=null;e.prototype.dispose.call(this)};t.prototype.handleKeyPress=function e(t){if(t.which===37||t.which===40){t.preventDefault();this.stepForward()}else if(t.which===38||t.which===39){t.preventDefault();this.stepBack()}};t.prototype.stepForward=function e(){var t=0;if(this.focusedChild_!==undefined){t=this.focusedChild_+1}this.focus(t)};t.prototype.stepBack=function e(){var t=0;if(this.focusedChild_!==undefined){t=this.focusedChild_-1}this.focus(t)};t.prototype.focus=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var r=this.children().slice();var i=r.length&&r[0].className&&/vjs-menu-title/.test(r[0].className);if(i){r.shift()}if(r.length>0){if(t<0){t=0}else if(t>=r.length){t=r.length-1}this.focusedChild_=t;r[t].el_.focus()}};return t}(_t);_t.registerComponent("Menu",Oi);var Ri=function(e){M(t,e);function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};U(this,t);var n=N(this,e.call(this,r,i));n.menuButton_=new ei(r,i);n.menuButton_.controlText(n.controlText_);n.menuButton_.el_.setAttribute("aria-haspopup","true");var a=ei.prototype.buildCSSClass();n.menuButton_.el_.className=n.buildCSSClass()+" "+a;n.menuButton_.removeClass("vjs-control");n.addChild(n.menuButton_);n.update();n.enabled_=true;n.on(n.menuButton_,"tap",n.handleClick);n.on(n.menuButton_,"click",n.handleClick);n.on(n.menuButton_,"focus",n.handleFocus);n.on(n.menuButton_,"blur",n.handleBlur);n.on("keydown",n.handleSubmenuKeyPress);return n}t.prototype.update=function e(){var t=this.createMenu();if(this.menu){this.menu.dispose();this.removeChild(this.menu)}this.menu=t;this.addChild(t);this.buttonPressed_=false;this.menuButton_.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length<=this.hideThreshold_){this.hide()}else{this.show()}};t.prototype.createMenu=function e(){var t=new Oi(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var r=se("li",{className:"vjs-menu-title",innerHTML:mt(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;t.children_.unshift(r);ue(r,t.contentEl())}this.items=this.createItems();if(this.items){for(var i=0;i<this.items.length;i++){t.addItem(this.items[i])}}return t};t.prototype.createItems=function e(){};t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})};t.prototype.buildWrapperCSSClass=function t(){var r="vjs-menu-button";if(this.options_.inline===true){r+="-inline"}else{r+="-popup"}var i=ei.prototype.buildCSSClass();return"vjs-menu-button "+r+" "+i+" "+e.prototype.buildCSSClass.call(this)};t.prototype.buildCSSClass=function t(){var r="vjs-menu-button";if(this.options_.inline===true){r+="-inline"}else{r+="-popup"}return"vjs-menu-button "+r+" "+e.prototype.buildCSSClass.call(this)};t.prototype.controlText=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(t,r)};t.prototype.handleClick=function e(t){this.one(this.menu.contentEl(),"mouseleave",tt(this,(function(e){this.unpressButton();this.el_.blur()})));if(this.buttonPressed_){this.unpressButton()}else{this.pressButton()}};t.prototype.focus=function e(){this.menuButton_.focus()};t.prototype.blur=function e(){this.menuButton_.blur()};t.prototype.handleFocus=function e(){Ve(a,"keydown",tt(this,this.handleKeyPress))};t.prototype.handleBlur=function e(){We(a,"keydown",tt(this,this.handleKeyPress))};t.prototype.handleKeyPress=function e(t){if(t.which===27||t.which===9){if(this.buttonPressed_){this.unpressButton()}if(t.which!==9){t.preventDefault();this.menuButton_.el_.focus()}}else if(t.which===38||t.which===40){if(!this.buttonPressed_){this.pressButton();t.preventDefault()}}};t.prototype.handleSubmenuKeyPress=function e(t){if(t.which===27||t.which===9){if(this.buttonPressed_){this.unpressButton()}if(t.which!==9){t.preventDefault();this.menuButton_.el_.focus()}}};t.prototype.pressButton=function e(){if(this.enabled_){this.buttonPressed_=true;this.menu.lockShowing();this.menuButton_.el_.setAttribute("aria-expanded","true");if(g&&ne()){return}this.menu.focus()}};t.prototype.unpressButton=function e(){if(this.enabled_){this.buttonPressed_=false;this.menu.unlockShowing();this.menuButton_.el_.setAttribute("aria-expanded","false")}};t.prototype.disable=function e(){this.unpressButton();this.enabled_=false;this.addClass("vjs-disabled");this.menuButton_.disable()};t.prototype.enable=function e(){this.enabled_=true;this.removeClass("vjs-disabled");this.menuButton_.enable()};return t}(_t);_t.registerComponent("MenuButton",Ri);var Pi=function(e){M(t,e);function t(r,i){U(this,t);var n=i.tracks;var a=N(this,e.call(this,r,i));if(a.items.length<=1){a.hide()}if(!n){return N(a)}var s=tt(a,a.update);n.addEventListener("removetrack",s);n.addEventListener("addtrack",s);a.player_.on("ready",s);a.player_.on("dispose",(function(){n.removeEventListener("removetrack",s);n.removeEventListener("addtrack",s)}));return a}return t}(Ri);_t.registerComponent("TrackButton",Pi);var Ui=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.selectable=i.selectable;n.isSelected_=i.selected||false;n.multiSelectable=i.multiSelectable;n.selected(n.isSelected_);if(n.selectable){if(n.multiSelectable){n.el_.setAttribute("role","menuitemcheckbox")}else{n.el_.setAttribute("role","menuitemradio")}}else{n.el_.setAttribute("role","menuitem")}return n}t.prototype.createEl=function t(r,i,n){this.nonIconControl=true;return e.prototype.createEl.call(this,"li",G({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},i),n)};t.prototype.handleClick=function e(t){this.selected(true)};t.prototype.selected=function e(t){if(this.selectable){if(t){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected");this.isSelected_=true}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText("");this.isSelected_=false}}};return t}(Wr);_t.registerComponent("MenuItem",Ui);var Mi=function(e){M(t,e);function t(r,i){U(this,t);var s=i.track;var o=r.textTracks();i.label=s.label||s.language||"Unknown";i.selected=s.mode==="showing";var u=N(this,e.call(this,r,i));u.track=s;var l=function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}u.handleTracksChange.apply(u,r)};var d=function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}u.handleSelectedLanguageChange.apply(u,r)};r.on(["loadstart","texttrackchange"],l);o.addEventListener("change",l);o.addEventListener("selectedlanguagechange",d);u.on("dispose",(function(){r.off(["loadstart","texttrackchange"],l);o.removeEventListener("change",l);o.removeEventListener("selectedlanguagechange",d)}));if(o.onchange===undefined){var f=void 0;u.on(["tap","click"],(function(){if(P(n.Event)!=="object"){try{f=new n.Event("change")}catch(e){}}if(!f){f=a.createEvent("Event");f.initEvent("change",true,true)}o.dispatchEvent(f)}))}u.handleTracksChange();return u}t.prototype.handleClick=function t(r){var i=this.track.kind;var n=this.track.kinds;var a=this.player_.textTracks();if(!n){n=[i]}e.prototype.handleClick.call(this,r);if(!a){return}for(var s=0;s<a.length;s++){var o=a[s];if(o===this.track&&n.indexOf(o.kind)>-1){if(o.mode!=="showing"){o.mode="showing"}}else if(o.mode!=="disabled"){o.mode="disabled"}}};t.prototype.handleTracksChange=function e(t){var r=this.track.mode==="showing";if(r!==this.isSelected_){this.selected(r)}};t.prototype.handleSelectedLanguageChange=function e(t){if(this.track.mode==="showing"){var r=this.player_.cache_.selectedLanguage;if(r&&r.enabled&&r.language===this.track.language&&r.kind!==this.track.kind){return}this.player_.cache_.selectedLanguage={enabled:true,language:this.track.language,kind:this.track.kind}}};t.prototype.dispose=function t(){this.track=null;e.prototype.dispose.call(this)};return t}(Ui);_t.registerComponent("TextTrackMenuItem",Mi);var Ni=function(e){M(t,e);function t(r,i){U(this,t);i.track={player:r,kind:i.kind,kinds:i.kinds,default:false,mode:"disabled"};if(!i.kinds){i.kinds=[i.kind]}if(i.label){i.track.label=i.label}else{i.track.label=i.kinds.join(" and ")+" off"}i.selectable=true;i.multiSelectable=false;return N(this,e.call(this,r,i))}t.prototype.handleTracksChange=function e(t){var r=this.player().textTracks();var i=true;for(var n=0,a=r.length;n<a;n++){var s=r[n];if(this.options_.kinds.indexOf(s.kind)>-1&&s.mode==="showing"){i=false;break}}if(i!==this.isSelected_){this.selected(i)}};t.prototype.handleSelectedLanguageChange=function e(t){var r=this.player().textTracks();var i=true;for(var n=0,a=r.length;n<a;n++){var s=r[n];if(["captions","descriptions","subtitles"].indexOf(s.kind)>-1&&s.mode==="showing"){i=false;break}}if(i){this.player_.cache_.selectedLanguage={enabled:false}}};return t}(Mi);_t.registerComponent("OffTextTrackMenuItem",Ni);var ji=function(e){M(t,e);function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};U(this,t);i.tracks=r.textTracks();return N(this,e.call(this,r,i))}t.prototype.createItems=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Mi;var i=void 0;if(this.label_){i=this.label_+" off"}t.push(new Ni(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i}));this.hideThreshold_+=1;var n=this.player_.textTracks();if(!Array.isArray(this.kinds_)){this.kinds_=[this.kind_]}for(var a=0;a<n.length;a++){var s=n[a];if(this.kinds_.indexOf(s.kind)>-1){var o=new r(this.player_,{track:s,selectable:true,multiSelectable:false});o.addClass("vjs-"+s.kind+"-menu-item");t.push(o)}}return t};return t}(Pi);_t.registerComponent("TextTrackButton",ji);var Bi=function(e){M(t,e);function t(r,i){U(this,t);var n=i.track;var a=i.cue;var s=r.currentTime();i.selectable=true;i.multiSelectable=false;i.label=a.text;i.selected=a.startTime<=s&&s<a.endTime;var o=N(this,e.call(this,r,i));o.track=n;o.cue=a;n.addEventListener("cuechange",tt(o,o.update));return o}t.prototype.handleClick=function t(r){e.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};t.prototype.update=function e(t){var r=this.cue;var i=this.player_.currentTime();this.selected(r.startTime<=i&&i<r.endTime)};return t}(Ui);_t.registerComponent("ChaptersTrackMenuItem",Bi);var Fi=function(e){M(t,e);function t(r,i,n){U(this,t);return N(this,e.call(this,r,i,n))}t.prototype.buildCSSClass=function t(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)};t.prototype.update=function t(r){if(!this.track_||r&&(r.type==="addtrack"||r.type==="removetrack")){this.setTrack(this.findChaptersTrack())}e.prototype.update.call(this)};t.prototype.setTrack=function e(t){if(this.track_===t){return}if(!this.updateHandler_){this.updateHandler_=this.update.bind(this)}if(this.track_){var r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(r){r.removeEventListener("load",this.updateHandler_)}this.track_=null}this.track_=t;if(this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(i){i.addEventListener("load",this.updateHandler_)}}};t.prototype.findChaptersTrack=function e(){var t=this.player_.textTracks()||[];for(var r=t.length-1;r>=0;r--){var i=t[r];if(i.kind===this.kind_){return i}}};t.prototype.getMenuCaption=function e(){if(this.track_&&this.track_.label){return this.track_.label}return this.localize(mt(this.kind_))};t.prototype.createMenu=function t(){this.options_.title=this.getMenuCaption();return e.prototype.createMenu.call(this)};t.prototype.createItems=function e(){var t=[];if(!this.track_){return t}var r=this.track_.cues;if(!r){return t}for(var i=0,n=r.length;i<n;i++){var a=r[i];var s=new Bi(this.player_,{track:this.track_,cue:a});t.push(s)}return t};return t}(ji);Fi.prototype.kind_="chapters";Fi.prototype.controlText_="Chapters";_t.registerComponent("ChaptersButton",Fi);var Hi=function(e){M(t,e);function t(r,i,n){U(this,t);var a=N(this,e.call(this,r,i,n));var s=r.textTracks();var o=tt(a,a.handleTracksChange);s.addEventListener("change",o);a.on("dispose",(function(){s.removeEventListener("change",o)}));return a}t.prototype.handleTracksChange=function e(t){var r=this.player().textTracks();var i=false;for(var n=0,a=r.length;n<a;n++){var s=r[n];if(s.kind!==this.kind_&&s.mode==="showing"){i=true;break}}if(i){this.disable()}else{this.enable()}};t.prototype.buildCSSClass=function t(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(ji);Hi.prototype.kind_="descriptions";Hi.prototype.controlText_="Descriptions";_t.registerComponent("DescriptionsButton",Hi);var qi=function(e){M(t,e);function t(r,i,n){U(this,t);return N(this,e.call(this,r,i,n))}t.prototype.buildCSSClass=function t(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)};return t}(ji);qi.prototype.kind_="subtitles";qi.prototype.controlText_="Subtitles";_t.registerComponent("SubtitlesButton",qi);var Gi=function(e){M(t,e);function t(r,i){U(this,t);i.track={player:r,kind:i.kind,label:i.kind+" settings",selectable:false,default:false,mode:"disabled"};i.selectable=false;i.name="CaptionSettingsMenuItem";var n=N(this,e.call(this,r,i));n.addClass("vjs-texttrack-settings");n.controlText(", opens "+i.kind+" settings dialog");return n}t.prototype.handleClick=function e(t){this.player().getChild("textTrackSettings").open()};return t}(Mi);_t.registerComponent("CaptionSettingsMenuItem",Gi);var Vi=function(e){M(t,e);function t(r,i,n){U(this,t);return N(this,e.call(this,r,i,n))}t.prototype.buildCSSClass=function t(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)};t.prototype.createItems=function t(){var r=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){r.push(new Gi(this.player_,{kind:this.kind_}));this.hideThreshold_+=1}return e.prototype.createItems.call(this,r)};return t}(ji);Vi.prototype.kind_="captions";Vi.prototype.controlText_="Captions";_t.registerComponent("CaptionsButton",Vi);var Wi=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(r,i,n){var a='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);if(this.options_.track.kind==="captions"){a+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "}a+="</span>";var s=e.prototype.createEl.call(this,r,G({innerHTML:a},i),n);return s};return t}(Mi);_t.registerComponent("SubsCapsMenuItem",Wi);var zi=function(e){M(t,e);function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};U(this,t);var n=N(this,e.call(this,r,i));n.label_="subtitles";if(["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)>-1){n.label_="captions"}n.menuButton_.controlText(mt(n.label_));return n}t.prototype.buildCSSClass=function t(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)};t.prototype.createItems=function t(){var r=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")){r.push(new Gi(this.player_,{kind:this.label_}));this.hideThreshold_+=1}r=e.prototype.createItems.call(this,r,Wi);return r};return t}(ji);zi.prototype.kinds_=["captions","subtitles"];zi.prototype.controlText_="Subtitles";_t.registerComponent("SubsCapsButton",zi);var Ki=function(e){M(t,e);function t(r,i){U(this,t);var n=i.track;var a=r.audioTracks();i.label=n.label||n.language||"Unknown";i.selected=n.enabled;var s=N(this,e.call(this,r,i));s.track=n;s.addClass("vjs-"+n.kind+"-menu-item");var o=function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}s.handleTracksChange.apply(s,r)};a.addEventListener("change",o);s.on("dispose",(function(){a.removeEventListener("change",o)}));return s}t.prototype.createEl=function t(r,i,n){var a='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);if(this.options_.track.kind==="main-desc"){a+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "}a+="</span>";var s=e.prototype.createEl.call(this,r,G({innerHTML:a},i),n);return s};t.prototype.handleClick=function t(r){var i=this.player_.audioTracks();e.prototype.handleClick.call(this,r);for(var n=0;n<i.length;n++){var a=i[n];a.enabled=a===this.track}};t.prototype.handleTracksChange=function e(t){this.selected(this.track.enabled)};return t}(Ui);_t.registerComponent("AudioTrackMenuItem",Ki);var Yi=function(e){M(t,e);function t(r){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};U(this,t);i.tracks=r.audioTracks();return N(this,e.call(this,r,i))}t.prototype.buildCSSClass=function t(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)};t.prototype.createItems=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.hideThreshold_=1;var r=this.player_.audioTracks();for(var i=0;i<r.length;i++){var n=r[i];t.push(new Ki(this.player_,{track:n,selectable:true,multiSelectable:false}))}return t};return t}(Pi);Yi.prototype.controlText_="Audio Track";_t.registerComponent("AudioTrackButton",Yi);var Xi=function(e){M(t,e);function t(r,i){U(this,t);var n=i.rate;var a=parseFloat(n,10);i.label=n;i.selected=a===1;i.selectable=true;i.multiSelectable=false;var s=N(this,e.call(this,r,i));s.label=n;s.rate=a;s.on(r,"ratechange",s.update);return s}t.prototype.handleClick=function t(r){e.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};t.prototype.update=function e(t){this.selected(this.player().playbackRate()===this.rate)};return t}(Ui);Xi.prototype.contentElType="button";_t.registerComponent("PlaybackRateMenuItem",Xi);var Ji=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.updateVisibility();n.updateLabel();n.on(r,"loadstart",n.updateVisibility);n.on(r,"ratechange",n.updateLabel);return n}t.prototype.createEl=function t(){var r=e.prototype.createEl.call(this);this.labelEl_=se("div",{className:"vjs-playback-rate-value",innerHTML:"1x"});r.appendChild(this.labelEl_);return r};t.prototype.dispose=function t(){this.labelEl_=null;e.prototype.dispose.call(this)};t.prototype.buildCSSClass=function t(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)};t.prototype.buildWrapperCSSClass=function t(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)};t.prototype.createMenu=function e(){var t=new Oi(this.player());var r=this.playbackRates();if(r){for(var i=r.length-1;i>=0;i--){t.addChild(new Xi(this.player(),{rate:r[i]+"x"}))}}return t};t.prototype.updateARIAAttributes=function e(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};t.prototype.handleClick=function e(t){var r=this.player().playbackRate();var i=this.playbackRates();var n=i[0];for(var a=0;a<i.length;a++){if(i[a]>r){n=i[a];break}}this.player().playbackRate(n)};t.prototype.playbackRates=function e(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates};t.prototype.playbackRateSupported=function e(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0};t.prototype.updateVisibility=function e(t){if(this.playbackRateSupported()){this.removeClass("vjs-hidden")}else{this.addClass("vjs-hidden")}};t.prototype.updateLabel=function e(t){if(this.playbackRateSupported()){this.labelEl_.innerHTML=this.player().playbackRate()+"x"}};return t}(Ri);Ji.prototype.controlText_="Playback Rate";_t.registerComponent("PlaybackRateMenuButton",Ji);var Qi=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.buildCSSClass=function t(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)};t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};return t}(_t);_t.registerComponent("Spacer",Qi);var $i=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.buildCSSClass=function t(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)};t.prototype.createEl=function t(){var r=e.prototype.createEl.call(this,{className:this.buildCSSClass()});r.innerHTML=" ";return r};return t}(Qi);_t.registerComponent("CustomControlSpacer",$i);var Zi=function(e){M(t,e);function t(){U(this,t);return N(this,e.apply(this,arguments))}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})};return t}(_t);Zi.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};_t.registerComponent("ControlBar",Zi);var en=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));n.on(r,"error",n.open);return n}t.prototype.buildCSSClass=function t(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)};t.prototype.content=function e(){var t=this.player().error();return t?this.localize(t.message):""};return t}(Ht);en.prototype.options_=yt(Ht.prototype.options_,{pauseOnOpen:false,fillAlways:true,temporary:false,uncloseable:true});_t.registerComponent("ErrorDisplay",en);var tn="vjs-text-track-settings";var rn=["#000","Black"];var nn=["#00F","Blue"];var an=["#0FF","Cyan"];var sn=["#0F0","Green"];var on=["#F0F","Magenta"];var un=["#F00","Red"];var ln=["#FFF","White"];var dn=["#FF0","Yellow"];var fn=["1","Opaque"];var cn=["0.5","Semi-Transparent"];var hn=["0","Transparent"];var pn={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[rn,ln,un,sn,nn,dn,on,an]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[fn,cn,hn]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[ln,rn,un,sn,nn,dn,on,an]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function e(t){return t==="1.00"?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[fn,cn]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[hn,cn,fn]}};pn.windowColor.options=pn.backgroundColor.options;function vn(e,t){if(t){e=t(e)}if(e&&e!=="none"){return e}}function mn(e,t){var r=e.options[e.options.selectedIndex].value;return vn(r,t)}function gn(e,t,r){if(!t){return}for(var i=0;i<e.options.length;i++){if(vn(e.options[i].value,r)===t){e.selectedIndex=i;break}}}var yn=function(e){M(t,e);function t(r,i){U(this,t);i.temporary=false;var n=N(this,e.call(this,r,i));n.updateDisplay=tt(n,n.updateDisplay);n.fill();n.hasBeenOpened_=n.hasBeenFilled_=true;n.endDialog=se("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")});n.el().appendChild(n.endDialog);n.setDefaults();if(i.persistTextTrackSettings===undefined){n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings}n.on(n.$(".vjs-done-button"),"click",(function(){n.saveSettings();n.close()}));n.on(n.$(".vjs-default-button"),"click",(function(){n.setDefaults();n.updateDisplay()}));H(pn,(function(e){n.on(n.$(e.selector),"change",n.updateDisplay)}));if(n.options_.persistTextTrackSettings){n.restoreSettings()}return n}t.prototype.dispose=function t(){this.endDialog=null;e.prototype.dispose.call(this)};t.prototype.createElSelect_=function e(t){var r=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"label";var a=pn[t];var s=a.id.replace("%s",this.id_);var o=[i,s].join(" ").trim();return["<"+n+' id="'+s+'" class="'+(n==="label"?"vjs-label":"")+'">',this.localize(a.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(a.options.map((function(e){var t=s+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',r.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")};t.prototype.createElFgColor_=function e(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")};t.prototype.createElBgColor_=function e(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")};t.prototype.createElWinColor_=function e(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")};t.prototype.createElColors_=function e(){return se("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})};t.prototype.createElFont_=function e(){return se("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})};t.prototype.createElControls_=function e(){var t=this.localize("restore all settings to the default values");return se("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})};t.prototype.content=function e(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]};t.prototype.label=function e(){return this.localize("Caption Settings Dialog")};t.prototype.description=function e(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")};t.prototype.buildCSSClass=function t(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"};t.prototype.getValues=function e(){var t=this;return q(pn,(function(e,r,i){var n=mn(t.$(r.selector),r.parser);if(n!==undefined){e[i]=n}return e}),{})};t.prototype.setValues=function e(t){var r=this;H(pn,(function(e,i){gn(r.$(e.selector),t[i],e.parser)}))};t.prototype.setDefaults=function e(){var t=this;H(pn,(function(e){var r=e.hasOwnProperty("default")?e["default"]:0;t.$(e.selector).selectedIndex=r}))};t.prototype.restoreSettings=function e(){var t=void 0;try{t=JSON.parse(n.localStorage.getItem(tn))}catch(e){J.warn(e)}if(t){this.setValues(t)}};t.prototype.saveSettings=function e(){if(!this.options_.persistTextTrackSettings){return}var t=this.getValues();try{if(Object.keys(t).length){n.localStorage.setItem(tn,JSON.stringify(t))}else{n.localStorage.removeItem(tn)}}catch(e){J.warn(e)}};t.prototype.updateDisplay=function e(){var t=this.player_.getChild("textTrackDisplay");if(t){t.updateDisplay()}};t.prototype.conditionalBlur_=function e(){this.previouslyActiveEl_=null;this.off(a,"keydown",this.handleKeyDown);var t=this.player_.controlBar;var r=t&&t.subsCapsButton;var i=t&&t.captionsButton;if(r){r.focus()}else if(i){i.focus()}};return t}(Ht);_t.registerComponent("TextTrackSettings",yn);var _n=function(e){M(t,e);function t(r,i){U(this,t);var a=i.ResizeObserver||n.ResizeObserver;if(i.ResizeObserver===null){a=false}var s=yt({createEl:!a},i);var o=N(this,e.call(this,r,s));o.ResizeObserver=i.ResizeObserver||n.ResizeObserver;o.loadListener_=null;o.resizeObserver_=null;o.debouncedHandler_=it((function(){o.resizeHandler()}),100,false,r);if(a){o.resizeObserver_=new o.ResizeObserver(o.debouncedHandler_);o.resizeObserver_.observe(r.el())}else{o.loadListener_=function(){if(o.el_.contentWindow){Ve(o.el_.contentWindow,"resize",o.debouncedHandler_)}o.off("load",o.loadListener_)};o.on("load",o.loadListener_)}return o}t.prototype.createEl=function t(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})};t.prototype.resizeHandler=function e(){this.player_.trigger("playerresize")};t.prototype.dispose=function e(){if(this.resizeObserver_){if(this.player_.el()){this.resizeObserver_.unobserve(this.player_.el())}this.resizeObserver_.disconnect()}if(this.el_&&this.el_.contentWindow){We(this.el_.contentWindow,"resize",this.debouncedHandler_)}if(this.loadListener_){this.off("load",this.loadListener_)}this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null};return t}(_t);_t.registerComponent("ResizeManager",_n);var bn=function e(t){var r=t.el();if(r.hasAttribute("src")){t.triggerSourceset(r.src);return true}var i=t.$$("source");var n=[];var a="";if(!i.length){return false}for(var s=0;s<i.length;s++){var o=i[s].src;if(o&&n.indexOf(o)===-1){n.push(o)}}if(!n.length){return false}if(n.length===1){a=n[0]}t.triggerSourceset(a);return true};var Tn={};if(!C){Tn=Object.defineProperty({},"innerHTML",{get:function e(){return this.cloneNode(true).innerHTML},set:function e(t){var r=a.createElement(this.nodeName.toLowerCase());r.innerHTML=t;var i=a.createDocumentFragment();while(r.childNodes.length){i.appendChild(r.childNodes[0])}this.innerText="";n.Element.prototype.appendChild.call(this,i);return this.innerHTML}})}var Sn=function e(t,r){var i={};for(var n=0;n<t.length;n++){i=Object.getOwnPropertyDescriptor(t[n],r);if(i&&i.set&&i.get){break}}i.enumerable=true;i.configurable=true;return i};var En=function e(t){return Sn([t.el(),n.HTMLMediaElement.prototype,n.Element.prototype,Tn],"innerHTML")};var wn=function e(t){var r=t.el();if(r.resetSourceWatch_){return}var i={};var n=En(t);var a=function e(i){return function(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++){n[a]=arguments[a]}var s=i.apply(r,n);bn(t);return s}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){if(!r[e]){return}i[e]=r[e];r[e]=a(i[e])}));Object.defineProperty(r,"innerHTML",yt(n,{set:a(n.set)}));r.resetSourceWatch_=function(){r.resetSourceWatch_=null;Object.keys(i).forEach((function(e){r[e]=i[e]}));Object.defineProperty(r,"innerHTML",n)};t.one("sourceset",r.resetSourceWatch_)};var kn={};if(!C){kn=Object.defineProperty({},"src",{get:function e(){if(this.hasAttribute("src")){return ir(n.Element.prototype.getAttribute.call(this,"src"))}return""},set:function e(t){n.Element.prototype.setAttribute.call(this,"src",t);return t}})}var An=function e(t){return Sn([t.el(),n.HTMLMediaElement.prototype,kn],"src")};var Cn=function e(t){if(!t.featuresSourceset){return}var r=t.el();if(r.resetSourceset_){return}var i=An(t);var n=r.setAttribute;var a=r.load;Object.defineProperty(r,"src",yt(i,{set:function e(n){var a=i.set.call(r,n);t.triggerSourceset(r.src);return a}}));r.setAttribute=function(e,i){var a=n.call(r,e,i);if(/src/i.test(e)){t.triggerSourceset(r.src)}return a};r.load=function(){var e=a.call(r);if(!bn(t)){t.triggerSourceset("");wn(t)}return e};if(r.currentSrc){t.triggerSourceset(r.currentSrc)}else if(!bn(t)){wn(t)}r.resetSourceset_=function(){r.resetSourceset_=null;r.load=a;r.setAttribute=n;Object.defineProperty(r,"src",i);if(r.resetSourceWatch_){r.resetSourceWatch_()}}};var Ln=j(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);var xn=function(e){M(t,e);function t(r,i){U(this,t);var n=N(this,e.call(this,r,i));var a=r.source;var o=false;if(a&&(n.el_.currentSrc!==a.src||r.tag&&r.tag.initNetworkState_===3)){n.setSource(a)}else{n.handleLateInit_(n.el_)}if(r.enableSourceset){n.setupSourcesetHandling_()}if(n.el_.hasChildNodes()){var u=n.el_.childNodes;var l=u.length;var d=[];while(l--){var f=u[l];var c=f.nodeName.toLowerCase();if(c==="track"){if(!n.featuresNativeTextTracks){d.push(f)}else{n.remoteTextTrackEls().addTrackElement_(f);n.remoteTextTracks().addTrack(f.track);n.textTracks().addTrack(f.track);if(!o&&!n.el_.hasAttribute("crossorigin")&&ar(f.src)){o=true}}}}for(var h=0;h<d.length;h++){n.el_.removeChild(d[h])}}n.proxyNativeTracks_();if(n.featuresNativeTextTracks&&o){J.warn(s(Ln))}n.restoreMetadataTracksInIOSNativePlayer_();if((I||v||S)&&r.nativeControlsForTouch===true){n.setControls(true)}n.proxyWebkitFullscreen_();n.triggerReady();return n}t.prototype.dispose=function r(){if(this.el_&&this.el_.resetSourceset_){this.el_.resetSourceset_()}t.disposeMediaElement(this.el_);this.options_=null;e.prototype.dispose.call(this)};t.prototype.setupSourcesetHandling_=function e(){Cn(this)};t.prototype.restoreMetadataTracksInIOSNativePlayer_=function e(){var t=this.textTracks();var r=void 0;var i=function e(){r=[];for(var i=0;i<t.length;i++){var n=t[i];if(n.kind==="metadata"){r.push({track:n,storedMode:n.mode})}}};i();t.addEventListener("change",i);this.on("dispose",(function(){return t.removeEventListener("change",i)}));var n=function e(){for(var i=0;i<r.length;i++){var n=r[i];if(n.track.mode==="disabled"&&n.track.mode!==n.storedMode){n.track.mode=n.storedMode}}t.removeEventListener("change",e)};this.on("webkitbeginfullscreen",(function(){t.removeEventListener("change",i);t.removeEventListener("change",n);t.addEventListener("change",n)}));this.on("webkitendfullscreen",(function(){t.removeEventListener("change",i);t.addEventListener("change",i);t.removeEventListener("change",n)}))};t.prototype.proxyNativeTracks_=function e(){var t=this;gr.names.forEach((function(e){var r=gr[e];var i=t.el()[r.getterName];var n=t[r.getterName]();if(!t["featuresNative"+r.capitalName+"Tracks"]||!i||!i.addEventListener){return}var a={change:function e(t){n.trigger({type:"change",target:n,currentTarget:n,srcElement:n})},addtrack:function e(t){n.addTrack(t.track)},removetrack:function e(t){n.removeTrack(t.track)}};var s=function e(){var t=[];for(var r=0;r<n.length;r++){var a=false;for(var s=0;s<i.length;s++){if(i[s]===n[r]){a=true;break}}if(!a){t.push(n[r])}}while(t.length){n.removeTrack(t.shift())}};Object.keys(a).forEach((function(e){var r=a[e];i.addEventListener(e,r);t.on("dispose",(function(t){return i.removeEventListener(e,r)}))}));t.on("loadstart",s);t.on("dispose",(function(e){return t.off("loadstart",s)}))}))};t.prototype.createEl=function e(){var r=this.options_.tag;if(!r||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(r){var i=r.cloneNode(true);if(r.parentNode){r.parentNode.insertBefore(i,r)}t.disposeMediaElement(r);r=i}else{r=a.createElement("video");var n=this.options_.tag&&pe(this.options_.tag);var s=yt({},n);if(!I||this.options_.nativeControlsForTouch!==true){delete s.controls}he(r,G(s,{id:this.options_.techId,class:"vjs-tech"}))}r.playerId=this.options_.playerId}if(typeof this.options_.preload!=="undefined"){me(r,"preload",this.options_.preload)}var o=["loop","muted","playsinline","autoplay"];for(var u=0;u<o.length;u++){var l=o[u];var d=this.options_[l];if(typeof d!=="undefined"){if(d){me(r,l,l)}else{ge(r,l)}r[l]=d}}return r};t.prototype.handleLateInit_=function e(t){if(t.networkState===0||t.networkState===3){return}if(t.readyState===0){var r=false;var i=function e(){r=true};this.on("loadstart",i);var n=function e(){if(!r){this.trigger("loadstart")}};this.on("loadedmetadata",n);this.ready((function(){this.off("loadstart",i);this.off("loadedmetadata",n);if(!r){this.trigger("loadstart")}}));return}var a=["loadstart"];a.push("loadedmetadata");if(t.readyState>=2){a.push("loadeddata")}if(t.readyState>=3){a.push("canplay")}if(t.readyState>=4){a.push("canplaythrough")}this.ready((function(){a.forEach((function(e){this.trigger(e)}),this)}))};t.prototype.setCurrentTime=function e(t){try{this.el_.currentTime=t}catch(e){J(e,"Video is not ready. (Video.js)")}};t.prototype.duration=function e(){var t=this;if(this.el_.duration===Infinity&&_&&k&&this.el_.currentTime===0){var r=function e(){if(t.el_.currentTime>0){if(t.el_.duration===Infinity){t.trigger("durationchange")}t.off("timeupdate",e)}};this.on("timeupdate",r);return NaN}return this.el_.duration||NaN};t.prototype.width=function e(){return this.el_.offsetWidth};t.prototype.height=function e(){return this.el_.offsetHeight};t.prototype.proxyWebkitFullscreen_=function e(){var t=this;if(!("webkitDisplayingFullscreen"in this.el_)){return}var r=function e(){this.trigger("fullscreenchange",{isFullscreen:false})};var i=function e(){if("webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"){this.one("webkitendfullscreen",r);this.trigger("fullscreenchange",{isFullscreen:true})}};this.on("webkitbeginfullscreen",i);this.on("dispose",(function(){t.off("webkitbeginfullscreen",i);t.off("webkitendfullscreen",r)}))};t.prototype.supportsFullScreen=function e(){if(typeof this.el_.webkitEnterFullScreen==="function"){var t=n.navigator&&n.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t)){return true}}return false};t.prototype.enterFullScreen=function e(){var t=this.el_;if(t.paused&&t.networkState<=t.HAVE_METADATA){this.el_.play();this.setTimeout((function(){t.pause();t.webkitEnterFullScreen()}),0)}else{t.webkitEnterFullScreen()}};t.prototype.exitFullScreen=function e(){this.el_.webkitExitFullScreen()};t.prototype.src=function e(t){if(t===undefined){return this.el_.src}this.setSrc(t)};t.prototype.reset=function e(){t.resetMediaElement(this.el_)};t.prototype.currentSrc=function e(){if(this.currentSource_){return this.currentSource_.src}return this.el_.currentSrc};t.prototype.setControls=function e(t){this.el_.controls=!!t};t.prototype.addTextTrack=function t(r,i,n){if(!this.featuresNativeTextTracks){return e.prototype.addTextTrack.call(this,r,i,n)}return this.el_.addTextTrack(r,i,n)};t.prototype.createRemoteTextTrack=function t(r){if(!this.featuresNativeTextTracks){return e.prototype.createRemoteTextTrack.call(this,r)}var i=a.createElement("track");if(r.kind){i.kind=r.kind}if(r.label){i.label=r.label}if(r.language||r.srclang){i.srclang=r.language||r.srclang}if(r["default"]){i["default"]=r["default"]}if(r.id){i.id=r.id}if(r.src){i.src=r.src}return i};t.prototype.addRemoteTextTrack=function t(r,i){var n=e.prototype.addRemoteTextTrack.call(this,r,i);if(this.featuresNativeTextTracks){this.el().appendChild(n)}return n};t.prototype.removeRemoteTextTrack=function t(r){e.prototype.removeRemoteTextTrack.call(this,r);if(this.featuresNativeTextTracks){var i=this.$$("track");var n=i.length;while(n--){if(r===i[n]||r===i[n].track){this.el().removeChild(i[n])}}}};t.prototype.getVideoPlaybackQuality=function e(){if(typeof this.el().getVideoPlaybackQuality==="function"){return this.el().getVideoPlaybackQuality()}var t={};if(typeof this.el().webkitDroppedFrameCount!=="undefined"&&typeof this.el().webkitDecodedFrameCount!=="undefined"){t.droppedVideoFrames=this.el().webkitDroppedFrameCount;t.totalVideoFrames=this.el().webkitDecodedFrameCount}if(n.performance&&typeof n.performance.now==="function"){t.creationTime=n.performance.now()}else if(n.performance&&n.performance.timing&&typeof n.performance.timing.navigationStart==="number"){t.creationTime=n.Date.now()-n.performance.timing.navigationStart}return t};return t}(Tr);if(re()){xn.TEST_VID=a.createElement("video");var Dn=a.createElement("track");Dn.kind="captions";Dn.srclang="en";Dn.label="English";xn.TEST_VID.appendChild(Dn)}xn.isSupported=function(){try{xn.TEST_VID.volume=.5}catch(e){return false}return!!(xn.TEST_VID&&xn.TEST_VID.canPlayType)};xn.canPlayType=function(e){return xn.TEST_VID.canPlayType(e)};xn.canPlaySource=function(e,t){return xn.canPlayType(e.type)};xn.canControlVolume=function(){try{var e=xn.TEST_VID.volume;xn.TEST_VID.volume=e/2+.1;return e!==xn.TEST_VID.volume}catch(e){return false}};xn.canMuteVolume=function(){try{var e=xn.TEST_VID.muted;xn.TEST_VID.muted=!e;if(xn.TEST_VID.muted){me(xn.TEST_VID,"muted","muted")}else{ge(xn.TEST_VID,"muted","muted")}return e!==xn.TEST_VID.muted}catch(e){return false}};xn.canControlPlaybackRate=function(){if(_&&k&&A<58){return false}try{var e=xn.TEST_VID.playbackRate;xn.TEST_VID.playbackRate=e/2+.1;return e!==xn.TEST_VID.playbackRate}catch(e){return false}};xn.canOverrideAttributes=function(){if(C){return false}try{var e=function e(){};Object.defineProperty(a.createElement("video"),"src",{get:e,set:e});Object.defineProperty(a.createElement("audio"),"src",{get:e,set:e});Object.defineProperty(a.createElement("video"),"innerHTML",{get:e,set:e});Object.defineProperty(a.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return false}return true};xn.supportsNativeTextTracks=function(){return D||g&&k};xn.supportsNativeVideoTracks=function(){return!!(xn.TEST_VID&&xn.TEST_VID.videoTracks)};xn.supportsNativeAudioTracks=function(){return!!(xn.TEST_VID&&xn.TEST_VID.audioTracks)};xn.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];xn.prototype.featuresVolumeControl=xn.canControlVolume();xn.prototype.featuresMuteControl=xn.canMuteVolume();xn.prototype.featuresPlaybackRate=xn.canControlPlaybackRate();xn.prototype.featuresSourceset=xn.canOverrideAttributes();xn.prototype.movingMediaElementInDOM=!g;xn.prototype.featuresFullscreenResize=true;xn.prototype.featuresProgressEvents=true;xn.prototype.featuresTimeupdateEvents=true;xn.prototype.featuresNativeTextTracks=xn.supportsNativeTextTracks();xn.prototype.featuresNativeVideoTracks=xn.supportsNativeVideoTracks();xn.prototype.featuresNativeAudioTracks=xn.supportsNativeAudioTracks();var In=xn.TEST_VID&&xn.TEST_VID.constructor.prototype.canPlayType;var On=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;var Rn=/^video\/mp4/i;xn.patchCanPlayType=function(){if(b>=4&&!E&&!k){xn.TEST_VID.constructor.prototype.canPlayType=function(e){if(e&&On.test(e)){return"maybe"}return In.call(this,e)}}else if(T){xn.TEST_VID.constructor.prototype.canPlayType=function(e){if(e&&Rn.test(e)){return"maybe"}return In.call(this,e)}}};xn.unpatchCanPlayType=function(){var e=xn.TEST_VID.constructor.prototype.canPlayType;xn.TEST_VID.constructor.prototype.canPlayType=In;return e};xn.patchCanPlayType();xn.disposeMediaElement=function(e){if(!e){return}if(e.parentNode){e.parentNode.removeChild(e)}while(e.hasChildNodes()){e.removeChild(e.firstChild)}e.removeAttribute("src");if(typeof e.load==="function"){(function(){try{e.load()}catch(e){}})()}};xn.resetMediaElement=function(e){if(!e){return}var t=e.querySelectorAll("source");var r=t.length;while(r--){e.removeChild(t[r])}e.removeAttribute("src");if(typeof e.load==="function"){(function(){try{e.load()}catch(e){}})()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){xn.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}));["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){xn.prototype["set"+mt(e)]=function(t){this.el_[e]=t;if(t){this.el_.setAttribute(e,e)}else{this.el_.removeAttribute(e)}}}));["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach((function(e){xn.prototype[e]=function(){return this.el_[e]}}));["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach((function(e){xn.prototype["set"+mt(e)]=function(t){this.el_[e]=t}}));["pause","load","play"].forEach((function(e){xn.prototype[e]=function(){return this.el_[e]()}}));Tr.withSourceHandlers(xn);xn.nativeSourceHandler={};xn.nativeSourceHandler.canPlayType=function(e){try{return xn.TEST_VID.canPlayType(e)}catch(e){return""}};xn.nativeSourceHandler.canHandleSource=function(e,t){if(e.type){return xn.nativeSourceHandler.canPlayType(e.type)}else if(e.src){var r=nr(e.src);return xn.nativeSourceHandler.canPlayType("video/"+r)}return""};xn.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)};xn.nativeSourceHandler.dispose=function(){};xn.registerSourceHandler(xn.nativeSourceHandler);Tr.registerTech("Html5",xn);var Pn=j(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "],["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);var Un=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"];var Mn={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"};var Nn=function(e){M(t,e);function t(r,i,n){U(this,t);r.id=r.id||i.id||"vjs_video_"+Re();i=G(t.getTagSettings(r),i);i.initChildren=false;i.createEl=false;i.evented=false;i.reportTouchActivity=false;if(!i.language){if(typeof r.closest==="function"){var a=r.closest("[lang]");if(a&&a.getAttribute){i.language=a.getAttribute("lang")}}else{var s=r;while(s&&s.nodeType===1){if(pe(s).hasOwnProperty("lang")){i.language=s.getAttribute("lang");break}s=s.parentNode}}}var o=N(this,e.call(this,null,i,n));o.isPosterFromTech_=false;o.queuedCallbacks_=[];o.isReady_=false;o.hasStarted_=false;o.userActive_=false;if(!o.options_||!o.options_.techOrder||!o.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?")}o.tag=r;o.tagAttributes=r&&pe(r);o.language(o.options_.language);if(i.languages){var u={};Object.getOwnPropertyNames(i.languages).forEach((function(e){u[e.toLowerCase()]=i.languages[e]}));o.languages_=u}else{o.languages_=t.prototype.options_.languages}o.cache_={};o.poster_=i.poster||"";o.controls_=!!i.controls;o.cache_.lastVolume=1;r.controls=false;r.removeAttribute("controls");if(r.hasAttribute("autoplay")){o.options_.autoplay=true}else{o.autoplay(o.options_.autoplay)}o.scrubbing_=false;o.el_=o.createEl();o.cache_.lastPlaybackRate=o.defaultPlaybackRate();ht(o,{eventBusKey:"el_"});var l=yt(o.options_);if(i.plugins){var f=i.plugins;Object.keys(f).forEach((function(e){if(typeof this[e]==="function"){this[e](f[e])}else{throw new Error('plugin "'+e+'" does not exist')}}),o)}o.options_.playerOptions=l;o.middleware_=[];o.initChildren();o.isAudio(r.nodeName.toLowerCase()==="audio");if(o.controls()){o.addClass("vjs-controls-enabled")}else{o.addClass("vjs-controls-disabled")}o.el_.setAttribute("role","region");if(o.isAudio()){o.el_.setAttribute("aria-label",o.localize("Audio Player"))}else{o.el_.setAttribute("aria-label",o.localize("Video Player"))}if(o.isAudio()){o.addClass("vjs-audio")}if(o.flexNotSupported_()){o.addClass("vjs-no-flex")}if(!g){o.addClass("vjs-workinghover")}t.players[o.id_]=o;var c=d.split(".")[0];o.addClass("vjs-v"+c);o.userActive(true);o.reportUserActivity();o.one("play",o.listenForUserActivity_);o.on("fullscreenchange",o.handleFullscreenChange_);o.on("stageclick",o.handleStageClick_);o.changingSrc_=false;o.playWaitingForReady_=false;o.playOnLoadstart_=null;return o}t.prototype.dispose=function r(){this.trigger("dispose");this.off("dispose");if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_);this.styleEl_=null}t.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null}if(this.el_&&this.el_.player){this.el_.player=null}if(this.tech_){this.tech_.dispose();this.isPosterFromTech_=false;this.poster_=""}if(this.playerElIngest_){this.playerElIngest_=null}if(this.tag){this.tag=null}Mr(this);e.prototype.dispose.call(this)};t.prototype.createEl=function t(){var r=this.tag;var i=void 0;var s=this.playerElIngest_=r.parentNode&&r.parentNode.hasAttribute&&r.parentNode.hasAttribute("data-vjs-player");var o=this.tag.tagName.toLowerCase()==="video-js";if(s){i=this.el_=r.parentNode}else if(!o){i=this.el_=e.prototype.createEl.call(this,"div")}var u=pe(r);if(o){i=this.el_=r;r=this.tag=a.createElement("video");while(i.children.length){r.appendChild(i.firstChild)}if(!le(i,"video-js")){de(i,"video-js")}i.appendChild(r);s=this.playerElIngest_=i;["autoplay","controls","crossOrigin","defaultMuted","defaultPlaybackRate","loop","muted","playbackRate","src","volume"].forEach((function(e){if(typeof i[e]!=="undefined"){r[e]=i[e]}}))}r.setAttribute("tabindex","-1");if(L){r.setAttribute("role","application")}r.removeAttribute("width");r.removeAttribute("height");Object.getOwnPropertyNames(u).forEach((function(e){if(e==="class"){i.className+=" "+u[e];if(o){r.className+=" "+u[e]}}else{i.setAttribute(e,u[e]);if(o){r.setAttribute(e,u[e])}}}));r.playerId=r.id;r.id+="_html5_api";r.className="vjs-tech";r.player=i.player=this;this.addClass("vjs-paused");if(n.VIDEOJS_NO_DYNAMIC_STYLE!==true){this.styleEl_=Ze("vjs-styles-dimensions");var l=xe(".vjs-styles-defaults");var d=xe("head");d.insertBefore(this.styleEl_,l?l.nextSibling:d.firstChild)}this.width(this.options_.width);this.height(this.options_.height);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);var f=r.getElementsByTagName("a");for(var c=0;c<f.length;c++){var h=f.item(c);de(h,"vjs-hidden");h.setAttribute("hidden","hidden")}r.initNetworkState_=r.networkState;if(r.parentNode&&!s){r.parentNode.insertBefore(i,r)}ue(r,i);this.children_.unshift(r);this.el_.setAttribute("lang",this.language_);this.el_=i;return i};t.prototype.width=function e(t){return this.dimension("width",t)};t.prototype.height=function e(t){return this.dimension("height",t)};t.prototype.dimension=function e(t,r){var i=t+"_";if(r===undefined){return this[i]||0}if(r===""){this[i]=undefined;this.updateStyleEl_();return}var n=parseFloat(r);if(isNaN(n)){J.error('Improper value "'+r+'" supplied for for '+t);return}this[i]=n;this.updateStyleEl_()};t.prototype.fluid=function e(t){if(t===undefined){return!!this.fluid_}this.fluid_=!!t;if(t){this.addClass("vjs-fluid")}else{this.removeClass("vjs-fluid")}this.updateStyleEl_()};t.prototype.aspectRatio=function e(t){if(t===undefined){return this.aspectRatio_}if(!/^\d+\:\d+$/.test(t)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.")}this.aspectRatio_=t;this.fluid(true);this.updateStyleEl_()};t.prototype.updateStyleEl_=function e(){if(n.VIDEOJS_NO_DYNAMIC_STYLE===true){var t=typeof this.width_==="number"?this.width_:this.options_.width;var r=typeof this.height_==="number"?this.height_:this.options_.height;var i=this.tech_&&this.tech_.el();if(i){if(t>=0){i.width=t}if(r>=0){i.height=r}}return}var a=void 0;var s=void 0;var o=void 0;var u=void 0;if(this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"){o=this.aspectRatio_}else if(this.videoWidth()>0){o=this.videoWidth()+":"+this.videoHeight()}else{o="16:9"}var l=o.split(":");var d=l[1]/l[0];if(this.width_!==undefined){a=this.width_}else if(this.height_!==undefined){a=this.height_/d}else{a=this.videoWidth()||300}if(this.height_!==undefined){s=this.height_}else{s=a*d}if(/^[^a-zA-Z]/.test(this.id())){u="dimensions-"+this.id()}else{u=this.id()+"-dimensions"}this.addClass(u);et(this.styleEl_,"\n      ."+u+" {\n        width: "+a+"px;\n        height: "+s+"px;\n      }\n\n      ."+u+".vjs-fluid {\n        padding-top: "+d*100+"%;\n      }\n    ")};t.prototype.loadTech_=function e(t,r){var i=this;if(this.tech_){this.unloadTech_()}var n=mt(t);var a=t.charAt(0).toLowerCase()+t.slice(1);if(n!=="Html5"&&this.tag){Tr.getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null}this.techName_=n;this.isReady_=false;var s=typeof this.autoplay()==="string"?false:this.autoplay();var o={source:r,autoplay:s,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+n+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||false,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};_r.names.forEach((function(e){var t=_r[e];o[t.getterName]=i[t.privateName]}));G(o,this.options_[n]);G(o,this.options_[a]);G(o,this.options_[t.toLowerCase()]);if(this.tag){o.tag=this.tag}if(r&&r.src===this.cache_.src&&this.cache_.currentTime>0){o.startTime=this.cache_.currentTime}var u=Tr.getTech(t);if(!u){throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'")}this.tech_=new u(o);this.tech_.ready(tt(this,this.handleTechReady_),true);jt.jsonToTextTracks(this.textTracksJson_||[],this.tech_);Un.forEach((function(e){i.on(i.tech_,e,i["handleTech"+mt(e)+"_"])}));Object.keys(Mn).forEach((function(e){i.on(i.tech_,e,(function(t){if(i.tech_.playbackRate()===0&&i.tech_.seeking()){i.queuedCallbacks_.push({callback:i["handleTech"+Mn[e]+"_"].bind(i),event:t});return}i["handleTech"+Mn[e]+"_"](t)}))}));this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"sourceset",this.handleTechSourceset_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_()}if(this.tech_.el().parentNode!==this.el()&&(n!=="Html5"||!this.tag)){ue(this.tech_.el(),this.el())}if(this.tag){this.tag.player=null;this.tag=null}};t.prototype.unloadTech_=function e(){var t=this;_r.names.forEach((function(e){var r=_r[e];t[r.privateName]=t[r.getterName]()}));this.textTracksJson_=jt.textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false;if(this.isPosterFromTech_){this.poster_="";this.trigger("posterchange")}this.isPosterFromTech_=false};t.prototype.tech=function e(t){if(t===undefined){J.warn(s(Pn))}return this.tech_};t.prototype.addTechControlsListeners_=function e(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)};t.prototype.removeTechControlsListeners_=function e(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_)};t.prototype.handleTechReady_=function e(){this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume)}this.handleTechPosterChange_();this.handleTechDurationChange_();if((this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused()){try{delete this.tag.poster}catch(e){J("deleting tag.poster throws in some browsers",e)}}};t.prototype.handleTechLoadStart_=function e(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay")}else{this.hasStarted(false);this.trigger("loadstart")}this.manualAutoplay_(this.autoplay())};t.prototype.manualAutoplay_=function e(t){var r=this;if(!this.tech_||typeof t!=="string"){return}var i=function e(){var t=r.muted();r.muted(true);var i=r.play();if(!i||!i.then||!i["catch"]){return}return i["catch"]((function(e){r.muted(t)}))};var n=void 0;if(t==="any"){n=this.play();if(n&&n.then&&n["catch"]){n["catch"]((function(){return i()}))}}else if(t==="muted"){n=i()}else{n=this.play()}if(!n||!n.then||!n["catch"]){return}return n.then((function(){r.trigger({type:"autoplay-success",autoplay:t})}))["catch"]((function(e){r.trigger({type:"autoplay-failure",autoplay:t})}))};t.prototype.updateSourceCaches_=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=t;var i="";if(typeof r!=="string"){r=t.src;i=t.type}if(/^blob:/.test(r)){return}this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];if(r&&!i){i=Hr(this,r)}this.cache_.source=yt({},t,{src:r,type:i});var n=this.cache_.sources.filter((function(e){return e.src&&e.src===r}));var a=[];var s=this.$$("source");var o=[];for(var u=0;u<s.length;u++){var l=pe(s[u]);a.push(l);if(l.src&&l.src===r){o.push(l.src)}}if(o.length&&!n.length){this.cache_.sources=a}else if(!n.length){this.cache_.sources=[this.cache_.source]}this.cache_.src=r};t.prototype.handleTechSourceset_=function e(t){var r=this;if(!this.changingSrc_){this.updateSourceCaches_(t.src);if(!t.src){var i=function e(t){if(t.type!=="sourceset"){r.updateSourceCaches_(r.techGet_("currentSrc"))}r.tech_.off(["sourceset","loadstart"],e)};this.tech_.one(["sourceset","loadstart"],i)}}this.trigger({src:t.src,type:"sourceset"})};t.prototype.hasStarted=function e(t){if(t===undefined){return this.hasStarted_}if(t===this.hasStarted_){return}this.hasStarted_=t;if(this.hasStarted_){this.addClass("vjs-has-started");this.trigger("firstplay")}else{this.removeClass("vjs-has-started")}};t.prototype.handleTechPlay_=function e(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play")};t.prototype.handleTechRateChange_=function e(){if(this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0){this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)}));this.queuedCallbacks_=[]}this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")};t.prototype.handleTechWaiting_=function e(){var t=this;this.addClass("vjs-waiting");this.trigger("waiting");this.one("timeupdate",(function(){return t.removeClass("vjs-waiting")}))};t.prototype.handleTechCanPlay_=function e(){this.removeClass("vjs-waiting");this.trigger("canplay")};t.prototype.handleTechCanPlayThrough_=function e(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};t.prototype.handleTechPlaying_=function e(){this.removeClass("vjs-waiting");this.trigger("playing")};t.prototype.handleTechSeeking_=function e(){this.addClass("vjs-seeking");this.trigger("seeking")};t.prototype.handleTechSeeked_=function e(){this.removeClass("vjs-seeking");this.trigger("seeked")};t.prototype.handleTechFirstPlay_=function e(){if(this.options_.starttime){J.warn("Passing the `starttime` option to the player will be deprecated in 6.0");this.currentTime(this.options_.starttime)}this.addClass("vjs-has-started");this.trigger("firstplay")};t.prototype.handleTechPause_=function e(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};t.prototype.handleTechEnded_=function e(){this.addClass("vjs-ended");if(this.options_.loop){this.currentTime(0);this.play()}else if(!this.paused()){this.pause()}this.trigger("ended")};t.prototype.handleTechDurationChange_=function e(){this.duration(this.techGet_("duration"))};t.prototype.handleTechClick_=function e(t){if(!Le(t)){return}if(!this.controls_){return}if(this.paused()){Pt(this.play())}else{this.pause()}};t.prototype.handleTechTap_=function e(){this.userActive(!this.userActive())};t.prototype.handleTechTouchStart_=function e(){this.userWasActive=this.userActive()};t.prototype.handleTechTouchMove_=function e(){if(this.userWasActive){this.reportUserActivity()}};t.prototype.handleTechTouchEnd_=function e(t){t.preventDefault()};t.prototype.handleFullscreenChange_=function e(){if(this.isFullscreen()){this.addClass("vjs-fullscreen")}else{this.removeClass("vjs-fullscreen")}};t.prototype.handleStageClick_=function e(){this.reportUserActivity()};t.prototype.handleTechFullscreenChange_=function e(t,r){if(r){this.isFullscreen(r.isFullscreen)}this.trigger("fullscreenchange")};t.prototype.handleTechError_=function e(){var t=this.tech_.error();this.error(t)};t.prototype.handleTechTextData_=function e(){var t=null;if(arguments.length>1){t=arguments[1]}this.trigger("textdata",t)};t.prototype.getCache=function e(){return this.cache_};t.prototype.techCall_=function e(t,r){this.ready((function(){if(t in Or){return xr(this.middleware_,this.tech_,t,r)}else if(t in Rr){return Dr(this.middleware_,this.tech_,t,r)}try{if(this.tech_){this.tech_[t](r)}}catch(e){J(e);throw e}}),true)};t.prototype.techGet_=function e(t){if(!this.tech_||!this.tech_.isReady_){return}if(t in Ir){return Lr(this.middleware_,this.tech_,t)}else if(t in Rr){return Dr(this.middleware_,this.tech_,t)}try{return this.tech_[t]()}catch(e){if(this.tech_[t]===undefined){J("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e);throw e}if(e.name==="TypeError"){J("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e);this.tech_.isReady_=false;throw e}J(e);throw e}};t.prototype.play=function e(){var t=this;var r=this.options_.Promise||n.Promise;if(r){return new r((function(e){t.play_(e)}))}return this.play_()};t.prototype.play_=function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Pt;if(this.playOnLoadstart_){this.off("loadstart",this.playOnLoadstart_)}if(!this.isReady_){if(this.playWaitingForReady_){return}this.playWaitingForReady_=true;this.ready((function(){t.playWaitingForReady_=false;r(t.play())}))}else if(!this.changingSrc_&&(this.src()||this.currentSrc())){r(this.techGet_("play"));return}else{this.playOnLoadstart_=function(){t.playOnLoadstart_=null;r(t.play())};this.one("loadstart",this.playOnLoadstart_)}};t.prototype.pause=function e(){this.techCall_("pause")};t.prototype.paused=function e(){return this.techGet_("paused")===false?false:true};t.prototype.played=function e(){return this.techGet_("played")||Et(0,0)};t.prototype.scrubbing=function e(t){if(typeof t==="undefined"){return this.scrubbing_}this.scrubbing_=!!t;if(t){this.addClass("vjs-scrubbing")}else{this.removeClass("vjs-scrubbing")}};t.prototype.currentTime=function e(t){if(typeof t!=="undefined"){if(t<0){t=0}this.techCall_("setCurrentTime",t);return}this.cache_.currentTime=this.techGet_("currentTime")||0;return this.cache_.currentTime};t.prototype.duration=function e(t){if(t===undefined){return this.cache_.duration!==undefined?this.cache_.duration:NaN}t=parseFloat(t);if(t<0){t=Infinity}if(t!==this.cache_.duration){this.cache_.duration=t;if(t===Infinity){this.addClass("vjs-live")}else{this.removeClass("vjs-live")}this.trigger("durationchange")}};t.prototype.remainingTime=function e(){return this.duration()-this.currentTime()};t.prototype.remainingTimeDisplay=function e(){return Math.floor(this.duration())-Math.floor(this.currentTime())};t.prototype.buffered=function e(){var e=this.techGet_("buffered");if(!e||!e.length){e=Et(0,0)}return e};t.prototype.bufferedPercent=function e(){return wt(this.buffered(),this.duration())};t.prototype.bufferedEnd=function e(){var t=this.buffered();var r=this.duration();var i=t.end(t.length-1);if(i>r){i=r}return i};t.prototype.volume=function e(t){var r=void 0;if(t!==undefined){r=Math.max(0,Math.min(1,parseFloat(t)));this.cache_.volume=r;this.techCall_("setVolume",r);if(r>0){this.lastVolume_(r)}return}r=parseFloat(this.techGet_("volume"));return isNaN(r)?1:r};t.prototype.muted=function e(t){if(t!==undefined){this.techCall_("setMuted",t);return}return this.techGet_("muted")||false};t.prototype.defaultMuted=function e(t){if(t!==undefined){return this.techCall_("setDefaultMuted",t)}return this.techGet_("defaultMuted")||false};t.prototype.lastVolume_=function e(t){if(t!==undefined&&t!==0){this.cache_.lastVolume=t;return}return this.cache_.lastVolume};t.prototype.supportsFullScreen=function e(){return this.techGet_("supportsFullScreen")||false};t.prototype.isFullscreen=function e(t){if(t!==undefined){this.isFullscreen_=!!t;return}return!!this.isFullscreen_};t.prototype.requestFullscreen=function e(){var t=kt;this.isFullscreen(true);if(t.requestFullscreen){Ve(a,t.fullscreenchange,tt(this,(function e(r){this.isFullscreen(a[t.fullscreenElement]);if(this.isFullscreen()===false){We(a,t.fullscreenchange,e)}this.trigger("fullscreenchange")})));this.el_[t.requestFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("enterFullScreen")}else{this.enterFullWindow();this.trigger("fullscreenchange")}};t.prototype.exitFullscreen=function e(){var t=kt;this.isFullscreen(false);if(t.requestFullscreen){a[t.exitFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("exitFullScreen")}else{this.exitFullWindow();this.trigger("fullscreenchange")}};t.prototype.enterFullWindow=function e(){this.isFullWindow=true;this.docOrigOverflow=a.documentElement.style.overflow;Ve(a,"keydown",tt(this,this.fullWindowOnEscKey));a.documentElement.style.overflow="hidden";de(a.body,"vjs-full-window");this.trigger("enterFullWindow")};t.prototype.fullWindowOnEscKey=function e(t){if(t.keyCode===27){if(this.isFullscreen()===true){this.exitFullscreen()}else{this.exitFullWindow()}}};t.prototype.exitFullWindow=function e(){this.isFullWindow=false;We(a,"keydown",this.fullWindowOnEscKey);a.documentElement.style.overflow=this.docOrigOverflow;fe(a.body,"vjs-full-window");this.trigger("exitFullWindow")};t.prototype.canPlayType=function e(t){var r=void 0;for(var i=0,n=this.options_.techOrder;i<n.length;i++){var a=n[i];var s=Tr.getTech(a);if(!s){s=_t.getComponent(a)}if(!s){J.error('The "'+a+'" tech is undefined. Skipped browser support check for that tech.');continue}if(s.isSupported()){r=s.canPlayType(t);if(r){return r}}}return""};t.prototype.selectSource=function e(t){var r=this;var i=this.options_.techOrder.map((function(e){return[e,Tr.getTech(e)]})).filter((function(e){var t=e[0],r=e[1];if(r){return r.isSupported()}J.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.');return false}));var n=function e(t,r,i){var n=void 0;t.some((function(e){return r.some((function(t){n=i(e,t);if(n){return true}}))}));return n};var a=void 0;var s=function e(t){return function(e,r){return t(r,e)}};var o=function e(t,i){var n=t[0],a=t[1];if(a.canPlaySource(i,r.options_[n.toLowerCase()])){return{source:i,tech:n}}};if(this.options_.sourceOrder){a=n(t,i,s(o))}else{a=n(i,t,o)}return a||false};t.prototype.src=function e(t){var r=this;if(typeof t==="undefined"){return this.cache_.src||""}var i=qr(t);if(!i.length){this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0);return}this.changingSrc_=true;this.cache_.sources=i;this.updateSourceCaches_(i[0]);Ar(this,i[0],(function(e,t){r.middleware_=t;r.cache_.sources=i;r.updateSourceCaches_(e);var n=r.src_(e);if(n){if(i.length>1){return r.src(i.slice(1))}r.changingSrc_=false;r.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0);r.triggerReady();return}Cr(t,r.tech_)}))};t.prototype.src_=function e(t){var r=this;var i=this.selectSource([t]);if(!i){return true}if(!gt(i.tech,this.techName_)){this.changingSrc_=true;this.loadTech_(i.tech,i.source);this.tech_.ready((function(){r.changingSrc_=false}));return false}this.ready((function(){if(this.tech_.constructor.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",t)}else{this.techCall_("src",t.src)}this.changingSrc_=false}),true);return false};t.prototype.load=function e(){this.techCall_("load")};t.prototype.reset=function e(){if(this.tech_){this.tech_.clearTracks("text")}this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset")};t.prototype.currentSources=function e(){var t=this.currentSource();var r=[];if(Object.keys(t).length!==0){r.push(t)}return this.cache_.sources||r};t.prototype.currentSource=function e(){return this.cache_.source||{}};t.prototype.currentSrc=function e(){return this.currentSource()&&this.currentSource().src||""};t.prototype.currentType=function e(){return this.currentSource()&&this.currentSource().type||""};t.prototype.preload=function e(t){if(t!==undefined){this.techCall_("setPreload",t);this.options_.preload=t;return}return this.techGet_("preload")};t.prototype.autoplay=function e(t){if(t===undefined){return this.options_.autoplay||false}var r=void 0;if(typeof t==="string"&&/(any|play|muted)/.test(t)){this.options_.autoplay=t;this.manualAutoplay_(t);r=false}else if(!t){this.options_.autoplay=false}else{this.options_.autoplay=true}r=r||this.options_.autoplay;if(this.tech_){this.techCall_("setAutoplay",r)}};t.prototype.playsinline=function e(t){if(t!==undefined){this.techCall_("setPlaysinline",t);this.options_.playsinline=t;return this}return this.techGet_("playsinline")};t.prototype.loop=function e(t){if(t!==undefined){this.techCall_("setLoop",t);this.options_.loop=t;return}return this.techGet_("loop")};t.prototype.poster=function e(t){if(t===undefined){return this.poster_}if(!t){t=""}if(t===this.poster_){return}this.poster_=t;this.techCall_("setPoster",t);this.isPosterFromTech_=false;this.trigger("posterchange")};t.prototype.handleTechPosterChange_=function e(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";if(t!==this.poster_){this.poster_=t;this.isPosterFromTech_=true;this.trigger("posterchange")}}};t.prototype.controls=function e(t){if(t===undefined){return!!this.controls_}t=!!t;if(this.controls_===t){return}this.controls_=t;if(this.usingNativeControls()){this.techCall_("setControls",t)}if(this.controls_){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_()}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_()}}};t.prototype.usingNativeControls=function e(t){if(t===undefined){return!!this.usingNativeControls_}t=!!t;if(this.usingNativeControls_===t){return}this.usingNativeControls_=t;if(this.usingNativeControls_){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols")}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols")}};t.prototype.error=function e(t){if(t===undefined){return this.error_||null}if(t===null){this.error_=t;this.removeClass("vjs-error");if(this.errorDisplay){this.errorDisplay.close()}return}this.error_=new It(t);this.addClass("vjs-error");J.error("(CODE:"+this.error_.code+" "+It.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return};t.prototype.reportUserActivity=function e(t){this.userActivity_=true};t.prototype.userActive=function e(t){if(t===undefined){return this.userActive_}t=!!t;if(t===this.userActive_){return}this.userActive_=t;if(this.userActive_){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_){this.tech_.one("mousemove",(function(e){e.stopPropagation();e.preventDefault()}))}this.userActivity_=false;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")};t.prototype.listenForUserActivity_=function e(){var t=void 0;var r=void 0;var i=void 0;var n=tt(this,this.reportUserActivity);var a=function e(t){if(t.screenX!==r||t.screenY!==i){r=t.screenX;i=t.screenY;n()}};var s=function e(){n();this.clearInterval(t);t=this.setInterval(n,250)};var o=function e(r){n();this.clearInterval(t)};this.on("mousedown",s);this.on("mousemove",a);this.on("mouseup",o);this.on("keydown",n);this.on("keyup",n);var u=void 0;this.setInterval((function(){if(!this.userActivity_){return}this.userActivity_=false;this.userActive(true);this.clearTimeout(u);var e=this.options_.inactivityTimeout;if(e<=0){return}u=this.setTimeout((function(){if(!this.userActivity_){this.userActive(false)}}),e)}),250)};t.prototype.playbackRate=function e(t){if(t!==undefined){this.techCall_("setPlaybackRate",t);return}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.cache_.lastPlaybackRate||this.techGet_("playbackRate")}return 1};t.prototype.defaultPlaybackRate=function e(t){if(t!==undefined){return this.techCall_("setDefaultPlaybackRate",t)}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.techGet_("defaultPlaybackRate")}return 1};t.prototype.isAudio=function e(t){if(t!==undefined){this.isAudio_=!!t;return}return!!this.isAudio_};t.prototype.addTextTrack=function e(t,r,i){if(this.tech_){return this.tech_.addTextTrack(t,r,i)}};t.prototype.addRemoteTextTrack=function e(t,r){if(this.tech_){return this.tech_.addRemoteTextTrack(t,r)}};t.prototype.removeRemoteTextTrack=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=t.track,i=r===undefined?arguments[0]:r;if(this.tech_){return this.tech_.removeRemoteTextTrack(i)}};t.prototype.getVideoPlaybackQuality=function e(){return this.techGet_("getVideoPlaybackQuality")};t.prototype.videoWidth=function e(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};t.prototype.videoHeight=function e(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};t.prototype.language=function e(t){if(t===undefined){return this.language_}this.language_=String(t).toLowerCase()};t.prototype.languages=function e(){return yt(t.prototype.options_.languages,this.languages_)};t.prototype.toJSON=function e(){var t=yt(this.options_);var r=t.tracks;t.tracks=[];for(var i=0;i<r.length;i++){var n=r[i];n=yt(n);n.player=undefined;t.tracks[i]=n}return t};t.prototype.createModal=function e(t,r){var i=this;r=r||{};r.content=t||"";var n=new Ht(this,r);this.addChild(n);n.on("dispose",(function(){i.removeChild(n)}));n.open();return n};t.getTagSettings=function e(t){var r={sources:[],tracks:[]};var i=pe(t);var n=i["data-setup"];if(le(t,"vjs-fluid")){i.fluid=true}if(n!==null){var a=o(n||"{}"),s=a[0],u=a[1];if(s){J.error(s)}G(i,u)}G(r,i);if(t.hasChildNodes()){var l=t.childNodes;for(var d=0,f=l.length;d<f;d++){var c=l[d];var h=c.nodeName.toLowerCase();if(h==="source"){r.sources.push(pe(c))}else if(h==="track"){r.tracks.push(pe(c))}}}return r};t.prototype.flexNotSupported_=function e(){var t=a.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)};return t}(_t);_r.names.forEach((function(e){var t=_r[e];Nn.prototype[t.getterName]=function(){if(this.tech_){return this.tech_[t.getterName]()}this[t.privateName]=this[t.privateName]||new t.ListClass;return this[t.privateName]}}));Nn.players={};var jn=n.navigator;Nn.prototype.options_={techOrder:Tr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:jn&&(jn.languages&&jn.languages[0]||jn.userLanguage||jn.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."};if(!C){Nn.prototype.options_.children.push("resizeManager")}["ended","seeking","seekable","networkState","readyState"].forEach((function(e){Nn.prototype[e]=function(){return this.techGet_(e)}}));Un.forEach((function(e){Nn.prototype["handleTech"+mt(e)+"_"]=function(){return this.trigger(e)}}));_t.registerComponent("Player",Nn);var Bn="plugin";var Fn="activePlugins_";var Hn={};var qn=function e(t){return Hn.hasOwnProperty(t)};var Gn=function e(t){return qn(t)?Hn[t]:undefined};var Vn=function e(t,r){t[Fn]=t[Fn]||{};t[Fn][r]=true};var Wn=function e(t,r,i){var n=(i?"before":"")+"pluginsetup";t.trigger(n,r);t.trigger(n+":"+r.name,r)};var zn=function e(t,r){var i=function e(){Wn(this,{name:t,plugin:r,instance:null},true);var i=r.apply(this,arguments);Vn(this,t);Wn(this,{name:t,plugin:r,instance:i});return i};Object.keys(r).forEach((function(e){i[e]=r[e]}));return i};var Kn=function e(t,r){r.prototype.name=t;return function(){Wn(this,{name:t,plugin:r,instance:null},true);for(var e=arguments.length,i=Array(e),n=0;n<e;n++){i[n]=arguments[n]}var a=new(Function.prototype.bind.apply(r,[null].concat([this].concat(i))));this[t]=function(){return a};Wn(this,a.getEventHash());return a}};var Yn=function(){function e(t){U(this,e);if(this.constructor===e){throw new Error("Plugin must be sub-classed; not directly instantiated.")}this.player=t;ht(this);delete this.trigger;vt(this,this.constructor.defaultState);Vn(t,this.name);this.dispose=tt(this,this.dispose);t.on("dispose",this.dispose)}e.prototype.version=function e(){return this.constructor.VERSION};e.prototype.getEventHash=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};t.name=this.name;t.plugin=this.constructor;t.instance=this;return t};e.prototype.trigger=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return ze(this.eventBusEl_,t,this.getEventHash(r))};e.prototype.handleStateChanged=function e(t){};e.prototype.dispose=function e(){var t=this.name,r=this.player;this.trigger("dispose");this.off();r.off("dispose",this.dispose);r[Fn][t]=false;this.player=this.state=null;r[t]=Kn(t,Hn[t])};e.isBasic=function t(r){var i=typeof r==="string"?Gn(r):r;return typeof i==="function"&&!e.prototype.isPrototypeOf(i.prototype)};e.registerPlugin=function t(r,i){if(typeof r!=="string"){throw new Error('Illegal plugin name, "'+r+'", must be a string, was '+(typeof r==="undefined"?"undefined":P(r))+".")}if(qn(r)){J.warn('A plugin named "'+r+'" already exists. You may want to avoid re-registering plugins!')}else if(Nn.prototype.hasOwnProperty(r)){throw new Error('Illegal plugin name, "'+r+'", cannot share a name with an existing player method!')}if(typeof i!=="function"){throw new Error('Illegal plugin for "'+r+'", must be a function, was '+(typeof i==="undefined"?"undefined":P(i))+".")}Hn[r]=i;if(r!==Bn){if(e.isBasic(i)){Nn.prototype[r]=zn(r,i)}else{Nn.prototype[r]=Kn(r,i)}}return i};e.deregisterPlugin=function e(t){if(t===Bn){throw new Error("Cannot de-register base plugin.")}if(qn(t)){delete Hn[t];delete Nn.prototype[t]}};e.getPlugins=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Object.keys(Hn);var r=void 0;t.forEach((function(e){var t=Gn(e);if(t){r=r||{};r[e]=t}}));return r};e.getPluginVersion=function e(t){var r=Gn(t);return r&&r.VERSION||""};return e}();Yn.getPlugin=Gn;Yn.BASE_PLUGIN_NAME=Bn;Yn.registerPlugin(Bn,Yn);Nn.prototype.usingPlugin=function(e){return!!this[Fn]&&this[Fn][e]===true};Nn.prototype.hasPlugin=function(e){return!!qn(e)};var Xn=function e(t,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof r==="undefined"?"undefined":P(r)))}t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(r){t.super_=r}};var Jn=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=function e(){t.apply(this,arguments)};var n={};if((typeof r==="undefined"?"undefined":P(r))==="object"){if(r.constructor!==Object.prototype.constructor){i=r.constructor}n=r}else if(typeof r==="function"){i=r}Xn(i,t);for(var a in n){if(n.hasOwnProperty(a)){i.prototype[a]=n[a]}}return i};if(typeof HTMLVideoElement==="undefined"&&re()){a.createElement("video");a.createElement("audio");a.createElement("track");a.createElement("video-js")}var Qn=function e(t){return t.indexOf("#")===0?t.slice(1):t};function $n(e,t,r){var i=$n.getPlayer(e);if(i){if(t){J.warn('Player "'+e+'" is already initialised. Options will not be applied.')}if(r){i.ready(r)}return i}var n=typeof e==="string"?xe("#"+Qn(e)):e;if(!ie(n)){throw new TypeError("The element or ID supplied is not valid. (videojs)")}if(!a.body.contains(n)){J.warn("The element supplied is not included in the DOM")}t=t||{};$n.hooks("beforesetup").forEach((function(e){var r=e(n,yt(t));if(!V(r)||Array.isArray(r)){J.error("please return an object in beforesetup hooks");return}t=yt(t,r)}));var s=_t.getComponent("Player");i=new s(n,t,r);$n.hooks("setup").forEach((function(e){return e(i)}));return i}$n.hooks_={};$n.hooks=function(e,t){$n.hooks_[e]=$n.hooks_[e]||[];if(t){$n.hooks_[e]=$n.hooks_[e].concat(t)}return $n.hooks_[e]};$n.hook=function(e,t){$n.hooks(e,t)};$n.hookOnce=function(e,t){$n.hooks(e,[].concat(t).map((function(t){var r=function r(){$n.removeHook(e,r);return t.apply(undefined,arguments)};return r})))};$n.removeHook=function(e,t){var r=$n.hooks(e).indexOf(t);if(r<=-1){return false}$n.hooks_[e]=$n.hooks_[e].slice();$n.hooks_[e].splice(r,1);return true};if(n.VIDEOJS_NO_DYNAMIC_STYLE!==true&&re()){var Zn=xe(".vjs-styles-defaults");if(!Zn){Zn=Ze("vjs-styles-defaults");var ea=xe("head");if(ea){ea.insertBefore(Zn,ea.firstChild)}et(Zn,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}$e(1,$n);$n.VERSION=d;$n.options=Nn.prototype.options_;$n.getPlayers=function(){return Nn.players};$n.getPlayer=function(e){var t=Nn.players;var r=void 0;if(typeof e==="string"){var i=Qn(e);var n=t[i];if(n){return n}r=xe("#"+i)}else{r=e}if(ie(r)){var a=r,s=a.player,o=a.playerId;if(s||t[o]){return s||t[o]}}};$n.getAllPlayers=function(){return Object.keys(Nn.players).map((function(e){return Nn.players[e]})).filter(Boolean)};$n.players=Nn.players;$n.getComponent=_t.getComponent;$n.registerComponent=function(e,t){if(Tr.isTech(t)){J.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)")}_t.registerComponent.call(_t,e,t)};$n.getTech=Tr.getTech;$n.registerTech=Tr.registerTech;$n.use=kr;if(!C&&Object.defineProperty){Object.defineProperty($n,"middleware",{value:{},writeable:false,enumerable:true});Object.defineProperty($n.middleware,"TERMINATOR",{value:wr,writeable:false,enumerable:true})}else{$n.middleware={TERMINATOR:wr}}$n.browser=R;$n.TOUCH_ENABLED=I;$n.extend=Jn;$n.mergeOptions=yt;$n.bind=tt;$n.registerPlugin=Yn.registerPlugin;$n.deregisterPlugin=Yn.deregisterPlugin;$n.plugin=function(e,t){J.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return Yn.registerPlugin(e,t)};$n.getPlugins=Yn.getPlugins;$n.getPlugin=Yn.getPlugin;$n.getPluginVersion=Yn.getPluginVersion;$n.addLanguage=function(e,t){var r;e=(""+e).toLowerCase();$n.options.languages=yt($n.options.languages,(r={},r[e]=t,r));return $n.options.languages[e]};$n.log=J;$n.createTimeRange=$n.createTimeRanges=Et;$n.formatTime=ui;$n.setFormatTime=si;$n.resetFormatTime=oi;$n.parseUrl=rr;$n.isCrossOrigin=ar;$n.EventTarget=nt;$n.on=Ve;$n.one=Ke;$n.off=We;$n.trigger=ze;$n.xhr=u;$n.TextTrack=lr;$n.AudioTrack=dr;$n.VideoTrack=fr;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){$n[e]=function(){J.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead");return Ie[e].apply(null,arguments)}}));$n.computedStyle=Q;$n.dom=Ie;$n.url=sr;e.exports=$n},"./node_modules/videojs-contrib-eme/dist/videojs-contrib-eme.es.js":function(e,t,r){"use strict";var i=r("./node_modules/global/document.js");var n=r.n(i);var a=r("./node_modules/video.js/dist/video.cjs.js");var s=r.n(a);var o=r("./node_modules/global/window.js");var u=r.n(o);function l(){l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};return l.apply(this,arguments)}var d=function e(t){var r=new ArrayBuffer(t.length*2);var i=new Uint16Array(r);for(var n=0;n<t.length;n++){i[n]=t.charCodeAt(n)}return i};var f=function e(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};var c=function e(t){var r=n.a.createElement("a");r.href=t;return r.hostname};var h=function e(t,r){if(t===r){return true}if(t.byteLength!==r.byteLength){return false}var i=new DataView(t);var n=new DataView(r);for(var a=0;a<i.byteLength;a++){if(i.getUint8(a)!==n.getUint8(a)){return false}}return true};var p=function e(t){if(t instanceof Uint8Array||t instanceof Uint16Array){return t.buffer}return t};var v=function e(){var t=s.a.mergeOptions.apply(s.a,arguments);Object.keys(t).forEach((function(e){if(t[e]===null){delete t[e]}}));return t};var m=function e(t){var r=(new u.a.DOMParser).parseFromString(String.fromCharCode.apply(null,new Uint16Array(t)),"application/xml");var i=r.getElementsByTagName("HttpHeaders")[0];var n={};if(i){var a=i.getElementsByTagName("name");var s=i.getElementsByTagName("value");for(var o=0;o<a.length;o++){n[a[o].childNodes[0].nodeValue]=s[o].childNodes[0].nodeValue}}var l=r.getElementsByTagName("Challenge")[0];var d;if(l){d=u.a.atob(l.childNodes[0].nodeValue)}return{headers:n,message:d}};var g=function e(t,r,i,n){var a=m(r);var o=a.message;var u=v(a.headers,i.emeHeaders,t.licenseHeaders);s.a.xhr({uri:t.url,method:"post",headers:u,body:o,responseType:"arraybuffer"},(function(e,t,r){if(e){n(e);return}if(t.statusCode>=400&&t.statusCode<=599){n({});return}n(null,r)}))};var y=function e(t){if(t.supportedConfigurations){return t.supportedConfigurations}var r={};var i=t.audioContentType;var n=t.audioRobustness;var a=t.videoContentType;var s=t.videoRobustness;var o=t.persistentState;if(i||n){r.audioCapabilities=[l({},i?{contentType:i}:{},n?{robustness:n}:{})]}if(a||s){r.videoCapabilities=[l({},a?{contentType:a}:{},s?{robustness:s}:{})]}if(o){r.persistentState=o}return[r]};var _=function e(t){var r;Object.keys(t).forEach((function(e){var i=y(t[e]);if(!r){r=u.a.navigator.requestMediaKeySystemAccess(e,i)}else{r=r.catch((function(t){return u.a.navigator.requestMediaKeySystemAccess(e,i)}))}}));return r};var b=function e(t){var r=t.mediaKeys,i=t.initDataType,n=t.initData,a=t.options,o=t.getLicense,u=t.removeSession,l=t.eventBus;var d=r.createSession();l.trigger("keysessioncreated");return new Promise((function(r,f){d.addEventListener("message",(function(e){if(e.messageType!=="license-request"&&e.messageType!=="license-renewal"){return}o(a,e.message).then((function(e){r(d.update(e))})).catch((function(e){f(e)}))}),false);d.addEventListener("keystatuseschange",(function(r){var i=false;d.keyStatuses.forEach((function(e,t){l.trigger({keyId:t,status:e,target:d,type:"keystatuschange"});switch(e){case"expired":i=true;break;case"internal-error":s.a.log.warn('Key status reported as "internal-error." Leaving the session open since we '+"don't have enough details to know if this error is fatal.",r);break}}));if(i){d.close().then((function(){u(n);e(t)}))}}),false);d.generateRequest(i,n).catch((function(){f("Unable to create or initialize key session")}))}))};var T=function e(t){var r=t.video,i=t.initDataType,n=t.initData,a=t.options,s=t.getLicense,o=t.removeSession,u=t.eventBus;if(r.mediaKeysObject){return b({mediaKeys:r.mediaKeysObject,initDataType:i,initData:n,options:a,getLicense:s,removeSession:o,eventBus:u})}r.pendingSessionData.push({initDataType:i,initData:n,options:a,getLicense:s,removeSession:o,eventBus:u});return Promise.resolve()};var S=function e(t){var r=t.video,i=t.certificate,n=t.createdMediaKeys;r.mediaKeysObject=n;var a=[];if(i){a.push(n.setServerCertificate(i))}for(var s=0;s<r.pendingSessionData.length;s++){var o=r.pendingSessionData[s];a.push(b({mediaKeys:r.mediaKeysObject,initDataType:o.initDataType,initData:o.initData,options:o.options,getLicense:o.getLicense,removeSession:o.removeSession,eventBus:o.eventBus}))}r.pendingSessionData=[];a.push(r.setMediaKeys(n));return Promise.all(a)};var E=function e(t){return function(e,r,i){g(t,r,e,i)}};var w=function e(t){return function(e,r,i){var n=v({"Content-type":"application/octet-stream"},e.emeHeaders,t.licenseHeaders);s.a.xhr({uri:t.url,method:"POST",responseType:"arraybuffer",body:r,headers:n},(function(e,t,r){if(e){i(e);return}if(t.statusCode>=400&&t.statusCode<=599){i({});return}i(null,r)}))}};var k=function e(t,r){return function(e,i){return new Promise((function(n,a){t(e,i,(function(e,t){if(r){r.trigger("licenserequestattempted")}if(e){a(e);return}n(t)}))}))}};var A=function e(t,r){if(typeof r==="string"){r={url:r}}if(!r.url&&!r.getLicense){throw new Error("Neither URL nor getLicense function provided to get license")}if(r.url&&!r.getLicense){r.getLicense=t==="com.microsoft.playready"?E(r):w(r)}return r};var C=function e(t){var r=t.video,i=t.initDataType,n=t.initData,a=t.keySystemAccess,s=t.options,o=t.removeSession,u=t.eventBus;var l=Promise.resolve();if(typeof r.mediaKeysObject==="undefined"){r.mediaKeysObject=null;r.pendingSessionData=[];var d;var f;l=new Promise((function(e,t){r.keySystem=a.keySystem;f=A(a.keySystem,s.keySystems[a.keySystem]);if(!f.getCertificate){e(a);return}f.getCertificate(s,(function(r,i){if(r){t(r);return}d=i;e()}))})).then((function(){return a.createMediaKeys()})).then((function(e){return S({video:r,certificate:d,createdMediaKeys:e})})).catch((function(e){if(e){return Promise.reject(e)}return Promise.reject("Failed to create and initialize a MediaKeys object")}))}return l.then((function(){return T({video:r,initDataType:i,initData:n,options:s,getLicense:r.keySystem?k(A(r.keySystem,s.keySystems[r.keySystem]).getLicense,u):null,removeSession:o,eventBus:u})}))};var L="com.apple.fps.1_0";var x=function e(t){var r=t.initData,i=t.id,n=t.cert;if(typeof i==="string"){i=d(i)}var a=0;var s=new ArrayBuffer(r.byteLength+4+i.byteLength+4+n.byteLength);var o=new DataView(s);var u=new Uint8Array(s,a,r.byteLength);u.set(r);a+=r.byteLength;o.setUint32(a,i.byteLength,true);a+=4;var l=new Uint16Array(s,a,i.length);l.set(i);a+=l.byteLength;o.setUint32(a,n.byteLength,true);a+=4;var f=new Uint8Array(s,a,n.byteLength);f.set(n);return new Uint8Array(s,0,s.byteLength)};var D=function e(t){var r=t.video,i=t.contentId,n=t.initData,a=t.cert,s=t.options,o=t.getLicense,l=t.eventBus;return new Promise((function(e,t){if(!r.webkitKeys){try{r.webkitSetMediaKeys(new u.a.WebKitMediaKeys(L))}catch(e){t("Could not create MediaKeys");return}}var d;try{d=r.webkitKeys.createSession("video/mp4",x({id:i,initData:n,cert:a}))}catch(e){t("Could not create key session");return}l.trigger("keysessioncreated");d.contentId=i;d.addEventListener("webkitkeymessage",(function(e){o(s,i,e.message,(function(e,r){if(l){l.trigger("licenserequestattempted")}if(e){t(e);return}d.update(new Uint8Array(r))}))}));d.addEventListener("webkitkeyadded",(function(){e()}));d.addEventListener("webkitkeyerror",(function(){var e=d.error;t("KeySession error: code "+e.code+", systemCode "+e.systemCode)}))}))};var I=function e(t){return function(e,r){var i=v(e.emeHeaders,t.certificateHeaders);s.a.xhr({uri:t.certificateUri,responseType:"arraybuffer",headers:i},(function(e,t,i){if(e){r(e);return}r(null,new Uint8Array(i))}))}};var O=function e(t,r){return c(f(r))};var R=function e(t){return function(e,r,i,n){var a=v({"Content-type":"application/octet-stream"},e.emeHeaders,t.licenseHeaders);s.a.xhr({uri:t.licenseUri,method:"POST",responseType:"arraybuffer",body:i,headers:a},(function(e,t,r){if(e){n(e);return}if(t.statusCode>=400&&t.statusCode<=599){n({});return}n(null,r)}))}};var P=function e(t){var r=t.video,i=t.initData,n=t.options,a=t.eventBus;var s=n.keySystems[L];var o=s.getCertificate||I(s);var u=s.getContentId||O;var l=s.getLicense||R(s);return new Promise((function(e,t){o(n,(function(r,i){if(r){t(r);return}e(i)}))})).then((function(e){return D({video:r,cert:e,initData:i,getLicense:l,options:n,contentId:u(n,i),eventBus:a})}))};var U="com.microsoft.playready";var M=function e(t,r,i,n){var a=t.keySystems[U];if(typeof a.getKey==="function"){a.getKey(t,i.destinationURL,i.message.buffer,(function(e,t){if(e){n.trigger({message:"Unable to get key: "+e,target:r,type:"mskeyerror"});return}r.update(t)}));return}if(typeof a==="string"){a={url:a}}else if(typeof a==="boolean"){a={}}if(!a.url){a.url=i.destinationURL}var s=function e(t,i){if(n){n.trigger("licenserequestattempted")}if(t){n.trigger({message:"Unable to request key from url: "+a.url,target:r,type:"mskeyerror"});return}r.update(new Uint8Array(i))};if(a.getLicense){a.getLicense(t,i.message.buffer,s)}else{g(a,i.message.buffer,t,s)}};var N=function e(t,r,i,n){var a=t.msKeys.createSession("video/mp4",r);if(!a){throw new Error("Could not create key session.")}n.trigger("keysessioncreated");a.addEventListener("mskeymessage",(function(e){M(i,a,e,n)}));a.addEventListener("mskeyerror",(function(e){n.trigger({message:"Unexpected key error from key session with "+("code: "+a.error.code+" and systemCode: "+a.error.systemCode),target:a,type:"mskeyerror"})}));a.addEventListener("mskeyadded",(function(){n.trigger({target:a,type:"mskeyadded"})}))};var j=function(e){var t=e.video,r=e.initData,i=e.options,n=e.eventBus;if(t.msKeys){delete t.msKeys}try{t.msSetMediaKeys(new u.a.MSMediaKeys(U))}catch(e){throw new Error("Unable to create media keys for PlayReady key system. "+"Error: "+e.message)}N(t,r,i,n)};var B=function e(t,r){for(var i=0;i<t.length;i++){if(!t[i].initData){continue}var n=p(t[i].initData);var a=p(r);if(h(n,a)){return true}}return false};var F=function e(t,r){for(var i=0;i<t.length;i++){if(t[i].initData===r){t.splice(i,1);return}}};var H=function e(t,r,i,n){if(!r||!r.keySystems){return Promise.resolve()}var a=t.initData;return _(r.keySystems).then((function(e){var s=e.keySystem;if(r.keySystems[s]&&r.keySystems[s].pssh){a=r.keySystems[s].pssh}if(B(i,a)||!a){return Promise.resolve()}i.push({initData:a});return C({video:t.target,initDataType:t.initDataType,initData:a,keySystemAccess:e,options:r,removeSession:F.bind(null,i),eventBus:n})}))};var q=function e(t,r,i){if(!r.keySystems||!r.keySystems[L]||!t.initData){return Promise.resolve()}return P({video:t.target,initData:t.initData,options:r,eventBus:i})};var G=function e(t,r,i,n){if(!r.keySystems||!r.keySystems[U]){return}if(i.reduce((function(e,t){return e||t.playready}),false)){return}var a=t.initData;if(r.keySystems[U]&&r.keySystems[U].pssh){a=r.keySystems[U].pssh}if(!a){return}i.push({playready:true,initData:a});j({video:t.target,initData:a,options:r,eventBus:n})};var V=function e(t){return s.a.mergeOptions(t.currentSource(),t.eme.options)};var W=function e(t){var r=t.src();if(r!==t.eme.activeSrc){t.eme.activeSrc=r;t.eme.sessions=[]}};var z=function e(t){return function(e){var r=typeof e==="string"?e:e&&e.message||null;t.error({code:5,message:r})}};var K=function e(t,r){if(t.$(".vjs-tech").tagName.toLowerCase()!=="video"){return}W(t);if(u.a.WebKitMediaKeys){t.tech_.el_.addEventListener("webkitneedkey",(function(e){W(t);q(e,V(t),t.tech_).catch(r)}))}else if(u.a.MediaKeys){t.tech_.el_.addEventListener("encrypted",(function(e){W(t);H(e,V(t),t.eme.sessions,t.tech_).catch(r)}))}else if(u.a.MSMediaKeys){t.tech_.el_.addEventListener("msneedkey",(function(e){W(t);try{G(e,V(t),t.eme.sessions,t.tech_)}catch(e){r(e)}}));t.tech_.on("mskeyerror",r);t.on("dispose",(function(){t.tech_.off("mskeyerror",r)}))}};var Y=function e(t){if(t===void 0){t={}}var r=this;var i=z(r);r.ready((function(){return K(r,i)}));r.eme={initializeMediaKeys:function e(n,a,o){if(n===void 0){n={}}if(a===void 0){a=function e(){}}if(o===void 0){o=false}var u=s.a.mergeOptions(r.currentSource(),t,n);var l={initDataType:"cenc",initData:null,target:r.tech_.el_};W(r);if(r.tech_.el_.setMediaKeys){H(l,u,r.eme.sessions,r.tech_).then((function(){return a()})).catch((function(e){a(e);if(!o){i(e)}}))}else if(r.tech_.el_.msSetMediaKeys){var d=function e(t){r.tech_.off("mskeyadded",e);r.tech_.off("mskeyerror",e);if(t.type==="mskeyerror"){a(t.target.error);if(!o){i(t.message)}}else{a()}};r.tech_.one("mskeyadded",d);r.tech_.one("mskeyerror",d);try{G(l,u,r.eme.sessions,r.tech_)}catch(e){r.tech_.off("mskeyadded",d);r.tech_.off("mskeyerror",d);a(e);if(!o){i(e)}}}},options:t}};var X=s.a.registerPlugin||s.a.plugin;X("eme",Y);var J=Y},"./node_modules/videojs-contrib-quality-levels/dist/videojs-contrib-quality-levels.es.js":function(e,t,r){"use strict";var i=r("./node_modules/video.js/dist/video.cjs.js");var n=r.n(i);var a=r("./node_modules/global/document.js");var s=r.n(a);function o(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function u(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var l=function e(t){var r=this;if(n.a.browser.IS_IE8){r=s.a.createElement("custom");for(var i in e.prototype){if(i!=="constructor"){r[i]=e.prototype[i]}}}r.id=t.id;r.label=r.id;r.width=t.width;r.height=t.height;r.bitrate=t.bandwidth;r.enabled_=t.enabled;Object.defineProperty(r,"enabled",{get:function e(){return r.enabled_()},set:function e(t){r.enabled_(t)}});return r};var d=function(e){o(t,e);function t(){var r;r=e.call(this)||this;var i=u(u(r));if(n.a.browser.IS_IE8){i=s.a.createElement("custom");for(var a in t.prototype){if(a!=="constructor"){i[a]=t.prototype[a]}}}i.levels_=[];i.selectedIndex_=-1;Object.defineProperty(i,"selectedIndex",{get:function e(){return i.selectedIndex_}});Object.defineProperty(i,"length",{get:function e(){return i.levels_.length}});return i||u(r)}var r=t.prototype;r.addQualityLevel=function e(t){var r=this.getQualityLevelById(t.id);if(r){return r}var i=this.levels_.length;r=new l(t);if(!(""+i in this)){Object.defineProperty(this,i,{get:function e(){return this.levels_[i]}})}this.levels_.push(r);this.trigger({qualityLevel:r,type:"addqualitylevel"});return r};r.removeQualityLevel=function e(t){var r=null;for(var i=0,n=this.length;i<n;i++){if(this[i]===t){r=this.levels_.splice(i,1)[0];if(this.selectedIndex_===i){this.selectedIndex_=-1}else if(this.selectedIndex_>i){this.selectedIndex_--}break}}if(r){this.trigger({qualityLevel:t,type:"removequalitylevel"})}return r};r.getQualityLevelById=function e(t){for(var r=0,i=this.length;r<i;r++){var n=this[r];if(n.id===t){return n}}return null};r.dispose=function e(){this.selectedIndex_=-1;this.levels_.length=0};return t}(n.a.EventTarget);d.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(var f in d.prototype.allowedEvents_){d.prototype["on"+f]=null}var c="2.0.9";var h=n.a.registerPlugin||n.a.plugin;var p=function e(t,r){var i=t.qualityLevels;var n=new d;var a=function e(){n.dispose();t.qualityLevels=i;t.off("dispose",e)};t.on("dispose",a);t.qualityLevels=function(){return n};t.qualityLevels.VERSION=c;return n};var v=function e(t){return p(this,n.a.mergeOptions({},t))};h("qualityLevels",v);v.VERSION=c;var m=v},"./node_modules/videojs-mux/dist/videojs-mux.js":function(e,t,r){var i=i||{};i.js=r("./node_modules/video.js/dist/video.cjs.js");(function(){var t=false;!function(t,i){if(true)e.exports=i(r("./node_modules/video.js/dist/video.cjs.js"));else{var n,a}}("undefined"!=typeof self?self:this,(function(e){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,r){!function(){!function(t,r){e.exports=r()}(0,(function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(e,t,r){(function(t){var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=r}).call(t,r(6))},function(e,t){function r(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function i(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}function n(e,t){var r=R(e)||h(e)?i(e.length,String):[],n=r.length,a=!!n;for(var s in e)!t&&!C.call(e,s)||a&&("length"==s||l(s,n))||r.push(s);return r}function a(e,t,r){var i=e[t];C.call(e,t)&&c(i,r)&&(void 0!==r||t in e)||(e[t]=r)}function s(e){if(!f(e))return D(e);var t=[];for(var r in Object(e))C.call(e,r)&&"constructor"!=r&&t.push(r);return t}function o(e,t){return t=I(void 0===t?e.length-1:t,0),function(){for(var i=arguments,n=-1,a=I(i.length-t,0),s=Array(a);++n<a;)s[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=s,r(e,this,o)}}function u(e,t,r,i){r||(r={});for(var n=-1,s=t.length;++n<s;){var o=t[n],u=i?i(r[o],e[o],o,r,e):void 0;a(r,o,void 0===u?e[o]:u)}return r}function l(e,t){return!!(t=null==t?T:t)&&("number"==typeof e||k.test(e))&&e>-1&&e%1==0&&e<t}function d(e,t,r){if(!y(r))return!1;var i=typeof t;return!!("number"==i?p(r)&&l(t,r.length):"string"==i&&t in r)&&c(r[t],e)}function f(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||A)}function c(e,t){return e===t||e!==e&&t!==t}function h(e){return v(e)&&C.call(e,"callee")&&(!x.call(e,"callee")||L.call(e)==S)}function p(e){return null!=e&&g(e.length)&&!m(e)}function v(e){return _(e)&&p(e)}function m(e){var t=y(e)?L.call(e):"";return t==E||t==w}function g(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=T}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function _(e){return!!e&&"object"==typeof e}function b(e){return p(e)?n(e):s(e)}var T=9007199254740991,S="[object Arguments]",E="[object Function]",w="[object GeneratorFunction]",k=/^(?:0|[1-9]\d*)$/,A=Object.prototype,C=A.hasOwnProperty,L=A.toString,x=A.propertyIsEnumerable,D=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),I=Math.max,O=!x.call({valueOf:1},"valueOf"),R=Array.isArray,P=function(e){return o((function(t,r){var i=-1,n=r.length,a=n>1?r[n-1]:void 0,s=n>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(n--,a):void 0,s&&d(r[0],r[1],s)&&(a=n<3?void 0:a,n=1),t=Object(t);++i<n;){var o=r[i];o&&e(t,o)}return t}))}((function(e,t){if(O||f(t)||p(t))return void u(t,b(t),e);for(var r in t)C.call(t,r)&&a(e,r,t[r])}));e.exports=P},function(e,t,r){"use strict";function i(e,t,r){r=void 0===r?1:r,e[t]=e[t]||0,e[t]+=r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a={};a.now=function(){var e=n.default.performance,t=e&&e.timing;return t&&"number"==typeof t.navigationStart&&"function"==typeof e.now?t.navigationStart+e.now():Date.now()},t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(18),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n.default.methodFactory;n.default.methodFactory=function(e,t,r){var i=a(e,t,r);return function(){for(var e=["[mux]"],t=0;t<arguments.length;t++)e.push(arguments[t]);i.apply(void 0,e)}},n.default.setLevel(n.default.getLevel()),t.default=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return a(e)[0]},n=function(e){return a(e)[1]},a=function(e){if("string"!=typeof e||""===e)return["localhost"];var t=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,r=e.match(t)||[],i=r[4],n=void 0;return i&&(n=(i.match(/[^\.]+\.[^\.]+$/)||[])[0]),[i,n]};t.extractHostnameAndDomain=a,t.extractHostname=i,t.extractDomain=n},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},n=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)};t.generateUUID=i,t.generateShortID=n},function(e,t,r){"use strict";function i(e){e=e||"";var t={};return e.trim().split(/[\r\n]+/).forEach((function(e){if(e){var r=e.split(": "),i=r.shift();i&&n.indexOf(i.toLowerCase())>=0&&(t[i]=r.join(": "))}})),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["x-cdn","content-type"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findMediaElement=t.getMuxPlayerId=void 0;var i=r(7),n=function(e){return e&&void 0!==e.nodeName?(e.muxId||(e.muxId=e.id||(0,i.generateShortID)()),e.muxId):e},a=function(e){var t=void 0;return e&&void 0!==e.nodeName?(t=e,e=n(t)):t=document.querySelector(e),[t,e,t&&t.nodeName?t.nodeName.toLowerCase():""]};t.getMuxPlayerId=n,t.findMediaElement=a},function(e,t,r){"use strict";function i(){return"1"===(a.default.doNotTrack||a.default.navigator&&(a.default.navigator.doNotTrack||a.default.navigator.msDoNotTrack))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a={};a.exists=function(){var e=n.default.performance;return void 0!==(e&&e.timing)},a.domContentLoadedEventEnd=function(){var e=n.default.performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},a.navigationStart=function(){var e=n.default.performance,t=e&&e.timing;return t&&t.navigationStart},t.default=a},function(e,t,r){"use strict";var i=r(42),n=r(43),a=r(14);e.exports={formats:a,parse:n,stringify:i}},function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,n=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e){for(var t;e.length;){var r=e.pop();if(t=r.obj[r.prop],Array.isArray(t)){for(var i=[],n=0;n<t.length;++n)void 0!==t[n]&&i.push(t[n]);r.obj[r.prop]=i}}return t};t.arrayToObject=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r},t.merge=function(e,r,n){if(!r)return e;if("object"!=typeof r){if(Array.isArray(e))e.push(r);else{if("object"!=typeof e)return[e,r];(n.plainObjects||n.allowPrototypes||!i.call(Object.prototype,r))&&(e[r]=!0)}return e}if("object"!=typeof e)return[e].concat(r);var a=e;return Array.isArray(e)&&!Array.isArray(r)&&(a=t.arrayToObject(e,n)),Array.isArray(e)&&Array.isArray(r)?(r.forEach((function(r,a){i.call(e,a)?e[a]&&"object"==typeof e[a]?e[a]=t.merge(e[a],r,n):e.push(r):e[a]=r})),e):Object.keys(r).reduce((function(e,a){var s=r[a];return i.call(e,a)?e[a]=t.merge(e[a],s,n):e[a]=s,e}),a)},t.assign=function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),r="",i=0;i<t.length;++i){var a=t.charCodeAt(i);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?r+=t.charAt(i):a<128?r+=n[a]:a<2048?r+=n[192|a>>6]+n[128|63&a]:a<55296||a>=57344?r+=n[224|a>>12]+n[128|a>>6&63]+n[128|63&a]:(i+=1,a=65536+((1023&a)<<10|1023&t.charCodeAt(i)),r+=n[240|a>>18]+n[128|a>>12&63]+n[128|a>>6&63]+n[128|63&a])}return r},t.compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var n=t[i],s=n.obj[n.prop],o=Object.keys(s),u=0;u<o.length;++u){var l=o[u],d=s[l];"object"==typeof d&&null!==d&&-1===r.indexOf(d)&&(t.push({obj:s,prop:l}),r.push(d))}return a(t)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,r){"use strict";var i=String.prototype.replace,n=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return i.call(e,n,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function a(e){var t={},r={};return Object.keys(e).forEach((function(i){var n=!1;if(e.hasOwnProperty(i)&&void 0!==e[i]){var a=i.split("_"),s=a[0],u=f[s];u||(o.default.info("Data key word `"+a[0]+"` not expected in "+i),u=s+"_"),a.splice(1).forEach((function(e){"url"===e&&(n=!0),h[e]?u+=h[e]:Number(e)&&Math.floor(Number(e))===Number(e)?u+=e:(o.default.info("Data key word `"+e+"` not expected in "+i),u+="_"+e+"_")})),n?r[u]=e[i]:t[u]=e[i]}})),(0,l.default)(t,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=r(4),o=i(s),u=r(1),l=i(u),d={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},f=n(d),c={ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",ca:"cached",cb:"cancel",cd:"code",cg:"category",ch:"changed",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",du:"duration",dv:"device",ec:"encoding",en:"end",eg:"engine",em:"embed",er:"error",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",fi:"first",fm:"family",ft:"format",fq:"frequency",fr:"frame",fs:"fullscreen",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",ta:"tag",tc:"tech",te:"text",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},h=n(c)},function(e,t,r){"use strict";e.exports=r(17).default},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(0),s=i(a),o=r(9),u=r(4),l=i(u),d=r(10),f=i(d),c=r(3),h=i(c),p=r(19),v=i(p),m=r(50),g=i(m),y=r(51),_=i(y),b={},T=function e(t){var r=arguments;"string"==typeof t?e.hasOwnProperty(t)?s.default.setTimeout((function(){r=Array.prototype.splice.call(r,1),e[t].apply(null,r)}),0):l.default.warn("`"+t+"` is an unknown task"):"function"==typeof t?s.default.setTimeout((function(){t(e)}),0):l.default.warn("`"+t+"` is invalid.")};T.loaded=h.default.now(),T.NAME="mux-embed",T.VERSION="4.2.0",T.API_VERSION="2.1",T.PLAYER_TRACKED=!1,T.monitor=function(e,t){return(0,g.default)(T,e,t)},T.destroyMonitor=function(e){var t=(0,o.findMediaElement)(e),r=n(t,1),i=r[0];i&&i.mux&&"function"==typeof i.mux.destroy?i.mux.destroy():l.default.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},T.addHLSJS=function(e,t){var r=(0,o.getMuxPlayerId)(e);b[r]?b[r].addHLSJS(t):l.default.error("A monitor for `"+r+"` has not been initialized.")},T.addDashJS=function(e,t){var r=(0,o.getMuxPlayerId)(e);b[r]?b[r].addDashJS(t):l.default.error("A monitor for `"+r+"` has not been initialized.")},T.removeHLSJS=function(e){var t=(0,o.getMuxPlayerId)(e);b[t]?b[t].removeHLSJS():l.default.error("A monitor for `"+t+"` has not been initialized.")},T.removeDashJS=function(e){var t=(0,o.getMuxPlayerId)(e);b[t]?b[t].removeDashJS():l.default.error("A monitor for `"+t+"` has not been initialized.")},T.init=function(e,t){(0,f.default)()&&t&&t.respectDoNotTrack&&l.default.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var r=(0,o.getMuxPlayerId)(e);b[r]=new v.default(T,r,t)},T.emit=function(e,t,r){var i=(0,o.getMuxPlayerId)(e);b[i]?(b[i].emit(t,r),"destroy"===t&&delete b[i]):l.default.error("A monitor for `"+i+"` has not been initialized.")},void 0!==s.default&&"function"==typeof s.default.addEventListener&&s.default.addEventListener("unload",(function(){T.WINDOW_UNLOADING=!0}),!1),T.checkDoNotTrack=f.default,T.log=l.default,T.utils=_.default,t.default=T},function(e,t,r){var i,n;!function(a,s){"use strict";i=s,void 0!==(n="function"==typeof i?i.call(t,r,t,e):i)&&(e.exports=n)}(0,(function(){"use strict";function e(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function t(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function r(r){return"debug"===r&&(r="log"),typeof console!==u&&("trace"===r&&l?t:void 0!==console[r]?e(console,r):void 0!==console.log?e(console,"log"):o)}function i(e,t){for(var r=0;r<d.length;r++){var i=d[r];this[i]=r<e?o:this.methodFactory(i,e,t)}this.log=this.debug}function n(e,t,r){return function(){typeof console!==u&&(i.call(this,t,r),this[e].apply(this,arguments))}}function a(e,t,i){return r(e)||n.apply(this,arguments)}function s(e,t,r){function n(e){var t=(d[e]||"silent").toUpperCase();if(typeof window!==u&&f){try{return void(window.localStorage[f]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(e){}}}function s(){var e;if(typeof window!==u&&f){try{e=window.localStorage[f]}catch(e){}if(typeof e===u)try{var t=window.document.cookie,r=t.indexOf(encodeURIComponent(f)+"=");-1!==r&&(e=/^([^;]+)/.exec(t.slice(r))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}}var o,l=this,f="loglevel";"string"==typeof e?f+=":"+e:"symbol"==typeof e&&(f=void 0),l.name=e,l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=r||a,l.getLevel=function(){return o},l.setLevel=function(t,r){if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(o=t,!1!==r&&n(t),i.call(l,t,e),typeof console===u&&t<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(e){s()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var c=s();null==c&&(c=null==t?"WARN":t),l.setLevel(c,!1)}var o=function(){},u="undefined",l=typeof window!==u&&typeof window.navigator!==u&&/Trident\/|MSIE /.test(window.navigator.userAgent),d=["trace","debug","info","warn","error"],f=new s,c={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=c[e];return t||(t=c[e]=new s(e,f.getLevel(),f.methodFactory)),t};var h=typeof window!==u?window.log:void 0;return f.noConflict=function(){return typeof window!==u&&window.log===f&&(window.log=h),f},f.getLoggers=function(){return c},f.default=f,f}))},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(4),s=i(a),o=r(1),u=i(o),l=r(7),d=r(5),f=r(0),c=i(f),h=r(11),p=i(h),v=r(2),m=i(v),g=r(20),y=i(g),_=r(25),b=r(26),T=r(27),S=i(T),E=r(28),w=i(E),k=r(29),A=i(k),C=r(30),L=i(C),x=r(31),D=i(x),I=r(32),O=i(I),R=r(33),P=i(R),U=r(34),M=i(U),N=r(35),j=i(N),B=r(36),F=i(B),H=r(37),q=i(H),G=r(38),V=i(G),W=r(39),z=i(W),K=r(40),Y=i(K),X=r(49),J=i(X),Q=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],$=function(e,t,r){var i=this;this.DOM_CONTENT_LOADED_EVENT_END=p.default.domContentLoadedEventEnd(),this.NAVIGATION_START=p.default.navigationStart();var n={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,errorTranslator:function(e){return e}};this.mux=e,this.id=t,r=(0,u.default)(n,r),r.data=r.data||{},r.data.property_key&&(r.data.env_key=r.data.property_key,delete r.data.property_key),s.default.setLevel(r.debug?"debug":"warn"),this.getPlayheadTime=r.getPlayheadTime,this.getStateData=r.getStateData||function(){},this.getAdData=r.getAdData||function(){},this.minimumRebufferDuration=r.minimumRebufferDuration,this.sustainedRebufferThreshold=r.sustainedRebufferThreshold,this.playbackHeartbeatTime=r.playbackHeartbeatTime,this.disableRebufferTracking=r.disableRebufferTracking,this.disableRebufferTracking&&this.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),this.errorTranslator=r.errorTranslator,this.playbackEventDispatcher=new Y.default(e,r.data.env_key,r),this.data={player_instance_id:(0,l.generateUUID)(),mux_sample_rate:r.sampleRate,beacon_domain:r.beaconDomain},this.data.view_sequence_number=1,this.data.player_sequence_number=1,this.oldEmit=this.emit,this.emit=function(e,t){t=(0,u.default)({viewer_time:this.mux.utils.now()},t),this.oldEmit(e,t)};var a=function(){void 0===this.data.view_start&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(this);this.on("viewinit",(function(e,t){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),(0,u.default)(this.data,t),this._initializeViewData(),this.one("play",a),this.one("adbreakstart",a)}));var o=function(e){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",e)}.bind(this);this.on("videochange",(function(e,t){o(t)})),this.on("programchange",(function(e,t){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),o((0,u.default)(t,{view_program_changed:!0})),a(),this.emit("play"),this.emit("playing")})),this.on("destroy",this.destroy);var d=this.destroy.bind(this);void 0!==c.default&&"function"==typeof c.default.addEventListener&&c.default.addEventListener("unload",d,!1),this.on("destroy",(function(){void 0!==c.default&&"function"==typeof c.default.removeEventListener&&c.default.removeEventListener("unload",d)})),this.on("playerready",(function(e,t){(0,u.default)(this.data,t)})),Q.forEach((function(e){i.on(e,(function(t,r){0!==e.indexOf("ad")&&this._updateStateData(),(0,u.default)(this.data,r),this._sanitizeData()})),i.on("after"+e,(function(){("error"!==e||this.viewErrored)&&this.send(e)}))})),this.on("viewend",(function(e,t){(0,u.default)(i.data,t)}));var f=function(e){var t=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=t-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};this.one("playerready",f),A.default.apply(this),z.default.apply(this),F.default.apply(this),O.default.apply(this),w.default.apply(this),j.default.apply(this),L.default.apply(this),D.default.apply(this),q.default.apply(this),P.default.apply(this),M.default.apply(this),V.default.apply(this),J.default.apply(this),r.hlsjs&&this.addHLSJS(r),r.dashjs&&this.addDashJS(r),this.emit("viewinit",r.data)};(0,u.default)($.prototype,S.default.prototype),(0,u.default)($.prototype,O.default.prototype),(0,u.default)($.prototype,F.default.prototype),(0,u.default)($.prototype,w.default.prototype),(0,u.default)($.prototype,L.default.prototype),(0,u.default)($.prototype,D.default.prototype),(0,u.default)($.prototype,q.default.prototype),(0,u.default)($.prototype,P.default.prototype),(0,u.default)($.prototype,M.default.prototype),$.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,void 0!==this.data.view_start&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),c.default.clearTimeout(this._heartBeatTimeout))},$.prototype.send=function(e){var t=(0,u.default)({},this.data);if(1===t.player_error_code&&(delete t.player_error_code,delete t.player_error_message),t.player_source_duration===1/0||t.video_source_duration===1/0?t.video_source_is_live=!0:(t.player_source_duration>0||t.video_source_duration>0)&&(t.video_source_is_live=!1),t.video_source_url=t.video_source_url||t.player_source_url,t.video_source_url){var r=(0,d.extractHostnameAndDomain)(t.video_source_url),i=n(r,2),a=i[0],s=i[1];t.video_source_domain=s,t.video_source_hostname=a}delete t.ad_request_id,this.playbackEventDispatcher.send(e,t),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat()},$.prototype._updateStateData=function(){(0,u.default)(this.data,this.getStateData()),this.getPlayheadTime&&(this.data.player_playhead_time=this.getPlayheadTime()),this._sanitizeData()},$.prototype._sanitizeData=function(){var e=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach((function(t){var r=parseInt(e.data[t],10);e.data[t]=isNaN(r)?void 0:r})),["player_source_url","video_source_url"].forEach((function(t){if(e.data[t]){var r=e.data[t].toLowerCase();0!==r.indexOf("data:")&&0!==r.indexOf("blob:")||(e.data[t]="MSE style URL")}}))},$.prototype._resetVideoData=function(e,t){var r=this;Object.keys(this.data).forEach((function(e){0===e.indexOf("video_")&&delete r.data[e]}))},$.prototype._resetViewData=function(){var e=this;Object.keys(this.data).forEach((function(t){0===t.indexOf("view_")&&delete e.data[t]})),this.data.view_sequence_number=1},$.prototype._resetErrorData=function(e,t){delete this.data.player_error_code,delete this.data.player_error_message},$.prototype._initializeViewData=function(){var e=this,t=this.data.view_id=(0,l.generateUUID)();this.data.video_id||(this.data.video_id=(0,y.default)(this.data.player_source_url));var r=function(){t===e.data.view_id&&(0,m.default)(e.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",r):r()},$.prototype._restartHeartBeat=function(){var e=this;c.default.clearTimeout(this._heartBeatTimeout),this.viewErrored||(this._heartBeatTimeout=c.default.setTimeout((function(){e.data.player_is_paused||e.emit("hb")}),1e4))},$.prototype.addHLSJS=function(e){return e.hlsjs?this.hlsjs?void this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=e.hlsjs,void(0,_.monitorHlsJs)(this.mux,this.id,e.hlsjs,{},e.Hls||c.default.Hls)):void this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")},$.prototype.removeHLSJS=function(){this.hlsjs&&((0,_.stopMonitoringHlsJs)(this.hlsjs),this.hlsjs=void 0)},$.prototype.addDashJS=function(e){return e.dashjs?this.dashjs?void this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=e.dashjs,void(0,b.monitorDashJS)(this.mux,this.id,e.dashjs)):void this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")},$.prototype.removeDashJS=function(){this.dashjs&&((0,b.stopMonitoringDashJS)(this.dashjs),this.dashjs=void 0)},t.default=$},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=s.default.createElement("a");t.href=e;var r=t.pathname.replace(/\.[^\/.]+$/,"");return u.default.encode(t.host+r).split("=")[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var a=r(21),s=i(a),o=r(23),u=i(o)},function(e,t,r){(function(t){var i,n=void 0!==t?t:"undefined"!=typeof window?window:{},a=r(22);"undefined"!=typeof document?i=document:(i=n["__GLOBAL_DOCUMENT_CACHE@4"])||(i=n["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=i}).call(t,r(6))},function(e,t){},function(e,t,r){(function(e,i){var n;!function(i){var a=("object"==typeof e&&e&&e.exports,function(e){this.message=e});a.prototype=new Error,a.prototype.name="InvalidCharacterError";var s=function(e){throw new a(e)},o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,l=function(e){e=String(e).replace(u,"");var t=e.length;t%4==0&&(e=e.replace(/==?$/,""),t=e.length),(t%4==1||/[^+a-zA-Z0-9\/]/.test(e))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var r,i,n=0,a="",l=-1;++l<t;)i=o.indexOf(e.charAt(l)),r=n%4?64*r+i:i,n++%4&&(a+=String.fromCharCode(255&r>>(-2*n&6)));return a},d=function(e){e=String(e),/[^\0-\xFF]/.test(e)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var t,r,i,n,a=e.length%3,u="",l=-1,d=e.length-a;++l<d;)t=e.charCodeAt(l)<<16,r=e.charCodeAt(++l)<<8,i=e.charCodeAt(++l),n=t+r+i,u+=o.charAt(n>>18&63)+o.charAt(n>>12&63)+o.charAt(n>>6&63)+o.charAt(63&n);return 2==a?(t=e.charCodeAt(l)<<8,r=e.charCodeAt(++l),n=t+r,u+=o.charAt(n>>10)+o.charAt(n>>4&63)+o.charAt(n<<2&63)+"="):1==a&&(n=e.charCodeAt(l),u+=o.charAt(n>>2)+o.charAt(n<<4&63)+"=="),u},f={encode:d,decode:l,version:"0.1.0"};void 0!==(n=function(){return f}.call(t,r,t,e))&&(e.exports=n)}()}).call(t,r(24)(e),r(6))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.stopMonitoringHlsJs=t.monitorHlsJs=void 0;var n=r(8),a=i(n),s=r(11),o=i(s),u=r(5),l=function(e){if(!e)return{};var t=o.default.navigationStart(),r=e.loading,i=r?r.start:e.trequest,n=r?r.first:e.tfirst,a=r?r.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+i),responseStart:Math.round(t+n),responseEnd:Math.round(t+a)}},d=function(e){if(e&&"function"==typeof e.getAllResponseHeaders)return(0,a.default)(e.getAllResponseHeaders())},f=function(e,t,r){var i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments[4]),n=e.log;if(!o.default.exists())return void n.warn("performance timing not supported. Not tracking HLS.js.");var a=function(r,i){return e.emit(t,r,i)},s=function(e,t){var r=t.levels,i=t.audioTracks,n=t.url,s=t.stats,o=t.networkDetails,f={},c={};r.forEach((function(e,t){f[t]={width:e.width,height:e.height,bitrate:e.bitrate,attrs:e.attrs}})),i.forEach((function(e,t){c[t]={name:e.name,language:e.lang,bitrate:e.bitrate}}));var h=l(s),p=h.bytesLoaded,v=h.requestStart,m=h.responseStart,g=h.responseEnd;a("requestcompleted",{request_event_type:e,request_bytes_loaded:p,request_start:v,request_response_start:m,request_response_end:g,request_type:"manifest",request_hostname:(0,u.extractHostname)(n),request_response_headers:d(o),request_rendition_lists:{media:f,audio:c,video:{}}})};r.on(i.Events.MANIFEST_LOADED,s);var f=function(e,t){var r=t.details,i=t.level,n=t.networkDetails,s=t.stats,o=l(s),f=o.bytesLoaded,c=o.requestStart,h=o.responseStart,p=o.responseEnd;a("requestcompleted",{request_event_type:e,request_bytes_loaded:f,request_start:c,request_response_start:h,request_response_end:p,request_current_level:i,request_type:"manifest",request_hostname:(0,u.extractHostname)(r.url),request_response_headers:d(n)})};r.on(i.Events.LEVEL_LOADED,f);var c=function(e,t){var r=t.details,i=t.networkDetails,n=t.stats,s=l(n),o=s.bytesLoaded,f=s.requestStart,c=s.responseStart,h=s.responseEnd;a("requestcompleted",{request_event_type:e,request_bytes_loaded:o,request_start:f,request_response_start:c,request_response_end:h,request_type:"manifest",request_hostname:(0,u.extractHostname)(r.url),request_response_headers:d(i)})};r.on(i.Events.AUDIO_TRACK_LOADED,c);var h=function(e,t){var i=t.stats,n=t.networkDetails,s=t.frag,o=l(i),f=o.bytesLoaded,c=o.requestStart,h=o.responseStart,p=o.responseEnd,v={request_event_type:e,request_bytes_loaded:f,request_start:c,request_response_start:h,request_response_end:p,request_hostname:n?(0,u.extractHostname)(n.responseURL):void 0,request_response_headers:d(n),request_media_duration:s.duration};"main"===s.type?(v.request_type="media",v.request_current_level=s.level,v.request_video_width=(r.levels[s.level]||{}).width,v.request_video_height=(r.levels[s.level]||{}).height):v.request_type=s.type,a("requestcompleted",v)};r.on(i.Events.FRAG_LOADED,h);var p=function(e,t){var r=t.details,n=t.response,s=t.context,o=t.frag;if(r===i.ErrorDetails.MANIFEST_LOAD_ERROR||r===i.ErrorDetails.MANIFEST_LOAD_TIMEOUT||r===i.ErrorDetails.FRAG_LOAD_ERROR||r===i.ErrorDetails.FRAG_LOAD_TIMEOUT||r===i.ErrorDetails.LEVEL_LOAD_ERROR||r===i.ErrorDetails.LEVEL_LOAD_TIMEOUT){var l=o&&o.url||s&&s.url||"";a("requestfailed",{request_error:r,request_url:l,request_hostname:(0,u.extractHostname)(l),request_type:r===i.ErrorDetails.FRAG_LOAD_ERROR||r===i.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":"manifest",request_error_code:n&&n.code,request_error_text:n&&n.text})}};r.on(i.Events.ERROR,p);var v=function(e,t){var r=t.frag,i=r&&r._url||"";a("requestcanceled",{request_cancel:e,request_url:i,request_type:"media",request_hostname:(0,u.extractHostname)(i)})};r.on(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,v);var m=function(e,t){var i=t.level,s=r.levels.find((function(e){return e.level===i}));if(s&&s.attrs&&s.attrs.BANDWIDTH){var o=s.attrs.BANDWIDTH;o?a("renditionchange",{video_source_bitrate:o,video_source_width:s.width,video_source_height:s.height}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};r.on(i.Events.LEVEL_SWITCHED,m),r._stopMuxMonitor=function(){r.off(i.Events.MANIFEST_LOADED,s),r.off(i.Events.LEVEL_LOADED,f),r.off(i.Events.AUDIO_TRACK_LOADED,c),r.off(i.Events.FRAG_LOADED,h),r.off(i.Events.ERROR,p),r.off(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,v),r.off(i.Events.LEVEL_SWITCHED,m),r.off(i.Events.DESTROYING,r._stopMuxMonitor),delete r._stopMuxMonitor},r.on(i.Events.DESTROYING,r._stopMuxMonitor)},c=function(e){e&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor()};t.monitorHlsJs=f,t.stopMonitoringHlsJs=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.stopMonitoringDashJS=t.monitorDashJS=void 0;var n=r(0),a=i(n),s=r(8),o=i(s),u=r(5),l=function(e,t){if(!e||"function"!=typeof e.getRequests)return{};var r=e.getRequests({state:"executed"});if(0===r.length)return{};var i=r[r.length-1],n=(0,u.extractHostname)(i.url),a=i.bytesLoaded,s=new Date(i.requestStartDate).getTime(),l=new Date(i.firstByteDate).getTime(),d=new Date(i.requestEndDate).getTime(),f=isNaN(i.duration)?0:i.duration,c="function"==typeof t.getMetricsFor?t.getMetricsFor(i.mediaType).HttpList:t.getDashMetrics().getHttpRequests(i.mediaType),h=void 0;return c.length>0&&(h=(0,o.default)(c[c.length-1]._responseHeaders||"")),{requestStart:s,requestResponseStart:l,requestResponseEnd:d,requestBytesLoaded:a,requestResponseHeaders:h,requestMediaDuration:f,requestHostname:n}},d=function(e,t){var r=t.getQualityFor(e),i=t.getCurrentTrackFor(e),n=i.bitrateList;return n?{currentLevel:r,renditionWidth:n[r].width||null,renditionHeight:n[r].height||null,renditionBitrate:n[r].bandwidth}:{}},f=function(e,t,r){var i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],e.log);if(!r||!r.on)return void i.warn("Invalid dash.js player reference. Monitoring blocked.");var n=function(r,i){return e.emit(t,r,i)},s=function(e){var t=e.type,r=e.data,i=r||{},a=i.url;n("requestcompleted",{request_event_type:t,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:(0,u.extractHostname)(a)})};r.on("manifestLoaded",s);var o={},f=function(e){var t=e.type,i=e.fragmentModel,a=e.chunk,s=a||{},u=s.mediaInfo,d=u||{},f=d.type,c=d.bitrateList;c=c||[];var h={};c.forEach((function(e,t){h[t]={},h[t].width=e.width,h[t].height=e.height,h[t].bitrate=e.bandwidth,h[t].attrs={}})),"video"===f?o.video=h:"audio"===f?o.audio=h:o.media=h;var p=l(i,r),v=p.requestStart,m=p.requestResponseStart,g=p.requestResponseEnd,y=p.requestResponseHeaders,_=p.requestMediaDuration,b=p.requestHostname;n("requestcompleted",{request_event_type:t,request_start:v,request_response_start:m,request_response_end:g,request_bytes_loaded:-1,request_type:f+"_init",request_response_headers:y,request_hostname:b,request_media_duration:_,request_rendition_lists:o})};r.on("initFragmentLoaded",f);var c=function(e){var t=e.type,i=e.fragmentModel,a=e.chunk,s=a||{},o=s.mediaInfo,u=s.start,f=o||{},c=f.type,h=l(i,r),p=h.requestStart,v=h.requestResponseStart,m=h.requestResponseEnd,g=h.requestBytesLoaded,y=h.requestResponseHeaders,_=h.requestMediaDuration,b=h.requestHostname,T=d(c,r),S=T.currentLevel,E=T.renditionWidth,w=T.renditionHeight,k=T.renditionBitrate;n("requestcompleted",{request_event_type:t,request_start:p,request_response_start:v,request_response_end:m,request_bytes_loaded:g,request_type:c,request_response_headers:y,request_hostname:b,request_media_start_time:u,request_media_duration:_,request_current_level:S,request_labeled_bitrate:k,request_video_width:E,request_video_height:w})};r.on("mediaFragmentLoaded",c);var h={video:void 0,audio:void 0,totalBitrate:void 0},p=function(){if(h.video&&"number"==typeof h.video.bitrate){if(!h.video.width||!h.video.height)return void i.warn("have bitrate info for video but missing width/height");var e=h.video.bitrate;return h.audio&&"number"==typeof h.audio.bitrate&&(e+=h.audio.bitrate),e!==h.totalBitrate?(h.totalBitrate=e,{video_source_bitrate:e,video_source_height:h.video.height,video_source_width:h.video.width}):void 0}},v=function(e,t,a){if("number"!=typeof e.newQuality)return void i.warn("missing evt.newQuality in qualityChangeRendered event",e);var s=e.mediaType;if("audio"===s||"video"===s){var o=r.getBitrateInfoListFor(s).find((function(t){return t.qualityIndex===e.newQuality}));if(!o||"number"!=typeof o.bitrate)return void i.warn("missing bitrate info for "+s);h[s]=o;var u=p();u&&n("renditionchange",u)}};r.on("qualityChangeRendered",v);var m=function(e){var t=e.error,r=e.event;r=r||{};var i=r.request||{},s=a.default.event&&a.default.event.currentTarget||{};n("requestfailed",{request_error:t+"_"+r.id+"_"+i.type,request_url:r.url,request_hostname:(0,u.extractHostname)(r.url),request_type:i.mediaType,request_error_code:s.status,request_error_type:s.statusText})};r.on("error",m),r._stopMuxMonitor=function(){r.off("manifestLoaded",s),r.off("initFragmentLoaded",f),r.off("mediaFragmentLoaded",c),r.off("qualityChangeRendered",v),r.off("error",m),delete r._stopMuxMonitor}},c=function(e){e&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor()};t.monitorDashJS=f,t.stopMonitoringDashJS=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){},n=0;i.prototype.on=function(e,t,r){return t._eventEmitterGuid=t._eventEmitterGuid||++n,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],r&&(t=t.bind(r)),this._listeners[e].push(t),t},i.prototype.off=function(e,t){var r=this._listeners&&this._listeners[e];r&&r.forEach((function(e,i){e._eventEmitterGuid===t._eventEmitterGuid&&r.splice(i,1)}))},i.prototype.one=function(e,t,r){var i=this;t._eventEmitterGuid=t._eventEmitterGuid||++n;var a=function n(){i.off(e,n),t.apply(r||this,arguments)};a._eventEmitterGuid=t._eventEmitterGuid,this.on(e,a)},i.prototype.emit=function(e,t){var r=this;if(this._listeners){t=t||{};var i=this._listeners["before*"]||[],n=this._listeners[e]||[],a=this._listeners["after"+e]||[],s=function(t,i){t=t.slice(),t.forEach((function(t){t.call(r,{type:e},i)}))};s(i,t),s(n,t),s(a,t)}},t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,this.on("playing",(function(){this._playheadShouldBeProgressing=!0})),this.on("play",this._startPlaybackHeartbeatInterval),this.on("playing",this._startPlaybackHeartbeatInterval),this.on("adbreakstart",this._startPlaybackHeartbeatInterval),this.on("adplay",this._startPlaybackHeartbeatInterval),this.on("adplaying",this._startPlaybackHeartbeatInterval),this.on("seeking",this._startPlaybackHeartbeatInterval),this.on("devicewake",this._startPlaybackHeartbeatInterval),this.on("viewstart",this._startPlaybackHeartbeatInterval),this.on("pause",this._stopPlaybackHeartbeatInterval),this.on("ended",this._stopPlaybackHeartbeatInterval),this.on("viewend",this._stopPlaybackHeartbeatInterval),this.on("error",this._stopPlaybackHeartbeatInterval),this.on("aderror",this._stopPlaybackHeartbeatInterval),this.on("adpause",this._stopPlaybackHeartbeatInterval),this.on("adended",this._stopPlaybackHeartbeatInterval),this.on("adbreakend",this._stopPlaybackHeartbeatInterval),this.on("seeked",(function(){this.data.player_is_paused?this._stopPlaybackHeartbeatInterval():this._startPlaybackHeartbeatInterval()})),this.on("timeupdate",(function(){null!==this._playbackHeartbeatInterval&&this.emit("playbackheartbeat")})),this.on("devicesleep",(function(e,t){null!==this._playbackHeartbeatInterval&&(n.default.clearInterval(this._playbackHeartbeatInterval),this.emit("playbackheartbeatend",{viewer_time:t.viewer_time}),this._playbackHeartbeatInterval=null)}))};a.prototype._startPlaybackHeartbeatInterval=function(){var e=this;null===this._playbackHeartbeatInterval&&(this.emit("playbackheartbeat"),this._playbackHeartbeatInterval=n.default.setInterval((function(){e.emit("playbackheartbeat")}),this.playbackHeartbeatTime))},a.prototype._stopPlaybackHeartbeatInterval=function(){this._playheadShouldBeProgressing=!1,null!==this._playbackHeartbeatInterval&&(n.default.clearInterval(this._playbackHeartbeatInterval),this.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)},t.default=a},function(e,t,r){"use strict";function i(){var e=this;this.on("viewinit",(function(){e.viewErrored=!1})),this.on("error",(function(){try{var t=e.errorTranslator({player_error_code:e.data.player_error_code,player_error_message:e.data.player_error_message});t?(e.data.player_error_code=t.player_error_code,e.data.player_error_message=t.player_error_message,e.viewErrored=!0):(delete e.data.player_error_code,delete e.data.player_error_message)}catch(t){e.mux.log.warn("Exception in error translator callback.",t),e.viewErrored=!0}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){this._watchTimeTrackerLastCheckedTime=null,this.on("playbackheartbeat",this._updateWatchTime),this.on("playbackheartbeatend",this._clearWatchTimeState)};a.prototype._updateWatchTime=function(e,t){var r=t.viewer_time;null===this._watchTimeTrackerLastCheckedTime&&(this._watchTimeTrackerLastCheckedTime=r),(0,n.default)(this.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r},a.prototype._clearWatchTimeState=function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null},t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){this._playbackTimeTrackerLastPlayheadPosition=-1,this.on("playbackheartbeat",this._updatePlaybackTime),this.on("playbackheartbeatend",this._clearPlaybackTimeState),this.on("seeking",this._clearPlaybackTimeState)};a.prototype._updatePlaybackTime=function(){var e=this.data.player_playhead_time;if(this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition){var t=e-this._playbackTimeTrackerLastPlayheadPosition;t<=1e3&&(0,n.default)(this.data,"view_content_playback_time",t)}this._playbackTimeTrackerLastPlayheadPosition=e},a.prototype._clearPlaybackTimeState=function(){this._updatePlaybackTime(),this._playbackTimeTrackerLastPlayheadPosition=-1},t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){this.on("playbackheartbeat",this._updatePlayheadTime),this.on("playbackheartbeatend",this._updatePlayheadTime),this.on("timeupdate",this._updatePlayheadTime),this.on("destroy",(function(){this.off("timeupdate",this._updatePlayheadTime)}))};i.prototype._updateMaxPlayheadPosition=function(){this.data.view_max_playhead_position=void 0===this.data.view_max_playhead_position?this.data.player_playhead_time:Math.max(this.data.view_max_playhead_position,this.data.player_playhead_time)},i.prototype._updatePlayheadTime=function(e,t){if(t.player_playhead_time)this.data.player_playhead_time=t.player_playhead_time,this._updateMaxPlayheadPosition();else if(this.getPlayheadTime){var r=this.getPlayheadTime();void 0!==r&&(this.data.player_playhead_time=r,this._updateMaxPlayheadPosition())}},t.default=i},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),a=i(n),s=r(2),o=i(s),u=function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,this.on("playbackheartbeat",this._checkIfRebuffering),this.on("playbackheartbeatend",this._cleanupRebufferTracker),this.on("seeking",(function(){this._cleanupRebufferTracker(null,{viewer_time:a.default.now()})}))};u.prototype._checkIfRebuffering=function(e,t){if(!this.disableRebufferTracking){if(this.isSeeking||this.isAdBreak||!this._playheadShouldBeProgressing)return void this._cleanupRebufferTracker(e,t);if(null===this._lastCheckedTime)return this._prepareRebufferTrackerState(t.viewer_time),void this._updateRebufferMetrics();if(this._lastPlayheadTime!==this.data.player_playhead_time)return void this._cleanupRebufferTracker(e,t,!0);var r=t.viewer_time-this._lastPlayheadTimeUpdatedTime;r>=this.sustainedRebufferThreshold&&(this._rebuffering?this._updateRebufferMetrics(t.viewer_time-this._lastCheckedTime):(this._rebuffering=!0,(0,o.default)(this.data,"view_rebuffer_count",1),this._updateRebufferMetrics(r),this.emit("rebufferstart"))),this._lastCheckedTime=t.viewer_time}},u.prototype._clearRebufferTrackerState=function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null},u.prototype._prepareRebufferTrackerState=function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e},u.prototype._cleanupRebufferTracker=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.disableRebufferTracking){if(this._rebuffering)this._rebuffering=!1,this._updateRebufferMetrics(t.viewer_time-this._lastCheckedTime),this.emit("rebufferend",{viewer_time:t.viewer_time});else{if(null===this._lastCheckedTime)return void this._updateRebufferMetrics();var i=this.data.player_playhead_time-this._lastPlayheadTime,n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;i>0&&n-i>this.minimumRebufferDuration?((0,o.default)(this.data,"view_rebuffer_count",1),this._updateRebufferMetrics(n-i),this.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+n-i})):this._updateRebufferMetrics()}r?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}},u.prototype._updateRebufferMetrics=function(e){e>0&&(0,o.default)(this.data,"view_rebuffer_duration",e),this.data.view_watch_time>=0&&this.data.view_rebuffer_count>0&&(this.data.view_rebuffer_frequency=this.data.view_rebuffer_count/this.data.view_watch_time,this.data.view_rebuffer_percentage=this.data.view_rebuffer_duration/this.data.view_watch_time)},t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){this.on("viewinit",(function(){var e=this.data,t=e.view_id;if(!e.view_program_changed){var r=function(e,r){var i=r.viewer_time;"playing"===e.type&&void 0===this.data.view_time_to_first_frame?this.calculateTimeToFirstFrame(i||n.default.now(),t):"adplaying"!==e.type||void 0!==this.data.view_time_to_first_frame&&!this.inPrerollPosition()||this.calculateTimeToFirstFrame(i||n.default.now(),t)};this.one("playing",r),this.one("adplaying",r),this.one("viewend",(function(){this.off("playing",r),this.off("adplaying",r)}))}}))};a.prototype.calculateTimeToFirstFrame=function(e,t){t===this.data.view_id&&(this._updateWatchTime(null,{viewer_time:e}),this.data.view_time_to_first_frame=this.data.view_watch_time,(this.data.player_autoplay_on||this.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.data.view_aggregate_startup_time=this.data.view_start+this.data.view_watch_time-this.NAVIGATION_START))},t.default=a},function(e,t,r){"use strict";function i(){var e=this;this.on("viewinit",(function(){this._lastPlayheadPosition=-1}));var t=["pause","rebufferstart","seeking","error","adbreakstart","hb"],r=["playing","hb"];t.forEach((function(t){e.on(t,(function(){if(this._lastPlayheadPosition>=0&&this.data.player_playhead_time>=0&&this._lastPlayerWidth>=0&&this._lastSourceWidth>0&&this._lastPlayerHeight>=0&&this._lastSourceHeight>0){var e=this.data.player_playhead_time-this._lastPlayheadPosition;if(e<0)return void(this._lastPlayheadPosition=-1);var t=Math.min(this._lastPlayerWidth/this._lastSourceWidth,this._lastPlayerHeight/this._lastSourceHeight),r=Math.max(0,t-1),i=Math.max(0,1-t);this.data.view_max_upscale_percentage=Math.max(this.data.view_max_upscale_percentage||0,r),this.data.view_max_downscale_percentage=Math.max(this.data.view_max_downscale_percentage||0,i),(0,a.default)(this.data,"view_total_content_playback_time",e),(0,a.default)(this.data,"view_total_upscaling",r*e),(0,a.default)(this.data,"view_total_downscaling",i*e)}this._lastPlayheadPosition=-1}))})),r.forEach((function(t){e.on(t,(function(){this._lastPlayheadPosition=this.data.player_playhead_time,this._lastPlayerWidth=this.data.player_width,this._lastPlayerHeight=this.data.player_height,this._lastSourceWidth=this.data.video_source_width,this._lastSourceHeight=this.data.video_source_height}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(2),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(){this.isSeeking=!1,this.on("seeking",(function(e,t){(0,d.default)(this.data,t),this._lastSeekingTime=s.default.now(),!1===this.isSeeking&&(this.isSeeking=!0,this.send("seeking"))})),this.on("seeked",(function(){this.isSeeking=!1;var e=this._lastSeekingTime||s.default.now(),t=s.default.now()-e;(0,u.default)(this.data,"view_seek_count",1),(0,u.default)(this.data,"view_seek_duration",t);var r=this.data.view_max_seek_time||0;this.data.view_max_seek_time=Math.max(r,t)})),this.on("viewend",(function(){this.isSeeking=!1}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var a=r(3),s=i(a),o=r(2),u=i(o),l=r(1),d=i(l)},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(2),s=i(a),o=r(5),u=r(1),l=i(u),d=function(e,t){e.push(t),e.sort((function(e,t){return e.viewer_time-t.viewer_time}))},f=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror"],c=function(){var e=this;this.on("viewinit",(function(){this.isAdBreak=!1,this._currentAdRequestNumber=0,this._currentAdResponseNumber=0,this._adRequests=[],this._adResponses=[],this._adHasPlayed=!1,this._wouldBeNewAdPlay=!0,this._prerollPlayTime=void 0})),f.forEach((function(t){return e.on(t,e._updateAdData)}));var t=function(){e.isAdBreak=!1};this.on("adbreakstart",(function(){this.isAdBreak=!0})),this.on("play",t),this.on("playing",t),this.on("viewend",t),this.on("adrequest",(function(e,t){t=(0,l.default)({ad_request_id:"generatedAdRequestId"+this._currentAdRequestNumber++},t),d(this._adRequests,t),(0,s.default)(this.data,"view_ad_request_count"),this.inPrerollPosition()&&(this.data.view_preroll_requested=!0,this._adHasPlayed||(0,s.default)(this.data,"view_preroll_request_count"))})),this.on("adresponse",(function(e,t){t=(0,l.default)({ad_request_id:"generatedAdRequestId"+this._currentAdResponseNumber++},t),d(this._adResponses,t);var r=this.findAdRequest(t.ad_request_id);r&&(0,s.default)(this.data,"view_ad_request_time",Math.max(0,t.viewer_time-r.viewer_time))})),this.on("adplay",(function(e,t){this._adHasPlayed=!0,this._wouldBeNewAdPlay&&(this._wouldBeNewAdPlay=!1,(0,s.default)(this.data,"view_ad_played_count")),this.inPrerollPosition()&&!this.data.view_preroll_played&&(this.data.view_preroll_played=!0,this._adRequests.length>0&&(this.data.view_preroll_request_time=Math.max(0,t.viewer_time-this._adRequests[0].viewer_time)),this.data.view_start&&(this.data.view_startup_preroll_request_time=Math.max(0,t.viewer_time-this.data.view_start)),this._prerollPlayTime=t.viewer_time)})),this.on("adplaying",(function(e,t){this.inPrerollPosition()&&void 0===this.data.view_preroll_load_time&&void 0!==this._prerollPlayTime&&(this.data.view_preroll_load_time=t.viewer_time-this._prerollPlayTime,this.data.view_startup_preroll_load_time=t.viewer_time-this._prerollPlayTime)})),this.on("adended",(function(){this._wouldBeNewAdPlay=!0})),this.on("aderror",(function(){this._wouldBeNewAdPlay=!0}))};c.prototype.inPrerollPosition=function(){return void 0===this.data.view_content_playback_time||this.data.view_content_playback_time<=1e3},c.prototype.findAdRequest=function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]},c.prototype._updateAdData=function(e,t){if(this.inPrerollPosition()){if(!this.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var r=(0,o.extractHostnameAndDomain)(t.ad_tag_url),i=n(r,2),a=i[0],s=i[1];this.data.view_preroll_ad_tag_domain=s,this.data.view_preroll_ad_tag_hostname=a}if(!this.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var u=(0,o.extractHostnameAndDomain)(t.ad_asset_url),l=n(u,2),d=l[0],f=l[1];this.data.view_preroll_ad_asset_domain=f,this.data.view_preroll_ad_asset_hostname=d}}},t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(){var e=this,t=void 0,r=void 0,i=function(){e.disableRebufferTracking||((0,u.default)(e.data,"view_waiting_rebuffer_count",1),t=s.default.now(),r=window.setInterval((function(){if(t){var r=s.default.now();(0,u.default)(e.data,"view_waiting_rebuffer_duration",r-t),t=r}}),250))},n=function(){e.disableRebufferTracking||t&&((0,u.default)(e.data,"view_waiting_rebuffer_duration",s.default.now()-t),t=!1,window.clearInterval(r))},a=!1,o=function(){a=!0},l=function(){a=!1,n()};this.on("waiting",(function(){a&&i()})),this.on("playing",(function(){n(),o()})),this.on("pause",l),this.on("seeking",l)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var a=r(3),s=i(a),o=r(2),u=i(o)},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(){var e=this;this.one("playbackheartbeat",l),this.on("playbackheartbeatend",(function(){e.off("before*",d),e.one("playbackheartbeat",l)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var a=r(1),s=i(a),o=r(3),u=i(o),l=function(){this.lastWallClockTime=u.default.now(),this.on("before*",d)},d=function(e){var t=u.default.now(),r=this.lastWallClockTime;this.lastWallClockTime=t,t-r>3e4&&(this.emit("devicesleep",{viewer_time:r}),(0,s.default)(this.data,{viewer_time:r}),this.send("devicesleep"),this.emit("devicewake",{viewer_time:t}),(0,s.default)(this.data,{viewer_time:t}),this.send("devicewake"))}},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(0),s=i(a),o=r(41),u=r(4),l=i(u),d=r(45),f=i(d),c=r(10),h=i(c),p=r(46),v=i(p),m=r(15),g=i(m),y=r(47),_=i(y),b=r(1),T=i(b),S=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id"],E=["viewstart","error","ended","viewend"],w=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.mux=e,this.envKey=t,this.eventQueue=new _.default((0,f.default)(t,r.beaconDomain)),this.previousBeaconData=null,this.lastEventTime=null,this.sampleRate=r.sampleRate,this.disableCookies=r.disableCookies,this.respectDoNotTrack=r.respectDoNotTrack;var i=r.platform||{};this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:i.name,viewer_application_version:i.version,viewer_application_engine:i.layout,viewer_device_name:i.product,viewer_device_category:"",viewer_device_manufacturer:i.manufacturer,viewer_os_family:i.os&&i.os.family,viewer_os_architecture:i.os&&i.os.architecture,viewer_os_version:i.os&&i.os.version};var n=(0,v.default)();n&&(this.pageLevelData=(0,T.default)(this.pageLevelData,{viewer_connection_type:n})),void 0!==s.default&&s.default.location&&s.default.location.href&&(this.pageLevelData.page_url=s.default.location.href),this.viewerData=this.disableCookies?{}:(0,o.getAndUpdateViewerData)()};w.prototype.send=function(e,t){if(e){if(this.respectDoNotTrack&&(0,h.default)())return l.default.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||"object"!==(void 0===t?"undefined":n(t)))return l.default.error("A data object was expected in send() but was not provided");var r=this.disableCookies?{}:(0,o.getAndUpdateSessionData)(),i={};(0,T.default)(i,this.pageLevelData),(0,T.default)(i,t),(0,T.default)(i,r),(0,T.default)(i,this.viewerData),i.event=e,i.env_key=this.envKey,i.user_id&&(i.viewer_user_id=i.user_id,delete i.user_id);var a=i.mux_sample_number>=this.sampleRate,s=this._deduplicateBeaconData(e,i),u=(0,g.default)(s);if(this.lastEventTime=this.mux.utils.now(),a)return l.default.info("Not sending event due to sample rate restriction",e,i,u);if(!this.envKey)return l.default.info("Not sending event due to missing environment key",e,i,u);if(!this.rateLimited)if(l.default.info("Sending event",e,i,u),this.rateLimited=!this.eventQueue.queueEvent(e,u),this.mux.WINDOW_UNLOADING&&"viewend"===e)this.eventQueue.destroy(!0);else if(E.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return i.event="eventrateexceeded",u=(0,g.default)(i),this.eventQueue.queueEvent(i.event,u),l.default.error("Beaconing disabled due to rate limit.")}},w.prototype.destroy=function(){this.eventQueue.destroy(!1)};var k=function(e,t,r,i){return!(!e||0!==t.indexOf("request_")||"request_response_headers"!==t&&"object"===(void 0===r?"undefined":n(r))&&"object"===(void 0===i?"undefined":n(i))&&Object.keys(r||{}).length===Object.keys(i||{}).length)},A=function(e,t){return"renditionchange"===e&&0===t.indexOf("video_source_")};w.prototype._deduplicateBeaconData=function(e,t){var r=this,i={},n=t.view_id;if(!n||"viewstart"===e||"viewend"===e||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)i=(0,T.default)({},t),n&&(this.previousBeaconData=i),n&&"viewend"===e&&(this.previousBeaconData=null);else{var a=0===e.indexOf("request");Object.keys(t).forEach((function(n){var s=t[n];(s!==r.previousBeaconData[n]||S.indexOf(n)>-1||k(a,n,s,r.previousBeaconData[n])||A(e,n))&&(i[n]=s,r.previousBeaconData[n]=s)}))}return i},t.default=w},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getAndUpdateSessionData=t.getAndUpdateViewerData=void 0;var n=r(12),a=i(n),s=r(44),o=i(s),u=r(7),l=r(3),d=i(l),f=function(){var e=void 0;try{e=a.default.parse(o.default.get("muxData")||"")}catch(t){e={}}return e},c=function(e){try{o.default.set("muxData",a.default.stringify(e),{expires:7300})}catch(e){}},h=function(){var e=f();return e.mux_viewer_id=e.mux_viewer_id||(0,u.generateUUID)(),e.msn=e.msn||Math.random(),c(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},p=function(){var e=f(),t=d.default.now();return e.session_start&&(e.sst=e.session_start,delete e.session_start),e.session_id&&(e.sid=e.session_id,delete e.session_id),e.session_expires&&(e.sex=e.session_expires,delete e.session_expires),(!e.sex||e.sex<t)&&(e.sid=(0,u.generateUUID)(),e.sst=t),e.sex=t+15e5,c(e),{session_id:e.sid,session_start:e.sst,session_expires:e.sex}};t.getAndUpdateViewerData=h,t.getAndUpdateSessionData=p},function(e,t,r){"use strict";var i=r(13),n=r(14),a={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},s=Date.prototype.toISOString,o={delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,serializeDate:function(e){return s.call(e)},skipNulls:!1,strictNullHandling:!1},u=function e(t,r,n,a,s,u,l,d,f,c,h,p){var v=t;if("function"==typeof l)v=l(r,v);else if(v instanceof Date)v=c(v);else if(null===v){if(a)return u&&!p?u(r,o.encoder):r;v=""}if("string"==typeof v||"number"==typeof v||"boolean"==typeof v||i.isBuffer(v))return u?[h(p?r:u(r,o.encoder))+"="+h(u(v,o.encoder))]:[h(r)+"="+h(String(v))];var m=[];if(void 0===v)return m;var g;if(Array.isArray(l))g=l;else{var y=Object.keys(v);g=d?y.sort(d):y}for(var _=0;_<g.length;++_){var b=g[_];s&&null===v[b]||(m=Array.isArray(v)?m.concat(e(v[b],n(r,b),n,a,s,u,l,d,f,c,h,p)):m.concat(e(v[b],r+(f?"."+b:"["+b+"]"),n,a,s,u,l,d,f,c,h,p)))}return m};e.exports=function(e,t){var r=e,s=t?i.assign({},t):{};if(null!==s.encoder&&void 0!==s.encoder&&"function"!=typeof s.encoder)throw new TypeError("Encoder has to be a function.");var l=void 0===s.delimiter?o.delimiter:s.delimiter,d="boolean"==typeof s.strictNullHandling?s.strictNullHandling:o.strictNullHandling,f="boolean"==typeof s.skipNulls?s.skipNulls:o.skipNulls,c="boolean"==typeof s.encode?s.encode:o.encode,h="function"==typeof s.encoder?s.encoder:o.encoder,p="function"==typeof s.sort?s.sort:null,v=void 0!==s.allowDots&&s.allowDots,m="function"==typeof s.serializeDate?s.serializeDate:o.serializeDate,g="boolean"==typeof s.encodeValuesOnly?s.encodeValuesOnly:o.encodeValuesOnly;if(void 0===s.format)s.format=n.default;else if(!Object.prototype.hasOwnProperty.call(n.formatters,s.format))throw new TypeError("Unknown format option provided.");var y,_,b=n.formatters[s.format];"function"==typeof s.filter?(_=s.filter,r=_("",r)):Array.isArray(s.filter)&&(_=s.filter,y=_);var T=[];if("object"!=typeof r||null===r)return"";var S;S=s.arrayFormat in a?s.arrayFormat:"indices"in s?s.indices?"indices":"repeat":"indices";var E=a[S];y||(y=Object.keys(r)),p&&y.sort(p);for(var w=0;w<y.length;++w){var k=y[w];f&&null===r[k]||(T=T.concat(u(r[k],k,E,d,f,c?h:null,_,p,v,m,b,g)))}var A=T.join(l),C=!0===s.addQueryPrefix?"?":"";return A.length>0?C+A:""}},function(e,t,r){"use strict";var i=r(13),n=Object.prototype.hasOwnProperty,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:i.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},s=function(e,t){for(var r={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=i.split(t.delimiter,s),u=0;u<o.length;++u){var l,d,f=o[u],c=f.indexOf("]="),h=-1===c?f.indexOf("="):c+1;-1===h?(l=t.decoder(f,a.decoder),d=t.strictNullHandling?null:""):(l=t.decoder(f.slice(0,h),a.decoder),d=t.decoder(f.slice(h+1),a.decoder)),n.call(r,l)?r[l]=[].concat(r[l]).concat(d):r[l]=d}return r},o=function(e,t,r){for(var i=t,n=e.length-1;n>=0;--n){var a,s=e[n];if("[]"===s)a=[],a=a.concat(i);else{a=r.plainObjects?Object.create(null):{};var o="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,u=parseInt(o,10);!isNaN(u)&&s!==o&&String(u)===o&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(a=[],a[u]=i):a[o]=i}i=a}return i},u=function(e,t,r){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,u=a.exec(i),l=u?i.slice(0,u.index):i,d=[];if(l){if(!r.plainObjects&&n.call(Object.prototype,l)&&!r.allowPrototypes)return;d.push(l)}for(var f=0;null!==(u=s.exec(i))&&f<r.depth;){if(f+=1,!r.plainObjects&&n.call(Object.prototype,u[1].slice(1,-1))&&!r.allowPrototypes)return;d.push(u[1])}return u&&d.push("["+i.slice(u.index)+"]"),o(d,t,r)}};e.exports=function(e,t){var r=t?i.assign({},t):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"==typeof r.delimiter||i.isRegExp(r.delimiter)?r.delimiter:a.delimiter,r.depth="number"==typeof r.depth?r.depth:a.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:a.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"==typeof r.decoder?r.decoder:a.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:a.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:a.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:a.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:a.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:a.strictNullHandling,""===e||null===e||void 0===e)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof e?s(e,r):e,o=r.plainObjects?Object.create(null):{},l=Object.keys(n),d=0;d<l.length;++d){var f=l[d],c=u(f,n[f],r);o=i.merge(o,c,r)}return i.compact(o)}},function(e,t,r){"use strict";var i,n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(s){var o=!1;if(i=s,void 0!==(n="function"==typeof i?i.call(t,r,t,e):i)&&(e.exports=n),o=!0,"object"===a(t)&&(e.exports=s(),o=!0),!o){var u=window.Cookies,l=window.Cookies=s();l.noConflict=function(){return window.Cookies=u,l}}}((function(){function e(r){function i(e,n,a){var s;if("undefined"!=typeof document){if(arguments.length>1){if(a=t({path:"/"},i.defaults,a),"number"==typeof a.expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*a.expires),a.expires=o}try{s=JSON.stringify(n),/^[\{\[]/.test(s)&&(n=s)}catch(e){}return n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape),document.cookie=[e,"=",n,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}e||(s={});for(var u=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<u.length;d++){var f=u[d].split("="),c=f.slice(1).join("=");'"'===c.charAt(0)&&(c=c.slice(1,-1));try{var h=f[0].replace(l,decodeURIComponent);if(c=r.read?r.read(c,h):r(c,h)||c.replace(l,decodeURIComponent),this.json)try{c=JSON.parse(c)}catch(e){}if(e===h){s=c;break}e||(s[h]=c)}catch(e){}}return s}}return i.set=i,i.get=function(e){return i.call(i,e)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(e,r){i(e,"",t(r,{expires:-1}))},i.withConverter=e,i}var t=function(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t};return e((function(){}))}))},function(e,t,r){"use strict";function i(e,t){return e=e||"",t=t||"litix.io",e.match(/^[a-z0-9]+$/)?"https://"+e+"."+t:"https://img.litix.io/a.gif"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),n=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){var e=void 0;switch(s()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},s=function(){var e=n.default.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};t.default=a},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=i(n),s=r(4),o=i(s),u=r(48),l=i(u),d=r(1),f=i(d),c=r(15),h=i(c),p=!!a.default.XMLHttpRequest&&"withCredentials"in new a.default.XMLHttpRequest,v={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:5e3},m=function(e,t){this._beaconUrl=e||"https://img.litix.io",this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=(0,f.default)({},v,t)};m.prototype.queueEvent=function(e,t){var r=(0,f.default)({},t);return p?(this._eventQueue.length<=this._options.maxQueueLength||"eventrateexceeded"===e)&&(this._eventQueue.push(r),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):(l.default.send(this._beaconUrl,r),!0)},m.prototype.flushEvents=function(){p&&(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},m.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e?this._clearBeaconQueue():this.flushEvents(),a.default.clearTimeout(this._sendTimeout)},m.prototype._clearBeaconQueue=function(){var e=a.default.navigator,t=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,r=this._eventQueue.slice(t);if(t>0&&(0,f.default)(r[r.length-1],(0,h.default)({mux_view_message:"event queue truncated"})),e.sendBeacon)e.sendBeacon(this._beaconUrl,JSON.stringify({events:r}));else if(a.default.XMLHttpRequest){var i=new a.default.XMLHttpRequest;i.open("POST",this._beaconUrl),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({events:r}))}else l.default.send(this._beaconUrl,r[r.length-1])},m.prototype._sendBeaconQueue=function(){var e=this;if(a.default.XMLHttpRequest&&!this._postInFlight){var t=new a.default.XMLHttpRequest,r=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0,t.onreadystatechange=function(){4===t.readyState&&(200!==t.status?(e._eventQueue=r.concat(e._eventQueue),e._failureCount+=1,o.default.info("Error sending beacon: "+t.status),o.default.info(t.responseText)):e._failureCount=0,e._postInFlight=!1)},t.open("POST",this._beaconUrl),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({events:r}))}},m.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var e=Math.pow(2,this._failureCount-1);return(1+(e*=Math.random()))*this._options.baseTimeBetweenBeacons},m.prototype._startBeaconSending=function(){var e=this;a.default.clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=a.default.setTimeout((function(){e._eventQueue.length&&e._sendBeaconQueue(),e._startBeaconSending()}),this._getNextBeaconTime()))},t.default=m},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),a=i(n),s=r(0),o=i(s),u={};u.send=function(e,t){function r(){i.src=s+(n?"&rc="+n:"")}var i=new Image,n=0,s=e+"?"+a.default.stringify(t);return i.addEventListener("error",(function(){n>3||o.default.setTimeout((function(){n++,r()}),5e3*n)})),r(),i},t.default=u},function(e,t,r){"use strict";function i(){function e(e,t){var r=t.request_start,u=t.request_response_start,l=t.request_response_end,d=t.request_bytes_loaded;s++;var f=void 0,c=void 0;if(u?(f=u-r,c=l-u):c=l-r,c>0&&d>0){var h=d/c*8e3;o++,n+=d,a+=c,this.data.view_min_request_throughput=Math.min(this.data.view_min_request_throughput||1/0,h),this.data.view_average_request_throughput=n/a*8e3,this.data.view_request_count=s,f>0&&(i+=f,this.data.view_max_request_latency=Math.max(this.data.view_max_request_latency||0,f),this.data.view_average_request_latency=i/o)}}function t(e,t){s++,u++,this.data.view_request_count=s,this.data.view_request_failed_count=u}function r(e,t){s++,l++,this.data.view_request_count=s,this.data.view_request_canceled_count=l}var i=0,n=0,a=0,s=0,o=0,u=0,l=0;this.on("requestcompleted",e),this.on("requestfailed",t),this.on("requestcanceled",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";function i(e,t,r){var i=(0,u.findMediaElement)(t),s=a(i,3),f=s[0],c=s[1],h=s[2],p=e.log,v=e.utils.getComputedStyle,m=e.utils.secondsToMs,g={automaticErrorTracking:!0};if(!f)return p.error("No element was found with the `"+c+"` query selector.");if("video"!==h&&"audio"!==h)return p.error("The element of `"+c+"` was not a media element.");r=(0,o.default)(g,r),r.data=(0,o.default)({player_software:"HTML5 Video Element",player_software_version:"No Versions",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:"4.2.0"},r.data),r.getPlayheadTime=function(){return m(f.currentTime)},r.getStateData=function(){var e=this.hlsjs&&this.hlsjs.url,t=this.dashjs&&n("function"===this.dashjs.getSource)&&this.dashjs.getSource();return{player_is_paused:f.paused,player_playhead_time:m(f.currentTime),player_width:parseInt(v(f,"width")),player_height:parseInt(v(f,"height")),player_autoplay_on:f.autoplay,player_preload_on:f.preload,video_poster_url:f.poster,video_source_url:e||t||f.currentSrc,video_source_duration:m(f.duration),video_source_height:f.videoHeight,video_source_width:f.videoWidth}},f.mux=f.mux||{},f.mux.deleted=!1,f.mux.emit=function(t,r){e.emit(c,t,r)};var y=function(){p.error("The monitor for this video element has already been destroyed.")};f.mux.destroy=function(){Object.keys(f.mux.listeners).forEach((function(e){f.removeEventListener(e,f.mux.listeners[e],!1)})),delete f.mux.listeners,f.mux.destroy=y,f.mux.swapElement=y,f.mux.emit=y,f.mux.addHLSJS=y,f.mux.addDashJS=y,f.mux.removeHLSJS=y,f.mux.removeDashJS=y,f.mux.deleted=!0,e.emit(c,"destroy")},f.mux.swapElement=function(t){var r=(0,u.findMediaElement)(t),i=a(r,3),n=i[0],s=i[1],l=i[2];return n?"video"!==l&&"audio"!==l?e.log.error("The element of `"+s+"` was not a media element."):(n.muxId=f.muxId,delete f.muxId,n.mux=n.mux||{},n.mux.listeners=(0,o.default)({},f.mux.listeners),delete f.mux.listeners,Object.keys(n.mux.listeners).forEach((function(e){f.removeEventListener(e,n.mux.listeners[e],!1),n.addEventListener(e,n.mux.listeners[e],!1)})),n.mux.swapElement=f.mux.swapElement,n.mux.destroy=f.mux.destroy,delete f.mux,void(f=n)):e.log.error("No element was found with the `"+s+"` query selector.")},f.mux.addHLSJS=function(t){e.addHLSJS(c,t)},f.mux.addDashJS=function(t){e.addDashJS(c,t)},f.mux.removeHLSJS=function(){e.removeHLSJS(c)},f.mux.removeDashJS=function(){e.removeDashJS(c)},e.init(c,r),e.emit(c,"playerready"),f.paused||(e.emit(c,"play"),f.readyState>2&&e.emit(c,"playing")),f.mux.listeners={},l.forEach((function(t){("error"!==t||r.automaticErrorTracking)&&(f.mux.listeners[t]=function(){var r={};"error"===t&&(r.player_error_code=f.error&&f.error.code,r.player_error_message=f.error&&d[f.error.code]),e.emit(c,t,r)},f.addEventListener(t,f.mux.listeners[t],!1))}))}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=i;var s=r(1),o=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(9),l=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],d={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"}},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(52),a=i(n),s=r(2),o=i(s),u=r(53),l=i(u),d=r(54),f=i(d),c=r(1),h=i(c),p=r(8),v=i(p),m=r(5),g=r(3),y=i(g),_={};_.safeCall=a.default,_.safeIncrement=o.default,_.getComputedStyle=l.default,_.secondsToMs=f.default,_.assign=h.default,_.headersStringToObject=v.default,_.extractHostnameAndDomain=m.extractHostnameAndDomain,_.extractHostname=m.extractHostname,_.now=y.default.now,t.default=_},function(e,t,r){"use strict";function i(e,t,r,i){var n=i;if(e&&"function"==typeof e[t])try{n=e[t].apply(e,r)}catch(e){a.default.info("safeCall error",e)}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(4),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";function i(e,t){if(e&&t&&a.default&&"function"==typeof a.default.getComputedStyle){var r=void 0;return s&&s.has(e)&&(r=s.get(e)),r||(r=a.default.getComputedStyle(e,null),s&&s.set(e,r)),r.getPropertyValue(t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n),s=void 0;a.default&&a.default.WeakMap&&(s=new WeakMap)},function(e,t,r){"use strict";function i(e){return Math.floor(1e3*e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}])}))}()},function(e,t,r){"use strict";function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return{}},o=!1;e.on("adstart",(function(){o=!0})),e.on("adend",(function(){o=!1})),e.on("adserror",(function(){o=!1}));var u=function(){var i=s(t.currentTime()),u=function r(){var u=a.default.utils.now(),l=s(t.currentTime());if(o){if(l>i){var d=n();d.viewer_time=u-Math.max(0,l-i),t.off("timeupdate",r),e.mux.emit("adplaying",d)}}else t.off("timeupdate",r)};t.on("timeupdate",u);var l=function e(){t.off("timeupdate",u),r.forEach((function(r){t.off(r,e)}))};r.forEach((function(e){t.on(e,l)}))};i.forEach((function(e){t.on(e,u)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n),s=a.default.utils.secondsToMs},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(s.default.IS_IE8)return!1;var t=this,r=t.id();e=S({automaticErrorTracking:!0},e),e.data=S({player_software_name:"Video.js",player_software_version:s.default.VERSION||"< 4.11",player_mux_plugin_name:"videojs-mux",player_mux_plugin_version:"4.2.0"},e.data),e.getPlayheadTime=function(){return k(t.currentTime())},e.getStateData=function(){var e=E(t,"videoHeight"),r=E(t,"videoWidth");if(void 0===r||void 0===e){var i=t.el().firstChild;i&&"VIDEO"===i.nodeName.toUpperCase()&&(e=i.videoHeight,r=i.videoWidth)}return{player_is_paused:E(t,"paused"),player_is_fullscreen:E(t,"isFullscreen"),player_autoplay_on:!!E(t,"autoplay"),player_preload_on:E(t,"preload"),player_width:w(t.el(),"width"),player_height:w(t.el(),"height"),player_language_code:E(t,"language"),video_poster_url:E(t,"poster"),video_source_url:E(t,"currentSrc"),video_source_mime_type:E(t,"currentType")&&E(t,"currentType").toLowerCase(),video_source_duration:k(E(t,"duration")||0),video_source_height:e,video_source_width:r}},t.mux=function(){T.error("[videojs-mux] The plugin was initialized more than once.")},t.mux.emit=function(e,t){u.default.emit(r,e,t)},t.mux.addHLSJS=function(e){u.default.addHLSJS(r,e)},t.mux.log=T,t.mux.utils=u.default.utils,u.default.init(r,e);var i=!1,n=function(){i||t.mux.emit("playerready"),i=!0};t.ready((function(){t.addClass("vjs-mux"),d.default.setTimeout(n,0)}));var a=!1;t.one("play",n),A.forEach((function(r){("error"!==r||e.automaticErrorTracking)&&t.on(r,(function(){if(!a){var e={};if("error"===r){var i=E(t,"error");e.player_error_code=i&&i.code,e.player_error_message=i&&i.message}t.mux.emit(r,e)}}))}));var o=!1;t.on("play",(function(){o=!0})),t.on("pause",(function(){o=!1})),t.on("adstart",(function(){a=!0,o&&t.mux.emit("pause"),t.mux.emit("adbreakstart")})),t.on("adend",(function(){t.mux.emit("adbreakend"),a=!1,E(t,"paused")||(t.mux.emit("play"),o=!0,t.onceux&&t.mux.emit("playing"))})),t.ima&&(0,c.default)(t),t.onceux&&(0,y.default)(t),t.ima3&&"function"==typeof t.ima3.ready&&(0,p.default)(t),t.FreeWheelPlugin&&t.FreeWheelPlugin.VERSION&&(0,m.default)(t),t.on("dispose",(function(){t.mux.emit("destroy")}))}var a=r(3),s=i(a),o=r(0),u=i(o),l=r(4),d=i(l),f=r(6),c=i(f),h=r(7),p=i(h),v=r(8),m=i(v),g=r(9),y=i(g),_=r(10),b=i(_),T=u.default.log,S=u.default.utils.assign,E=u.default.utils.safeCall,w=u.default.utils.getComputedStyle,k=u.default.utils.secondsToMs,A=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"];(s.default.registerPlugin||s.default.plugin||function(){u.default.log.error("No valid method to register videojs plugin available.")})("mux",n),(0,b.default)(s.default)},function(t,r){t.exports=e},function(e,t,r){(function(t){var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=r}).call(t,r(5))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function i(e){var t=function(t){t=t||{};var r="function"==typeof t.getAdData?t.getAdData():{},i="function"==typeof t.getAd?t.getAd():{},n="function"==typeof i.getMediaUrl?i.getMediaUrl():r.mediaUrl,a=e.ima.settings||{},s={};return n&&(s.ad_asset_url=n),a.adTagUrl&&(s.ad_tag_url=a.adTagUrl),s},r=void 0,i=void 0,n=void 0,a=void 0,s=void 0,o=void 0;try{var u=window.google.ima.AdEvent.Type;r=u.LOADED,i=u.STARTED,n=u.COMPLETE,a=u.PAUSED,s=u.RESUMED,o=u.SKIPPED}catch(e){r="loaded",i="start",n="complete",a="pause",s="resume",o="skip"}var l=0;e.mux.triggerAdRequest=function(){l++,e.mux.emit("adrequest",t())},e.on("adsready",(function(){var u=e.ima.addEventListener||function(){};u(r,(function(r){var i=t(r);l>0&&(l--,e.mux.emit("adresponse",i)),e.mux.emit("adplay",i)})),u(i,(function(r){var i=t(r);e.mux.emit("adplaying",i)})),u(s,(function(r){var i=t(r);e.mux.emit("adplay",i),e.mux.emit("adplaying",i)})),u(a,(function(r){var i=t(r);e.mux.emit("adpause",i)})),u(n,(function(r){var i=t(r);e.mux.emit("adended",i)})),u(o,(function(r){var i=t(r);e.mux.emit("adended",i)})),e.on("adserror",(function(){l>0&&(l--,e.mux.emit("adresponse")),e.mux.emit("aderror")}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";function i(e){if("string"!=typeof e)return!1;var t=e.split(".").map((function(e){return parseInt(e)})),r=t[0],i=t[1];return r>2||2===r&&i>=3}function n(e){var t=function(){var t=e.ima3.currentAd,r=e.ima3.settings,i={};return t&&(i.ad_asset_url=t.mediaUrl),r&&(i.ad_tag_url=r.serverUrl),i};if(i(e.ima3.version)){var r=0,n=function(){r>0&&(r--,e.mux.emit("adresponse",t()))};e.on("ads-request",(function(){r++,e.mux.emit("adrequest",t())})),e.on("ads-load",(function(){n(),e.mux.emit("adplay",t())})),e.on("adserror",(function(){n(),e.mux.emit("aderror")})),e.on("ads-play",(function(){e.mux.emit("adplay",t())})),e.on("ads-pause",(function(){e.mux.emit("adpause",t())})),e.on("ads-ad-ended",(function(){e.mux.emit("adended",t())}))}e.ima3.ready((function(){if(e.ima3.adPlayer){i(e.ima3.version)||(e.ima3.adPlayer.on("play",(function(){e.mux.emit("adplay")})),e.ima3.adPlayer.on("pause",(function(){e.mux.emit("adpause")})),e.ima3.adPlayer.on("ended",(function(){e.mux.emit("adended")})));var r=["pause","ended","adserror"],n=["play"];(0,s.default)(e,e.ima3.adPlayer,r,n,t)}else e.mux.log("Legacy IMA3 plugin found, ad events may not track correctly."),e.on("ads-ad-started",(function(){e.mux.emit("adplaying",t())})),e.on("ads-play",(function(){e.mux.emit("adplaying",t())}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.brightcoveImaAdsEventsSupported=i,t.default=n;var a=r(1),s=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,r){"use strict";function i(e){var t=function(t){var r=e.FreeWheelPlugin,i={};switch(t){case"adplay":case"adplaying":case"adpause":i.ad_asset_url=e.currentSrc()}return r&&(i.ad_tag_url="html5"===r.tech.toLowerCase()?r.settings.Html5.serverUrl:r.settings.Flash.serverUrl),i};e.on("ads-request",(function(){e.mux.emit("adrequest",t("adrequest"))})),e.on("ads-load",(function(){e.mux.emit("adresponse",t("adresponse"))})),e.on("adserror",(function(){e.mux.emit("aderror")})),e.on("ads-ad-started",(function(){e.mux.emit("adplay",t("adplay")),e.mux.emit("adplaying",t("adplaying"))})),e.on("ads-play",(function(){e.mux.emit("adplay",t("adplay")),e.mux.emit("adplaying",t("adplaying"))})),e.on("ads-pause",(function(){e.mux.emit("adpause",t("adpause"))})),e.on("ads-ad-ended",(function(){e.mux.emit("adended",t("adended"))})),e.on("adend",(function(){e.mux.emit("play")}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,r){"use strict";function i(e){var t=["onceux-linearad-pause","onceux-linearad-skipped","onceux-linearad-complete","adserror"],r=["adstart","onceux-linearad-resume"];(0,a.default)(e,e,t,r),e.on("adstart",(function(){e.mux.emit("adplay")})),e.on("onceux-linearad-start",(function(t){t.linearAd&&t.linearAd.index>0&&(e.mux.emit("adplay"),e.mux.emit("adplaying"))})),e.on("onceux-linearad-resume",(function(){e.mux.emit("adplay")})),e.on("onceux-linearad-pause",(function(){e.mux.emit("adpause")})),e.on("onceux-linearad-complete",(function(){e.mux.emit("adended")})),e.on("onceux-linearad-skipped",(function(){e.mux.emit("adended")}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";function i(e){if(!u&&"function"==typeof e.getTech){for(var t=e.getTech("Html5")||{},r=t.sourceHandlers,i=0;i<r.length;i++)!function(t){var i=r[t],a=i.handleSource;i.handleSource=function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=a(t,r,i);if(u&&"function"==typeof u.xhr)try{var l=e.VERSION.split("."),d=n(l,2),f=d[0],c=d[1];f=parseInt(f),c=parseInt(c);var h=f>=7&&c>=4?u.player().id():u.player_.el_.parentNode.id;(0,s.default)(e(h),u.xhr),(0,o.trackRenditionChanges)(e(h))}catch(e){}return u}}(i);u=!0}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=i;var a=r(11),s=function(e){return e&&e.__esModule?e:{default:e}}(a),o=r(13),u=!1},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var r=function(t,r,i){var n=(0,s.default)(e,t,r);return function(){try{n()}catch(e){}try{i()}catch(e){}}},i=function(e){return function(t){var i=u.default.utils.now();try{e(t)}catch(e){}try{t.onreadystatechange=r(t,i,t.onreadystatechange||function(){})}catch(e){}}};t.beforeRequest=function(e){return function(t){var r=e(t);return r.beforeSend=i(r.beforeSend||function(){}),r}}(t.beforeRequest||function(e){return e})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var a=r(12),s=i(a),o=r(0),u=i(o)},function(e,t,r){"use strict";function i(e,t,r){var i=e.mux.utils.extractHostnameAndDomain,a=e.mux.utils.headersStringToObject,o=function(e){var t=e["content-type"];return t?t.match(/^audio\/mpegurl/i)?"manifest":t.match(/^audio.*/i)?"audio":t.match(/^video.*/)?"video":t.match(/^application\/x-mpegurl/i)?"manifest":t.match(/^application\/vnd.apple.mpegurl/i)?"manifest":t.match(/^application\/dash+xml/i)?"manifest":"unknown":"unknown"},u=0;return function(){var l=t.readyState;if(l>=2){if(u=u||s.default.utils.now(),4!==l)return;if(t.status>=200&&t.status<300){var d=s.default.utils.now(),f="arraybuffer"===t.responseType?t.response.byteLength:t.responseText.length,c=i(t.responseURL),h=n(c,1),p=h[0],v=a(t.getAllResponseHeaders?t.getAllResponseHeaders():""),m=o(v),g={request_start:r,request_response_start:u,request_response_end:d,request_bytes_loaded:f,request_hostname:p,request_response_headers:v,request_type:m};e.mux.emit("requestcompleted",g)}else e.mux.emit("requestfailed")}}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=i;var a=r(0),s=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){for(var t=e.textTracks(),r=void 0,i=0;i<t.length;i++)"segment-metadata"===t[i].label&&(r=t[i]);return r},n=function(e){var t=i(e),r=void 0;t&&t.on&&t.on("cuechange",(function(){try{var t=e.tech({IWillNotUseThisInPlugins:!0}),i=t.vhs||t.hls,n=i.playlists.media().attributes.BANDWIDTH;r!==n&&e.mux.emit("renditionchange",{video_source_bitrate:n}),r=n}catch(t){e.mux&&e.mux.log&&e.mux.log.warn&&e.mux.log.warn("Cannot retrieve BANDWIDTH information from player: "+t)}}))};t.getSegmentMetadataTrack=i,t.trackRenditionChanges=n}])}))})()},"./node_modules/videojs-vtt.js/lib/browser-index.js":function(e,t,r){var i=r("./node_modules/global/window.js");var n=e.exports={WebVTT:r("./node_modules/videojs-vtt.js/lib/vtt.js"),VTTCue:r("./node_modules/videojs-vtt.js/lib/vttcue.js"),VTTRegion:r("./node_modules/videojs-vtt.js/lib/vttregion.js")};i.vttjs=n;i.WebVTT=n.WebVTT;var a=n.VTTCue;var s=n.VTTRegion;var o=i.VTTCue;var u=i.VTTRegion;n.shim=function(){i.VTTCue=a;i.VTTRegion=s};n.restore=function(){i.VTTCue=o;i.VTTRegion=u};if(!i.VTTCue){n.shim()}},"./node_modules/videojs-vtt.js/lib/vtt.js":function(e,t){var r=Object.create||function(){function e(){}return function(t){if(arguments.length!==1){throw new Error("Object.create shim only accepts one parameter.")}e.prototype=t;return new e}}();function i(e,t){this.name="ParsingError";this.code=e.code;this.message=t||e.message}i.prototype=r(Error.prototype);i.prototype.constructor=i;i.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function n(e){function t(e,t,r,i){return(e|0)*3600+(t|0)*60+(r|0)+(i|0)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!r){return null}if(r[3]){return t(r[1],r[2],r[3].replace(":",""),r[4])}else if(r[1]>59){return t(r[1],r[2],0,r[4])}else{return t(0,r[1],r[2],r[4])}}function a(){this.values=r(null)}a.prototype={set:function(e,t){if(!this.get(e)&&t!==""){this.values[e]=t}},get:function(e,t,r){if(r){return this.has(e)?this.values[e]:t[r]}return this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i){if(t===r[i]){this.set(e,t);break}}},integer:function(e,t){if(/^-?\d+$/.test(t)){this.set(e,parseInt(t,10))}},percent:function(e,t){var r;if(r=t.match(/^([\d]{1,3})(\.[\d]*)?%$/)){t=parseFloat(t);if(t>=0&&t<=100){this.set(e,t);return true}}return false}};function s(e,t,r,i){var n=i?e.split(i):[e];for(var a in n){if(typeof n[a]!=="string"){continue}var s=n[a].split(r);if(s.length!==2){continue}var o=s[0];var u=s[1];t(o,u)}}function o(e,t,r){var o=e;function u(){var t=n(e);if(t===null){throw new i(i.Errors.BadTimeStamp,"Malformed timestamp: "+o)}e=e.replace(/^[^\sa-zA-Z-]+/,"");return t}function l(e,t){var i=new a;s(e,(function(e,t){switch(e){case"region":for(var n=r.length-1;n>=0;n--){if(r[n].id===t){i.set(e,r[n].region);break}}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];i.integer(e,s);i.percent(e,s)?i.set("snapToLines",false):null;i.alt(e,s,["auto"]);if(a.length===2){i.alt("lineAlign",a[1],["start","middle","end"])}break;case"position":a=t.split(",");i.percent(e,a[0]);if(a.length===2){i.alt("positionAlign",a[1],["start","middle","end"])}break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","middle","end","left","right"]);break}}),/:/,/\s/);t.region=i.get("region",null);t.vertical=i.get("vertical","");t.line=i.get("line","auto");t.lineAlign=i.get("lineAlign","start");t.snapToLines=i.get("snapToLines",true);t.size=i.get("size",100);t.align=i.get("align","middle");t.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align);t.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}function d(){e=e.replace(/^\s+/,"")}d();t.startTime=u();d();if(e.substr(0,3)!=="--\x3e"){throw new i(i.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+o)}e=e.substr(3);d();t.endTime=u();d();l(e,t)}var u={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "};var l={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"};var d={v:"title",lang:"lang"};var f={rt:"ruby"};function c(e,t){function r(){if(!t){return null}function e(e){t=t.substr(e.length);return e}var r=t.match(/^([^<]*)(<[^>]*>?)?/);return e(r[1]?r[1]:r[2])}function i(e){return u[e]}function a(e){while(y=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/)){e=e.replace(y[0],i)}return e}function s(e,t){return!f[t.localName]||f[t.localName]===e.localName}function o(t,r){var i=l[t];if(!i){return null}var n=e.document.createElement(i);n.localName=i;var a=d[t];if(a&&r){n[a]=r.trim()}return n}var c=e.document.createElement("div"),h=c,p,v=[];while((p=r())!==null){if(p[0]==="<"){if(p[1]==="/"){if(v.length&&v[v.length-1]===p.substr(2).replace(">","")){v.pop();h=h.parentNode}continue}var m=n(p.substr(1,p.length-2));var g;if(m){g=e.document.createProcessingInstruction("timestamp",m);h.appendChild(g);continue}var y=p.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y){continue}g=o(y[1],y[3]);if(!g){continue}if(!s(h,g)){continue}if(y[2]){g.className=y[2].substr(1).replace("."," ")}v.push(y[1]);h.appendChild(g);h=g;continue}h.appendChild(e.document.createTextNode(a(p)))}return c}var h=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function p(e){for(var t=0;t<h.length;t++){var r=h[t];if(e>=r[0]&&e<=r[1]){return true}}return false}function v(e){var t=[],r="",i;if(!e||!e.childNodes){return"ltr"}function n(e,t){for(var r=t.childNodes.length-1;r>=0;r--){e.push(t.childNodes[r])}}function a(e){if(!e||!e.length){return null}var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);if(i){e.length=0;return i[0]}return r}if(t.tagName==="ruby"){return a(e)}if(t.childNodes){n(e,t);return a(e)}}n(t,e);while(r=a(t)){for(var s=0;s<r.length;s++){i=r.charCodeAt(s);if(p(i)){return"rtl"}}}return"ltr"}function m(e){if(typeof e.line==="number"&&(e.snapToLines||e.line>=0&&e.line<=100)){return e.line}if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement){return-1}var t=e.track,r=t.textTrackList,i=0;for(var n=0;n<r.length&&r[n]!==t;n++){if(r[n].mode==="showing"){i++}}return++i*-1}function g(){}g.prototype.applyStyles=function(e,t){t=t||this.div;for(var r in e){if(e.hasOwnProperty(r)){t.style[r]=e[r]}}};g.prototype.formatStyle=function(e,t){return e===0?0:e+t};function y(e,t,r){var i=/MSIE\s8\.0/.test(navigator.userAgent);var n="rgba(255, 255, 255, 1)";var a="rgba(0, 0, 0, 0.8)";if(i){n="rgb(255, 255, 255)";a="rgb(0, 0, 0)"}g.call(this);this.cue=t;this.cueDiv=c(e,t.text);var s={color:n,backgroundColor:a,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};if(!i){s.writingMode=t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl";s.unicodeBidi="plaintext"}this.applyStyles(s,this.cueDiv);this.div=e.document.createElement("div");s={textAlign:t.align==="middle"?"center":t.align,font:r.font,whiteSpace:"pre-line",position:"absolute"};if(!i){s.direction=v(this.cueDiv);s.writingMode=t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"}this.applyStyles(s);this.div.appendChild(this.cueDiv);var o=0;switch(t.positionAlign){case"start":o=t.position;break;case"middle":o=t.position-t.size/2;break;case"end":o=t.position-t.size;break}if(t.vertical===""){this.applyStyles({left:this.formatStyle(o,"%"),width:this.formatStyle(t.size,"%")})}else{this.applyStyles({top:this.formatStyle(o,"%"),height:this.formatStyle(t.size,"%")})}this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}y.prototype=r(g.prototype);y.prototype.constructor=y;function _(e){var t=/MSIE\s8\.0/.test(navigator.userAgent);var r,i,n,a;if(e.div){i=e.div.offsetHeight;n=e.div.offsetWidth;a=e.div.offsetTop;var s=(s=e.div.childNodes)&&(s=s[0])&&s.getClientRects&&s.getClientRects();e=e.div.getBoundingClientRect();r=s?Math.max(s[0]&&s[0].height||0,e.height/s.length):0}this.left=e.left;this.right=e.right;this.top=e.top||a;this.height=e.height||i;this.bottom=e.bottom||a+(e.height||i);this.width=e.width||n;this.lineHeight=r!==undefined?r:e.lineHeight;if(t&&!this.lineHeight){this.lineHeight=13}}_.prototype.move=function(e,t){t=t!==undefined?t:this.lineHeight;switch(e){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t;break}};_.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top};_.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++){if(this.overlaps(e[t])){return true}}return false};_.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right};_.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}};_.prototype.intersectPercentage=function(e){var t=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),r=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top)),i=t*r;return i/(this.height*this.width)};_.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}};_.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0;var r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0;var i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e;var n={left:e.left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||r};return n};function b(e,t,r,i){function n(e,t){var n,a=new _(e),s=1;for(var o=0;o<t.length;o++){while(e.overlapsOppositeAxis(r,t[o])||e.within(r)&&e.overlapsAny(i)){e.move(t[o])}if(e.within(r)){return e}var u=e.intersectPercentage(r);if(s>u){n=new _(e);s=u}e=new _(a)}return n||a}var a=new _(t),s=t.cue,o=m(s),u=[];if(s.snapToLines){var l;switch(s.vertical){case"":u=["+y","-y"];l="height";break;case"rl":u=["+x","-x"];l="width";break;case"lr":u=["-x","+x"];l="width";break}var d=a.lineHeight,f=d*Math.round(o),c=r[l]+d,h=u[0];if(Math.abs(f)>c){f=f<0?-1:1;f*=Math.ceil(c/d)*d}if(o<0){f+=s.vertical===""?r.height:r.width;u=u.reverse()}a.move(h,f)}else{var p=a.lineHeight/r.height*100;switch(s.lineAlign){case"middle":o-=p/2;break;case"end":o-=p;break}switch(s.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")});break}u=["+y","-x","+x","-y"];a=new _(t)}var v=n(a,u);t.move(v.toCSSCompatValues(r))}function T(){}T.StringDecoder=function(){return{decode:function(e){if(!e){return""}if(typeof e!=="string"){throw new Error("Error - expected string data.")}return decodeURIComponent(encodeURIComponent(e))}}};T.convertCueToDOMTree=function(e,t){if(!e||!t){return null}return c(e,t)};var S=.05;var E="sans-serif";var w="1.5%";T.processCues=function(e,t,r){if(!e||!t||!r){return null}while(r.firstChild){r.removeChild(r.firstChild)}var i=e.document.createElement("div");i.style.position="absolute";i.style.left="0";i.style.right="0";i.style.top="0";i.style.bottom="0";i.style.margin=w;r.appendChild(i);function n(e){for(var t=0;t<e.length;t++){if(e[t].hasBeenReset||!e[t].displayState){return true}}return false}if(!n(t)){for(var a=0;a<t.length;a++){i.appendChild(t[a].displayState)}return}var s=[],o=_.getSimpleBoxPosition(i),u=Math.round(o.height*S*100)/100;var l={font:u+"px "+E};(function(){var r,n;for(var a=0;a<t.length;a++){n=t[a];r=new y(e,n,l);i.appendChild(r.div);b(e,r,o,s);n.displayState=r.div;s.push(_.getSimpleBoxPosition(r))}})()};T.Parser=function(e,t,r){if(!r){r=t;t={}}if(!t){t={}}this.window=e;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=r||new TextDecoder("utf8");this.regionList=[]};T.Parser.prototype={reportOrThrowError:function(e){if(e instanceof i){this.onparsingerror&&this.onparsingerror(e)}else{throw e}},parse:function(e){var t=this;if(e){t.buffer+=t.decoder.decode(e,{stream:true})}function r(){var e=t.buffer;var r=0;while(r<e.length&&e[r]!=="\r"&&e[r]!=="\n"){++r}var i=e.substr(0,r);if(e[r]==="\r"){++r}if(e[r]==="\n"){++r}t.buffer=e.substr(r);return i}function u(e){var r=new a;s(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(i.length!==2){break}var n=new a;n.percent("x",i[0]);n.percent("y",i[1]);if(!n.has("x")||!n.has("y")){break}r.set(e+"X",n.get("x"));r.set(e+"Y",n.get("y"));break;case"scroll":r.alt(e,t,["up"]);break}}),/=/,/\s/);if(r.has("id")){var i=new(t.vttjs.VTTRegion||t.window.VTTRegion);i.width=r.get("width",100);i.lines=r.get("lines",3);i.regionAnchorX=r.get("regionanchorX",0);i.regionAnchorY=r.get("regionanchorY",100);i.viewportAnchorX=r.get("viewportanchorX",0);i.viewportAnchorY=r.get("viewportanchorY",100);i.scroll=r.get("scroll","");t.onregion&&t.onregion(i);t.regionList.push({id:r.get("id"),region:i})}}function l(e){var r=new a;s(e,(function(e,t){switch(e){case"MPEGT":r.integer(e+"S",t);break;case"LOCA":r.set(e+"L",n(t));break}}),/[^\d]:/,/,/);t.ontimestampmap&&t.ontimestampmap({MPEGTS:r.get("MPEGTS"),LOCAL:r.get("LOCAL")})}function d(e){if(e.match(/X-TIMESTAMP-MAP/)){s(e,(function(e,t){switch(e){case"X-TIMESTAMP-MAP":l(t);break}}),/=/)}else{s(e,(function(e,t){switch(e){case"Region":u(t);break}}),/:/)}}try{var f;if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer)){return this}f=r();var c=f.match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0]){throw new i(i.Errors.BadSignature)}t.state="HEADER"}var h=false;while(t.buffer){if(!/\r\n|\n/.test(t.buffer)){return this}if(!h){f=r()}else{h=false}switch(t.state){case"HEADER":if(/:/.test(f)){d(f)}else if(!f){t.state="ID"}continue;case"NOTE":if(!f){t.state="ID"}continue;case"ID":if(/^NOTE($|[ \t])/.test(f)){t.state="NOTE";break}if(!f){continue}t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");t.state="CUE";if(f.indexOf("--\x3e")===-1){t.cue.id=f;continue}case"CUE":try{o(f,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e);t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var p=f.indexOf("--\x3e")!==-1;if(!f||p&&(h=true)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}if(t.cue.text){t.cue.text+="\n"}t.cue.text+=f;continue;case"BADCUE":if(!f){t.state="ID"}continue}}}catch(e){t.reportOrThrowError(e);if(t.state==="CUETEXT"&&t.cue&&t.oncue){t.oncue(t.cue)}t.cue=null;t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{e.buffer+=e.decoder.decode();if(e.cue||e.state==="HEADER"){e.buffer+="\n\n";e.parse()}if(e.state==="INITIAL"){throw new i(i.Errors.BadSignature)}}catch(t){e.reportOrThrowError(t)}e.onflush&&e.onflush();return this}};e.exports=T},"./node_modules/videojs-vtt.js/lib/vttcue.js":function(e,t){var r="auto";var i={"":true,lr:true,rl:true};var n={start:true,middle:true,end:true,left:true,right:true};function a(e){if(typeof e!=="string"){return false}var t=i[e.toLowerCase()];return t?e.toLowerCase():false}function s(e){if(typeof e!=="string"){return false}var t=n[e.toLowerCase()];return t?e.toLowerCase():false}function o(e){var t=1;for(;t<arguments.length;t++){var r=arguments[t];for(var i in r){e[i]=r[i]}}return e}function u(e,t,i){var n=this;var u=/MSIE\s8\.0/.test(navigator.userAgent);var l={};if(u){n=document.createElement("custom")}else{l.enumerable=true}n.hasBeenReset=false;var d="";var f=false;var c=e;var h=t;var p=i;var v=null;var m="";var g=true;var y="auto";var _="start";var b=50;var T="middle";var S=50;var E="middle";Object.defineProperty(n,"id",o({},l,{get:function(){return d},set:function(e){d=""+e}}));Object.defineProperty(n,"pauseOnExit",o({},l,{get:function(){return f},set:function(e){f=!!e}}));Object.defineProperty(n,"startTime",o({},l,{get:function(){return c},set:function(e){if(typeof e!=="number"){throw new TypeError("Start time must be set to a number.")}c=e;this.hasBeenReset=true}}));Object.defineProperty(n,"endTime",o({},l,{get:function(){return h},set:function(e){if(typeof e!=="number"){throw new TypeError("End time must be set to a number.")}h=e;this.hasBeenReset=true}}));Object.defineProperty(n,"text",o({},l,{get:function(){return p},set:function(e){p=""+e;this.hasBeenReset=true}}));Object.defineProperty(n,"region",o({},l,{get:function(){return v},set:function(e){v=e;this.hasBeenReset=true}}));Object.defineProperty(n,"vertical",o({},l,{get:function(){return m},set:function(e){var t=a(e);if(t===false){throw new SyntaxError("An invalid or illegal string was specified.")}m=t;this.hasBeenReset=true}}));Object.defineProperty(n,"snapToLines",o({},l,{get:function(){return g},set:function(e){g=!!e;this.hasBeenReset=true}}));Object.defineProperty(n,"line",o({},l,{get:function(){return y},set:function(e){if(typeof e!=="number"&&e!==r){throw new SyntaxError("An invalid number or illegal string was specified.")}y=e;this.hasBeenReset=true}}));Object.defineProperty(n,"lineAlign",o({},l,{get:function(){return _},set:function(e){var t=s(e);if(!t){throw new SyntaxError("An invalid or illegal string was specified.")}_=t;this.hasBeenReset=true}}));Object.defineProperty(n,"position",o({},l,{get:function(){return b},set:function(e){if(e<0||e>100){throw new Error("Position must be between 0 and 100.")}b=e;this.hasBeenReset=true}}));Object.defineProperty(n,"positionAlign",o({},l,{get:function(){return T},set:function(e){var t=s(e);if(!t){throw new SyntaxError("An invalid or illegal string was specified.")}T=t;this.hasBeenReset=true}}));Object.defineProperty(n,"size",o({},l,{get:function(){return S},set:function(e){if(e<0||e>100){throw new Error("Size must be between 0 and 100.")}S=e;this.hasBeenReset=true}}));Object.defineProperty(n,"align",o({},l,{get:function(){return E},set:function(e){var t=s(e);if(!t){throw new SyntaxError("An invalid or illegal string was specified.")}E=t;this.hasBeenReset=true}}));n.displayState=undefined;if(u){return n}}u.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};e.exports=u},"./node_modules/videojs-vtt.js/lib/vttregion.js":function(e,t){var r={"":true,up:true};function i(e){if(typeof e!=="string"){return false}var t=r[e.toLowerCase()];return t?e.toLowerCase():false}function n(e){return typeof e==="number"&&(e>=0&&e<=100)}function a(){var e=100;var t=3;var r=0;var a=100;var s=0;var o=100;var u="";Object.defineProperties(this,{width:{enumerable:true,get:function(){return e},set:function(t){if(!n(t)){throw new Error("Width must be between 0 and 100.")}e=t}},lines:{enumerable:true,get:function(){return t},set:function(e){if(typeof e!=="number"){throw new TypeError("Lines must be set to a number.")}t=e}},regionAnchorY:{enumerable:true,get:function(){return a},set:function(e){if(!n(e)){throw new Error("RegionAnchorX must be between 0 and 100.")}a=e}},regionAnchorX:{enumerable:true,get:function(){return r},set:function(e){if(!n(e)){throw new Error("RegionAnchorY must be between 0 and 100.")}r=e}},viewportAnchorY:{enumerable:true,get:function(){return o},set:function(e){if(!n(e)){throw new Error("ViewportAnchorY must be between 0 and 100.")}o=e}},viewportAnchorX:{enumerable:true,get:function(){return s},set:function(e){if(!n(e)){throw new Error("ViewportAnchorX must be between 0 and 100.")}s=e}},scroll:{enumerable:true,get:function(){return u},set:function(e){var t=i(e);if(t===false){throw new SyntaxError("An invalid or illegal string was specified.")}u=t}}})}e.exports=a}}]);
//# sourceMappingURL=vendor-videojs.84b516ab458dfea2eac8.js.map